<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src * 'self' data: gap: capacitor: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; script-src * 'self' 'unsafe-inline' 'unsafe-eval';">
  <title>React App Test</title>
  <style>
    body { font-family: -apple-system, system-ui, sans-serif; padding: 20px; }
    .panel { background: #f0f0f0; border-radius: 8px; padding: 15px; margin-bottom: 15px; }
    .success { color: green; }
    .error { color: red; }
    button { padding: 10px; margin: 5px 0; border-radius: 4px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <div class="panel">
    <h1>React App Test</h1>
    <p>This page tests if React can initialize correctly.</p>
    <div id="status">Starting tests...</div>
  </div>
  
  <div class="panel">
    <h2>1. DOM Structure Test</h2>
    <p>Testing if we can create and find DOM elements</p>
    <div id="dom-test-area"></div>
    <button onclick="runDOMTest()">Run DOM Test</button>
  </div>
  
  <div class="panel">
    <h2>2. React CDN Test</h2>
    <p>Testing if React loads from CDN</p>
    <div id="react-cdn-root"></div>
    <button onclick="loadReactCDN()">Load React from CDN</button>
  </div>
  
  <div class="panel">
    <h2>3. Original App Structure</h2>
    <p>This is the original root div:</p>
    <div id="root"></div>
    <button onclick="checkRoot()">Check Root Element</button>
  </div>
  
  <script>
    // Update status
    function updateStatus(message, type) {
      document.getElementById('status').innerHTML = 
        `<span class="${type || 'info'}">${message}</span>`;
      console.log(`[${type || 'info'}] ${message}`);
    }
    
    // Log to a specific area
    function logTo(id, message, type) {
      const el = document.getElementById(id);
      if (el) {
        el.innerHTML += `<div class="${type || 'info'}">${message}</div>`;
      }
    }
    
    // Test 1: DOM manipulation
    function runDOMTest() {
      try {
        const testArea = document.getElementById('dom-test-area');
        testArea.innerHTML = ''; // Clear previous results
        
        // Create a test element
        const testDiv = document.createElement('div');
        testDiv.id = 'test-element';
        testDiv.textContent = 'Test element created successfully!';
        testDiv.style.padding = '10px';
        testDiv.style.border = '1px solid green';
        testDiv.style.marginTop = '10px';
        
        testArea.appendChild(testDiv);
        
        // Can we find it?
        const found = document.getElementById('test-element');
        if (found) {
          logTo('dom-test-area', 'Successfully created and found test element', 'success');
        } else {
          logTo('dom-test-area', 'Failed to find test element after creation', 'error');
        }
      } catch (e) {
        logTo('dom-test-area', `Error in DOM test: ${e.message}`, 'error');
      }
    }
    
    // Test 2: Load React from CDN
    function loadReactCDN() {
      try {
        updateStatus('Loading React from CDN...', 'info');
        const reactRoot = document.getElementById('react-cdn-root');
        reactRoot.innerHTML = 'Loading React...';
        
        // Load React scripts
        const script1 = document.createElement('script');
        script1.src = 'https://unpkg.com/react@18.2.0/umd/react.production.min.js';
        
        script1.onload = function() {
          logTo('react-cdn-root', 'React core loaded', 'success');
          
          const script2 = document.createElement('script');
          script2.src = 'https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js';
          
          script2.onload = function() {
            logTo('react-cdn-root', 'ReactDOM loaded', 'success');
            
            // Try to render a component
            setTimeout(function() {
              try {
                const container = document.createElement('div');
                container.id = 'react-test-container';
                reactRoot.appendChild(container);
                
                const root = ReactDOM.createRoot(container);
                
                // Create a hello world component with plain JS
                const element = React.createElement(
                  'div',
                  { style: { padding: '10px', border: '1px solid blue', marginTop: '10px' } },
                  'Hello from React 18!'
                );
                
                root.render(element);
                logTo('react-cdn-root', 'React rendered successfully!', 'success');
              } catch (e) {
                logTo('react-cdn-root', `Error rendering React: ${e.message}`, 'error');
              }
            }, 500);
          };
          
          script2.onerror = function() {
            logTo('react-cdn-root', 'Failed to load ReactDOM', 'error');
          };
          
          document.head.appendChild(script2);
        };
        
        script1.onerror = function() {
          logTo('react-cdn-root', 'Failed to load React core', 'error');
        };
        
        document.head.appendChild(script1);
      } catch (e) {
        logTo('react-cdn-root', `Error in React CDN test: ${e.message}`, 'error');
      }
    }
    
    // Test 3: Check original root
    function checkRoot() {
      try {
        const root = document.getElementById('root');
        if (root) {
          root.innerHTML = '<div style="padding: 10px; border: 1px solid green;">Root element found and working!</div>';
          updateStatus('Root element is working correctly!', 'success');
        } else {
          updateStatus('Root element not found!', 'error');
        }
      } catch (e) {
        updateStatus(`Error checking root: ${e.message}`, 'error');
      }
    }
    
    // Run on page load
    document.addEventListener('DOMContentLoaded', function() {
      updateStatus('Test page loaded successfully', 'success');
      
      // Auto-run the root check
      setTimeout(checkRoot, 500);
    });
  </script>
</body>
</html>