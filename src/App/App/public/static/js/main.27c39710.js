/*! For license information please see main.27c39710.js.LICENSE.txt */
(()=>{var e={422:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=o(n(9007)),i=o(n(5301)),a=n(4709);function o(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var c=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],u=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],d=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));if(r.isValid=!1,-1!==e.search(/^[0-9]{6}$/))r.middleDigits=e,r.upcA=h(e,"0"),r.text=n.text||""+r.upcA[0]+e+r.upcA[r.upcA.length-1],r.isValid=!0;else{if(-1===e.search(/^[01][0-9]{7}$/))return l(r);if(r.middleDigits=e.substring(1,e.length-1),r.upcA=h(r.middleDigits,e[0]),r.upcA[r.upcA.length-1]!==e[e.length-1])return l(r);r.isValid=!0}return r.displayValue=n.displayValue,n.fontSize>10*n.width?r.fontSize=10*n.width:r.fontSize=n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var e="";return e+="101",e+=this.encodeMiddleDigits(),{data:e+="010101",text:this.text}}},{key:"guardedEncoding",value:function(){var e=[];return this.displayValue&&e.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),e.push({data:"101",options:{height:this.guardHeight}}),e.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),e.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&e.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),e}},{key:"encodeMiddleDigits",value:function(){var e=this.upcA[0],t=this.upcA[this.upcA.length-1],n=u[parseInt(t)][parseInt(e)];return(0,s.default)(this.middleDigits,n)}}]),t}(i.default);function h(e,t){for(var n=parseInt(e[e.length-1]),r=c[n],s="",i=0,o=0;o<r.length;o++){var l=r[o];s+="X"===l?e[i++]:l}return""+(s=""+t+s)+(0,a.checksum)(s)}t.default=d},443:(e,t,n)=>{"use strict";n.d(t,{$b:()=>s,Vy:()=>c});const r=[];var s;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(s||(s={}));const i={debug:s.DEBUG,verbose:s.VERBOSE,info:s.INFO,warn:s.WARN,error:s.ERROR,silent:s.SILENT},a=s.INFO,o={[s.DEBUG]:"log",[s.VERBOSE]:"log",[s.INFO]:"info",[s.WARN]:"warn",[s.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=o[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var s=arguments.length,i=new Array(s>2?s-2:0),a=2;a<s;a++)i[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...i)};class c{constructor(e){this.name=e,this._logLevel=a,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in s))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?i[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.DEBUG,...t),this._logHandler(this,s.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.VERBOSE,...t),this._logHandler(this,s.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.INFO,...t),this._logHandler(this,s.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.WARN,...t),this._logHandler(this,s.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,s.ERROR,...t),this._logHandler(this,s.ERROR,...t)}}},579:(e,t,n)=>{"use strict";e.exports=n(1153)},799:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var n in t)t.hasOwnProperty(n)&&"string"===typeof e[n=t[n]]&&(e[n]=parseInt(e[n],10));"string"===typeof e.displayValue&&(e.displayValue="false"!=e.displayValue);return e}},917:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9918),i=a(n(9007));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var e=s.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,i.default)(this.data,e,"01"),text:this.text}}}]),t}(a(n(5301)).default);t.default=o},1029:(e,t)=>{"use strict";var n;function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var s=t.SET_A=0,i=t.SET_B=1,a=t.SET_C=2,o=(t.SHIFT=98,t.START_A=103),l=t.START_B=104,c=t.START_C=105;t.MODULO=103,t.STOP=106,t.FNC1=207,t.SET_BY_CODE=(r(n={},o,s),r(n,l,i),r(n,c,a),n),t.SWAP={101:s,100:i,99:a},t.A_START_CHAR=String.fromCharCode(208),t.B_START_CHAR=String.fromCharCode(209),t.C_START_CHAR=String.fromCharCode(210),t.A_CHARS="[\0-_\xc8-\xcf]",t.B_CHARS="[ -\x7f\xc8-\xcf]",t.C_CHARS="(\xcf*[0-9]{2}\xcf*)",t.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]},1153:(e,t,n)=>{"use strict";var r=n(5043),s=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:s,type:e,key:c,ref:u,props:i,_owner:o.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},1157:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.object=t,this.encodings=n,this.options=r}return n(e,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),e}();t.default=r},1257:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GenericBarcode=void 0;var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5301);var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),t}(((r=i)&&r.__esModule?r:{default:r}).default);t.GenericBarcode=a},1466:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t}return n(e,[{key:"handleCatch",value:function(e){if("InvalidInputException"!==e.name)throw e;if(this.api._options.valid===this.api._defaults.valid)throw e.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(e){try{var t=e.apply(void 0,arguments);return this.api._options.valid(!0),t}catch(n){return this.handleCatch(n),this.api}}}]),e}();t.default=r},1497:(e,t,n)=>{"use strict";var r=n(3218);function s(){}function i(){}i.resetWarningCache=s,e.exports=function(){function e(e,t,n,s,i,a){if(a!==r){var o=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:s};return n.PropTypes=n,n}},1529:(e,t,n)=>{"use strict";n.d(t,{cY:()=>f,FA:()=>_,g:()=>F,u:()=>o,Uj:()=>a,Fy:()=>v,tD:()=>B,bD:()=>R,hp:()=>L,T9:()=>h,Tj:()=>u,yU:()=>d,XA:()=>m,mS:()=>l,Ku:()=>q,ZQ:()=>w,sr:()=>j,zJ:()=>p,c1:()=>N,Im:()=>I,lT:()=>E,zW:()=>k,jZ:()=>D,lV:()=>C,nr:()=>A,gE:()=>g,Am:()=>O,I9:()=>M,P1:()=>b,eX:()=>S});const r=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296===(64512&s)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],i=s+1<e.length,a=i?e[s+1]:0,o=s+2<e.length,l=o?e[s+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,i||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(r(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const i=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],a=s<e.length?n[e.charAt(s)]:0;++s;const o=s<e.length?n[e.charAt(s)]:64;++s;const l=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==a||null==o||null==l)throw new i;const c=t<<2|a>>4;if(r.push(c),64!==o){const e=a<<4&240|o>>2;if(r.push(e),64!==l){const e=o<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){return function(e){const t=r(e);return s.encodeByteArray(t,!0)}(e).replace(/\./g,"")},o=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function l(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const c=()=>{try{return l().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&o(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},u=e=>{var t,n;return null===(n=null===(t=c())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},d=e=>{const t=u(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},h=()=>{var e;return null===(e=c())||void 0===e?void 0:e.config},m=e=>{var t;return null===(t=c())||void 0===t?void 0:t["_".concat(e)]};class f{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function p(e){return e.endsWith(".cloudworkstations.dev")}async function g(e){return(await fetch(e,{credentials:"include"})).ok}function v(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(i)),""].join(".")}const x={};let y=!1;function b(e,t){if("undefined"===typeof window||"undefined"===typeof document||!p(window.location.host)||x[e]===t||x[e]||y)return;function n(e){return"__firebase__banner__".concat(e)}x[e]=t;const r="__firebase__banner",s=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(x))x[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{y=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function a(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),a=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,a,l,n),document.body.appendChild(t)}s?(a.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',a.innerText="Preview backend running in this workspace."),a.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",a):a()}function w(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function D(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(w())}function N(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function j(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function C(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function E(){const e=w();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function A(){return!function(){var e;const t=null===(e=c())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k(){try{return"object"===typeof indexedDB}catch(e){return!1}}function S(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var e;t((null===(e=s.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class F extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,F.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_.prototype.create)}}class _{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],s=r?function(e,t){return e.replace(T,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",i="".concat(this.serviceName,": ").concat(s," (").concat(n,").");return new F(n,i,t)}}const T=/\{\$([^}]+)}/g;function I(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function R(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],i=t[s];if(P(n)&&P(i)){if(!R(n,i))return!1}else if(n!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function P(e){return null!==e&&"object"===typeof e}function O(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function M(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function L(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function B(e,t){const n=new z(e,t);return n.subscribe.bind(n)}class z{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=U),void 0===r.error&&(r.error=U),void 0===r.complete&&(r.complete=U);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function U(){}function q(e){return e&&e._delegate?e._delegate:e}},1573:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(3498),i=(r=s)&&r.__esModule?r:{default:r},a=n(8997);var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e+=(0,a.mod11)(e),e+=(0,a.mod10)(e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o},1616:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CODE128C=t.CODE128B=t.CODE128A=t.CODE128=void 0;var r=o(n(7754)),s=o(n(7587)),i=o(n(2182)),a=o(n(2901));function o(e){return e&&e.__esModule?e:{default:e}}t.CODE128=r.default,t.CODE128A=s.default,t.CODE128B=i.default,t.CODE128C=a.default},1704:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(3498),i=(r=s)&&r.__esModule?r:{default:r},a=n(8997);var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+(0,a.mod11)(e),n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o},2179:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,n);if(void 0===s){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in s)return s.value;var a=s.get;return void 0!==a?a.call(r):void 0},a=n(9918),o=n(9011),l=(r=o)&&r.__esModule?r:{default:r};var c=function(e){return(10-e.substr(0,12).split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+3*t:e+t}),0)%10)%10},u=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),-1!==e.search(/^[0-9]{12}$/)&&(e+=c(e));var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.lastChar=n.lastChar,r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===c(this.data)}},{key:"leftText",value:function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var e=this.data.substr(1,6),n=a.EAN13_STRUCTURE[this.data[0]];return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftEncode",this).call(this,e,n)}},{key:"rightText",value:function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var e=this.data.substr(7,6);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightEncode",this).call(this,e,"RRRRRR")}},{key:"encodeGuarded",value:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(e.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(e.push({data:"00"}),e.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),e}}]),t}(l.default);t.default=u},2182:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6190),a=(r=i)&&r.__esModule?r:{default:r},o=n(1029);var l=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.B_START_CHAR+e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return new RegExp("^"+o.B_CHARS+"+$").test(this.data)}}]),t}(a.default);t.default=l},2352:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9918),i=o(n(9007)),a=o(n(5301));function o(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var e,t=s.EAN5_STRUCTURE[(e=this.data,e.split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+9*t:e+3*t}),0)%10)];return{data:"1011"+(0,i.default)(this.data,t,"01"),text:this.text}}}]),t}(a.default);t.default=l},2522:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(9224),a=(r=i)&&r.__esModule?r:{default:r},o=n(3531);var l=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.encodings=n,this.options=r}return s(e,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var e=0;e<this.encodings.length;e++){var t=(0,a.default)(this.options,this.encodings[e].options);this.drawCanvasBarcode(t,this.encodings[e]),this.drawCanvasText(t,this.encodings[e]),this.moveCanvasDrawing(this.encodings[e])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var e=this.canvas.getContext("2d");e.save(),(0,o.calculateEncodingAttributes)(this.encodings,this.options,e);var t=(0,o.getTotalWidthOfEncodings)(this.encodings),n=(0,o.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=t+this.options.marginLeft+this.options.marginRight,this.canvas.height=n,e.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(e.fillStyle=this.options.background,e.fillRect(0,0,this.canvas.width,this.canvas.height)),e.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(e,t){var n,r=this.canvas.getContext("2d"),s=t.data;n="top"==e.textPosition?e.marginTop+e.fontSize+e.textMargin:e.marginTop,r.fillStyle=e.lineColor;for(var i=0;i<s.length;i++){var a=i*e.width+t.barcodePadding;"1"===s[i]?r.fillRect(a,n,e.width,e.height):s[i]&&r.fillRect(a,n,e.width,e.height*s[i])}}},{key:"drawCanvasText",value:function(e,t){var n,r,s=this.canvas.getContext("2d"),i=e.fontOptions+" "+e.fontSize+"px "+e.font;e.displayValue&&(r="top"==e.textPosition?e.marginTop+e.fontSize-e.textMargin:e.height+e.textMargin+e.marginTop+e.fontSize,s.font=i,"left"==e.textAlign||t.barcodePadding>0?(n=0,s.textAlign="left"):"right"==e.textAlign?(n=t.width-1,s.textAlign="right"):(n=t.width/2,s.textAlign="center"),s.fillText(t.text,n,r))}},{key:"moveCanvasDrawing",value:function(e){this.canvas.getContext("2d").translate(e.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),e}();t.default=l},2546:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pharmacode=void 0;var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5301);var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.number=parseInt(e,10),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"encode",value:function(){for(var e=this.number,t="";!isNaN(e)&&0!=e;)e%2===0?(t="11100"+t,e=(e-2)/2):(t="100"+t,e=(e-1)/2);return{data:t=t.slice(0,-2),text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),t}(((r=i)&&r.__esModule?r:{default:r}).default);t.pharmacode=a},2730:(e,t,n)=>{"use strict";var r=n(5043),s=n(8853);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function p(e,t,n,r,s,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function x(e){return e[1].toUpperCase()}function y(e,t,n,r){var s=g.hasOwnProperty(t)?g[t]:null;(null!==s?0!==s.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,r)&&(n=null),r||null===s?function(e){return!!d.call(f,e)||!d.call(m,e)&&(h.test(e)?f[e]=!0:(m[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,r=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,x);g[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,x);g[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,x);g[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),D=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),A=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),F=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var I=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var O,M=Object.assign;function L(e){if(void 0===O)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var B=!1;function z(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),i=r.stack.split("\n"),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(1!==a||1!==o)do{if(a--,0>--o||s[a]!==i[o]){var l="\n"+s[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?L(e):""}function U(e){switch(e.tag){case 5:return L(e.type);case 16:return L("Lazy");case 13:return L("Suspense");case 19:return L("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case D:return"Portal";case C:return"Profiler";case j:return"StrictMode";case S:return"Suspense";case F:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case E:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case _:return null!==(t=e.displayName||null)?t:q(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q(t);case 8:return t===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function $(e,t){X(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(r&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ie(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),s=pe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}Object.keys(me).forEach((function(e){fe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]}))}));var ve=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var De=null,Ne=null,je=null;function Ce(e){if(e=ys(e)){if("function"!==typeof De)throw Error(i(280));var t=e.stateNode;t&&(t=ws(t),De(e.stateNode,e.type,t))}}function Ee(e){Ne?je?je.push(e):je=[e]:Ne=e}function Ae(){if(Ne){var e=Ne,t=je;if(je=Ne=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function ke(e,t){return e(t)}function Se(){}var Fe=!1;function _e(e,t,n){if(Fe)return e(t,n);Fe=!0;try{return ke(e,t,n)}finally{Fe=!1,(null!==Ne||null!==je)&&(Se(),Ae())}}function Te(e,t){var n=e.stateNode;if(null===n)return null;var r=ws(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Ie=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){Ie=!1}function Pe(e,t,n,r,s,i,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Oe=!1,Me=null,Le=!1,Be=null,ze={onError:function(e){Oe=!0,Me=e}};function Ue(e,t,n,r,s,i,a,o,l){Oe=!1,Me=null,Pe.apply(ze,arguments)}function qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(qe(e)!==e)throw Error(i(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=qe(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(null===s)break;var a=s.alternate;if(null===a){if(null!==(r=s.return)){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return He(s),e;if(a===r)return He(s),t;a=a.sibling}throw Error(i(188))}if(n.return!==r.return)n=s,r=a;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=a;break}if(l===r){o=!0,r=s,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=s;break}if(l===r){o=!0,r=a,n=s;break}l=l.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=s.unstable_scheduleCallback,Qe=s.unstable_cancelCallback,Ye=s.unstable_shouldYield,Je=s.unstable_requestPaint,Xe=s.unstable_now,$e=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,rt=s.unstable_IdlePriority,st=null,it=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~s;0!==o?r=dt(o):0!==(i&=a)&&(r=dt(i))}else 0!==(a=n&~s)?r=dt(a):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(i=t&-t)||16===s&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)s=1<<(n=31-at(t)),r|=e[n],t&=~s;return r}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function xt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var yt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,Dt,Nt,jt,Ct,Et=!1,At=[],kt=null,St=null,Ft=null,_t=new Map,Tt=new Map,It=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":kt=null;break;case"dragenter":case"dragleave":St=null;break;case"mouseover":case"mouseout":Ft=null;break;case"pointerover":case"pointerout":_t.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tt.delete(t.pointerId)}}function Ot(e,t,n,r,s,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},null!==t&&(null!==(t=ys(t))&&Dt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Mt(e){var t=xs(e.target);if(null!==t){var n=qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ve(n)))return e.blockedOn=t,void Ct(e.priority,(function(){Nt(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Lt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ys(n))&&Dt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Bt(e,t,n){Lt(e)&&n.delete(t)}function zt(){Et=!1,null!==kt&&Lt(kt)&&(kt=null),null!==St&&Lt(St)&&(St=null),null!==Ft&&Lt(Ft)&&(Ft=null),_t.forEach(Bt),Tt.forEach(Bt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Et||(Et=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,zt)))}function qt(e){function t(t){return Ut(t,e)}if(0<At.length){Ut(At[0],e);for(var n=1;n<At.length;n++){var r=At[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==kt&&Ut(kt,e),null!==St&&Ut(St,e),null!==Ft&&Ut(Ft,e),_t.forEach(t),Tt.forEach(t),n=0;n<It.length;n++)(r=It[n]).blockedOn===e&&(r.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Mt(n),null===n.blockedOn&&It.shift()}var Vt=b.ReactCurrentBatchConfig,Ht=!0;function Wt(e,t,n,r){var s=yt,i=Vt.transition;Vt.transition=null;try{yt=1,Kt(e,t,n,r)}finally{yt=s,Vt.transition=i}}function Gt(e,t,n,r){var s=yt,i=Vt.transition;Vt.transition=null;try{yt=4,Kt(e,t,n,r)}finally{yt=s,Vt.transition=i}}function Kt(e,t,n,r){if(Ht){var s=Yt(e,t,n,r);if(null===s)Hr(e,t,r,Qt,n),Pt(e,r);else if(function(e,t,n,r,s){switch(t){case"focusin":return kt=Ot(kt,e,t,n,r,s),!0;case"dragenter":return St=Ot(St,e,t,n,r,s),!0;case"mouseover":return Ft=Ot(Ft,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return _t.set(i,Ot(_t.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Tt.set(i,Ot(Tt.get(i)||null,e,t,n,r,s)),!0}return!1}(s,e,t,n,r))r.stopPropagation();else if(Pt(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==s;){var i=ys(s);if(null!==i&&wt(i),null===(i=Yt(e,t,n,r))&&Hr(e,t,r,Qt,n),i===s)break;s=i}null!==s&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=xs(e=we(r))))if(null===(t=qe(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,$t=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=$t,r=n.length,s="value"in Xt?Xt.value:Xt.textContent,i=s.length;for(e=0;e<r&&n[e]===s[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===s[i-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,s,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=M({},cn,{view:0,detail:0}),hn=sn(dn),mn=M({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),fn=sn(mn),pn=sn(M({},mn,{dataTransfer:0})),gn=sn(M({},dn,{relatedTarget:0})),vn=sn(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),xn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=sn(xn),bn=sn(M({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Cn(){return jn}var En=M({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Dn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),An=sn(En),kn=sn(M({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Sn=sn(M({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Fn=sn(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),_n=M({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Tn=sn(_n),In=[9,13,27,32],Rn=u&&"CompositionEvent"in window,Pn=null;u&&"documentMode"in document&&(Pn=document.documentMode);var On=u&&"TextEvent"in window&&!Pn,Mn=u&&(!Rn||Pn&&8<Pn&&11>=Pn),Ln=String.fromCharCode(32),Bn=!1;function zn(e,t){switch(e){case"keyup":return-1!==In.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var Vn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ee(r),0<(t=Gr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Qn(e){Lr(e,0)}function Yn(e){if(K(bs(e)))return e}function Jn(e,t){if("change"===e)return t}var Xn=!1;if(u){var $n;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Xn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Kn=Gn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];Wn(t,Kn,e,we(e)),_e(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function ir(e,t){if("click"===e)return Yn(t)}function ar(e,t){if("input"===e||"change"===e)return Yn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!d.call(t,s)||!or(e[s],t[s]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&mr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=void 0===r.end?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=ur(n,i);var a=ur(n,r);s&&a&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,xr=null,yr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&mr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},xr&&lr(xr,r)||(xr=r,0<(r=Gr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Dr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Nr={},jr={};function Cr(e){if(Nr[e])return Nr[e];if(!Dr[e])return e;var t,n=Dr[e];for(t in n)if(n.hasOwnProperty(t)&&t in jr)return Nr[e]=n[t];return e}u&&(jr=document.createElement("div").style,"AnimationEvent"in window||(delete Dr.animationend.animation,delete Dr.animationiteration.animation,delete Dr.animationstart.animation),"TransitionEvent"in window||delete Dr.transitionend.transition);var Er=Cr("animationend"),Ar=Cr("animationiteration"),kr=Cr("animationstart"),Sr=Cr("transitionend"),Fr=new Map,_r="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(e,t){Fr.set(e,t),l(t,[e])}for(var Ir=0;Ir<_r.length;Ir++){var Rr=_r[Ir];Tr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Tr(Er,"onAnimationEnd"),Tr(Ar,"onAnimationIteration"),Tr(kr,"onAnimationStart"),Tr("dblclick","onDoubleClick"),Tr("focusin","onFocus"),Tr("focusout","onBlur"),Tr(Sr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Or=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,s,a,o,l,c){if(Ue.apply(this,arguments),Oe){if(!Oe)throw Error(i(198));var u=Me;Oe=!1,Me=null,Le||(Le=!0,Be=u)}}(r,t,void 0,e),e.currentTarget=null}function Lr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;Mr(s,o,c),i=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;Mr(s,o,c),i=l}}}if(Le)throw e=Be,Le=!1,Be=null,e}function Br(e,t){var n=t[ps];void 0===n&&(n=t[ps]=new Set);var r=e+"__bubble";n.has(r)||(Vr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Vr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function qr(e){if(!e[Ur]){e[Ur]=!0,a.forEach((function(t){"selectionchange"!==t&&(Or.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,zr("selectionchange",!1,t))}}function Vr(e,t,n,r){switch(Jt(t)){case 1:var s=Wt;break;case 4:s=Gt;break;default:s=Kt}n=s.bind(null,t,n,e),s=void 0,!Ie||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),r?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,s){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;a=a.return}for(;null!==o;){if(null===(a=xs(o)))return;if(5===(l=a.tag)||6===l){r=i=a;continue e}o=o.parentNode}}r=r.return}_e((function(){var r=i,s=we(n),a=[];e:{var o=Fr.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=An;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Sn;break;case Er:case Ar:case kr:l=vn;break;case Sr:l=Fn;break;case"scroll":l=hn;break;case"wheel":l=Tn;break;case"copy":case"cut":case"paste":l=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=kn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var m,f=r;null!==f;){var p=(m=f).stateNode;if(5===m.tag&&null!==p&&(m=p,null!==h&&(null!=(p=Te(f,h))&&u.push(Wr(f,p,m)))),d)break;f=f.return}0<u.length&&(o=new l(o,c,null,n,s),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!xs(c)&&!c[fs])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?xs(c):null)&&(c!==(d=qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=fn,p="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=kn,p="onPointerLeave",h="onPointerEnter",f="pointer"),d=null==l?o:bs(l),m=null==c?o:bs(c),(o=new u(p,f+"leave",l,n,s)).target=d,o.relatedTarget=m,p=null,xs(s)===r&&((u=new u(h,f+"enter",c,n,s)).target=m,u.relatedTarget=d,p=u),d=p,l&&c)e:{for(h=c,f=0,m=u=l;m;m=Kr(m))f++;for(m=0,p=h;p;p=Kr(p))m++;for(;0<f-m;)u=Kr(u),f--;for(;0<m-f;)h=Kr(h),m--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Kr(u),h=Kr(h)}u=null}else u=null;null!==l&&Qr(a,o,l,u,!1),null!==c&&null!==d&&Qr(a,d,c,u,!0)}if("select"===(l=(o=r?bs(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Jn;else if(Hn(o))if(Xn)g=ar;else{g=sr;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ir);switch(g&&(g=g(e,r))?Wn(a,g,n,s):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?bs(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,xr=null);break;case"focusout":xr=vr=gr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,br(a,n,s);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":br(a,n,s)}var x;if(Rn)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else qn?zn(e,n)&&(y="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(y="onCompositionStart");y&&(Mn&&"ko"!==n.locale&&(qn||"onCompositionStart"!==y?"onCompositionEnd"===y&&qn&&(x=en()):($t="value"in(Xt=s)?Xt.value:Xt.textContent,qn=!0)),0<(v=Gr(r,y)).length&&(y=new bn(y,e,null,n,s),a.push({event:y,listeners:v}),x?y.data=x:null!==(x=Un(n))&&(y.data=x))),(x=On?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Bn=!0,Ln);case"textInput":return(e=t.data)===Ln&&Bn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Rn&&zn(e,t)?(e=en(),Zt=$t=Xt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(s=new bn("onBeforeInput","beforeinput",null,n,s),a.push({event:s,listeners:r}),s.data=x))}Lr(a,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var s=e,i=s.stateNode;5===s.tag&&null!==i&&(s=i,null!=(i=Te(e,n))&&r.unshift(Wr(e,i,s)),null!=(i=Te(e,t))&&r.push(Wr(e,i,s))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,s){for(var i=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,s?null!=(l=Te(n,i))&&a.unshift(Wr(n,l,o)):s||null!=(l=Te(n,i))&&a.push(Wr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Yr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Jr,"")}function $r(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(i(425))}function Zr(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rs="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,is="function"===typeof Promise?Promise:void 0,as="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof is?function(e){return is.resolve(null).then(e).catch(os)}:rs;function os(e){setTimeout((function(){throw e}))}function ls(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===r)return e.removeChild(s),void qt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=s}while(n);qt(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function us(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ds=Math.random().toString(36).slice(2),hs="__reactFiber$"+ds,ms="__reactProps$"+ds,fs="__reactContainer$"+ds,ps="__reactEvents$"+ds,gs="__reactListeners$"+ds,vs="__reactHandles$"+ds;function xs(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fs]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=us(e);null!==e;){if(n=e[hs])return n;e=us(e)}return t}n=(e=n).parentNode}return null}function ys(e){return!(e=e[hs]||e[fs])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ws(e){return e[ms]||null}var Ds=[],Ns=-1;function js(e){return{current:e}}function Cs(e){0>Ns||(e.current=Ds[Ns],Ds[Ns]=null,Ns--)}function Es(e,t){Ns++,Ds[Ns]=e.current,e.current=t}var As={},ks=js(As),Ss=js(!1),Fs=As;function _s(e,t){var n=e.type.contextTypes;if(!n)return As;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s,i={};for(s in n)i[s]=t[s];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ts(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Is(){Cs(Ss),Cs(ks)}function Rs(e,t,n){if(ks.current!==As)throw Error(i(168));Es(ks,t),Es(Ss,n)}function Ps(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var s in r=r.getChildContext())if(!(s in t))throw Error(i(108,V(e)||"Unknown",s));return M({},n,r)}function Os(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||As,Fs=ks.current,Es(ks,e),Es(Ss,Ss.current),!0}function Ms(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ps(e,t,Fs),r.__reactInternalMemoizedMergedChildContext=e,Cs(Ss),Cs(ks),Es(ks,e)):Cs(Ss),Es(Ss,n)}var Ls=null,Bs=!1,zs=!1;function Us(e){null===Ls?Ls=[e]:Ls.push(e)}function qs(){if(!zs&&null!==Ls){zs=!0;var e=0,t=yt;try{var n=Ls;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ls=null,Bs=!1}catch(s){throw null!==Ls&&(Ls=Ls.slice(e+1)),Ke(Ze,qs),s}finally{yt=t,zs=!1}}return null}var Vs=[],Hs=0,Ws=null,Gs=0,Ks=[],Qs=0,Ys=null,Js=1,Xs="";function $s(e,t){Vs[Hs++]=Gs,Vs[Hs++]=Ws,Ws=e,Gs=t}function Zs(e,t,n){Ks[Qs++]=Js,Ks[Qs++]=Xs,Ks[Qs++]=Ys,Ys=e;var r=Js;e=Xs;var s=32-at(r)-1;r&=~(1<<s),n+=1;var i=32-at(t)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Js=1<<32-at(t)+s|n<<s|r,Xs=i+e}else Js=1<<i|n<<s|r,Xs=e}function ei(e){null!==e.return&&($s(e,1),Zs(e,1,0))}function ti(e){for(;e===Ws;)Ws=Vs[--Hs],Vs[Hs]=null,Gs=Vs[--Hs],Vs[Hs]=null;for(;e===Ys;)Ys=Ks[--Qs],Ks[Qs]=null,Xs=Ks[--Qs],Ks[Qs]=null,Js=Ks[--Qs],Ks[Qs]=null}var ni=null,ri=null,si=!1,ii=null;function ai(e,t){var n=_c(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ys?{id:Js,overflow:Xs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=_c(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function li(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(si){var t=ri;if(t){var n=t;if(!oi(e,t)){if(li(e))throw Error(i(418));t=cs(n.nextSibling);var r=ni;t&&oi(e,t)?ai(r,n):(e.flags=-4097&e.flags|2,si=!1,ni=e)}}else{if(li(e))throw Error(i(418));e.flags=-4097&e.flags|2,si=!1,ni=e}}}function ui(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!si)return ui(e),si=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ri)){if(li(e))throw hi(),Error(i(418));for(;t;)ai(e,t),t=cs(t.nextSibling)}if(ui(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?cs(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=cs(e.nextSibling)}function mi(){ri=ni=null,si=!1}function fi(e){null===ii?ii=[e]:ii.push(e)}var pi=b.ReactCurrentBatchConfig;function gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var s=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=s.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function vi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xi(e){return(0,e._init)(e._payload)}function yi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Ic(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Mc(n,e.mode,r)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===N?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===T&&xi(i)===t.type)?((r=s(t,n.props)).ref=gi(e,t,n),r.return=e,r):((r=Rc(n.type,n.key,n.props,null,e.mode,r)).ref=gi(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Lc(n,e.mode,r)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Pc(n,e.mode,r,i)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Rc(t.type,t.key,t.props,null,e.mode,n)).ref=gi(e,null,t),n.return=e,n;case D:return(t=Lc(t,e.mode,n)).return=e,t;case T:return h(e,(0,t._init)(t._payload),n)}if(te(t)||P(t))return(t=Pc(t,e.mode,n,null)).return=e,t;vi(e,t)}return null}function m(e,t,n,r){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,r):null;case D:return n.key===s?u(e,t,n,r):null;case T:return m(e,t,(s=n._init)(n._payload),r)}if(te(n)||P(n))return null!==s?null:d(e,t,n,r,null);vi(e,n)}return null}function f(e,t,n,r,s){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,s);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,s);case D:return u(t,e=e.get(null===r.key?n:r.key)||null,r,s);case T:return f(e,t,n,(0,r._init)(r._payload),s)}if(te(r)||P(r))return d(t,e=e.get(n)||null,r,s,null);vi(t,r)}return null}function p(s,i,o,l){for(var c=null,u=null,d=i,p=i=0,g=null;null!==d&&p<o.length;p++){d.index>p?(g=d,d=null):g=d.sibling;var v=m(s,d,o[p],l);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(s,d),i=a(v,i,p),null===u?c=v:u.sibling=v,u=v,d=g}if(p===o.length)return n(s,d),si&&$s(s,p),c;if(null===d){for(;p<o.length;p++)null!==(d=h(s,o[p],l))&&(i=a(d,i,p),null===u?c=d:u.sibling=d,u=d);return si&&$s(s,p),c}for(d=r(s,d);p<o.length;p++)null!==(g=f(d,s,p,o[p],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?p:g.key),i=a(g,i,p),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(s,e)})),si&&$s(s,p),c}function g(s,o,l,c){var u=P(l);if("function"!==typeof u)throw Error(i(150));if(null==(l=u.call(l)))throw Error(i(151));for(var d=u=null,p=o,g=o=0,v=null,x=l.next();null!==p&&!x.done;g++,x=l.next()){p.index>g?(v=p,p=null):v=p.sibling;var y=m(s,p,x.value,c);if(null===y){null===p&&(p=v);break}e&&p&&null===y.alternate&&t(s,p),o=a(y,o,g),null===d?u=y:d.sibling=y,d=y,p=v}if(x.done)return n(s,p),si&&$s(s,g),u;if(null===p){for(;!x.done;g++,x=l.next())null!==(x=h(s,x.value,c))&&(o=a(x,o,g),null===d?u=x:d.sibling=x,d=x);return si&&$s(s,g),u}for(p=r(s,p);!x.done;g++,x=l.next())null!==(x=f(p,s,g,x.value,c))&&(e&&null!==x.alternate&&p.delete(null===x.key?g:x.key),o=a(x,o,g),null===d?u=x:d.sibling=x,d=x);return e&&p.forEach((function(e){return t(s,e)})),si&&$s(s,g),u}return function e(r,i,a,l){if("object"===typeof a&&null!==a&&a.type===N&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case w:e:{for(var c=a.key,u=i;null!==u;){if(u.key===c){if((c=a.type)===N){if(7===u.tag){n(r,u.sibling),(i=s(u,a.props.children)).return=r,r=i;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===T&&xi(c)===u.type){n(r,u.sibling),(i=s(u,a.props)).ref=gi(r,u,a),i.return=r,r=i;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===N?((i=Pc(a.props.children,r.mode,l,a.key)).return=r,r=i):((l=Rc(a.type,a.key,a.props,null,r.mode,l)).ref=gi(r,i,a),l.return=r,r=l)}return o(r);case D:e:{for(u=a.key;null!==i;){if(i.key===u){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(r,i.sibling),(i=s(i,a.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Lc(a,r.mode,l)).return=r,r=i}return o(r);case T:return e(r,i,(u=a._init)(a._payload),l)}if(te(a))return p(r,i,a,l);if(P(a))return g(r,i,a,l);vi(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==i&&6===i.tag?(n(r,i.sibling),(i=s(i,a)).return=r,r=i):(n(r,i),(i=Mc(a,r.mode,l)).return=r,r=i),o(r)):n(r,i)}}var bi=yi(!0),wi=yi(!1),Di=js(null),Ni=null,ji=null,Ci=null;function Ei(){Ci=ji=Ni=null}function Ai(e){var t=Di.current;Cs(Di),e._currentValue=t}function ki(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t){Ni=e,Ci=ji=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yo=!0),e.firstContext=null)}function Fi(e){var t=e._currentValue;if(Ci!==e)if(e={context:e,memoizedValue:t,next:null},null===ji){if(null===Ni)throw Error(i(308));ji=e,Ni.dependencies={lanes:0,firstContext:e}}else ji=ji.next=e;return t}var _i=null;function Ti(e){null===_i?_i=[e]:_i.push(e)}function Ii(e,t,n,r){var s=t.interleaved;return null===s?(n.next=n,Ti(t)):(n.next=s.next,s.next=n),t.interleaved=n,Ri(e,r)}function Ri(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Pi=!1;function Oi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Li(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&kl)){var s=r.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Ri(e,n)}return null===(s=r.interleaved)?(t.next=t,Ti(r)):(t.next=s.next,s.next=t),r.interleaved=t,Ri(e,n)}function zi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xt(e,n)}}function Ui(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var s=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?s=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?s=i=t:i=i.next=t}else s=i=t;return n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qi(e,t,n,r){var s=e.updateQueue;Pi=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?i=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==i){var d=s.baseState;for(a=0,u=c=l=null,o=i;;){var h=o.lane,m=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,p=o;switch(h=t,m=n,p.tag){case 1:if("function"===typeof(f=p.payload)){d=f.call(m,d,h);break e}d=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=p.payload)?f.call(m,d,h):f)||void 0===h)break e;d=M({},d,h);break e;case 2:Pi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=m,l=d):u=u.next=m,a|=h;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(h=o).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===u&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,null!==(t=s.shared.interleaved)){s=t;do{a|=s.lane,s=s.next}while(s!==t)}else null===i&&(s.shared.lanes=0);Ol|=a,e.lanes=a,e.memoizedState=d}}function Vi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(null!==s){if(r.callback=null,r=n,"function"!==typeof s)throw Error(i(191,s));s.call(r)}}}var Hi={},Wi=js(Hi),Gi=js(Hi),Ki=js(Hi);function Qi(e){if(e===Hi)throw Error(i(174));return e}function Yi(e,t){switch(Es(Ki,t),Es(Gi,e),Es(Wi,Hi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Cs(Wi),Es(Wi,t)}function Ji(){Cs(Wi),Cs(Gi),Cs(Ki)}function Xi(e){Qi(Ki.current);var t=Qi(Wi.current),n=le(t,e.type);t!==n&&(Es(Gi,e),Es(Wi,n))}function $i(e){Gi.current===e&&(Cs(Wi),Cs(Gi))}var Zi=js(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ra=b.ReactCurrentDispatcher,sa=b.ReactCurrentBatchConfig,ia=0,aa=null,oa=null,la=null,ca=!1,ua=!1,da=0,ha=0;function ma(){throw Error(i(321))}function fa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function pa(e,t,n,r,s,a){if(ia=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ra.current=null===e||null===e.memoizedState?$a:Za,e=n(r,s),ua){a=0;do{if(ua=!1,da=0,25<=a)throw Error(i(301));a+=1,la=oa=null,t.updateQueue=null,ra.current=eo,e=n(r,s)}while(ua)}if(ra.current=Xa,t=null!==oa&&null!==oa.next,ia=0,la=oa=aa=null,ca=!1,t)throw Error(i(300));return e}function ga(){var e=0!==da;return da=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function xa(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(i(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function ya(e,t){return"function"===typeof t?t(e):t}function ba(e){var t=xa(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=oa,s=r.baseQueue,a=n.pending;if(null!==a){if(null!==s){var o=s.next;s.next=a.next,a.next=o}r.baseQueue=s=a,n.pending=null}if(null!==s){a=s.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((ia&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,aa.lanes|=d,Ol|=d}u=u.next}while(null!==u&&u!==a);null===c?o=r:c.next=l,or(r,t.memoizedState)||(yo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){s=e;do{a=s.lane,aa.lanes|=a,Ol|=a,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wa(e){var t=xa(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,a=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{a=e(a,o.action),o=o.next}while(o!==s);or(a,t.memoizedState)||(yo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Da(){}function Na(e,t){var n=aa,r=xa(),s=t(),a=!or(r.memoizedState,s);if(a&&(r.memoizedState=s,yo=!0),r=r.queue,Pa(Ea.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Fa(9,Ca.bind(null,n,r,s,t),void 0,null),null===Sl)throw Error(i(349));0!==(30&ia)||ja(n,t,s)}return s}function ja(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Ca(e,t,n,r){t.value=n,t.getSnapshot=r,Aa(t)&&ka(e)}function Ea(e,t,n){return n((function(){Aa(t)&&ka(e)}))}function Aa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function ka(e){var t=Ri(e,1);null!==t&&nc(t,e,1,-1)}function Sa(e){var t=va();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ya,lastRenderedState:e},t.queue=e,e=e.dispatch=Ka.bind(null,aa,e),[t.memoizedState,e]}function Fa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function _a(){return xa().memoizedState}function Ta(e,t,n,r){var s=va();aa.flags|=e,s.memoizedState=Fa(1|t,n,void 0,void 0===r?null:r)}function Ia(e,t,n,r){var s=xa();r=void 0===r?null:r;var i=void 0;if(null!==oa){var a=oa.memoizedState;if(i=a.destroy,null!==r&&fa(r,a.deps))return void(s.memoizedState=Fa(t,n,i,r))}aa.flags|=e,s.memoizedState=Fa(1|t,n,i,r)}function Ra(e,t){return Ta(8390656,8,e,t)}function Pa(e,t){return Ia(2048,8,e,t)}function Oa(e,t){return Ia(4,2,e,t)}function Ma(e,t){return Ia(4,4,e,t)}function La(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ba(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ia(4,4,La.bind(null,t,e),n)}function za(){}function Ua(e,t){var n=xa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qa(e,t){var n=xa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&fa(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Va(e,t,n){return 0===(21&ia)?(e.baseState&&(e.baseState=!1,yo=!0),e.memoizedState=n):(or(n,t)||(n=pt(),aa.lanes|=n,Ol|=n,e.baseState=!0),t)}function Ha(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=sa.transition;sa.transition={};try{e(!1),t()}finally{yt=n,sa.transition=r}}function Wa(){return xa().memoizedState}function Ga(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qa(e))Ya(t,n);else if(null!==(n=Ii(e,t,n,r))){nc(n,e,r,ec()),Ja(n,t,r)}}function Ka(e,t,n){var r=tc(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qa(e))Ya(t,s);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=i(a,n);if(s.hasEagerState=!0,s.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(s.next=s,Ti(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Ii(e,t,s,r))&&(nc(n,e,r,s=ec()),Ja(n,t,r))}}function Qa(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Ya(e,t){ua=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ja(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,xt(e,n)}}var Xa={readContext:Fi,useCallback:ma,useContext:ma,useEffect:ma,useImperativeHandle:ma,useInsertionEffect:ma,useLayoutEffect:ma,useMemo:ma,useReducer:ma,useRef:ma,useState:ma,useDebugValue:ma,useDeferredValue:ma,useTransition:ma,useMutableSource:ma,useSyncExternalStore:ma,useId:ma,unstable_isNewReconciler:!1},$a={readContext:Fi,useCallback:function(e,t){return va().memoizedState=[e,void 0===t?null:t],e},useContext:Fi,useEffect:Ra,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ta(4194308,4,La.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ta(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ta(4,2,e,t)},useMemo:function(e,t){var n=va();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=va();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ga.bind(null,aa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},va().memoizedState=e},useState:Sa,useDebugValue:za,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=Sa(!1),t=e[0];return e=Ha.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=aa,s=va();if(si){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Sl)throw Error(i(349));0!==(30&ia)||ja(r,t,n)}s.memoizedState=n;var a={value:n,getSnapshot:t};return s.queue=a,Ra(Ea.bind(null,r,a,e),[e]),r.flags|=2048,Fa(9,Ca.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=va(),t=Sl.identifierPrefix;if(si){var n=Xs;t=":"+t+"R"+(n=(Js&~(1<<32-at(Js)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ha++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Za={readContext:Fi,useCallback:Ua,useContext:Fi,useEffect:Pa,useImperativeHandle:Ba,useInsertionEffect:Oa,useLayoutEffect:Ma,useMemo:qa,useReducer:ba,useRef:_a,useState:function(){return ba(ya)},useDebugValue:za,useDeferredValue:function(e){return Va(xa(),oa.memoizedState,e)},useTransition:function(){return[ba(ya)[0],xa().memoizedState]},useMutableSource:Da,useSyncExternalStore:Na,useId:Wa,unstable_isNewReconciler:!1},eo={readContext:Fi,useCallback:Ua,useContext:Fi,useEffect:Pa,useImperativeHandle:Ba,useInsertionEffect:Oa,useLayoutEffect:Ma,useMemo:qa,useReducer:wa,useRef:_a,useState:function(){return wa(ya)},useDebugValue:za,useDeferredValue:function(e){var t=xa();return null===oa?t.memoizedState=e:Va(t,oa.memoizedState,e)},useTransition:function(){return[wa(ya)[0],xa().memoizedState]},useMutableSource:Da,useSyncExternalStore:Na,useId:Wa,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),s=tc(e),i=Li(r,s);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,s))&&(nc(t,e,s,r),zi(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),s=tc(e),i=Li(r,s);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Bi(e,i,s))&&(nc(t,e,s,r),zi(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),s=Li(n,r);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=Bi(e,s,r))&&(nc(t,e,r,n),zi(t,e,r))}};function so(e,t,n,r,s,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(s,i))}function io(e,t,n){var r=!1,s=As,i=t.contextType;return"object"===typeof i&&null!==i?i=Fi(i):(s=Ts(t)?Fs:ks.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?_s(e,s):As),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function ao(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Oi(e);var i=t.contextType;"object"===typeof i&&null!==i?s.context=Fi(i):(i=Ts(t)?Fs:ks.current,s.context=_s(e,i)),s.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(no(e,t,i,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&ro.enqueueReplaceState(s,s.state,null),qi(e,n,s,r),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var s=n}catch(i){s="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:s,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,n){(n=Li(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Wl=r),uo(0,t)},n}function fo(e,t,n){(n=Li(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){uo(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function po(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var s=new Set;r.set(t,s)}else void 0===(s=r.get(t))&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vo(e,t,n,r,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Li(-1,1)).tag=2,Bi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var xo=b.ReactCurrentOwner,yo=!1;function bo(e,t,n,r){t.child=null===e?wi(t,null,n,r):bi(t,e.child,n,r)}function wo(e,t,n,r,s){n=n.render;var i=t.ref;return Si(t,s),r=pa(e,t,n,r,i,s),n=ga(),null===e||yo?(si&&n&&ei(t),t.flags|=1,bo(e,t,r,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ho(e,t,s))}function Do(e,t,n,r,s){if(null===e){var i=n.type;return"function"!==typeof i||Tc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Rc(n.type,null,r,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,No(e,t,i,r,s))}if(i=e.child,0===(e.lanes&s)){var a=i.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return Ho(e,t,s)}return t.flags|=1,(e=Ic(i,r)).ref=t.ref,e.return=t,t.child=e}function No(e,t,n,r,s){if(null!==e){var i=e.memoizedProps;if(lr(i,r)&&e.ref===t.ref){if(yo=!1,t.pendingProps=r=i,0===(e.lanes&s))return t.lanes=e.lanes,Ho(e,t,s);0!==(131072&e.flags)&&(yo=!0)}}return Eo(e,t,n,r,s)}function jo(e,t,n){var r=t.pendingProps,s=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Es(Il,Tl),Tl|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Es(Il,Tl),Tl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Es(Il,Tl),Tl|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Es(Il,Tl),Tl|=r;return bo(e,t,s,n),t.child}function Co(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eo(e,t,n,r,s){var i=Ts(n)?Fs:ks.current;return i=_s(t,i),Si(t,s),n=pa(e,t,n,r,i,s),r=ga(),null===e||yo?(si&&r&&ei(t),t.flags|=1,bo(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ho(e,t,s))}function Ao(e,t,n,r,s){if(Ts(n)){var i=!0;Os(t)}else i=!1;if(Si(t,s),null===t.stateNode)Vo(e,t),io(t,n,r),oo(t,n,r,s),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=Fi(c):c=_s(t,c=Ts(n)?Fs:ks.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&ao(t,a,r,c),Pi=!1;var h=t.memoizedState;a.state=h,qi(t,r,a,s),l=t.memoizedState,o!==r||h!==l||Ss.current||Pi?("function"===typeof u&&(no(t,n,u,r),l=t.memoizedState),(o=Pi||so(t,n,o,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Mi(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=Fi(l):l=_s(t,l=Ts(n)?Fs:ks.current);var m=n.getDerivedStateFromProps;(u="function"===typeof m||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&ao(t,a,r,l),Pi=!1,h=t.memoizedState,a.state=h,qi(t,r,a,s);var f=t.memoizedState;o!==d||h!==f||Ss.current||Pi?("function"===typeof m&&(no(t,n,m,r),f=t.memoizedState),(c=Pi||so(t,n,c,r,h,f,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return ko(e,t,n,r,i,s)}function ko(e,t,n,r,s,i){Co(e,t);var a=0!==(128&t.flags);if(!r&&!a)return s&&Ms(t,n,!1),Ho(e,t,i);r=t.stateNode,xo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=bi(t,e.child,null,i),t.child=bi(t,null,o,i)):bo(e,t,o,i),t.memoizedState=r.state,s&&Ms(t,n,!0),t.child}function So(e){var t=e.stateNode;t.pendingContext?Rs(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Rs(0,t.context,!1),Yi(e,t.containerInfo)}function Fo(e,t,n,r,s){return mi(),fi(s),t.flags|=256,bo(e,t,n,r),t.child}var _o,To,Io,Ro,Po={dehydrated:null,treeContext:null,retryLane:0};function Oo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mo(e,t,n){var r,s=t.pendingProps,a=Zi.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Es(Zi,1&a),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,o?(s=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Oc(l,s,0,null),e=Pc(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Oo(n),t.memoizedState=Po,e):Lo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,s,a,o){if(n)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,r=co(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,s=t.mode,r=Oc({mode:"visible",children:r.children},s,0,null),(a=Pc(a,s,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&bi(t,e.child,null,o),t.child.memoizedState=Oo(o),t.memoizedState=Po,a);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var l=r.dgst;return r=l,Bo(e,t,o,r=co(a=Error(i(419)),r,void 0))}if(l=0!==(o&e.childLanes),yo||l){if(null!==(r=Sl)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|o))?0:s)&&s!==a.retryLane&&(a.retryLane=s,Ri(e,s),nc(r,e,s,-1))}return pc(),Bo(e,t,o,r=co(Error(i(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Ac.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,ri=cs(s.nextSibling),ni=t,si=!0,ii=null,null!==e&&(Ks[Qs++]=Js,Ks[Qs++]=Xs,Ks[Qs++]=Ys,Js=e.id,Xs=e.overflow,Ys=t),t=Lo(t,r.children),t.flags|=4096,t)}(e,t,l,s,r,a,n);if(o){o=s.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==a?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Ic(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Ic(r,o):(o=Pc(o,l,n,null)).flags|=2,o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,l=null===(l=e.child.memoizedState)?Oo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Po,s}return e=(o=e.child).sibling,s=Ic(o,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Lo(e,t){return(t=Oc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,n,r){return null!==r&&fi(r),bi(t,e.child,null,n),(e=Lo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ki(e.return,t,n)}function Uo(e,t,n,r,s){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function qo(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(bo(e,t,r.children,n),0!==(2&(r=Zi.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Es(Zi,r),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Uo(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ea(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Uo(t,!0,n,null,i);break;case"together":Uo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ol|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Ic(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ic(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wo(e,t){if(!si)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Go(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=14680064&s.subtreeFlags,r|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Go(t),null;case 1:case 17:return Ts(t.type)&&Is(),Go(t),null;case 3:return r=t.stateNode,Ji(),Cs(Ss),Cs(ks),na(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(ac(ii),ii=null))),To(e,t),Go(t),null;case 5:$i(t);var s=Qi(Ki.current);if(n=t.type,null!==e&&null!=t.stateNode)Io(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Go(t),null}if(e=Qi(Wi.current),di(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hs]=t,r[ms]=a,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(s=0;s<Pr.length;s++)Br(Pr[s],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":J(r,a),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Br("invalid",r);break;case"textarea":se(r,a),Br("invalid",r)}for(var l in xe(n,a),s=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&$r(r.textContent,c,e),s=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&$r(r.textContent,c,e),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Br("scroll",r)}switch(n){case"input":G(r),Z(r,a,!0);break;case"textarea":G(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=s,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hs]=t,e[ms]=r,_o(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(n,r),n){case"dialog":Br("cancel",e),Br("close",e),s=r;break;case"iframe":case"object":case"embed":Br("load",e),s=r;break;case"video":case"audio":for(s=0;s<Pr.length;s++)Br(Pr[s],e);s=r;break;case"source":Br("error",e),s=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),s=r;break;case"details":Br("toggle",e),s=r;break;case"input":J(e,r),s=Y(e,r),Br("invalid",e);break;case"option":default:s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=M({},r,{value:void 0}),Br("invalid",e);break;case"textarea":se(e,r),s=re(e,r),Br("invalid",e)}for(a in xe(n,s),c=s)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Br("scroll",e):null!=u&&y(e,a,u,l))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Go(t),null;case 6:if(e&&null!=t.stateNode)Ro(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=Qi(Ki.current),Qi(Wi.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[hs]=t,(a=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hs]=t,t.stateNode=r}return Go(t),null;case 13:if(Cs(Zi),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(si&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),mi(),t.flags|=98560,a=!1;else if(a=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));a[hs]=t}else mi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Go(t),a=!1}else null!==ii&&(ac(ii),ii=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zi.current)?0===Rl&&(Rl=3):pc())),null!==t.updateQueue&&(t.flags|=4),Go(t),null);case 4:return Ji(),To(e,t),null===e&&qr(t.stateNode.containerInfo),Go(t),null;case 10:return Ai(t.type._context),Go(t),null;case 19:if(Cs(Zi),null===(a=t.memoizedState))return Go(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Wo(a,!1);else{if(0!==Rl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Wo(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Es(Zi,1&Zi.current|2),t.child}e=e.sibling}null!==a.tail&&Xe()>ql&&(t.flags|=128,r=!0,Wo(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ea(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!si)return Go(t),null}else 2*Xe()-a.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Wo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Xe(),t.sibling=null,n=Zi.current,Es(Zi,r?1&n|2:1&n),t):(Go(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Tl)&&(Go(t),6&t.subtreeFlags&&(t.flags|=8192)):Go(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Qo(e,t){switch(ti(t),t.tag){case 1:return Ts(t.type)&&Is(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ji(),Cs(Ss),Cs(ks),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $i(t),null;case 13:if(Cs(Zi),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));mi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Cs(Zi),null;case 4:return Ji(),null;case 10:return Ai(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}_o=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},To=function(){},Io=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Qi(Wi.current);var i,a=null;switch(n){case"input":s=Y(e,s),r=Y(e,r),a=[];break;case"select":s=M({},s,{value:void 0}),r=M({},r,{value:void 0}),a=[];break;case"textarea":s=re(e,s),r=re(e,r),a=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in xe(n,r),n=null,s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&null!=s[u])if("style"===u){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=s?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Br("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ro=function(e,t,n,r){n!==r&&(t.flags|=4)};var Yo=!1,Jo=!1,Xo="function"===typeof WeakSet?WeakSet:Set,$o=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){jc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){jc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,void 0!==i&&el(t,n,i)}s=s.next}while(s!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[ms],delete t[ps],delete t[gs],delete t[vs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(st,n)}catch(o){}switch(n.tag){case 5:Jo||Zo(n,t);case 6:var r=ul,s=dl;ul=null,hl(e,t,n),dl=s,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),qt(e)):ls(ul,n.stateNode));break;case 4:r=ul,s=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=s;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,void 0!==a&&(0!==(2&i)||0!==(4&i))&&el(n,t,a),s=s.next}while(s!==r)}hl(e,t,n);break;case 1:if(!Jo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){jc(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Jo=(r=Jo)||null!==n.memoizedState,hl(e,t,n),Jo=r):hl(e,t,n);break;default:hl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xo),t.forEach((function(t){var r=kc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function pl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var s=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(i(160));ml(a,o,s),ul=null,dl=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(u){jc(s,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),vl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){jc(e,e.return,g)}try{nl(5,e,e.return)}catch(g){jc(e,e.return,g)}}break;case 1:pl(t,e),vl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(pl(t,e),vl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(g){jc(e,e.return,g)}}if(4&r&&null!=(s=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&X(s,a),ye(l,o);var u=ye(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(s,h):"dangerouslySetInnerHTML"===d?de(s,h):"children"===d?he(s,h):y(s,d,h,u)}switch(l){case"input":$(s,a);break;case"textarea":ie(s,a);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var f=a.value;null!=f?ne(s,!!a.multiple,f,!1):m!==!!a.multiple&&(null!=a.defaultValue?ne(s,!!a.multiple,a.defaultValue,!0):ne(s,!!a.multiple,a.multiple?[]:"",!1))}s[ms]=a}catch(g){jc(e,e.return,g)}}break;case 6:if(pl(t,e),vl(e),4&r){if(null===e.stateNode)throw Error(i(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){jc(e,e.return,g)}}break;case 3:if(pl(t,e),vl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{qt(t.containerInfo)}catch(g){jc(e,e.return,g)}break;case 4:default:pl(t,e),vl(e);break;case 13:pl(t,e),vl(e),8192&(s=e.child).flags&&(a=null!==s.memoizedState,s.stateNode.isHidden=a,!a||null!==s.alternate&&null!==s.alternate.memoizedState||(Ul=Xe())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Jo=(u=Jo)||d,pl(t,e),Jo=u):pl(t,e),vl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for($o=e,d=e.child;null!==d;){for(h=$o=d;null!==$o;){switch(f=(m=$o).child,m.tag){case 0:case 11:case 14:case 15:nl(4,m,m.return);break;case 1:Zo(m,m.return);var p=m.stateNode;if("function"===typeof p.componentWillUnmount){r=m,n=m.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){jc(r,n,g)}}break;case 5:Zo(m,m.return);break;case 22:if(null!==m.memoizedState){wl(h);continue}}null!==f?(f.return=m,$o=f):wl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{s=h.stateNode,u?"function"===typeof(a=s.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(g){jc(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){jc(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:pl(t,e),vl(e),4&r&&fl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(he(s,""),r.flags&=-33),cl(e,ol(e),s);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(i(161))}}catch(o){jc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xl(e,t,n){$o=e,yl(e,t,n)}function yl(e,t,n){for(var r=0!==(1&e.mode);null!==$o;){var s=$o,i=s.child;if(22===s.tag&&r){var a=null!==s.memoizedState||Yo;if(!a){var o=s.alternate,l=null!==o&&null!==o.memoizedState||Jo;o=Yo;var c=Jo;if(Yo=a,(Jo=l)&&!c)for($o=s;null!==$o;)l=(a=$o).child,22===a.tag&&null!==a.memoizedState?Dl(s):null!==l?(l.return=a,$o=l):Dl(s);for(;null!==i;)$o=i,yl(i,t,n),i=i.sibling;$o=s,Yo=o,Jo=c}bl(e)}else 0!==(8772&s.subtreeFlags)&&null!==i?(i.return=s,$o=i):bl(e)}}function bl(e){for(;null!==$o;){var t=$o;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Jo)if(null===n)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Vi(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Vi(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&qt(h)}}}break;default:throw Error(i(163))}Jo||512&t.flags&&sl(t)}catch(m){jc(t,t.return,m)}}if(t===e){$o=null;break}if(null!==(n=t.sibling)){n.return=t.return,$o=n;break}$o=t.return}}function wl(e){for(;null!==$o;){var t=$o;if(t===e){$o=null;break}var n=t.sibling;if(null!==n){n.return=t.return,$o=n;break}$o=t.return}}function Dl(e){for(;null!==$o;){var t=$o;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){jc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var s=t.return;try{r.componentDidMount()}catch(l){jc(t,s,l)}}var i=t.return;try{sl(t)}catch(l){jc(t,i,l)}break;case 5:var a=t.return;try{sl(t)}catch(l){jc(t,a,l)}}}catch(l){jc(t,t.return,l)}if(t===e){$o=null;break}var o=t.sibling;if(null!==o){o.return=t.return,$o=o;break}$o=t.return}}var Nl,jl=Math.ceil,Cl=b.ReactCurrentDispatcher,El=b.ReactCurrentOwner,Al=b.ReactCurrentBatchConfig,kl=0,Sl=null,Fl=null,_l=0,Tl=0,Il=js(0),Rl=0,Pl=null,Ol=0,Ml=0,Ll=0,Bl=null,zl=null,Ul=0,ql=1/0,Vl=null,Hl=!1,Wl=null,Gl=null,Kl=!1,Ql=null,Yl=0,Jl=0,Xl=null,$l=-1,Zl=0;function ec(){return 0!==(6&kl)?Xe():-1!==$l?$l:$l=Xe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&kl)&&0!==_l?_l&-_l:null!==pi.transition?(0===Zl&&(Zl=pt()),Zl):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function nc(e,t,n,r){if(50<Jl)throw Jl=0,Xl=null,Error(i(185));vt(e,n,r),0!==(2&kl)&&e===Sl||(e===Sl&&(0===(2&kl)&&(Ml|=n),4===Rl&&oc(e,_l)),rc(e,r),1===n&&0===kl&&0===(1&t.mode)&&(ql=Xe()+500,Bs&&qs()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-at(i),o=1<<a,l=s[a];-1===l?0!==(o&n)&&0===(o&r)||(s[a]=mt(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}(e,t);var r=ht(e,e===Sl?_l:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Bs=!0,Us(e)}(lc.bind(null,e)):Us(lc.bind(null,e)),as((function(){0===(6&kl)&&qs()})),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Sc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if($l=-1,Zl=0,0!==(6&kl))throw Error(i(327));var n=e.callbackNode;if(Dc()&&e.callbackNode!==n)return null;var r=ht(e,e===Sl?_l:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var s=kl;kl|=2;var a=fc();for(Sl===e&&_l===t||(Vl=null,ql=Xe()+500,hc(e,t));;)try{xc();break}catch(l){mc(e,l)}Ei(),Cl.current=a,kl=s,null!==Fl?t=0:(Sl=null,_l=0,t=Rl)}if(0!==t){if(2===t&&(0!==(s=ft(e))&&(r=s,t=ic(e,s))),1===t)throw n=Pl,hc(e,0),oc(e,r),rc(e,Xe()),n;if(6===t)oc(e,r);else{if(s=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!or(i(),s))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=gc(e,r))&&(0!==(a=ft(e))&&(r=a,t=ic(e,a))),1===t))throw n=Pl,hc(e,0),oc(e,r),rc(e,Xe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,zl,Vl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Ul+500-Xe())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rs(wc.bind(null,e,zl,Vl),t);break}wc(e,zl,Vl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>s&&(s=o),r&=~a}if(r=s,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jl(r/1960))-r)){e.timeoutHandle=rs(wc.bind(null,e,zl,Vl),r);break}wc(e,zl,Vl);break;default:throw Error(i(329))}}}return rc(e,Xe()),e.callbackNode===n?sc.bind(null,e):null}function ic(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&ac(t)),e}function ac(e){null===zl?zl=e:zl.push.apply(zl,e)}function oc(e,t){for(t&=~Ll,t&=~Ml,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&kl))throw Error(i(327));Dc();var t=ht(e,0);if(0===(1&t))return rc(e,Xe()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=ft(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Pl,hc(e,0),oc(e,t),rc(e,Xe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Vl),rc(e,Xe()),null}function cc(e,t){var n=kl;kl|=1;try{return e(t)}finally{0===(kl=n)&&(ql=Xe()+500,Bs&&qs())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&kl)&&Dc();var t=kl;kl|=1;var n=Al.transition,r=yt;try{if(Al.transition=null,yt=1,e)return e()}finally{yt=r,Al.transition=n,0===(6&(kl=t))&&qs()}}function dc(){Tl=Il.current,Cs(Il)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==Fl)for(n=Fl.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Is();break;case 3:Ji(),Cs(Ss),Cs(ks),na();break;case 5:$i(r);break;case 4:Ji();break;case 13:case 19:Cs(Zi);break;case 10:Ai(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Sl=e,Fl=e=Ic(e.current,null),_l=Tl=t,Rl=0,Pl=null,Ll=Ml=Ol=0,zl=Bl=null,null!==_i){for(t=0;t<_i.length;t++)if(null!==(r=(n=_i[t]).interleaved)){n.interleaved=null;var s=r.next,i=n.pending;if(null!==i){var a=i.next;i.next=s,r.next=a}n.pending=r}_i=null}return e}function mc(e,t){for(;;){var n=Fl;try{if(Ei(),ra.current=Xa,ca){for(var r=aa.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}ca=!1}if(ia=0,la=oa=aa=null,ua=!1,da=0,El.current=null,null===n||null===n.return){Rl=1,Pl=t,Fl=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=_l,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=go(o);if(null!==f){f.flags&=-257,vo(f,o,l,0,t),1&f.mode&&po(a,u,t),c=u;var p=(t=f).updateQueue;if(null===p){var g=new Set;g.add(c),t.updateQueue=g}else p.add(c);break e}if(0===(1&t)){po(a,u,t),pc();break e}c=Error(i(426))}else if(si&&1&l.mode){var v=go(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vo(v,o,l,0,t),fi(lo(c,l));break e}}a=c=lo(c,l),4!==Rl&&(Rl=2),null===Bl?Bl=[a]:Bl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Ui(a,mo(0,c,t));break e;case 1:l=c;var x=a.type,y=a.stateNode;if(0===(128&a.flags)&&("function"===typeof x.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Gl||!Gl.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t,Ui(a,fo(a,l,t));break e}}a=a.return}while(null!==a)}bc(n)}catch(b){t=b,Fl===n&&null!==n&&(Fl=n=n.return);continue}break}}function fc(){var e=Cl.current;return Cl.current=Xa,null===e?Xa:e}function pc(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Sl||0===(268435455&Ol)&&0===(268435455&Ml)||oc(Sl,_l)}function gc(e,t){var n=kl;kl|=2;var r=fc();for(Sl===e&&_l===t||(Vl=null,hc(e,t));;)try{vc();break}catch(s){mc(e,s)}if(Ei(),kl=n,Cl.current=r,null!==Fl)throw Error(i(261));return Sl=null,_l=0,Rl}function vc(){for(;null!==Fl;)yc(Fl)}function xc(){for(;null!==Fl&&!Ye();)yc(Fl)}function yc(e){var t=Nl(e.alternate,e,Tl);e.memoizedProps=e.pendingProps,null===t?bc(e):Fl=t,El.current=null}function bc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Tl)))return void(Fl=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Fl=n);if(null===e)return Rl=6,void(Fl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Fl=t);Fl=t=e}while(null!==t);0===Rl&&(Rl=5)}function wc(e,t,n){var r=yt,s=Al.transition;try{Al.transition=null,yt=1,function(e,t,n,r){do{Dc()}while(null!==Ql);if(0!==(6&kl))throw Error(i(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-at(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}(e,a),e===Sl&&(Fl=Sl=null,_l=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Sc(tt,(function(){return Dc(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Al.transition,Al.transition=null;var o=yt;yt=1;var l=kl;kl|=4,El.current=null,function(e,t){if(es=Ht,mr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,m=null;t:for(;;){for(var f;h!==n||0!==s&&3!==h.nodeType||(l=o+s),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(f=h.firstChild);)m=h,h=f;for(;;){if(h===e)break t;if(m===n&&++u===s&&(l=o),m===a&&++d===r&&(c=o),null!==(f=h.nextSibling))break;m=(h=m).parentNode}h=f}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},Ht=!1,$o=t;null!==$o;)if(e=(t=$o).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$o=e;else for(;null!==$o;){t=$o;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var g=p.memoizedProps,v=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),v);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(i(163))}}catch(w){jc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,$o=e;break}$o=t.return}p=tl,tl=!1}(e,n),gl(n,e),fr(ts),Ht=!!es,ts=es=null,e.current=n,xl(n,e,s),Je(),kl=l,yt=o,Al.transition=a}else e.current=n;if(Kl&&(Kl=!1,Ql=e,Yl=s),a=e.pendingLanes,0===a&&(Gl=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Hl)throw Hl=!1,e=Wl,Wl=null,e;0!==(1&Yl)&&0!==e.tag&&Dc(),a=e.pendingLanes,0!==(1&a)?e===Xl?Jl++:(Jl=0,Xl=e):Jl=0,qs()}(e,t,n,r)}finally{Al.transition=s,yt=r}return null}function Dc(){if(null!==Ql){var e=bt(Yl),t=Al.transition,n=yt;try{if(Al.transition=null,yt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&kl))throw Error(i(331));var s=kl;for(kl|=4,$o=e.current;null!==$o;){var a=$o,o=a.child;if(0!==(16&$o.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for($o=u;null!==$o;){var d=$o;switch(d.tag){case 0:case 11:case 15:nl(8,d,a)}var h=d.child;if(null!==h)h.return=d,$o=h;else for(;null!==$o;){var m=(d=$o).sibling,f=d.return;if(il(d),d===u){$o=null;break}if(null!==m){m.return=f,$o=m;break}$o=f}}}var p=a.alternate;if(null!==p){var g=p.child;if(null!==g){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}$o=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,$o=o;else e:for(;null!==$o;){if(0!==(2048&(a=$o).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var x=a.sibling;if(null!==x){x.return=a.return,$o=x;break e}$o=a.return}}var y=e.current;for($o=y;null!==$o;){var b=(o=$o).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,$o=b;else e:for(o=y;null!==$o;){if(0!==(2048&(l=$o).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(D){jc(l,l.return,D)}if(l===o){$o=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,$o=w;break e}$o=l.return}}if(kl=s,qs(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(st,e)}catch(D){}r=!0}return r}finally{yt=n,Al.transition=t}}return!1}function Nc(e,t,n){e=Bi(e,t=mo(0,t=lo(n,t),1),1),t=ec(),null!==e&&(vt(e,1,t),rc(e,t))}function jc(e,t,n){if(3===e.tag)Nc(e,e,n);else for(;null!==t;){if(3===t.tag){Nc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gl||!Gl.has(r))){t=Bi(t,e=fo(t,e=lo(n,e),1),1),e=ec(),null!==t&&(vt(t,1,e),rc(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Sl===e&&(_l&n)===n&&(4===Rl||3===Rl&&(130023424&_l)===_l&&500>Xe()-Ul?hc(e,0):Ll|=n),rc(e,t)}function Ec(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Ri(e,t))&&(vt(e,t,n),rc(e,n))}function Ac(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ec(e,n)}function kc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Ec(e,n)}function Sc(e,t){return Ke(e,t)}function Fc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _c(e,t,n,r){return new Fc(e,t,n,r)}function Tc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ic(e,t){var n=e.alternate;return null===n?((n=_c(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Rc(e,t,n,r,s,a){var o=2;if(r=e,"function"===typeof e)Tc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Pc(n.children,s,a,t);case j:o=8,s|=8;break;case C:return(e=_c(12,n,t,2|s)).elementType=C,e.lanes=a,e;case S:return(e=_c(13,n,t,s)).elementType=S,e.lanes=a,e;case F:return(e=_c(19,n,t,s)).elementType=F,e.lanes=a,e;case I:return Oc(n,s,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case E:o=10;break e;case A:o=9;break e;case k:o=11;break e;case _:o=14;break e;case T:o=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=_c(o,n,t,s)).elementType=e,t.type=r,t.lanes=a,t}function Pc(e,t,n,r){return(e=_c(7,e,r,t)).lanes=n,e}function Oc(e,t,n,r){return(e=_c(22,e,r,t)).elementType=I,e.lanes=n,e.stateNode={isHidden:!1},e}function Mc(e,t,n){return(e=_c(6,e,null,t)).lanes=n,e}function Lc(e,t,n){return(t=_c(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,s,i,a,o,l){return e=new Bc(e,t,n,o,l),1===t?(t=1,!0===i&&(t|=8)):t=0,i=_c(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oi(i),e}function Uc(e){if(!e)return As;e:{if(qe(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ts(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ts(n))return Ps(e,n,t)}return t}function qc(e,t,n,r,s,i,a,o,l){return(e=zc(n,r,!0,e,0,i,0,o,l)).context=Uc(null),n=e.current,(i=Li(r=ec(),s=tc(n))).callback=void 0!==t&&null!==t?t:null,Bi(n,i,s),e.current.lanes=s,vt(e,s,r),rc(e,r),e}function Vc(e,t,n,r){var s=t.current,i=ec(),a=tc(s);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Li(i,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bi(s,t,a))&&(nc(e,s,a,i),zi(e,s,a)),a}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}Nl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ss.current)yo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return yo=!1,function(e,t,n){switch(t.tag){case 3:So(t),mi();break;case 5:Xi(t);break;case 1:Ts(t.type)&&Os(t);break;case 4:Yi(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Es(Di,r._currentValue),r._currentValue=s;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Es(Zi,1&Zi.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Mo(e,t,n):(Es(Zi,1&Zi.current),null!==(e=Ho(e,t,n))?e.sibling:null);Es(Zi,1&Zi.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qo(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Es(Zi,Zi.current),r)break;return null;case 22:case 23:return t.lanes=0,jo(e,t,n)}return Ho(e,t,n)}(e,t,n);yo=0!==(131072&e.flags)}else yo=!1,si&&0!==(1048576&t.flags)&&Zs(t,Gs,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vo(e,t),e=t.pendingProps;var s=_s(t,ks.current);Si(t,n),s=pa(null,t,r,e,s,n);var a=ga();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ts(r)?(a=!0,Os(t)):a=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Oi(t),s.updater=ro,t.stateNode=s,s._reactInternals=t,oo(t,r,e,n),t=ko(null,t,r,!0,a,n)):(t.tag=0,si&&a&&ei(t),bo(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vo(e,t),e=t.pendingProps,r=(s=r._init)(r._payload),t.type=r,s=t.tag=function(e){if("function"===typeof e)return Tc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===_)return 14}return 2}(r),e=to(r,e),s){case 0:t=Eo(null,t,r,e,n);break e;case 1:t=Ao(null,t,r,e,n);break e;case 11:t=wo(null,t,r,e,n);break e;case 14:t=Do(null,t,r,to(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,Eo(e,t,r,s=t.elementType===r?s:to(r,s),n);case 1:return r=t.type,s=t.pendingProps,Ao(e,t,r,s=t.elementType===r?s:to(r,s),n);case 3:e:{if(So(t),null===e)throw Error(i(387));r=t.pendingProps,s=(a=t.memoizedState).element,Mi(e,t),qi(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Fo(e,t,r,n,s=lo(Error(i(423)),t));break e}if(r!==s){t=Fo(e,t,r,n,s=lo(Error(i(424)),t));break e}for(ri=cs(t.stateNode.containerInfo.firstChild),ni=t,si=!0,ii=null,n=wi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(mi(),r===s){t=Ho(e,t,n);break e}bo(e,t,r,n)}t=t.child}return t;case 5:return Xi(t),null===e&&ci(t),r=t.type,s=t.pendingProps,a=null!==e?e.memoizedProps:null,o=s.children,ns(r,s)?o=null:null!==a&&ns(r,a)&&(t.flags|=32),Co(e,t),bo(e,t,o,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Mo(e,t,n);case 4:return Yi(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=bi(t,null,r,n):bo(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,wo(e,t,r,s=t.elementType===r?s:to(r,s),n);case 7:return bo(e,t,t.pendingProps,n),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,a=t.memoizedProps,o=s.value,Es(Di,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===s.children&&!Ss.current){t=Ho(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Li(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),ki(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),ki(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}bo(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Si(t,n),r=r(s=Fi(s)),t.flags|=1,bo(e,t,r,n),t.child;case 14:return s=to(r=t.type,t.pendingProps),Do(e,t,r,s=to(r.type,s),n);case 15:return No(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:to(r,s),Vo(e,t),t.tag=1,Ts(r)?(e=!0,Os(t)):e=!1,Si(t,n),io(t,r,s),oo(t,r,s,n),ko(null,t,r,!0,e,n);case 19:return qo(e,t,n);case 22:return jo(e,t,n)}throw Error(i(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function Zc(e,t,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if("function"===typeof s){var o=s;s=function(){var e=Hc(a);o.call(e)}}Vc(t,a,e,s)}else a=function(e,t,n,r,s){if(s){if("function"===typeof r){var i=r;r=function(){var e=Hc(a);i.call(e)}}var a=qc(t,r,e,0,null,!1,0,"",$c);return e._reactRootContainer=a,e[fs]=a.current,qr(8===e.nodeType?e.parentNode:e),uc(),a}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof r){var o=r;r=function(){var e=Hc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=l,e[fs]=l.current,qr(8===e.nodeType?e.parentNode:e),uc((function(){Vc(t,l,n,r)})),l}(n,t,e,s,r);return Hc(a)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Vc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Vc(null,e,null,null)})),t[fs]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=jt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<It.length&&0!==t&&t<It[n].priority;n++);It.splice(n,0,e),0===n&&Mt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(xt(t,1|n),rc(t,Xe()),0===(6&kl)&&(ql=Xe()+500,qs()))}break;case 13:uc((function(){var t=Ri(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Gc(e,1)}},Dt=function(e){if(13===e.tag){var t=Ri(e,134217728);if(null!==t)nc(t,e,134217728,ec());Gc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),n=Ri(e,t);if(null!==n)nc(n,e,t,ec());Gc(e,t)}},jt=function(){return yt},Ct=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},De=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ws(r);if(!s)throw Error(i(90));K(r),$(r,s)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},ke=cc,Se=uc;var eu={usingClientEntryPoint:!1,Events:[ys,bs,ws,Ee,Ae,cc]},tu={findFiberByHostInstance:xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{st=ru.inject(nu),it=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:D,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(i(299));var n=!1,r="",s=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,s),e[fs]=t.current,qr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(i(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,s=!1,a="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,s,0,a,o),e[fs]=t.current,qr(e),r)for(e=0;e<r.length;e++)s=(s=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Yc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(i(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(i(40));return!!e._reactRootContainer&&(uc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[fs]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},2778:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};t.default=n},2901:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6190),a=(r=i)&&r.__esModule?r:{default:r},o=n(1029);var l=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.C_START_CHAR+e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return new RegExp("^"+o.C_CHARS+"+$").test(this.data)}}]),t}(a.default);t.default=l},2922:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=o(n(7305)),i=o(n(8176)),a=n(3530);function o(e){return e&&e.__esModule?e:{default:e}}function l(e){if("string"===typeof e)return function(e){var t=document.querySelectorAll(e);if(0===t.length)return;for(var n=[],r=0;r<t.length;r++)n.push(l(t[r]));return n}(e);if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(l(e[n]));return t}if("undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLImageElement)return function(e){var t=document.createElement("canvas");return{element:t,options:(0,s.default)(e),renderer:i.default.CanvasRenderer,afterRender:function(){e.setAttribute("src",t.toDataURL())}}}(e);if(e&&e.nodeName&&"svg"===e.nodeName.toLowerCase()||"undefined"!==typeof SVGElement&&e instanceof SVGElement)return{element:e,options:(0,s.default)(e),renderer:i.default.SVGRenderer};if("undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement)return{element:e,options:(0,s.default)(e),renderer:i.default.CanvasRenderer};if(e&&e.getContext)return{element:e,renderer:i.default.CanvasRenderer};if(e&&"object"===("undefined"===typeof e?"undefined":r(e))&&!e.nodeName)return{element:e,renderer:i.default.ObjectRenderer};throw new a.InvalidElementException}t.default=l},2956:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codabar=void 0;var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5301);var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),0===e.search(/^[0-9\-\$\:\.\+\/]+$/)&&(e="A"+e+"A");var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.toUpperCase(),n));return r.text=r.options.text||r.text.replace(/[A-D]/g,""),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var e=[],t=this.getEncodings(),n=0;n<this.data.length;n++)e.push(t[this.data.charAt(n)]),n!==this.data.length-1&&e.push("0");return{text:this.text,data:e.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),t}(((r=i)&&r.__esModule?r:{default:r}).default);t.codabar=a},2978:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(9224),a=(r=i)&&r.__esModule?r:{default:r},o=n(3531);var l="http://www.w3.org/2000/svg",c=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.svg=t,this.encodings=n,this.options=r,this.document=r.xmlDocument||document}return s(e,[{key:"render",value:function(){var e=this.options.marginLeft;this.prepareSVG();for(var t=0;t<this.encodings.length;t++){var n=this.encodings[t],r=(0,a.default)(this.options,n.options),s=this.createGroup(e,r.marginTop,this.svg);this.setGroupOptions(s,r),this.drawSvgBarcode(s,r,n),this.drawSVGText(s,r,n),e+=n.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,o.calculateEncodingAttributes)(this.encodings,this.options);var e=(0,o.getTotalWidthOfEncodings)(this.encodings),t=(0,o.getMaximumHeightOfEncodings)(this.encodings),n=e+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(n,t),this.options.background&&this.drawRect(0,0,n,t,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(e,t,n){var r,s=n.data;r="top"==t.textPosition?t.fontSize+t.textMargin:0;for(var i=0,a=0,o=0;o<s.length;o++)a=o*t.width+n.barcodePadding,"1"===s[o]?i++:i>0&&(this.drawRect(a-t.width*i,r,t.width*i,t.height,e),i=0);i>0&&this.drawRect(a-t.width*(i-1),r,t.width*i,t.height,e)}},{key:"drawSVGText",value:function(e,t,n){var r,s,i=this.document.createElementNS(l,"text");t.displayValue&&(i.setAttribute("style","font:"+t.fontOptions+" "+t.fontSize+"px "+t.font),s="top"==t.textPosition?t.fontSize-t.textMargin:t.height+t.textMargin+t.fontSize,"left"==t.textAlign||n.barcodePadding>0?(r=0,i.setAttribute("text-anchor","start")):"right"==t.textAlign?(r=n.width-1,i.setAttribute("text-anchor","end")):(r=n.width/2,i.setAttribute("text-anchor","middle")),i.setAttribute("x",r),i.setAttribute("y",s),i.appendChild(this.document.createTextNode(n.text)),e.appendChild(i))}},{key:"setSvgAttributes",value:function(e,t){var n=this.svg;n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),n.setAttribute("x","0px"),n.setAttribute("y","0px"),n.setAttribute("viewBox","0 0 "+e+" "+t),n.setAttribute("xmlns",l),n.setAttribute("version","1.1"),n.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(e,t,n){var r=this.document.createElementNS(l,"g");return r.setAttribute("transform","translate("+e+", "+t+")"),n.appendChild(r),r}},{key:"setGroupOptions",value:function(e,t){e.setAttribute("style","fill:"+t.lineColor+";")}},{key:"drawRect",value:function(e,t,n,r,s){var i=this.document.createElementNS(l,"rect");return i.setAttribute("x",e),i.setAttribute("y",t),i.setAttribute("width",n),i.setAttribute("height",r),s.appendChild(i),i}}]),e}();t.default=c},3092:(e,t,n)=>{"use strict";function r(e){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var s,i=l(n(5043)),a=l(n(9298)),o=l(n(5173));function l(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}var m=i.default.version.split(/[.-]/);s="0"!==m[0]||"13"!==m[1]&&"12"!==m[1]?function(e){return e}:function(e){return e.getDOMNode()};var f=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?d(e):t}(this,u(t).call(this,e))).renderElementRef=i.default.createRef(),n.update=n.update.bind(d(n)),n}var n,o,l;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),n=t,(o=[{key:"shouldComponentUpdate",value:function(e){var n=this;return Object.keys(t.propTypes).some((function(t){return n.props[t]!==e[t]}))}},{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"update",value:function(){var e=s(this.renderElementRef.current);try{new a.default(e,this.props.value,Object.assign({text:this.props.text||this.props.value},this.props))}catch(t){window.console.error(t)}}},{key:"render",value:function(){var e=this.props,t=e.id,n=e.className;return"svg"===this.props.renderer?i.default.createElement("svg",{ref:this.renderElementRef,id:t,className:n}):"canvas"===this.props.renderer?i.default.createElement("canvas",{ref:this.renderElementRef,id:t,className:n}):"img"===this.props.renderer?i.default.createElement("img",{ref:this.renderElementRef,id:t,className:n}):void 0}}])&&c(n.prototype,o),l&&c(n,l),t}(i.default.Component);f.propTypes={value:o.default.string.isRequired,text:o.default.string,renderer:o.default.string,format:o.default.string,width:o.default.number,height:o.default.number,displayValue:o.default.bool,fontOptions:o.default.string,font:o.default.string,textAlign:o.default.string,textPosition:o.default.string,textMargin:o.default.number,fontSize:o.default.number,background:o.default.string,lineColor:o.default.string,margin:o.default.number,marginTop:o.default.number,marginBottom:o.default.number,marginLeft:o.default.number,marginRight:o.default.number,id:o.default.string,className:o.default.string,ean128:o.default.bool},f.defaultProps={format:"CODE128",renderer:"svg",width:2,height:100,displayValue:!0,fontOptions:"",font:"monospace",textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,className:"",ean128:!1},e.exports=f},3159:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ITF14=t.ITF=void 0;var r=i(n(5310)),s=i(n(8807));function i(e){return e&&e.__esModule?e:{default:e}}t.ITF=r.default,t.ITF14=s.default},3175:(e,t)=>{"use strict";const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,r=/^[\u0021-\u003A\u003C-\u007E]*$/,s=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,i=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function l(e,t,n){do{const n=e.charCodeAt(t);if(32!==n&&9!==n)return t}while(++t<n);return n}function c(e,t,n){for(;t>n;){const n=e.charCodeAt(--t);if(32!==n&&9!==n)return t+1}return n}function u(e){if(-1===e.indexOf("%"))return e;try{return decodeURIComponent(e)}catch(t){return e}}},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},3240:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString,r=Object.defineProperty,s=Object.getOwnPropertyDescriptor,i=function(e){return"function"===typeof Array.isArray?Array.isArray(e):"[object Array]"===n.call(e)},a=function(e){if(!e||"[object Object]"!==n.call(e))return!1;var r,s=t.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&t.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!s&&!i)return!1;for(r in e);return"undefined"===typeof r||t.call(e,r)},o=function(e,t){r&&"__proto__"===t.name?r(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},l=function(e,n){if("__proto__"===n){if(!t.call(e,n))return;if(s)return s(e,n).value}return e[n]};e.exports=function e(){var t,n,r,s,c,u,d=arguments[0],h=1,m=arguments.length,f=!1;for("boolean"===typeof d&&(f=d,d=arguments[1]||{},h=2),(null==d||"object"!==typeof d&&"function"!==typeof d)&&(d={});h<m;++h)if(null!=(t=arguments[h]))for(n in t)r=l(d,n),d!==(s=l(t,n))&&(f&&s&&(a(s)||(c=i(s)))?(c?(c=!1,u=r&&i(r)?r:[]):u=r&&a(r)?r:{},o(d,{name:n,newValue:e(f,u,s)})):"undefined"!==typeof s&&o(d,{name:n,newValue:s}));return d}},3498:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5301);var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"encode",value:function(){for(var e="110",t=0;t<this.data.length;t++){var n=parseInt(this.data[t]).toString(2);n=o(n,4-n.length);for(var r=0;r<n.length;r++)e+="0"==n[r]?"100":"110"}return{data:e+="1001",text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),t}(((r=i)&&r.__esModule?r:{default:r}).default);function o(e,t){for(var n=0;n<t;n++)e="0"+e;return e}t.default=a},3530:(e,t)=>{"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t,s){n(this,e);var i=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.name="InvalidInputException",i.symbology=t,i.input=s,i.message='"'+i.input+'" is not a valid input for '+i.symbology,i}return s(e,Error),e}(),a=function(){function e(){n(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return s(e,Error),e}(),o=function(){function e(){n(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}return s(e,Error),e}();t.InvalidInputException=i,t.InvalidElementException=a,t.NoElementException=o},3531:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTotalWidthOfEncodings=t.calculateEncodingAttributes=t.getBarcodePadding=t.getEncodingHeight=t.getMaximumHeightOfEncodings=void 0;var r,s=n(9224),i=(r=s)&&r.__esModule?r:{default:r};function a(e,t){return t.height+(t.displayValue&&e.text.length>0?t.fontSize+t.textMargin:0)+t.marginTop+t.marginBottom}function o(e,t,n){if(n.displayValue&&t<e){if("center"==n.textAlign)return Math.floor((e-t)/2);if("left"==n.textAlign)return 0;if("right"==n.textAlign)return Math.floor(e-t)}return 0}function l(e,t,n){var r;if(n)r=n;else{if("undefined"===typeof document)return 0;r=document.createElement("canvas").getContext("2d")}r.font=t.fontOptions+" "+t.fontSize+"px "+t.font;var s=r.measureText(e);return s?s.width:0}t.getMaximumHeightOfEncodings=function(e){for(var t=0,n=0;n<e.length;n++)e[n].height>t&&(t=e[n].height);return t},t.getEncodingHeight=a,t.getBarcodePadding=o,t.calculateEncodingAttributes=function(e,t,n){for(var r=0;r<e.length;r++){var s,c=e[r],u=(0,i.default)(t,c.options);s=u.displayValue?l(c.text,u,n):0;var d=c.data.length*u.width;c.width=Math.ceil(Math.max(s,d)),c.height=a(c,u),c.barcodePadding=o(s,d,u)}},t.getTotalWidthOfEncodings=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].width;return t}},3986:(e,t,n)=>{"use strict";function r(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}n.d(t,{A:()=>r})},4202:(e,t)=>{"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}function x(){}function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||f}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=v.prototype;var b=y.prototype=new x;b.constructor=y,p(b,v.prototype),b.isPureReactComponent=!0;var w=Array.isArray,D=Object.prototype.hasOwnProperty,N={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var s,i={},a=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)D.call(t,s)&&!j.hasOwnProperty(s)&&(i[s]=t[s]);var l=arguments.length-2;if(1===l)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===i[s]&&(i[s]=l[s]);return{$$typeof:n,type:e,key:a,ref:o,props:i,_owner:N.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function k(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function S(e,t,s,i,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===i?"."+k(l,0):i,w(a)?(s="",null!=e&&(s=e.replace(A,"$&/")+"/"),S(a,t,s,"",(function(e){return e}))):null!=a&&(E(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,s+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(A,"$&/")+"/")+e)),t.push(a)),1;if(l=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var u=i+k(o=e[c],c);l+=S(o,t,s,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=S(o=o.value,t,s,u=i+k(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function F(e,t,n){if(null==e)return e;var r=[],s=0;return S(e,r,"","",(function(e){return t.call(n,e,s++)})),r}function _(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var T={current:null},I={transition:null},R={ReactCurrentDispatcher:T,ReactCurrentBatchConfig:I,ReactCurrentOwner:N};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:F,forEach:function(e,t,n){F(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return F(e,(function(){t++})),t},toArray:function(e){return F(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=s,t.Profiler=a,t.PureComponent=y,t.StrictMode=i,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=P,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=p({},e.props),i=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=N.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)D.call(t,c)&&!j.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:n,type:e.type,key:i,ref:a,props:s,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:_}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=I.transition;I.transition={};try{e()}finally{I.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return T.current.useCallback(e,t)},t.useContext=function(e){return T.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return T.current.useDeferredValue(e)},t.useEffect=function(e,t){return T.current.useEffect(e,t)},t.useId=function(){return T.current.useId()},t.useImperativeHandle=function(e,t,n){return T.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return T.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return T.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return T.current.useMemo(e,t)},t.useReducer=function(e,t,n){return T.current.useReducer(e,t,n)},t.useRef=function(e){return T.current.useRef(e)},t.useState=function(e){return T.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return T.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return T.current.useTransition()},t.version="18.3.1"},4222:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=null;if(!e||"string"!==typeof e)return n;var r=(0,s.default)(e),i="function"===typeof t;return r.forEach((function(e){if("declaration"===e.type){var r=e.property,s=e.value;i?t(r,s,e):s&&((n=n||{})[r]=s)}})),n};var s=r(n(4403))},4238:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=[];return function e(n){if(Array.isArray(n))for(var r=0;r<n.length;r++)e(n[r]);else n.text=n.text||"",n.data=n.data||"",t.push(n)}(e),t}},4391:(e,t,n)=>{"use strict";var r=n(7950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4403:e=>{var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,n=/\n/g,r=/^\s*/,s=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,i=/^:\s*/,a=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,o=/^[;\s]*/,l=/^\s+|\s+$/g,c="";function u(e){return e?e.replace(l,c):c}e.exports=function(e,l){if("string"!==typeof e)throw new TypeError("First argument must be a string");if(!e)return[];l=l||{};var d=1,h=1;function m(e){var t=e.match(n);t&&(d+=t.length);var r=e.lastIndexOf("\n");h=~r?e.length-r:h+e.length}function f(){var e={line:d,column:h};return function(t){return t.position=new p(e),y(),t}}function p(e){this.start=e,this.end={line:d,column:h},this.source=l.source}p.prototype.content=e;var g=[];function v(t){var n=new Error(l.source+":"+d+":"+h+": "+t);if(n.reason=t,n.filename=l.source,n.line=d,n.column=h,n.source=e,!l.silent)throw n;g.push(n)}function x(t){var n=t.exec(e);if(n){var r=n[0];return m(r),e=e.slice(r.length),n}}function y(){x(r)}function b(e){var t;for(e=e||[];t=w();)!1!==t&&e.push(t);return e}function w(){var t=f();if("/"==e.charAt(0)&&"*"==e.charAt(1)){for(var n=2;c!=e.charAt(n)&&("*"!=e.charAt(n)||"/"!=e.charAt(n+1));)++n;if(n+=2,c===e.charAt(n-1))return v("End of comment missing");var r=e.slice(2,n-2);return h+=2,m(r),e=e.slice(n),h+=2,t({type:"comment",comment:r})}}function D(){var e=f(),n=x(s);if(n){if(w(),!x(i))return v("property missing ':'");var r=x(a),l=e({type:"declaration",property:u(n[0].replace(t,c)),value:r?u(r[0].replace(t,c)):c});return x(o),l}}return y(),function(){var e,t=[];for(b(t);e=D();)!1!==e&&(t.push(e),b(t));return t}()}},4709:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.checksum=o;var s=i(n(9007));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),-1!==e.search(/^[0-9]{11}$/)&&(e+=o(e));var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.displayValue=n.displayValue,n.fontSize>10*n.width?r.fontSize=10*n.width:r.fontSize=n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==o(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var e="";return e+="101",e+=(0,s.default)(this.data.substr(0,6),"LLLLLL"),e+="01010",e+=(0,s.default)(this.data.substr(6,6),"RRRRRR"),{data:e+="101",text:this.text}}},{key:"guardedEncoding",value:function(){var e=[];return this.displayValue&&e.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),e.push({data:"101"+(0,s.default)(this.data[0],"L"),options:{height:this.guardHeight}}),e.push({data:(0,s.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),e.push({data:"01010",options:{height:this.guardHeight}}),e.push({data:(0,s.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),e.push({data:(0,s.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&e.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),e}}]),t}(i(n(5301)).default);function o(e){var t,n=0;for(t=1;t<11;t+=2)n+=parseInt(e[t]);for(t=0;t<11;t+=2)n+=3*parseInt(e[t]);return(10-n%10)%10}t.default=a},4733:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var r,s=n(7051),i=n(5662),a=n(5472),o=n(6493),l=n(4857);!function(e){e.Unimplemented="UNIMPLEMENTED",e.Unavailable="UNAVAILABLE"}(r||(r={}));class c extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const u=e=>{const t=e.CapacitorCustomPlatform||null,n=e.Capacitor||{},s=n.Plugins=n.Plugins||{},i=()=>null!==t?t.name:(e=>{var t,n;return(null===e||void 0===e?void 0:e.androidBridge)?"android":(null===(n=null===(t=null===e||void 0===e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===n?void 0:n.bridge)?"ios":"web"})(e),a=e=>{var t;return null===(t=n.PluginHeaders)||void 0===t?void 0:t.find((t=>t.name===e))},o=new Map;return n.convertFileSrc||(n.convertFileSrc=e=>e),n.getPlatform=i,n.handleError=t=>e.console.error(t),n.isNativePlatform=()=>"web"!==i(),n.isPluginAvailable=e=>{const t=o.get(e);return!!(null===t||void 0===t?void 0:t.platforms.has(i()))||!!a(e)},n.registerPlugin=function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const u=o.get(e);if(u)return console.warn('Capacitor plugin "'.concat(e,'" already registered. Cannot register plugins twice.')),u.proxy;const d=i(),h=a(e);let m;const f=s=>{let i;const a=function(){for(var a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];const f=(async()=>(!m&&d in l?m=m="function"===typeof l[d]?await l[d]():l[d]:null!==t&&!m&&"web"in l&&(m=m="function"===typeof l.web?await l.web():l.web),m))().then((t=>{const a=((t,s)=>{var i,a;if(!h){if(t)return null===(a=t[s])||void 0===a?void 0:a.bind(t);throw new c('"'.concat(e,'" plugin is not implemented on ').concat(d),r.Unimplemented)}{const r=null===h||void 0===h?void 0:h.methods.find((e=>s===e.name));if(r)return"promise"===r.rtype?t=>n.nativePromise(e,s.toString(),t):(t,r)=>n.nativeCallback(e,s.toString(),t,r);if(t)return null===(i=t[s])||void 0===i?void 0:i.bind(t)}})(t,s);if(a){const e=a(...o);return i=null===e||void 0===e?void 0:e.remove,e}throw new c('"'.concat(e,".").concat(s,'()" is not implemented on ').concat(d),r.Unimplemented)}));return"addListener"===s&&(f.remove=async()=>i()),f};return a.toString=()=>"".concat(s.toString(),"() { [capacitor code] }"),Object.defineProperty(a,"name",{value:s,writable:!1,configurable:!1}),a},p=f("addListener"),g=f("removeListener"),v=(e,t)=>{const n=p({eventName:e},t),r=async()=>{const r=await n;g({eventName:e,callbackId:r},t)},s=new Promise((e=>n.then((()=>e({remove:r})))));return s.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await r()},s},x=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return h?v:p;case"removeListener":return g;default:return f(t)}}});return s[e]=x,o.set(e,{name:e,proxy:x,platforms:new Set([...Object.keys(l),...h?[d]:[]])}),x},n.Exception=c,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},d=(e=>e.Capacitor=u(e))("undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{}),h=d.registerPlugin;class m{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r),n&&this.sendRetainedArgumentsForEvent(e);return Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const r=this.listeners[e];if(r)r.forEach((e=>e(t)));else if(n){let n=this.retainedEventArguments[e];n||(n=[]),n.push(t),this.retainedEventArguments[e]=n}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not implemented";return new d.Exception(e,r.Unimplemented)}unavailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not available";return new d.Exception(e,r.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const r=n.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach((t=>{this.notifyListeners(e,t)})))}}const f=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),p=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class g extends m{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach((e=>{if(e.length<=0)return;let[n,r]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");n=p(n).trim(),r=p(r).trim(),t[n]=r})),t}async setCookie(e){try{const t=f(e.key),n=f(e.value),r="; expires=".concat((e.expires||"").replace("expires=","")),s=(e.path||"/").replace("path=",""),i=null!=e.url&&e.url.length>0?"domain=".concat(e.url):"";document.cookie="".concat(t,"=").concat(n||"").concat(r,"; path=").concat(s,"; ").concat(i,";")}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie="".concat(e.key,"=; Max-Age=0")}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,"=;expires=".concat((new Date).toUTCString(),";path=/"))}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}h("CapacitorCookies",{web:()=>new g});const v=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=Object.assign({method:e.method||"GET",headers:e.headers},t),r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=Object.keys(e);return Object.keys(e).map((e=>e.toLocaleLowerCase())).reduce(((n,r,s)=>(n[r]=e[t[s]],n)),{})}(e.headers),s=r["content-type"]||"";if("string"===typeof e.data)n.body=e.data;else if(s.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[n,r]of Object.entries(e.data||{}))t.set(n,r);n.body=t.toString()}else if(s.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach(((e,n)=>{t.append(n,e)}));else for(const n of Object.keys(e.data))t.append(n,e.data[n]);n.body=t;const r=new Headers(n.headers);r.delete("content-type"),n.headers=r}else(s.includes("application/json")||"object"===typeof e.data)&&(n.body=JSON.stringify(e.data));return n};class x extends m{async request(e){const t=v(e,e.webFetchExtra),n=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e?Object.entries(e).reduce(((e,n)=>{const[r,s]=n;let i,a;return Array.isArray(s)?(a="",s.forEach((e=>{i=t?encodeURIComponent(e):e,a+="".concat(r,"=").concat(i,"&")})),a.slice(0,-1)):(i=t?encodeURIComponent(s):s,a="".concat(r,"=").concat(i)),"".concat(e,"&").concat(a)}),"").substr(1):null}(e.params,e.shouldEncodeUrlParams),r=n?"".concat(e.url,"?").concat(n):e.url,s=await fetch(r,t),i=s.headers.get("content-type")||"";let a,o,{responseType:l="text"}=s.ok?e:{};switch(i.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":o=await s.blob(),a=await(async e=>new Promise(((t,n)=>{const r=new FileReader;r.onload=()=>{const e=r.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},r.onerror=e=>n(e),r.readAsDataURL(e)})))(o);break;case"json":a=await s.json();break;default:a=await s.text()}const c={};return s.headers.forEach(((e,t)=>{c[t]=e})),{data:a,headers:c,status:s.status,url:s.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}h("CapacitorHttp",{web:()=>new x});const y=h("PushNotifications",{});class b{static async createNotification(e){try{console.log("Creating notification with data:",e);const t={};Object.keys(e).forEach((n=>{void 0!==e[n]&&(t[n]=e[n])}));const n=(0,s.A)((0,s.A)({},t),{},{timestamp:(0,a.O5)(),read:!1});let r;r=e.messageId?(0,a.P)((0,a.rJ)(i.db,"notifications"),(0,a._M)("toUser","==",e.toUser),(0,a._M)("read","==",!1),(0,a._M)("messageId","==",e.messageId),(0,a.AB)(1)):e.requestId?(0,a.P)((0,a.rJ)(i.db,"notifications"),(0,a._M)("toUser","==",e.toUser),(0,a._M)("read","==",!1),(0,a._M)("requestId","==",e.requestId),(0,a.AB)(1)):(0,a.P)((0,a.rJ)(i.db,"notifications"),(0,a._M)("toUser","==",e.toUser),(0,a._M)("read","==",!1),(0,a._M)("type","==",e.type),(0,a.AB)(1));const o=await(0,a.GG)(r);if(!o.empty)return console.log("Similar notification already exists, skipping creation"),o.docs[0].id;const l=await(0,a.gS)((0,a.rJ)(i.db,"notifications"),n);return console.log("Notification document created with ID:",l.id),await this.incrementUnreadCounters(e),l.id}catch(t){throw console.error("Error creating notification:",t),new Error("Failed to create notification")}}static async createMessageNotification(e,t){try{console.log("NotificationService.createMessageNotification called with:",{messageData:e,recipientId:t});const{senderId:s,senderName:o,text:c,type:u,courseId:d,courseName:h,tripId:m,tripName:f,chatId:p,id:g}=e;if(s===t)return void console.log("Skipping notification - sender is recipient");let v,x,y=!1;if(u.startsWith("course_")){try{const e=(0,a.H9)(i.db,"courses",d),n=await(0,a.x7)(e);if(n.exists()){y=n.data().instructorId===t,x=y?"/instructor":"/training?courseId=".concat(d)}}catch(n){console.error("Error checking if recipient is course instructor:",n)}u===l.l.COURSE_BROADCAST?v="course_broadcast":u===l.l.COURSE_DISCUSSION?v="course_message":u===l.l.COURSE_PRIVATE&&(v="course_direct")}else if(u.startsWith("trip_")){try{const e=(0,a.H9)(i.db,"trips",m),n=await(0,a.x7)(e);if(n.exists()){y=n.data().instructorId===t,x=y?"/instructor":"/travel?tripId=".concat(m)}}catch(n){console.error("Error checking if recipient is trip instructor:",n)}u===l.l.TRIP_BROADCAST?v="trip_broadcast":u===l.l.TRIP_DISCUSSION?v="trip_message":u===l.l.TRIP_PRIVATE&&(v="trip_direct"),console.log("Creating trip notification:",{tripId:m,originalType:u,notificationType:v,recipientId:t,senderId:s,isInstructorNotification:y})}else u===l.l.CHAT&&(v="new_message",x="/messages/".concat(p));if(console.log("Determined notification type:",{originalType:u,mappedType:v,targetRoute:x,isInstructorNotification:y}),!v)return void console.warn("Could not determine notification type for:",u);const b={type:v,fromUser:s,fromUserName:o,toUser:t,messageId:g,messagePreview:c&&c.length>100?"".concat(c.substring(0,100),"..."):c,targetRoute:x,timestamp:(0,a.O5)(),urgent:u===l.l.COURSE_BROADCAST||u===l.l.TRIP_BROADCAST,isInstructorNotification:y};p&&(b.chatId=p),d&&(b.courseId=d),h&&(b.courseName=h),m&&(b.tripId=m),f&&(b.tripName=f),console.log("Creating notification with data:",b);try{await this.createNotification(b),console.log("Notification created successfully")}catch(r){console.error("Error in createNotification:",r)}}catch(r){console.error("Error creating message notification:",r)}}static async createBuddyRequestNotification(e){try{const{fromUser:t,fromUserName:n,toUser:r,requestId:s}=e,i={type:"buddy_request",fromUser:t,fromUserName:n,toUser:r,requestId:s,targetRoute:"/buddies/requests",read:!1};await this.createNotification(i),console.log("Buddy request notification created successfully")}catch(t){console.error("Error creating buddy request notification:",t)}}static async incrementUnreadCounters(e){try{const{toUser:t,type:n,isInstructorNotification:r}=e;console.log("Incrementing unread counters for user:",t);const s=(0,a.H9)(i.db,"unreadCounters",t);(await(0,a.x7)(s)).exists()||await(0,a.BN)(s,{messages:0,training:0,travel:0,buddies:0,instructor:0,total:0});let o=null;r?o="instructor":"new_message"===n?o="messages":n.startsWith("course_")?o="training":n.startsWith("trip_")?o="travel":"buddy_request"===n&&(o="buddies"),console.log("Counter updates:",{type:n,categoryUpdated:o,increment:1,isInstructorNotification:r}),console.log("Notification data for counter increment:",{toUser:t,type:n,counterField:o,tripId:e.tripId,courseId:e.courseId,chatId:e.chatId,fromUser:e.fromUser,isInstructorNotification:r}),o&&(console.log("Incrementing ".concat(o," counter for user ").concat(t)),await(0,a.mZ)(s,{[o]:(0,a.GV)(1),total:(0,a.GV)(1)}))}catch(t){console.error("Error incrementing unread counters:",t)}}static subscribeToUnreadCounters(e,t){if(!e)return()=>{};const n=(0,a.H9)(i.db,"unreadCounters",e);return(0,a.aQ)(n,(e=>{e.exists()?t(e.data()):t({messages:0,training:0,travel:0,buddies:0,instructor:0,total:0})}),(e=>{console.error("Error subscribing to unread counters:",e),t({messages:0,training:0,travel:0,buddies:0,instructor:0,total:0,error:!0})}))}static async getUnreadCountsForCategory(e,t,n){try{const r=(0,a.P)((0,a.rJ)(i.db,"notifications"),(0,a._M)("toUser","==",e),(0,a._M)("read","==",!1),(0,a._M)(t+"Id","==",n));return(await(0,a.GG)(r)).size}catch(r){return console.error("Error getting unread counts for category:",r),0}}static subscribeToItemNotifications(e,t,n,r){if(!e||!n)return()=>{};const o="".concat(t,"Id"),l=(0,a.P)((0,a.rJ)(i.db,"notifications"),(0,a._M)("toUser","==",e),(0,a._M)("read","==",!1),(0,a._M)(o,"==",n),(0,a.My)("timestamp","desc"));return(0,a.aQ)(l,(e=>{const t=e.docs.map((e=>{var t;return(0,s.A)((0,s.A)({id:e.id},e.data()),{},{timestamp:null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate()})})),n={broadcast:t.filter((e=>e.type.includes("broadcast"))).length,discussion:t.filter((e=>e.type.includes("message")&&!e.type.includes("direct"))).length,direct:t.filter((e=>e.type.includes("direct"))).length};r({notifications:t,tabCounts:n,totalCount:t.length})}),(e=>{console.error("Error subscribing to ".concat(t," notifications:"),e),r({notifications:[],tabCounts:{broadcast:0,discussion:0,direct:0},totalCount:0,error:!0})}))}static async markTabNotificationsAsRead(e,t,n,r){try{const s=(0,a.wP)(i.db),o=(0,a.H9)(i.db,"unreadCounters",e),l=await(0,a.x7)(o),c=l.exists()?l.data():{messages:0,training:0,travel:0,buddies:0,instructor:0,total:0},u="".concat(t,"Id");let d=[];"broadcast"===r?d=["course_broadcast","trip_broadcast"]:"discussion"===r?d=["course_message","trip_message"]:"direct"===r||"private"===r?(d=["course_direct","trip_direct","course_private","trip_private"],console.log("Processing ".concat(r," tab notifications for ").concat(t," ").concat(n))):"chat"===r&&(d=["new_message"]),console.log("Looking for notifications of types:",d);const h=(0,a.P)((0,a.rJ)(i.db,"notifications"),(0,a._M)("toUser","==",e),(0,a._M)("read","==",!1),(0,a._M)(u,"==",n),(0,a._M)("type","in",d)),m=await(0,a.GG)(h);console.log("Found ".concat(m.size," notifications to mark as read")),m.size>0&&console.log("First notification type:",m.docs[0].data().type);let f=0,p=0;m.forEach((e=>{const t=e.data();s.update(e.ref,{read:!0}),f++,t.isInstructorNotification&&p++})),console.log("Marking ".concat(f," ").concat(r," notifications as read for ").concat(t," ").concat(n));let g="";if("course"===t?g="training":"trip"===t?g="travel":"chat"===t?g="messages":"buddy"!==t&&"buddy_request"!==r||(g="buddies"),g&&f>0){const e=c[g]||0,t=Math.min(f-p,Math.max(0,e));console.log("Decrementing ".concat(g," counter by ").concat(t," (from ").concat(e,")")),t>0&&s.update(o,{[g]:(0,a.GV)(-t),total:(0,a.GV)(-t)})}if(p>0){const e=c.instructor||0,t=Math.min(p,Math.max(0,e));console.log("Decrementing instructor counter by ".concat(t," (from ").concat(e,")")),t>0&&s.update(o,{instructor:(0,a.GV)(-t),total:(0,a.GV)(-t)})}return await s.commit(),f}catch(s){return console.error("Error marking tab notifications as read:",s),0}}static async clearInstructorNotifications(e){try{const t=(0,a.wP)(i.db),n=(0,a.H9)(i.db,"unreadCounters",e),r=(0,a.P)((0,a.rJ)(i.db,"notifications"),(0,a._M)("toUser","==",e),(0,a._M)("read","==",!1),(0,a._M)("isInstructorNotification","==",!0)),s=await(0,a.GG)(r);console.log("Found ".concat(s.size," instructor notifications to mark as read")),s.forEach((e=>{t.update(e.ref,{read:!0})}));const o=await(0,a.x7)(n);if(o.exists()){const e=o.data().instructor||0;e>0&&t.update(n,{instructor:0,total:(0,a.GV)(-e)})}return await t.commit(),s.size}catch(t){return console.error("Error clearing instructor notifications:",t),0}}static async markNotificationAsRead(e,t){try{const n=(0,a.H9)(i.db,"notifications",e),r=await(0,a.x7)(n);if(!r.exists()||r.data().read)return;const s=r.data();await(0,a.mZ)(n,{read:!0});const o=(0,a.H9)(i.db,"unreadCounters",t),l=await(0,a.x7)(o),c=l.exists()?l.data():{messages:0,training:0,travel:0,buddies:0,instructor:0,total:0};let u="";if(s.isInstructorNotification?u="instructor":"new_message"===s.type?u="messages":s.type.startsWith("course_")?u="training":s.type.startsWith("trip_")?u="travel":"buddy_request"===s.type&&(u="buddies"),u){(c[u]||0)>0&&await(0,a.mZ)(o,{[u]:(0,a.GV)(-1),total:(0,a.GV)(-1)})}}catch(n){console.error("Error marking notification as read:",n)}}static async clearAllNotifications(e){try{const t=(0,a.wP)(i.db),n=(0,a.P)((0,a.rJ)(i.db,"notifications"),(0,a._M)("toUser","==",e),(0,a._M)("read","==",!1));(await(0,a.GG)(n)).forEach((e=>{t.update(e.ref,{read:!0})}));const r=(0,a.H9)(i.db,"unreadCounters",e);t.update(r,{messages:0,training:0,travel:0,buddies:0,instructor:0,total:0}),await t.commit()}catch(t){console.error("Error clearing all notifications:",t)}}static async resetNegativeCounters(e){try{const t=(0,a.H9)(i.db,"unreadCounters",e),n=await(0,a.x7)(t);if(n.exists()){const r=n.data();if(r.messages<0||r.training<0||r.travel<0||r.buddies<0||r.instructor<0||r.total<0)return console.log("Resetting negative counters for user ".concat(e)),await(0,a.mZ)(t,{messages:Math.max(0,r.messages||0),training:Math.max(0,r.training||0),travel:Math.max(0,r.travel||0),buddies:Math.max(0,r.buddies||0),instructor:Math.max(0,r.instructor||0),total:Math.max(0,r.total||0)}),!0}return!1}catch(t){return console.error("Error resetting negative counters:",t),!1}}static async initPushNotifications(){if(this._isInitialized)console.log("Push notifications already initialized, skipping...");else if(d.isNativePlatform())try{console.log("Initializing push notifications on native platform");try{const{receive:e}=await y.checkPermissions();console.log("Current permission status:",e),"granted"===e&&console.log("Push notifications already have permission")}catch(e){console.log("Error checking permissions:",e)}console.log("Requesting push notification permissions...");const t=await y.requestPermissions();if(console.log("Permission request result:",t),"granted"!==t.receive)return void console.log("Push notification permission denied");console.log("Permission granted, registering for push notifications..."),await y.register(),console.log("Registration request sent"),this.setupPushListeners(),this._isInitialized=!0}catch(t){console.error("Error initializing push notifications:",t)}else console.log("Push notifications not available on this platform")}static setupPushListeners(){try{y.removeAllListeners()}catch(e){console.log("No existing listeners to remove")}y.addListener("registration",(e=>{console.log("Push registration success:",e.value),this.savePushToken(e.value)})),y.addListener("registrationError",(e=>{console.error("Push registration failed:",JSON.stringify(e))})),y.addListener("pushNotificationReceived",(e=>{console.log("Push notification received:",e),this.handleReceivedPushNotification(e)})),y.addListener("pushNotificationActionPerformed",(e=>{console.log("Push notification action performed:",e);const t=e.notification;this.handleNotificationTap(t)}))}static async savePushToken(e){try{const t=(0,o.xI)().currentUser;if(!t)return void console.log("No user logged in, cannot save push token");const n=t.uid;console.log("Attempting to save push token for user ".concat(n,": ").concat(e));const r=(0,a.H9)(i.db,"users",n),s=await(0,a.x7)(r);if(s.exists()){const t=s.data();if((t.pushTokens||[]).includes(e))return void console.log("Token already exists in user profile, skipping save");await(0,a.mZ)(r,{pushTokens:(0,a.hq)(e),lastTokenUpdate:(0,a.O5)()}),console.log("Push token saved successfully to user profile")}else console.error("User document does not exist")}catch(t){console.error("Error saving push token:",t)}}static async handleReceivedPushNotification(e){try{const t=e.title,n=e.body,r=e.data;console.log("Push Notification: ".concat(t," - ").concat(n)),console.log("Notification data:",r)}catch(t){console.error("Error handling received push notification:",t)}}static handleNotificationTap(e){try{const t=e.data;if(!t)return;const n=t.targetRoute;n&&(console.log("Should navigate to: ".concat(n)),window.location.href=n)}catch(t){console.error("Error handling notification tap:",t)}}}b._isInitialized=!1;const w=b},4857:(e,t,n)=>{"use strict";n.d(t,{l:()=>r});const r={CHAT:"chat",COURSE_DISCUSSION:"course_discussion",COURSE_PRIVATE:"course_private",COURSE_BROADCAST:"course_broadcast",TRIP_DISCUSSION:"trip_discussion",TRIP_PRIVATE:"trip_private",TRIP_BROADCAST:"trip_broadcast"}},4863:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(3498),i=(r=s)&&r.__esModule?r:{default:r},a=n(8997);var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e+(0,a.mod10)(e),n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o},5043:(e,t,n)=>{"use strict";e.exports=n(4202)},5173:(e,t,n)=>{e.exports=n(1497)()},5179:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CODE39=void 0;var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5301);var a=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=e.toUpperCase(),n.mod43&&(e+=function(e){return o[e]}(function(e){for(var t=0,n=0;n<e.length;n++)t+=u(e[n]);return t%=43}(e))),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"encode",value:function(){for(var e=c("*"),t=0;t<this.data.length;t++)e+=c(this.data[t])+"0";return{data:e+=c("*"),text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),t}(((r=i)&&r.__esModule?r:{default:r}).default),o=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],l=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function c(e){return function(e){return l[e].toString(2)}(u(e))}function u(e){return o.indexOf(e)}t.CODE39=a},5301:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.text=n.text||t,this.options=n}},5310:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(7626),a=n(5301);var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var e=this,t=this.data.match(/.{2}/g).map((function(t){return e.encodePair(t)})).join("");return{data:i.START_BIN+t+i.END_BIN,text:this.text}}},{key:"encodePair",value:function(e){var t=i.BINARIES[e[1]];return i.BINARIES[e[0]].split("").map((function(e,n){return("1"===e?"111":"1")+("1"===t[n]?"000":"0")})).join("")}}]),t}(((r=a)&&r.__esModule?r:{default:r}).default);t.default=o},5472:(e,t,n)=>{"use strict";n.d(t,{Dc:()=>ne,gS:()=>gc,hq:()=>jc,rJ:()=>Xo,kd:()=>pc,CL:()=>Dc,H9:()=>$o,x7:()=>uc,GG:()=>hc,aU:()=>sl,GV:()=>Cc,AB:()=>Jl,aQ:()=>vc,My:()=>Ql,P:()=>Vl,O5:()=>Nc,BN:()=>mc,HM:()=>$l,mZ:()=>fc,_M:()=>Wl,wP:()=>Ec});var r,s,i=n(7150),a=n(8812),o=n(443),l=n(1529),c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},u={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var s=0;16>s;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];var i=e.g[3],a=t+(i^n&(s^i))+r[0]+3614090360&4294967295;a=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=(n=(s=(i=(t=n+(a<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^n&(s^i))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=i+(s^t&(n^s))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=s+(n^i&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^s&(i^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^i&(n^s))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(s^i&(n^s))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=i+(n^s&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=s+(t^n&(i^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(i^t&(s^i))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^s^i)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^s^i)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=i+(t^n^s)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=s+(i^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(s^i^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(s^(n|~i))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(s^(n|~i))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(s^(n|~i))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=s+(t^(i|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(i^(s|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((i=(t=n+((a=t+(s^(n|~i))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=i+(n^(t|~s))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((s=i+((a=s+(t^(i|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+i&4294967295}function i(e,t){this.h=t;for(var n=[],r=!0,s=e.length-1;0<=s;s--){var i=0|e[s];r&&i==t||(n[s]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,s=this.B,i=this.h,a=0;a<t;){if(0==i)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(s[i++]=e.charCodeAt(a++),i==this.blockSize){n(this,s),i=0;break}}else for(;a<t;)if(s[i++]=e[a++],i==this.blockSize){n(this,s),i=0;break}}this.h=i,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var a={};function o(e){return-128<=e&&128>e?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new i([0|e],0>e?-1:0)})):new i([0|e],0>e?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return c;if(0>e)return p(l(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new i(t,0)}var c=o(0),d=o(1),h=o(16777216);function m(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function f(e){return-1==e.h}function p(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new i(n,~e.h).add(d)}function g(e,t){return e.add(p(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function x(e,t){this.g=e,this.h=t}function y(e,t){if(m(t))throw Error("division by zero");if(m(e))return new x(c,c);if(f(e))return t=y(p(e),t),new x(p(t.g),p(t.h));if(f(t))return t=y(e,p(t)),new x(p(t.g),t.h);if(30<e.g.length){if(f(e)||f(t))throw Error("slowDivide_ only works with positive integers.");for(var n=d,r=t;0>=r.l(e);)n=b(n),r=b(r);var s=w(n,1),i=w(r,1);for(r=w(r,2),n=w(n,2);!m(r);){var a=i.add(r);0>=a.l(e)&&(s=s.add(n),i=a),r=w(r,1),n=w(n,1)}return t=g(e,s.j(t)),new x(s,t)}for(s=c;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),a=(i=l(n)).j(t);f(a)||0<a.l(e);)a=(i=l(n-=r)).j(t);m(i)&&(i=d),s=s.add(i),e=g(e,a)}return new x(s,e)}function b(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new i(n,e.h)}function w(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,s=[],a=0;a<r;a++)s[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new i(s,e.h)}(e=i.prototype).m=function(){if(f(this))return-p(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(m(this))return"0";if(f(this))return"-"+p(this).toString(e);for(var t=l(Math.pow(e,6)),n=this,r="";;){var s=y(n,t).g,i=((0<(n=g(n,s.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(m(n=s))return i+r;for(;6>i.length;)i="0"+i;r=i+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return f(e=g(this,e))?-1:m(e)?0:1},e.abs=function(){return f(this)?p(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,s=0;s<=t;s++){var a=r+(65535&this.i(s))+(65535&e.i(s)),o=(a>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);r=o>>>16,a&=65535,o&=65535,n[s]=o<<16|a}return new i(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(m(this)||m(e))return c;if(f(this))return f(e)?p(this).j(p(e)):p(p(this).j(e));if(f(e))return p(this.j(p(e)));if(0>this.l(h)&&0>e.l(h))return l(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<e.g.length;s++){var a=this.i(r)>>>16,o=65535&this.i(r),u=e.i(s)>>>16,d=65535&e.i(s);n[2*r+2*s]+=o*d,v(n,2*r+2*s),n[2*r+2*s+1]+=a*d,v(n,2*r+2*s+1),n[2*r+2*s+1]+=o*u,v(n,2*r+2*s+1),n[2*r+2*s+2]+=a*u,v(n,2*r+2*s+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new i(n,0)},e.A=function(e){return y(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new i(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new i(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new i(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,s=u.Md5=t,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.A,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=l,i.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return p(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=l(Math.pow(n,8)),s=c,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+a),n);8>a?(a=l(Math.pow(n,a)),s=s.j(a).add(l(o))):s=(s=s.j(r)).add(l(o))}return s},r=u.Integer=i}).apply("undefined"!==typeof c?c:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var d,h,m,f,p,g,v,x,y="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},b={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof y&&y];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var s=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var a=e[i];if(!(a in s))break e;s=s[a]}(r=r(i=s[e=e[e.length-1]]))!=i&&null!=r&&t(s,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,s={next:function(){if(!r&&n<e.length){var s=n++;return{value:t(s,e[s]),done:!1}}return r=!0,{done:!0,value:void 0}}};return s[Symbol.iterator]=function(){return s},s}(this,(function(e,t){return t}))}}));var r=r||{},s=this||self;function i(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function w(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}function D(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function N(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(i(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let s=0;s<r;s++)e[n+s]=t[s]}else e.push(t)}}function j(e){return/^[\s\xa0]*$/.test(e)}function C(){var e=s.navigator;return e&&(e=e.userAgent)?e:""}function E(e){return E[" "](e),e}E[" "]=function(){};var A=-1!=C().indexOf("Gecko")&&!(-1!=C().toLowerCase().indexOf("webkit")&&-1==C().indexOf("Edge"))&&!(-1!=C().indexOf("Trident")||-1!=C().indexOf("MSIE"))&&-1==C().indexOf("Edge");function k(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function S(e){const t={};for(const n in e)t[n]=e[n];return t}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(e,t){let n,r;for(let s=1;s<arguments.length;s++){for(n in r=arguments[s],r)e[n]=r[n];for(let t=0;t<F.length;t++)n=F[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function T(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function I(e){s.setTimeout((()=>{throw e}),0)}function R(){var e=B;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var P=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new O),(e=>e.reset()));class O{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let M,L=!1,B=new class{constructor(){this.h=this.g=null}add(e,t){const n=P.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},z=()=>{const e=s.Promise.resolve(void 0);M=()=>{e.then(U)}};var U=()=>{for(var e;e=R();){try{e.h.call(e.g)}catch(n){I(n)}var t=P;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}L=!1};function q(){this.s=this.s,this.C=this.C}function V(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},V.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function W(e,t){if(V.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(A){e:{try{E(t.nodeName);var s=!0;break e}catch(i){}s=!1}s||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:G[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&W.aa.h.call(this)}}w(W,V);var G={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var K="closure_listenable_"+(1e6*Math.random()|0),Q=0;function Y(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=s,this.key=++Q,this.da=this.fa=!1}function J(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function X(e){this.src=e,this.g={},this.h=0}function $(e,t){var n=t.type;if(n in e.g){var r,s=e.g[n],i=Array.prototype.indexOf.call(s,t,void 0);(r=0<=i)&&Array.prototype.splice.call(s,i,1),r&&(J(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Z(e,t,n,r){for(var s=0;s<e.length;++s){var i=e[s];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return s}return-1}X.prototype.add=function(e,t,n,r,s){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var a=Z(e,t,r,s);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new Y(t,this.src,i,!!r,s)).fa=n,e.push(t)),t};var ee="closure_lm_"+(1e6*Math.random()|0),te={};function ne(e,t,n,r,s){if(r&&r.once)return se(e,t,n,r,s);if(Array.isArray(t)){for(var i=0;i<t.length;i++)ne(e,t[i],n,r,s);return null}return n=de(n),e&&e[K]?e.K(t,n,a(r)?!!r.capture:!!r,s):re(e,t,n,!1,r,s)}function re(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");var o=a(s)?!!s.capture:!!s,l=ce(e);if(l||(e[ee]=l=new X(e)),(n=l.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=le;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)H||(s=o),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(oe(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function se(e,t,n,r,s){if(Array.isArray(t)){for(var i=0;i<t.length;i++)se(e,t[i],n,r,s);return null}return n=de(n),e&&e[K]?e.L(t,n,a(r)?!!r.capture:!!r,s):re(e,t,n,!0,r,s)}function ie(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)ie(e,t[i],n,r,s);else r=a(r)?!!r.capture:!!r,n=de(n),e&&e[K]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Z(i=e.g[t],n,r,s))&&(J(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=ce(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Z(t,n,r,s)),(n=-1<e?t[e]:null)&&ae(n))}function ae(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[K])$(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(oe(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ce(t))?($(n,e),0==n.h&&(n.src=null,t[ee]=null)):J(e)}}}function oe(e){return e in te?te[e]:te[e]="on"+e}function le(e,t){if(e.da)e=!0;else{t=new W(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&ae(e),e=n.call(r,t)}return e}function ce(e){return(e=e[ee])instanceof X?e:null}var ue="__closure_events_fn_"+(1e9*Math.random()>>>0);function de(e){return"function"===typeof e?e:(e[ue]||(e[ue]=function(t){return e.handleEvent(t)}),e[ue])}function he(){q.call(this),this.i=new X(this),this.M=this,this.F=null}function me(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new V(t,e);else if(t instanceof V)t.target=t.target||e;else{var s=t;_(t=new V(r,e),s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var a=t.g=n[i];s=fe(a,r,!0,t)&&s}if(s=fe(a=t.g=e,r,!0,t)&&s,s=fe(a,r,!1,t)&&s,n)for(i=0;i<n.length;i++)s=fe(a=t.g=n[i],r,!1,t)&&s}function fe(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var s=!0,i=0;i<t.length;++i){var a=t[i];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&$(e.i,a),s=!1!==o.call(l,r)&&s}}return s&&!r.defaultPrevented}function pe(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:s.setTimeout(e,t||0)}function ge(e){e.g=pe((()=>{e.g=null,e.i&&(e.i=!1,ge(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}w(he,q),he.prototype[K]=!0,he.prototype.removeEventListener=function(e,t,n,r){ie(this,e,t,n,r)},he.prototype.N=function(){if(he.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)J(n[r]);delete t.g[e],t.h--}}this.F=null},he.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},he.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ve extends q{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ge(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xe(e){q.call(this),this.h=e,this.g={}}w(xe,q);var ye=[];function be(e){k(e.g,(function(e,t){this.g.hasOwnProperty(t)&&ae(e)}),e),e.g={}}xe.prototype.N=function(){xe.aa.N.call(this),be(this)},xe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var we=s.JSON.stringify,De=s.JSON.parse,Ne=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function je(){}function Ce(e){return e.h||(e.h=e.i())}function Ee(){}je.prototype.h=null;var Ae={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ke(){V.call(this,"d")}function Se(){V.call(this,"c")}w(ke,V),w(Se,V);var Fe={},_e=null;function Te(){return _e=_e||new he}function Ie(e){V.call(this,Fe.La,e)}function Re(e){const t=Te();me(t,new Ie(t))}function Pe(e,t){V.call(this,Fe.STAT_EVENT,e),this.stat=t}function Oe(e){const t=Te();me(t,new Pe(t,e))}function Me(e,t){V.call(this,Fe.Ma,e),this.size=t}function Le(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout((function(){e()}),t)}function Be(){this.g=!0}function ze(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var a=1;a<s.length;a++)s[a]=""}}}return we(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}Fe.La="serverreachability",w(Ie,V),Fe.STAT_EVENT="statevent",w(Pe,V),Fe.Ma="timingevent",w(Me,V),Be.prototype.xa=function(){this.g=!1},Be.prototype.info=function(){};var Ue,qe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ve={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function He(){}function We(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new xe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ge}function Ge(){this.i=null,this.g="",this.h=!1}w(He,je),He.prototype.g=function(){return new XMLHttpRequest},He.prototype.i=function(){return{}},Ue=new He;var Ke={},Qe={};function Ye(e,t,n){e.L=1,e.v=wt(gt(t)),e.m=n,e.P=!0,Je(e,null)}function Je(e,t){e.F=Date.now(),Ze(e),e.A=gt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Pt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Ge,e.g=Nn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ve(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var s="readystatechange";Array.isArray(s)||(s&&(ye[0]=s.toString()),s=ye);for(var i=0;i<s.length;i++){var a=ne(n,s[i],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?S(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Re(),function(e,t,n,r,s,i){e.info((function(){if(e.g)if(i)for(var a="",o=i.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");a=2<=d.length&&"type"==d[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+a}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Xe(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function $e(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Qe:(n=Number(t.substring(n,r)),isNaN(n)?Ke:(r+=1)+n>t.length?Qe:(t=t.slice(r,r+n),e.C=r+n,t))}function Ze(e){e.S=Date.now()+e.I,et(e,e.I)}function et(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Le(c(e.ba,e),t)}function tt(e){e.B&&(s.clearTimeout(e.B),e.B=null)}function nt(e){0==e.j.G||e.J||xn(e.j,e)}function rt(e){tt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,be(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function st(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||ct(n.h,e)))if(!e.K&&ct(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;vn(n),on(n)}fn(n),Oe(18)}}else n.za=s[1],0<n.za-n.T&&37500>s[2]&&n.F&&0==n.v&&!n.C&&(n.C=Le(c(n.Za,n),6e3));if(1>=lt(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else bn(n,11)}else if((e.K||n.g==e)&&vn(n),!j(t))for(s=n.Da.g.parse(t),t=0;t<s.length;t++){let c=s[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const s=c[4];null!=s&&(n.Aa=s,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(ut(i,i.h),i.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,bt(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=Dn(r,r.J?r.ia:null,r.W),a.K){dt(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(tt(o),Ze(o)),r.g=a}else mn(r);0<n.i.length&&cn(n)}else"stop"!=c[0]&&"close"!=c[0]||bn(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?bn(n,7):an(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Re()}catch(u){}}We.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==tn(e)?t.j():this.Y(e)},We.prototype.Y=function(e){try{if(e==this.g)e:{const h=tn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||nn(this.g)))){this.J||4!=h||7==t||Re(),tt(this);var n=this.g.Z();this.X=n;t:if(Xe(this)){var r=nn(this.g);e="";var i=r.length,a=4==tn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){rt(this),nt(this);var o="";break t}this.h.i=new s.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==i-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,s,i,a){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+i+" "+a}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Oe(12),rt(this),nt(this);break e}ze(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,st(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=$e(this,o),e==Qe){4==h&&(this.s=4,Oe(14),n=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}if(e==Ke){this.s=4,Oe(15),ze(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}ze(this.i,this.l,e,null),st(this,e)}if(Xe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Oe(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),pn(d),d.M=!0,Oe(11))}}else ze(this.i,this.l,o,"[Invalid Chunked Response]"),rt(this),nt(this)}else ze(this.i,this.l,o,null),st(this,o);4==h&&rt(this),this.o&&!this.J&&(4==h?xn(this.j,this):(this.o=!1,Ze(this)))}else(function(e){const t={};e=(e.g&&2<=tn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(j(e[r]))continue;var n=T(e[r]);const s=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),rt(this),nt(this)}}}catch(h){}},We.prototype.cancel=function(){this.J=!0,rt(this)},We.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Re(),Oe(17)),rt(this),this.s=2,nt(this)):et(this,this.S-e)};var it=class{constructor(e,t){this.g=e,this.map=t}};function at(e){this.l=e||10,s.PerformanceNavigationTiming?e=0<(e=s.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ot(e){return!!e.h||!!e.g&&e.g.size>=e.j}function lt(e){return e.h?1:e.g?e.g.size:0}function ct(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ut(e,t){e.g?e.g.add(t):e.h=t}function dt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ht(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return D(e.i)}function mt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(i(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(i(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(i(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),s=r.length,a=0;a<s;a++)t.call(void 0,r[a],n&&n[a],e)}at.prototype.cancel=function(){if(this.i=ht(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var ft=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof pt){this.h=e.h,vt(this,e.j),this.o=e.o,this.g=e.g,xt(this,e.s),this.l=e.l;var t=e.i,n=new _t;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),yt(this,n),this.m=e.m}else e&&(t=String(e).match(ft))?(this.h=!1,vt(this,t[1]||"",!0),this.o=Dt(t[2]||""),this.g=Dt(t[3]||"",!0),xt(this,t[4]),this.l=Dt(t[5]||"",!0),yt(this,t[6]||"",!0),this.m=Dt(t[7]||"")):(this.h=!1,this.i=new _t(null,this.h))}function gt(e){return new pt(e)}function vt(e,t,n){e.j=n?Dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function xt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function yt(e,t,n){t instanceof _t?(e.i=t,function(e,t){t&&!e.j&&(Tt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(It(this,t),Pt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Nt(t,St)),e.i=new _t(t,e.h))}function bt(e,t,n){e.i.set(t,n)}function wt(e){return bt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Nt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,jt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function jt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}pt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Nt(t,Et,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(Nt(t,Et,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Nt(n,"/"==n.charAt(0)?kt:At,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",Nt(n,Ft)),e.join("")};var Ct,Et=/[#\/\?@]/g,At=/[#\?:]/g,kt=/[#\?]/g,St=/[#\?@]/g,Ft=/#/g;function _t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Tt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),s=null;if(0<=r){var i=e[n].substring(0,r);s=e[n].substring(r+1)}else i=e[n];t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function It(e,t){Tt(e),t=Ot(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Rt(e,t){return Tt(e),t=Ot(e,t),e.g.has(t)}function Pt(e,t,n){It(e,t),0<n.length&&(e.i=null,e.g.set(Ot(e,t),D(n)),e.h+=n.length)}function Ot(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Mt(e,t,n,r,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),r(n)}catch(i){}}function Lt(){this.g=new Ne}function Bt(e,t,n){const r=n||"";try{mt(e,(function(e,n){let s=e;a(e)&&(s=we(e)),t.push(r+n+"="+encodeURIComponent(s))}))}catch(s){throw t.push(r+"type="+encodeURIComponent("_badmap")),s}}function zt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Ut(e,t){he.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function qt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Vt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ht(e)}function Ht(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Wt(e){let t="";return k(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Gt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Wt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):bt(e,t,n))}function Kt(e){he.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=_t.prototype).add=function(e,t){Tt(this),this.i=null,e=Ot(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Tt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Tt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const s=e[r];for(let e=0;e<s.length;e++)n.push(t[r])}return n},e.V=function(e){Tt(this);let t=[];if("string"===typeof e)Rt(this,e)&&(t=t.concat(this.g.get(Ot(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Tt(this),this.i=null,Rt(this,e=Ot(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const i=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var s=i;""!==a[r]&&(s+="="+encodeURIComponent(String(a[r]))),e.push(s)}}return this.i=e.join("&")},w(zt,je),zt.prototype.g=function(){return new Ut(this.l,this.j)},zt.prototype.i=(Ct={},function(){return Ct}),w(Ut,he),(e=Ut.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ht(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||s).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Vt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ht(this)),this.g&&(this.readyState=3,Ht(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Vt(this):Ht(this),3==this.readyState&&qt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Vt(this))},e.Qa=function(e){this.g&&(this.response=e,Vt(this))},e.ga=function(){this.g&&Vt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ut.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),w(Kt,he);var Qt=/^https?$/i,Yt=["POST","PUT"];function Jt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Xt(e),Zt(e)}function Xt(e){e.A||(e.A=!0,me(e,"complete"),me(e,"error"))}function $t(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=tn(e)||2!=e.Z()))if(e.u&&4==tn(e))pe(e.Ea,0,e);else if(me(e,"readystatechange"),4==tn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var i;if(i=0===r){var a=String(e.D).match(ft)[1]||null;!a&&s.self&&s.self.location&&(a=s.self.location.protocol.slice(0,-1)),i=!Qt.test(a?a.toLowerCase():"")}n=i}if(n)me(e,"complete"),me(e,"success");else{e.m=6;try{var o=2<tn(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Xt(e)}}finally{Zt(e)}}}function Zt(e,t){if(e.g){en(e);const r=e.g,s=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||me(e,"ready");try{r.onreadystatechange=s}catch(n){}}}function en(e){e.I&&(s.clearTimeout(e.I),e.I=null)}function tn(e){return e.g?e.g.readyState:0}function nn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function rn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function sn(e){this.Aa=0,this.i=[],this.j=new Be,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=rn("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=rn("baseRetryDelayMs",5e3,e),this.cb=rn("retryDelaySeedMs",1e4,e),this.Wa=rn("forwardChannelMaxRetries",2,e),this.wa=rn("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new at(e&&e.concurrentRequestLimit),this.Da=new Lt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function an(e){if(ln(e),3==e.G){var t=e.U++,n=gt(e.I);if(bt(n,"SID",e.K),bt(n,"RID",t),bt(n,"TYPE","terminate"),dn(e,n),(t=new We(e,e.j,t)).L=2,t.v=wt(gt(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.v,n=!0),n||(t.g=Nn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Ze(t)}wn(e)}function on(e){e.g&&(pn(e),e.g.cancel(),e.g=null)}function ln(e){on(e),e.u&&(s.clearTimeout(e.u),e.u=null),vn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&s.clearTimeout(e.s),e.s=null)}function cn(e){if(!ot(e.h)&&!e.s){e.s=!0;var t=e.Ga;M||z(),L||(M(),L=!0),B.add(t,e),e.B=0}}function un(e,t){var n;n=t?t.l:e.U++;const r=gt(e.I);bt(r,"SID",e.K),bt(r,"RID",n),bt(r,"AID",e.T),dn(e,r),e.m&&e.o&&Gt(r,e.m,e.o),n=new We(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=hn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ut(e.h,n),Ye(n,r,t)}function dn(e,t){e.H&&k(e.H,(function(e,n){bt(t,n,e)})),e.l&&mt({},(function(e,n){bt(t,n,e)}))}function hn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var s=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let o=0;o<n;o++){let n=s[o].g;const l=s[o].map;if(n-=t,0>n)t=Math.max(0,s[o].g-100),a=!1;else try{Bt(l,e,"req"+n+"_")}catch(i){r&&r(l)}}if(a){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function mn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;M||z(),L||(M(),L=!0),B.add(t,e),e.v=0}}function fn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Le(c(e.Fa,e),yn(e,e.v)),e.v++,!0)}function pn(e){null!=e.A&&(s.clearTimeout(e.A),e.A=null)}function gn(e){e.g=new We(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=gt(e.qa);bt(t,"RID","rpc"),bt(t,"SID",e.K),bt(t,"AID",e.T),bt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&bt(t,"TO",e.ja),bt(t,"TYPE","xmlhttp"),dn(e,t),e.m&&e.o&&Gt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=wt(gt(t)),n.m=null,n.P=!0,Je(n,e)}function vn(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function xn(e,t){var n=null;if(e.g==t){vn(e),pn(e),e.g=null;var r=2}else{if(!ct(e.h,t))return;n=t.D,dt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var s=e.B;me(r=Te(),new Me(r,n)),cn(e)}else mn(e);else if(3==(s=t.s)||0==s&&0<t.X||!(1==r&&function(e,t){return!(lt(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Le(c(e.Ga,e,t),yn(e,e.B)),e.B++,!0))}(e,t)||2==r&&fn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),s){case 1:bn(e,5);break;case 4:bn(e,10);break;case 3:bn(e,6);break;default:bn(e,2)}}function yn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function bn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new pt(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||vt(r,"https"),wt(r),t?function(e,t){const n=new Be;if(s.Image){const r=new Image;r.onload=u(Mt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Mt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Mt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Mt,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Be;const n=new AbortController,r=setTimeout((()=>{n.abort(),Mt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Mt(0,0,!0,t):Mt(0,0,!1,t)})).catch((()=>{clearTimeout(r),Mt(0,0,!1,t)}))}(r.toString(),n)}else Oe(2);e.G=0,e.l&&e.l.sa(t),wn(e),ln(e)}function wn(e){if(e.G=0,e.ka=[],e.l){const t=ht(e.h);0==t.length&&0==e.i.length||(N(e.ka,t),N(e.ka,e.i),e.h.i.length=0,D(e.i),e.i.length=0),e.l.ra()}}function Dn(e,t,n){var r=n instanceof pt?gt(n):new pt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),xt(r,r.s);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var a=new pt(null);r&&vt(a,r),t&&(a.g=t),i&&xt(a,i),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&bt(r,n,t),bt(r,"VER",e.la),dn(e,r),r}function Nn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Kt(new zt({eb:n})):new Kt(e.pa)).Ha(e.J),t}function jn(){}function Cn(){}function En(e,t){he.call(this),this.g=new sn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!j(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!j(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Sn(this)}function An(e){ke.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function kn(){Se.call(this),this.status=1}function Sn(e){this.g=e}(e=Kt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ue.g(),this.v=this.o?Ce(this.o):Ce(Ue),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Jt(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=s.FormData&&e instanceof s.FormData,!(0<=Array.prototype.indexOf.call(Yt,t,void 0))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{en(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){Jt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,me(this,"complete"),me(this,"abort"),Zt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zt(this,!0)),Kt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?$t(this):this.bb())},e.bb=function(){$t(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<tn(this)?this.g.status:-1}catch(Ct){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(Ct){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),De(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=sn.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Oe(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=Dn(this,null,this.W),cn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const s=new We(this,this.j,e);let i=this.o;if(this.S&&(i?(i=S(i),_(i,this.S)):i=this.S),null!==this.m||this.O||(s.H=i,i=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=hn(this,s,t),bt(n=gt(this.I),"RID",e),bt(n,"CVER",22),this.D&&bt(n,"X-HTTP-Session-Id",this.D),dn(this,n),i&&(this.O?t="headers="+encodeURIComponent(String(Wt(i)))+"&"+t:this.m&&Gt(n,this.m,i)),ut(this.h,s),this.Ua&&bt(n,"TYPE","init"),this.P?(bt(n,"$req",t),bt(n,"SID","null"),s.T=!0,Ye(s,n,null)):Ye(s,n,t),this.G=2}}else 3==this.G&&(e?un(this,e):0==this.i.length||ot(this.h)||un(this))},e.Fa=function(){if(this.u=null,gn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Le(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),on(this),gn(this))},e.Za=function(){null!=this.C&&(this.C=null,on(this),fn(this),Oe(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=jn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Cn.prototype.g=function(e,t){return new En(e,t)},w(En,he),En.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},En.prototype.close=function(){an(this.g)},En.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=we(e),e=n);t.i.push(new it(t.Ya++,e)),3==t.G&&cn(t)},En.prototype.N=function(){this.g.l=null,delete this.j,an(this.g),delete this.g,En.aa.N.call(this)},w(An,ke),w(kn,Se),w(Sn,jn),Sn.prototype.ua=function(){me(this.g,"a")},Sn.prototype.ta=function(e){me(this.g,new An(e))},Sn.prototype.sa=function(e){me(this.g,new kn)},Sn.prototype.ra=function(){me(this.g,"b")},Cn.prototype.createWebChannel=Cn.prototype.g,En.prototype.send=En.prototype.o,En.prototype.open=En.prototype.m,En.prototype.close=En.prototype.close,x=b.createWebChannelTransport=function(){return new Cn},v=b.getStatEventTarget=function(){return Te()},g=b.Event=Fe,p=b.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qe.NO_ERROR=0,qe.TIMEOUT=8,qe.HTTP_ERROR=6,f=b.ErrorCode=qe,Ve.COMPLETE="complete",m=b.EventType=Ve,Ee.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",he.prototype.listen=he.prototype.K,h=b.WebChannel=Ee,b.FetchXmlHttpFactory=zt,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,d=b.XhrIo=Kt}).apply("undefined"!==typeof y?y:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const w="@firebase/firestore",D="4.7.14";class N{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}N.UNAUTHENTICATED=new N(null),N.GOOGLE_CREDENTIALS=new N("google-credentials-uid"),N.FIRST_PARTY=new N("first-party-uid"),N.MOCK_USER=new N("mock-user");let j="11.7.3";const C=new o.Vy("@firebase/firestore");function E(){return C.logLevel}function A(e){if(C.logLevel<=o.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(F);C.debug("Firestore (".concat(j,"): ").concat(e),...s)}}function k(e){if(C.logLevel<=o.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(F);C.error("Firestore (".concat(j,"): ").concat(e),...s)}}function S(e){if(C.logLevel<=o.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=n.map(F);C.warn("Firestore (".concat(j,"): ").concat(e),...s)}}function F(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function _(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,T(e,r,n)}function T(e,t,n){let r="FIRESTORE (".concat(j,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw k(r),new Error(r)}function I(e,t,n,r){let s="Unexpected state";"string"==typeof n?s=n:r=n,e||T(t,s,r)}function R(e,t){return e}const P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class O extends l.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class M{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class L{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class B{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(N.UNAUTHENTICATED)))}shutdown(){}}class z{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class U{constructor(e){this.t=e,this.currentUser=N.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){I(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new M;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new M,e.enqueueRetryable((()=>r(this.currentUser)))};const i=()=>{const t=s;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},a=e=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit((e=>a(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new M)}}),0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(I("string"==typeof t.accessToken,31837,{l:t}),new L(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return I(null===e||"string"==typeof e,2055,{h:e}),new N(e)}}class q{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=N.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class V{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new q(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(N.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class H{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class W{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,i.xZ)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){I(void 0===this.o,3512);const n=e=>{null!=e.error&&A("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,A("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new H(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(I("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new H(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function G(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}function K(){return new TextEncoder}class Q{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=G(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Y(e,t){return e<t?-1:e>t?1:0}function J(e,t){let n=0;for(;n<e.length&&n<t.length;){const r=e.codePointAt(n),s=t.codePointAt(n);if(r!==s){if(r<128&&s<128)return Y(r,s);{const i=K(),a=$(i.encode(X(e,n)),i.encode(X(t,n)));return 0!==a?a:Y(r,s)}}n+=r>65535?2:1}return Y(e.length,t.length)}function X(e,t){return e.codePointAt(t)>65535?e.substring(t,t+2):e.substring(t,t+1)}function $(e,t){for(let n=0;n<e.length&&n<t.length;++n)if(e[n]!==t[n])return Y(e[n],t[n]);return Y(e.length,t.length)}function Z(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}const ee=-62135596800,te=1e6;class ne{static now(){return ne.fromMillis(Date.now())}static fromDate(e){return ne.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*te);return new ne(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new O(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new O(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ee)throw new O(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new O(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/te}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-ee;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class re{static fromTimestamp(e){return new re(e)}static min(){return new re(new ne(0,0))}static max(){return new re(new ne(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const se="__name__";class ie{constructor(e,t,n){void 0===t?t=0:t>e.length&&_(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&_(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ie.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ie?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=ie.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Y(e.length,t.length)}static compareSegments(e,t){const n=ie.isNumericId(e),r=ie.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ie.extractNumericId(e).compare(ie.extractNumericId(t)):J(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return r.fromString(e.substring(4,e.length-2))}}class ae extends ie{construct(e,t,n){return new ae(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n){if(s.indexOf("//")>=0)throw new O(P.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push(...s.split("/").filter((e=>e.length>0)))}return new ae(e)}static emptyPath(){return new ae([])}}const oe=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class le extends ie{construct(e,t,n){return new le(e,t,n)}static isValidIdentifier(e){return oe.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),le.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===se}static keyField(){return new le([se])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new O(P.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new O(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new O(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new O(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new le(t)}static emptyPath(){return new le([])}}class ce{constructor(e){this.path=e}static fromPath(e){return new ce(ae.fromString(e))}static fromName(e){return new ce(ae.fromString(e).popFirst(5))}static empty(){return new ce(ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ae.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ce(new ae(e.slice()))}}const ue=-1;class de{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}de.UNKNOWN_ID=-1;function he(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=re.fromTimestamp(1e9===r?new ne(n+1,0):new ne(n,r));return new fe(s,ce.empty(),t)}function me(e){return new fe(e.readTime,e.key,ue)}class fe{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new fe(re.min(),ce.empty(),ue)}static max(){return new fe(re.max(),ce.empty(),ue)}}function pe(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ce.comparator(e.documentKey,t.documentKey),0!==n?n:Y(e.largestBatchId,t.largestBatchId))}const ge="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ve{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function xe(e){if(e.code!==P.FAILED_PRECONDITION||e.message!==ge)throw e;A("LocalStore","Unexpectedly lost primary lease")}class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&_(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ye(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ye?t:ye.resolve(t)}catch(e){return ye.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ye.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ye.reject(t)}static resolve(e){return new ye(((t,n)=>{t(e)}))}static reject(e){return new ye(((t,n)=>{n(e)}))}static waitFor(e){return new ye(((t,n)=>{let r=0,s=0,i=!1;e.forEach((e=>{++r,e.next((()=>{++s,i&&s===r&&t()}),(e=>n(e)))})),i=!0,s===r&&t()}))}static or(e){let t=ye.resolve(!1);for(const n of e)t=t.next((e=>e?ye.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new ye(((n,r)=>{const s=e.length,i=new Array(s);let a=0;for(let o=0;o<s;o++){const l=o;t(e[l]).next((e=>{i[l]=e,++a,a===s&&n(i)}),(e=>r(e)))}}))}static doWhile(e,t){return new ye(((n,r)=>{const s=()=>{!0===e()?t().next((()=>{s()}),r):n()};s()}))}}function be(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function we(e){return"IndexedDbTransactionError"===e.name}class De{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ue(e),this.ce=e=>t.writeSequenceNumber(e))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}De.le=-1;const Ne=-1;function je(e){return null==e}function Ce(e){return 0===e&&1/e==-1/0}function Ee(e){return"number"==typeof e&&Number.isInteger(e)&&!Ce(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Ae="\x01";function ke(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Fe(t)),t=Se(e.get(n),t);return Fe(t)}function Se(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const t=e.charAt(s);switch(t){case"\0":n+="\x01\x10";break;case Ae:n+="\x01\x11";break;default:n+=t}}return n}function Fe(e){return e+Ae+"\x01"}const _e="remoteDocuments",Te="owner",Ie="mutationQueues",Re="mutations";const Pe="documentMutations",Oe="remoteDocumentsV14",Me="remoteDocumentGlobal",Le="targets",Be="targetDocuments",ze="targetGlobal",Ue="collectionParents",qe="clientMetadata",Ve="bundles",He="namedQueries",We="indexConfiguration",Ge="indexState",Ke="indexEntries",Qe="documentOverlays",Ye="globals",Je=[Ie,Re,Pe,_e,Le,Te,ze,Be,qe,Me,Ue,Ve,He],Xe=[Ie,Re,Pe,Oe,Le,Te,ze,Be,qe,Me,Ue,Ve,He,Qe],$e=Xe,Ze=[...$e,We,Ge,Ke];function et(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function tt(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function nt(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class rt{constructor(e,t){this.comparator=e,this.root=t||it.EMPTY}insert(e,t){return new rt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,it.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,it.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push("".concat(t,":").concat(n)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new st(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new st(this.root,e,this.comparator,!1)}getReverseIterator(){return new st(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new st(this.root,e,this.comparator,!0)}}class st{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class it{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:it.RED,this.left=null!=r?r:it.EMPTY,this.right=null!=s?s:it.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new it(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return it.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return it.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,it.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,it.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _(27949);return e+(this.isRed()?0:1)}}it.EMPTY=null,it.RED=!0,it.BLACK=!1,it.EMPTY=new class{constructor(){this.size=0}get key(){throw _(57766)}get value(){throw _(16141)}get color(){throw _(16727)}get left(){throw _(29726)}get right(){throw _(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new it(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class at{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ot(this.data.getIterator())}getIteratorFrom(e){return new ot(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof at))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new at(this.comparator);return t.data=e,t}}class ot{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class lt{constructor(e){this.fields=e,e.sort(le.comparator)}static empty(){return new lt([])}unionWith(e){let t=new at(le.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new lt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Z(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class ct extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ut{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new ct("Invalid base64 string: "+e):e}}(e);return new ut(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ut(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ut.EMPTY_BYTE_STRING=new ut("");const dt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ht(e){if(I(!!e,39018),"string"==typeof e){let t=0;const n=dt.exec(e);if(I(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:mt(e.seconds),nanos:mt(e.nanos)}}function mt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ft(e){return"string"==typeof e?ut.fromBase64String(e):ut.fromUint8Array(e)}const pt="server_timestamp",gt="__type__",vt="__previous_value__",xt="__local_write_time__";function yt(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[gt])||void 0===n?void 0:n.stringValue)===pt}function bt(e){const t=e.mapValue.fields[vt];return yt(t)?bt(t):t}function wt(e){const t=ht(e.mapValue.fields[xt].timestampValue);return new ne(t.seconds,t.nanos)}class Dt{constructor(e,t,n,r,s,i,a,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const Nt="(default)";class jt{constructor(e,t){this.projectId=e,this.database=t||Nt}static empty(){return new jt("","")}get isDefaultDatabase(){return this.database===Nt}isEqual(e){return e instanceof jt&&e.projectId===this.projectId&&e.database===this.database}}const Ct="__type__",Et="__max__",At={mapValue:{fields:{__type__:{stringValue:Et}}}},kt="__vector__",St="value";function Ft(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?yt(e)?4:Kt(e)?9007199254740991:Wt(e)?10:11:_(28295,{value:e})}function _t(e,t){if(e===t)return!0;const n=Ft(e);if(n!==Ft(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return wt(e).isEqual(wt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ht(e.timestampValue),r=ht(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ft(e.bytesValue).isEqual(ft(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return mt(e.geoPointValue.latitude)===mt(t.geoPointValue.latitude)&&mt(e.geoPointValue.longitude)===mt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return mt(e.integerValue)===mt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=mt(e.doubleValue),r=mt(t.doubleValue);return n===r?Ce(n)===Ce(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Z(e.arrayValue.values||[],t.arrayValue.values||[],_t);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(et(n)!==et(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!_t(n[s],r[s])))return!1;return!0}(e,t);default:return _(52216,{left:e})}}function Tt(e,t){return void 0!==(e.values||[]).find((e=>_t(e,t)))}function It(e,t){if(e===t)return 0;const n=Ft(e),r=Ft(t);if(n!==r)return Y(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Y(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=mt(e.integerValue||e.doubleValue),r=mt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Rt(e.timestampValue,t.timestampValue);case 4:return Rt(wt(e),wt(t));case 5:return J(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ft(e),r=ft(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=Y(n[s],r[s]);if(0!==e)return e}return Y(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Y(mt(e.latitude),mt(t.latitude));return 0!==n?n:Y(mt(e.longitude),mt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Pt(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,s,i;const a=e.fields||{},o=t.fields||{},l=null===(n=a[St])||void 0===n?void 0:n.arrayValue,c=null===(r=o[St])||void 0===r?void 0:r.arrayValue,u=Y((null===(s=null==l?void 0:l.values)||void 0===s?void 0:s.length)||0,(null===(i=null==c?void 0:c.values)||void 0===i?void 0:i.length)||0);return 0!==u?u:Pt(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===At.mapValue&&t===At.mapValue)return 0;if(e===At.mapValue)return 1;if(t===At.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let a=0;a<r.length&&a<i.length;++a){const e=J(r[a],i[a]);if(0!==e)return e;const t=It(n[r[a]],s[i[a]]);if(0!==t)return t}return Y(r.length,i.length)}(e.mapValue,t.mapValue);default:throw _(23264,{Pe:n})}}function Rt(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Y(e,t);const n=ht(e),r=ht(t),s=Y(n.seconds,r.seconds);return 0!==s?s:Y(n.nanos,r.nanos)}function Pt(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=It(n[s],r[s]);if(e)return e}return Y(n.length,r.length)}function Ot(e){return Mt(e)}function Mt(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ht(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ft(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return ce.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Mt(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+="".concat(s,":").concat(Mt(e.fields[s]));return n+"}"}(e.mapValue):_(61005,{value:e})}function Lt(e){switch(Ft(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=bt(e);return t?16+Lt(t):16;case 5:return 2*e.stringValue.length;case 6:return ft(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Lt(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return tt(e.fields,((e,n)=>{t+=e.length+Lt(n)})),t}(e.mapValue);default:throw _(13486,{value:e})}}function Bt(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function zt(e){return!!e&&"integerValue"in e}function Ut(e){return!!e&&"arrayValue"in e}function qt(e){return!!e&&"nullValue"in e}function Vt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ht(e){return!!e&&"mapValue"in e}function Wt(e){var t,n;return(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{})[Ct])||void 0===n?void 0:n.stringValue)===kt}function Gt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return tt(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Gt(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Gt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Kt(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Et}class Qt{constructor(e){this.value=e}static empty(){return new Qt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ht(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gt(t)}setAll(e){let t=le.emptyPath(),n={},r=[];e.forEach(((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=Gt(e):r.push(s.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());Ht(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return _t(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ht(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){tt(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new Qt(Gt(this.value))}}function Yt(e){const t=[];return tt(e.fields,((e,n)=>{const r=new le([e]);if(Ht(n)){const e=Yt(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new lt(t)}class Jt{constructor(e,t,n,r,s,i,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=a}static newInvalidDocument(e){return new Jt(e,0,re.min(),re.min(),re.min(),Qt.empty(),0)}static newFoundDocument(e,t,n,r){return new Jt(e,1,t,re.min(),n,r,0)}static newNoDocument(e,t){return new Jt(e,2,t,re.min(),re.min(),Qt.empty(),0)}static newUnknownDocument(e,t){return new Jt(e,3,t,re.min(),re.min(),Qt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(re.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Jt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Jt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Xt{constructor(e,t){this.position=e,this.inclusive=t}}function $t(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],a=e.position[s];if(r=i.field.isKeyField()?ce.comparator(ce.fromName(a.referenceValue),n.key):It(a,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Zt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!_t(e.position[n],t.position[n]))return!1;return!0}class en{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function tn(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class nn{}class rn extends nn{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new hn(e,t,n):"array-contains"===t?new gn(e,n):"in"===t?new vn(e,n):"not-in"===t?new xn(e,n):"array-contains-any"===t?new yn(e,n):new rn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new mn(e,n):new fn(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(It(t,this.value)):null!==t&&Ft(this.value)===Ft(t)&&this.matchesComparison(It(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return _(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class sn extends nn{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new sn(e,t)}matches(e){return an(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.Te||(this.Te=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function an(e){return"and"===e.op}function on(e){return ln(e)&&an(e)}function ln(e){for(const t of e.filters)if(t instanceof sn)return!1;return!0}function cn(e){if(e instanceof rn)return e.field.canonicalString()+e.op.toString()+Ot(e.value);if(on(e))return e.filters.map((e=>cn(e))).join(",");{const t=e.filters.map((e=>cn(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function un(e,t){return e instanceof rn?function(e,t){return t instanceof rn&&e.op===t.op&&e.field.isEqual(t.field)&&_t(e.value,t.value)}(e,t):e instanceof sn?function(e,t){return t instanceof sn&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&un(n,t.filters[r])),!0)}(e,t):void _(19439)}function dn(e){return e instanceof rn?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Ot(e.value))}(e):e instanceof sn?function(e){return e.op.toString()+" {"+e.getFilters().map(dn).join(" ,")+"}"}(e):"Filter"}class hn extends rn{constructor(e,t,n){super(e,t,n),this.key=ce.fromName(n.referenceValue)}matches(e){const t=ce.comparator(e.key,this.key);return this.matchesComparison(t)}}class mn extends rn{constructor(e,t){super(e,"in",t),this.keys=pn("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class fn extends rn{constructor(e,t){super(e,"not-in",t),this.keys=pn("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function pn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>ce.fromName(e.referenceValue)))}class gn extends rn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ut(t)&&Tt(t.arrayValue,this.value)}}class vn extends rn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Tt(this.value.arrayValue,t)}}class xn extends rn{constructor(e,t){super(e,"not-in",t)}matches(e){if(Tt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Tt(this.value.arrayValue,t)}}class yn extends rn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ut(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Tt(this.value.arrayValue,e)))}}class bn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=a,this.Ie=null}}function wn(e){return new bn(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Dn(e){const t=R(e);if(null===t.Ie){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>cn(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),je(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Ot(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Ot(e))).join(",")),t.Ie=e}return t.Ie}function Nn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!tn(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!un(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Zt(e.startAt,t.startAt)&&Zt(e.endAt,t.endAt)}function jn(e){return ce.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Cn{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=a,this.endAt=o,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function En(e,t,n,r,s,i,a,o){return new Cn(e,t,n,r,s,i,a,o)}function An(e){return new Cn(e)}function kn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Sn(e){return null!==e.collectionGroup}function Fn(e){const t=R(e);if(null===t.Ee){t.Ee=[];const e=new Set;for(const s of t.explicitOrderBy)t.Ee.push(s),e.add(s.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new at(le.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ee.push(new en(r,n))})),e.has(le.keyField().canonicalString())||t.Ee.push(new en(le.keyField(),n))}return t.Ee}function _n(e){const t=R(e);return t.de||(t.de=Tn(t,Fn(e))),t.de}function Tn(e,t){if("F"===e.limitType)return wn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new en(e.field,t)}));const n=e.endAt?new Xt(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Xt(e.startAt.position,e.startAt.inclusive):null;return wn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function In(e,t){const n=e.filters.concat([t]);return new Cn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Rn(e,t,n){return new Cn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Pn(e,t){return Nn(_n(e),_n(t))&&e.limitType===t.limitType}function On(e){return"".concat(Dn(_n(e)),"|lt:").concat(e.limitType)}function Mn(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>dn(e))).join(", "),"]")),je(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Ot(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Ot(e))).join(",")),"Target(".concat(t,")")}(_n(e)),"; limitType=").concat(e.limitType,")")}function Ln(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ce.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Fn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=$t(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Fn(e),t))&&!(e.endAt&&!function(e,t,n){const r=$t(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Fn(e),t))}(e,t)}function Bn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function zn(e){return(t,n)=>{let r=!1;for(const s of Fn(e)){const e=Un(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function Un(e,t,n){const r=e.field.isKeyField()?ce.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?It(r,s):_(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return _(19790,{direction:e.dir})}}class qn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){tt(this.inner,((t,n)=>{for(const[r,s]of n)e(r,s)}))}isEmpty(){return nt(this.inner)}size(){return this.innerSize}}const Vn=new rt(ce.comparator);function Hn(){return Vn}const Wn=new rt(ce.comparator);function Gn(){let e=Wn;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.insert(s.key,s);return e}function Kn(e){let t=Wn;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Qn(){return Jn()}function Yn(){return Jn()}function Jn(){return new qn((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Xn=new rt(ce.comparator),$n=new at(ce.comparator);function Zn(){let e=$n;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const s of n)e=e.add(s);return e}const er=new at(Y);function tr(){return er}function nr(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ce(t)?"-0":t}}function rr(e){return{integerValue:""+e}}function sr(e,t){return Ee(t)?rr(t):nr(e,t)}class ir{constructor(){this._=void 0}}function ar(e,t,n){return e instanceof cr?function(e,t){const n={fields:{[gt]:{stringValue:pt},[xt]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&yt(t)&&(t=bt(t)),t&&(n.fields[vt]=t),{mapValue:n}}(n,t):e instanceof ur?dr(e,t):e instanceof hr?mr(e,t):function(e,t){const n=lr(e,t),r=pr(n)+pr(e.Re);return zt(n)&&zt(e.Re)?rr(r):nr(e.serializer,r)}(e,t)}function or(e,t,n){return e instanceof ur?dr(e,t):e instanceof hr?mr(e,t):n}function lr(e,t){return e instanceof fr?function(e){return zt(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class cr extends ir{}class ur extends ir{constructor(e){super(),this.elements=e}}function dr(e,t){const n=gr(t);for(const r of e.elements)n.some((e=>_t(e,r)))||n.push(r);return{arrayValue:{values:n}}}class hr extends ir{constructor(e){super(),this.elements=e}}function mr(e,t){let n=gr(t);for(const r of e.elements)n=n.filter((e=>!_t(e,r)));return{arrayValue:{values:n}}}class fr extends ir{constructor(e,t){super(),this.serializer=e,this.Re=t}}function pr(e){return mt(e.integerValue||e.doubleValue)}function gr(e){return Ut(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class vr{constructor(e,t){this.field=e,this.transform=t}}class xr{constructor(e,t){this.version=e,this.transformResults=t}}class yr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new yr}static exists(e){return new yr(void 0,e)}static updateTime(e){return new yr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function br(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class wr{}function Dr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Tr(e.key,yr.none()):new Ar(e.key,e.data,yr.none());{const n=e.data,r=Qt.empty();let s=new at(le.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new kr(e.key,r,new lt(s.toArray()),yr.none())}}function Nr(e,t,n){e instanceof Ar?function(e,t,n){const r=e.value.clone(),s=Fr(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof kr?function(e,t,n){if(!br(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Fr(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(Sr(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function jr(e,t,n,r){return e instanceof Ar?function(e,t,n,r){if(!br(e.precondition,t))return n;const s=e.value.clone(),i=_r(e.fieldTransforms,r,t);return s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof kr?function(e,t,n,r){if(!br(e.precondition,t))return n;const s=_r(e.fieldTransforms,r,t),i=t.data;return i.setAll(Sr(e)),i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return br(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Cr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=lr(r.transform,e||null);null!=s&&(null===n&&(n=Qt.empty()),n.set(r.field,s))}return n||null}function Er(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Z(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ur&&t instanceof ur||e instanceof hr&&t instanceof hr?Z(e.elements,t.elements,_t):e instanceof fr&&t instanceof fr?_t(e.Re,t.Re):e instanceof cr&&t instanceof cr}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ar extends wr{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class kr extends wr{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Sr(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Fr(e,t,n){const r=new Map;I(e.length===n.length,32656,{Ve:n.length,me:e.length});for(let s=0;s<n.length;s++){const i=e[s],a=i.transform,o=t.data.field(i.field);r.set(i.field,or(a,o,n[s]))}return r}function _r(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,ar(e,i,t))}return r}class Tr extends wr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ir extends wr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Rr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Nr(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=jr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=jr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Yn();return this.mutations.forEach((r=>{const s=e.get(r.key),i=s.overlayedDocument;let a=this.applyToLocalView(i,s.mutatedFields);a=t.has(r.key)?null:a;const o=Dr(i,a);null!==o&&n.set(r.key,o),i.isValidDocument()||i.convertToNoDocument(re.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Zn())}isEqual(e){return this.batchId===e.batchId&&Z(this.mutations,e.mutations,((e,t)=>Er(e,t)))&&Z(this.baseMutations,e.baseMutations,((e,t)=>Er(e,t)))}}class Pr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){I(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let r=Xn;const s=e.mutations;for(let i=0;i<s.length;i++)r=r.insert(s[i].key,n[i].version);return new Pr(e,t,n,r)}}class Or{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Mr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Lr,Br;function zr(e){switch(e){case P.OK:return _(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return _(15467,{code:e})}}function Ur(e){if(void 0===e)return k("GRPC error has no .code"),P.UNKNOWN;switch(e){case Lr.OK:return P.OK;case Lr.CANCELLED:return P.CANCELLED;case Lr.UNKNOWN:return P.UNKNOWN;case Lr.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case Lr.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case Lr.INTERNAL:return P.INTERNAL;case Lr.UNAVAILABLE:return P.UNAVAILABLE;case Lr.UNAUTHENTICATED:return P.UNAUTHENTICATED;case Lr.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case Lr.NOT_FOUND:return P.NOT_FOUND;case Lr.ALREADY_EXISTS:return P.ALREADY_EXISTS;case Lr.PERMISSION_DENIED:return P.PERMISSION_DENIED;case Lr.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case Lr.ABORTED:return P.ABORTED;case Lr.OUT_OF_RANGE:return P.OUT_OF_RANGE;case Lr.UNIMPLEMENTED:return P.UNIMPLEMENTED;case Lr.DATA_LOSS:return P.DATA_LOSS;default:return _(39323,{code:e})}}(Br=Lr||(Lr={}))[Br.OK=0]="OK",Br[Br.CANCELLED=1]="CANCELLED",Br[Br.UNKNOWN=2]="UNKNOWN",Br[Br.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Br[Br.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Br[Br.NOT_FOUND=5]="NOT_FOUND",Br[Br.ALREADY_EXISTS=6]="ALREADY_EXISTS",Br[Br.PERMISSION_DENIED=7]="PERMISSION_DENIED",Br[Br.UNAUTHENTICATED=16]="UNAUTHENTICATED",Br[Br.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Br[Br.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Br[Br.ABORTED=10]="ABORTED",Br[Br.OUT_OF_RANGE=11]="OUT_OF_RANGE",Br[Br.UNIMPLEMENTED=12]="UNIMPLEMENTED",Br[Br.INTERNAL=13]="INTERNAL",Br[Br.UNAVAILABLE=14]="UNAVAILABLE",Br[Br.DATA_LOSS=15]="DATA_LOSS";let qr=null;const Vr=new r([4294967295,4294967295],0);function Hr(e){const t=K().encode(e),n=new s;return n.update(t),new Uint8Array(n.digest())}function Wr(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),s=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new r([n,s],0),new r([i,a],0)]}class Gr{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Kr("Invalid padding: ".concat(t));if(n<0)throw new Kr("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new Kr("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new Kr("Invalid padding when bitmap length is 0: ".concat(t));this.pe=8*e.length-t,this.ye=r.fromNumber(this.pe)}we(e,t,n){let s=e.add(t.multiply(r.fromNumber(n)));return 1===s.compare(Vr)&&(s=new r([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.pe)return!1;const t=Hr(e),[n,r]=Wr(t);for(let s=0;s<this.hashCount;s++){const e=this.we(n,r,s);if(!this.be(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new Gr(s,r,t);return n.forEach((e=>i.insert(e))),i}insert(e){if(0===this.pe)return;const t=Hr(e),[n,r]=Wr(t);for(let s=0;s<this.hashCount;s++){const e=this.we(n,r,s);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Kr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Qr{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Yr.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Qr(re.min(),r,new rt(Y),Hn(),Zn())}}class Yr{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Yr(n,t,Zn(),Zn(),Zn())}}class Jr{constructor(e,t,n,r){this.De=e,this.removedTargetIds=t,this.key=n,this.ve=r}}class Xr{constructor(e,t){this.targetId=e,this.Ce=t}}class $r{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ut.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Zr{constructor(){this.Fe=0,this.Me=ns(),this.xe=ut.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return 0!==this.Fe}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Zn(),t=Zn(),n=Zn();return this.Me.forEach(((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:_(38017,{changeType:s})}})),new Yr(this.xe,this.Oe,e,t,n)}Qe(){this.Ne=!1,this.Me=ns()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,I(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class es{constructor(e){this.ze=e,this.je=new Map,this.He=Hn(),this.Je=ts(),this.Ye=ts(),this.Ze=new rt(Y)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,(t=>{const n=this.rt(t);switch(e.state){case 0:this.it(t)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(t);break;case 3:this.it(t)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),n.ke(e.resumeToken));break;default:_(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach(((e,n)=>{this.it(n)&&t(n)}))}ot(e){const t=e.targetId,n=e.Ce.count,r=this._t(t);if(r){const s=r.target;if(jn(s))if(0===n){const e=new ce(s.path);this.tt(t,e,Jt.newNoDocument(e,re.min()))}else I(1===n,20013,{expectedCount:n});else{const r=this.ut(t);if(r!==n){const n=this.ct(e),s=n?this.lt(n,e,r):1;if(0!==s){this.st(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,e)}null==qr||qr.ht(function(e,t,n,r,s){var i,a,o,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===s,hashCount:null!==(i=null==h?void 0:h.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(l=null===(o=null===(a=null==h?void 0:h.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.Ce,this.ze.Pt(),n,s))}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let i,a;try{i=ft(n).toUint8Array()}catch(e){if(e instanceof ct)return S("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new Gr(i,r,s)}catch(e){return S(e instanceof Kr?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.pe?null:a}lt(e,t,n){return t.Ce.count===n-this.Tt(e,t.targetId)?0:2}Tt(e,t){const n=this.ze.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const s=this.ze.Pt(),i="projects/".concat(s.projectId,"/databases/").concat(s.database,"/documents/").concat(n.path.canonicalString());e.mightContain(i)||(this.tt(t,n,null),r++)})),r}It(e){const t=new Map;this.je.forEach(((n,r)=>{const s=this._t(r);if(s){if(n.current&&jn(s.target)){const t=new ce(s.target.path);this.Et(t).has(r)||this.dt(r,t)||this.tt(r,t,Jt.newNoDocument(t,e))}n.Le&&(t.set(r,n.qe()),n.Qe())}}));let n=Zn();this.Ye.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this._t(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.He.forEach(((t,n)=>n.setReadTime(e)));const r=new Qr(e,t,this.Ze,this.He,n);return this.He=Hn(),this.Je=ts(),this.Ye=ts(),this.Ze=new rt(Y),r}et(e,t){if(!this.it(e))return;const n=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,n),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,n){if(!this.it(e))return;const r=this.rt(e);this.dt(e,t)?r.$e(t,1):r.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),n&&(this.He=this.He.insert(t,n))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new Zr,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new at(Y),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new at(Y),this.Je=this.Je.insert(e,t)),t}it(e){const t=null!==this._t(e);return t||A("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new Zr),this.ze.getRemoteKeysForTarget(e).forEach((t=>{this.tt(e,t,null)}))}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function ts(){return new rt(ce.comparator)}function ns(){return new rt(ce.comparator)}const rs={asc:"ASCENDING",desc:"DESCENDING"},ss={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},is={and:"AND",or:"OR"};class as{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function os(e,t){return e.useProto3Json||je(t)?t:{value:t}}function ls(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function cs(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function us(e,t){return ls(e,t.toTimestamp())}function ds(e){return I(!!e,49232),re.fromTimestamp(function(e){const t=ht(e);return new ne(t.seconds,t.nanos)}(e))}function hs(e,t){return ms(e,t).canonicalString()}function ms(e,t){const n=function(e){return new ae(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function fs(e){const t=ae.fromString(e);return I(Rs(t),10190,{key:t.toString()}),t}function ps(e,t){return hs(e.databaseId,t.path)}function gs(e,t){const n=fs(t);if(n.get(1)!==e.databaseId.projectId)throw new O(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new O(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ce(bs(n))}function vs(e,t){return hs(e.databaseId,t)}function xs(e){const t=fs(e);return 4===t.length?ae.emptyPath():bs(t)}function ys(e){return new ae(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function bs(e){return I(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function ws(e,t,n){return{name:ps(e,t),fields:n.value.mapValue.fields}}function Ds(e,t){let n;if(t instanceof Ar)n={update:ws(e,t.key,t.value)};else if(t instanceof Tr)n={delete:ps(e,t.key)};else if(t instanceof kr)n={update:ws(e,t.key,t.data),updateMask:Is(t.fieldMask)};else{if(!(t instanceof Ir))return _(16599,{ft:t.type});n={verify:ps(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof cr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ur)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof hr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof fr)return{fieldPath:t.field.canonicalString(),increment:n.Re};throw _(20930,{transform:t.transform})}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:us(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:_(27497)}(e,t.precondition)),n}function Ns(e,t){return{documents:[vs(e,t.path)]}}function js(e,t){const n={structuredQuery:{}},r=t.path;let s;null!==t.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=vs(e,s);const i=function(e){if(0!==e.length)return Ts(sn.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const a=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Fs(e.field),direction:As(e.dir)}}(e)))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=os(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{gt:n,parent:s}}function Cs(e){let t=xs(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){I(1===r,65062);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=Es(e);return t instanceof sn&&on(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map((e=>function(e){return new en(_s(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,je(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Xt(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Xt(n,t)}(n.endAt)),En(t,s,a,i,o,"F",l,c)}function Es(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=_s(e.unaryFilter.field);return rn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=_s(e.unaryFilter.field);return rn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=_s(e.unaryFilter.field);return rn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=_s(e.unaryFilter.field);return rn.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _(61313);default:return _(60726)}}(e):void 0!==e.fieldFilter?function(e){return rn.create(_s(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _(58110);default:return _(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return sn.create(e.compositeFilter.filters.map((e=>Es(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return _(1026)}}(e.compositeFilter.op))}(e):_(30097,{filter:e})}function As(e){return rs[e]}function ks(e){return ss[e]}function Ss(e){return is[e]}function Fs(e){return{fieldPath:e.canonicalString()}}function _s(e){return le.fromServerFormat(e.fieldPath)}function Ts(e){return e instanceof rn?function(e){if("=="===e.op){if(Vt(e.value))return{unaryFilter:{field:Fs(e.field),op:"IS_NAN"}};if(qt(e.value))return{unaryFilter:{field:Fs(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Vt(e.value))return{unaryFilter:{field:Fs(e.field),op:"IS_NOT_NAN"}};if(qt(e.value))return{unaryFilter:{field:Fs(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fs(e.field),op:ks(e.op),value:e.value}}}(e):e instanceof sn?function(e){const t=e.getFilters().map((e=>Ts(e)));return 1===t.length?t[0]:{compositeFilter:{op:Ss(e.op),filters:t}}}(e):_(54877,{filter:e})}function Is(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Rs(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Ps{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:re.min(),i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:re.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ut.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new Ps(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ps(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Os{constructor(e){this.wt=e}}function Ms(e){const t=Cs({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Rn(t,t.limit,"L"):t}class Ls{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(mt(e.integerValue));else if("doubleValue"in e){const n=mt(e.doubleValue);isNaN(n)?this.Mt(t,13):(this.Mt(t,15),Ce(n)?t.xt(0):t.xt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Mt(t,20),"string"==typeof n&&(n=ht(n)),t.Ot("".concat(n.seconds||"")),t.xt(n.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(ft(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Mt(t,45),t.xt(n.latitude||0),t.xt(n.longitude||0)}else"mapValue"in e?Kt(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):Wt(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):_(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const n=e.fields||{};this.Mt(t,55);for(const r of Object.keys(n))this.Nt(r,t),this.Ct(n[r],t)}qt(e,t){var n,r;const s=e.fields||{};this.Mt(t,53);const i=St,a=(null===(r=null===(n=s[i].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.Mt(t,15),t.xt(mt(a)),this.Nt(i,t),this.Ct(s[i],t)}$t(e,t){const n=e.values||[];this.Mt(t,50);for(const r of n)this.Ct(r,t)}kt(e,t){this.Mt(t,37),ce.fromName(e).path.forEach((e=>{this.Mt(t,60),this.Kt(e,t)}))}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}Ls.Wt=new Ls;class Bs{constructor(){this.yn=new zs}addToCollectionParentIndex(e,t){return this.yn.add(t),ye.resolve()}getCollectionParents(e,t){return ye.resolve(this.yn.getEntries(t))}addFieldIndex(e,t){return ye.resolve()}deleteFieldIndex(e,t){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,t){return ye.resolve()}getDocumentsMatchingTarget(e,t){return ye.resolve(null)}getIndexType(e,t){return ye.resolve(0)}getFieldIndexes(e,t){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,t){return ye.resolve(fe.min())}getMinOffsetFromCollectionGroup(e,t){return ye.resolve(fe.min())}updateCollectionGroup(e,t,n){return ye.resolve()}updateIndexEntries(e,t){return ye.resolve()}}class zs{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new at(ae.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new at(ae.comparator)).toArray()}}new Uint8Array(0);const Us={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qs=41943040;class Vs{static withCacheSize(e){return new Vs(e,Vs.DEFAULT_COLLECTION_PERCENTILE,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Vs.DEFAULT_COLLECTION_PERCENTILE=10,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vs.DEFAULT=new Vs(qs,Vs.DEFAULT_COLLECTION_PERCENTILE,Vs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vs.DISABLED=new Vs(-1,0,0);class Hs{constructor(e){this.nr=e}next(){return this.nr+=2,this.nr}static rr(){return new Hs(0)}static ir(){return new Hs(-1)}}const Ws="LruGarbageCollector",Gs=1048576;function Ks(e,t){let[n,r]=e,[s,i]=t;const a=Y(n,s);return 0===a?Y(r,i):a}class Qs{constructor(e){this.cr=e,this.buffer=new at(Ks),this.lr=0}hr(){return++this.lr}Pr(e){const t=[e,this.hr()];if(this.buffer.size<this.cr)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Ks(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Ys{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Tr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Ir(6e4)}stop(){this.Tr&&(this.Tr.cancel(),this.Tr=null)}get started(){return null!==this.Tr}Ir(e){A(Ws,"Garbage collection scheduled in ".concat(e,"ms")),this.Tr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Tr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){we(e)?A(Ws,"Ignoring IndexedDB error during garbage collection: ",e):await xe(e)}await this.Ir(3e5)}))}}class Js{constructor(e,t){this.Er=e,this.params=t}calculateTargetCount(e,t){return this.Er.dr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return ye.resolve(De.le);const n=new Qs(t);return this.Er.forEachTarget(e,(e=>n.Pr(e.sequenceNumber))).next((()=>this.Er.Ar(e,(e=>n.Pr(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Er.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Er.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(Us)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),Us):this.Rr(e,t)))}getCacheSize(e){return this.Er.getCacheSize(e)}Rr(e,t){let n,r,s,i,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,a=Date.now(),this.removeTargets(e,n,t)))).next((t=>(s=t,l=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),E()<=o.$b.DEBUG&&A("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(i-u,"ms\n\tDetermined least recently used ").concat(r," in ")+(a-i)+"ms\n"+"\tRemoved ".concat(s," targets in ")+(l-a)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-l)+"ms\n"+"Total Duration: ".concat(c-u,"ms")),ye.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:e}))))}}function Xs(e,t){return new Js(e,t)}class $s{constructor(){this.changes=new qn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Jt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ye.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Zs{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ei{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&jr(n.mutation,e,lt.empty(),ne.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Zn()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Zn();const r=Qn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Gn();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Qn();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Zn())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let s=Hn();const i=Jn(),a=Jn();return t.forEach(((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof kr)?s=s.insert(t.key,t):void 0!==a?(i.set(t.key,a.mutation.getFieldMask()),jr(a.mutation,t,a.mutation.getFieldMask(),ne.now())):i.set(t.key,lt.empty())})),this.recalculateAndSaveOverlays(e,s).next((e=>(e.forEach(((e,t)=>i.set(e,t))),t.forEach(((e,t)=>{var n;return a.set(e,new Zs(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),a)))}recalculateAndSaveOverlays(e,t){const n=Jn();let r=new rt(((e,t)=>e-t)),s=Zn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const s of e)s.keys().forEach((e=>{const i=t.get(e);if(null===i)return;let a=n.get(e)||lt.empty();a=s.applyToLocalView(i,a),n.set(e,a);const o=(r.get(s.batchId)||Zn()).add(e);r=r.insert(s.batchId,o)}))})).next((()=>{const i=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=Yn();l.forEach((e=>{if(!s.has(e)){const r=Dr(t.get(e),n.get(e));null!==r&&c.set(e,r),s=s.add(e)}})),i.push(this.documentOverlayCache.saveOverlays(e,o,c))}return ye.waitFor(i)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return ce.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Sn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):ye.resolve(Qn());let a=ue,o=s;return i.next((t=>ye.forEach(t,((t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),s.get(t)?ye.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,s))).next((()=>this.computeViews(e,o,t,Zn()))).next((e=>({batchId:a,changes:Kn(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ce(t)).next((e=>{let t=Gn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let i=Gn();return this.indexManager.getCollectionParents(e,s).next((a=>ye.forEach(a,(a=>{const o=function(e,t){return new Cn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r)))).next((e=>{s.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Jt.newInvalidDocument(r)))}));let n=Gn();return e.forEach(((e,r)=>{const i=s.get(e);void 0!==i&&jr(i.mutation,r,lt.empty(),ne.now()),Ln(t,r)&&(n=n.insert(e,r))})),n}))}}class ti{constructor(e){this.serializer=e,this.Fr=new Map,this.Mr=new Map}getBundleMetadata(e,t){return ye.resolve(this.Fr.get(t))}saveBundleMetadata(e,t){return this.Fr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ds(e.createTime)}}(t)),ye.resolve()}getNamedQuery(e,t){return ye.resolve(this.Mr.get(t))}saveNamedQuery(e,t){return this.Mr.set(t.name,function(e){return{name:e.name,query:Ms(e.bundledQuery),readTime:ds(e.readTime)}}(t)),ye.resolve()}}class ni{constructor(){this.overlays=new rt(ce.comparator),this.Or=new Map}getOverlay(e,t){return ye.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Qn();return ye.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.St(e,t,r)})),ye.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Or.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Or.delete(n)),ye.resolve()}getOverlaysForCollection(e,t,n){const r=Qn(),s=t.length+1,i=new ce(t.child("")),a=this.overlays.getIteratorFrom(i);for(;a.hasNext();){const e=a.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ye.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new rt(((e,t)=>e-t));const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=Qn(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=Qn(),o=s.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>a.set(e,t))),!(a.size()>=r)););return ye.resolve(a)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Or.get(r.largestBatchId).delete(n.key);this.Or.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Or(t,n));let s=this.Or.get(t);void 0===s&&(s=Zn(),this.Or.set(t,s)),this.Or.set(t,s.add(n.key))}}class ri{constructor(){this.sessionToken=ut.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ye.resolve()}}class si{constructor(){this.Nr=new at(ii.Br),this.Lr=new at(ii.kr)}isEmpty(){return this.Nr.isEmpty()}addReference(e,t){const n=new ii(e,t);this.Nr=this.Nr.add(n),this.Lr=this.Lr.add(n)}qr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Qr(new ii(e,t))}$r(e,t){e.forEach((e=>this.removeReference(e,t)))}Ur(e){const t=new ce(new ae([])),n=new ii(t,e),r=new ii(t,e+1),s=[];return this.Lr.forEachInRange([n,r],(e=>{this.Qr(e),s.push(e.key)})),s}Kr(){this.Nr.forEach((e=>this.Qr(e)))}Qr(e){this.Nr=this.Nr.delete(e),this.Lr=this.Lr.delete(e)}Wr(e){const t=new ce(new ae([])),n=new ii(t,e),r=new ii(t,e+1);let s=Zn();return this.Lr.forEachInRange([n,r],(e=>{s=s.add(e.key)})),s}containsKey(e){const t=new ii(e,0),n=this.Nr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ii{constructor(e,t){this.key=e,this.Gr=t}static Br(e,t){return ce.comparator(e.key,t.key)||Y(e.Gr,t.Gr)}static kr(e,t){return Y(e.Gr,t.Gr)||ce.comparator(e.key,t.key)}}class ai{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Jn=1,this.zr=new at(ii.Br)}checkEmpty(e){return ye.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.Jn;this.Jn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new Rr(s,t,n,r);this.mutationQueue.push(i);for(const a of r)this.zr=this.zr.add(new ii(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ye.resolve(i)}lookupMutationBatch(e,t){return ye.resolve(this.jr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Hr(n),s=r<0?0:r;return ye.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(0===this.mutationQueue.length?Ne:this.Jn-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ii(t,0),r=new ii(t,Number.POSITIVE_INFINITY),s=[];return this.zr.forEachInRange([n,r],(e=>{const t=this.jr(e.Gr);s.push(t)})),ye.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new at(Y);return t.forEach((e=>{const t=new ii(e,0),r=new ii(e,Number.POSITIVE_INFINITY);this.zr.forEachInRange([t,r],(e=>{n=n.add(e.Gr)}))})),ye.resolve(this.Jr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;ce.isDocumentKey(s)||(s=s.child(""));const i=new ii(new ce(s),0);let a=new at(Y);return this.zr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.Gr)),!0)}),i),ye.resolve(this.Jr(a))}Jr(e){const t=[];return e.forEach((e=>{const n=this.jr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){I(0===this.Yr(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.zr;return ye.forEach(t.mutations,(r=>{const s=new ii(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.zr=n}))}Xn(e){}containsKey(e,t){const n=new ii(t,0),r=this.zr.firstAfterOrEqual(n);return ye.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}Yr(e,t){return this.Hr(e)}Hr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}jr(e){const t=this.Hr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class oi{constructor(e){this.Zr=e,this.docs=new rt(ce.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,i=this.Zr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ye.resolve(n?n.document.mutableCopy():Jt.newInvalidDocument(t))}getEntries(e,t){let n=Hn();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Jt.newInvalidDocument(e))})),ye.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Hn();const i=t.path,a=new ce(i.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||pe(me(a),n)<=0||(r.has(a.key)||Ln(t,a))&&(s=s.insert(a.key,a.mutableCopy()))}return ye.resolve(s)}getAllFromCollectionGroup(e,t,n,r){_(9500)}Xr(e,t){return ye.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new li(this)}getSize(e){return ye.resolve(this.size)}}class li extends $s{constructor(e){super(),this.vr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.vr.addEntry(e,r)):this.vr.removeEntry(n)})),ye.waitFor(t)}getFromCache(e,t){return this.vr.getEntry(e,t)}getAllFromCache(e,t){return this.vr.getEntries(e,t)}}class ci{constructor(e){this.persistence=e,this.ei=new qn((e=>Dn(e)),Nn),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.ti=0,this.ni=new si,this.targetCount=0,this.ri=Hs.rr()}forEachTarget(e,t){return this.ei.forEach(((e,n)=>t(n))),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.ti)}allocateTargetId(e){return this.highestTargetId=this.ri.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ti&&(this.ti=t),ye.resolve()}ar(e){this.ei.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ri=new Hs(t),this.highestTargetId=t),e.sequenceNumber>this.ti&&(this.ti=e.sequenceNumber)}addTargetData(e,t){return this.ar(t),this.targetCount+=1,ye.resolve()}updateTargetData(e,t){return this.ar(t),ye.resolve()}removeTargetData(e,t){return this.ei.delete(t.target),this.ni.Ur(t.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.ei.forEach(((i,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.ei.delete(i),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),ye.waitFor(s).next((()=>r))}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,t){const n=this.ei.get(t)||null;return ye.resolve(n)}addMatchingKeys(e,t,n){return this.ni.qr(t,n),ye.resolve()}removeMatchingKeys(e,t,n){this.ni.$r(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach((t=>{s.push(r.markPotentiallyOrphaned(e,t))})),ye.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ni.Ur(t),ye.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ni.Wr(t);return ye.resolve(n)}containsKey(e,t){return ye.resolve(this.ni.containsKey(t))}}class ui{constructor(e,t){this.ii={},this.overlays={},this.si=new De(0),this.oi=!1,this.oi=!0,this._i=new ri,this.referenceDelegate=e(this),this.ai=new ci(this),this.indexManager=new Bs,this.remoteDocumentCache=function(e){return new oi(e)}((e=>this.referenceDelegate.ui(e))),this.serializer=new Os(t),this.ci=new ti(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.oi=!1,Promise.resolve()}get started(){return this.oi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ni,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ii[e.toKey()];return n||(n=new ai(t,this.referenceDelegate),this.ii[e.toKey()]=n),n}getGlobalsCache(){return this._i}getTargetCache(){return this.ai}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.ci}runTransaction(e,t,n){A("MemoryPersistence","Starting transaction:",e);const r=new di(this.si.next());return this.referenceDelegate.li(),n(r).next((e=>this.referenceDelegate.hi(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Pi(e,t){return ye.or(Object.values(this.ii).map((n=>()=>n.containsKey(e,t))))}}class di extends ve{constructor(e){super(),this.currentSequenceNumber=e}}class hi{constructor(e){this.persistence=e,this.Ti=new si,this.Ii=null}static Ei(e){return new hi(e)}get di(){if(this.Ii)return this.Ii;throw _(60996)}addReference(e,t,n){return this.Ti.addReference(n,t),this.di.delete(n.toString()),ye.resolve()}removeReference(e,t,n){return this.Ti.removeReference(n,t),this.di.add(n.toString()),ye.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ye.resolve()}removeTarget(e,t){this.Ti.Ur(t.targetId).forEach((e=>this.di.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.di.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}li(){this.Ii=new Set}hi(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.di,(n=>{const r=ce.fromPath(n);return this.Ai(e,r).next((e=>{e||t.removeEntry(r,re.min())}))})).next((()=>(this.Ii=null,t.apply(e))))}updateLimboDocument(e,t){return this.Ai(e,t).next((e=>{e?this.di.delete(t.toString()):this.di.add(t.toString())}))}ui(e){return 0}Ai(e,t){return ye.or([()=>ye.resolve(this.Ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Pi(e,t)])}}class mi{constructor(e,t){this.persistence=e,this.Ri=new qn((e=>ke(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=Xs(this,t)}static Ei(e,t){return new mi(e,t)}li(){}hi(e){return ye.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.Vr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Vr(e){let t=0;return this.Ar(e,(e=>{t++})).next((()=>t))}Ar(e,t){return ye.forEach(this.Ri,((n,r)=>this.gr(e,n,r).next((e=>e?ye.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.Xr(e,(r=>this.gr(e,r,t).next((e=>{e||(n++,s.removeEntry(r,re.min()))})))).next((()=>s.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.Ri.set(t,e.currentSequenceNumber),ye.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.Ri.set(n,e.currentSequenceNumber),ye.resolve()}removeReference(e,t,n){return this.Ri.set(n,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,t){return this.Ri.set(t,e.currentSequenceNumber),ye.resolve()}ui(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Lt(e.data.value)),t}gr(e,t,n){return ye.or([()=>this.persistence.Pi(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.Ri.get(t);return ye.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class fi{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.ls=n,this.hs=r}static Ps(e,t){let n=Zn(),r=Zn();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new fi(e,t.fromCache,n,r)}}class pi{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class gi{constructor(){this.Ts=!1,this.Is=!1,this.Es=100,this.ds=(0,l.nr)()?8:be((0,l.ZQ)())>0?6:4}initialize(e,t){this.As=e,this.indexManager=t,this.Ts=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.Rs(e,t).next((e=>{s.result=e})).next((()=>{if(!s.result)return this.Vs(e,t,r,n).next((e=>{s.result=e}))})).next((()=>{if(s.result)return;const n=new pi;return this.fs(e,t,n).next((r=>{if(s.result=r,this.Is)return this.gs(e,t,n,r.size)}))})).next((()=>s.result))}gs(e,t,n,r){return n.documentReadCount<this.Es?(E()<=o.$b.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",Mn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Es,"documents"),ye.resolve()):(E()<=o.$b.DEBUG&&A("QueryEngine","Query:",Mn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.ds*r?(E()<=o.$b.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",Mn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_n(t))):ye.resolve())}Rs(e,t){if(kn(t))return ye.resolve(null);let n=_n(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Rn(t,null,"F"),n=_n(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const s=Zn(...r);return this.As.getDocuments(e,s).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const i=this.ps(t,r);return this.ys(t,i,s,n.readTime)?this.Rs(e,Rn(t,null,"F")):this.ws(e,i,t,n)}))))})))))}Vs(e,t,n,r){return kn(t)||r.isEqual(re.min())?ye.resolve(null):this.As.getDocuments(e,n).next((s=>{const i=this.ps(t,s);return this.ys(t,i,n,r)?ye.resolve(null):(E()<=o.$b.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Mn(t)),this.ws(e,i,t,he(r,ue)).next((e=>e)))}))}ps(e,t){let n=new at(zn(e));return t.forEach(((t,r)=>{Ln(e,r)&&(n=n.add(r))})),n}ys(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}fs(e,t,n){return E()<=o.$b.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",Mn(t)),this.As.getDocumentsMatchingQuery(e,t,fe.min(),n)}ws(e,t,n,r){return this.As.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const vi="LocalStore",xi=3e8;class yi{constructor(e,t,n,r){this.persistence=e,this.bs=t,this.serializer=r,this.Ss=new rt(Y),this.Ds=new qn((e=>Dn(e)),Nn),this.vs=new Map,this.Cs=e.getRemoteDocumentCache(),this.ai=e.getTargetCache(),this.ci=e.getBundleCache(),this.Fs(n)}Fs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ei(this.Cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Cs.setIndexManager(this.indexManager),this.bs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ss)))}}function bi(e,t,n,r){return new yi(e,t,n,r)}async function wi(e,t){const n=R(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((s=>(r=s,n.Fs(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const s=[],i=[];let a=Zn();for(const e of r){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next((e=>({Ms:e,removedBatchIds:s,addedBatchIds:i})))}))}))}function Di(e){const t=R(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.ai.getLastRemoteSnapshotVersion(e)))}function Ni(e,t,n){let r=Zn(),s=Zn();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Hn();return n.forEach(((n,i)=>{const a=e.get(n);i.isFoundDocument()!==a.isFoundDocument()&&(s=s.add(n)),i.isNoDocument()&&i.version.isEqual(re.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!a.isValidDocument()||i.version.compareTo(a.version)>0||0===i.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):A(vi,"Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",i.version)})),{xs:r,Os:s}}))}function ji(e,t){const n=R(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=Ne),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Ci(e,t){const n=R(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.ai.getTargetData(e,t).next((s=>s?(r=s,ye.resolve(r)):n.ai.allocateTargetId(e).next((s=>(r=new Ps(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.ai.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ss.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ss=n.Ss.insert(e.targetId,e),n.Ds.set(t,e.targetId)),e}))}async function Ei(e,t,n){const r=R(e),s=r.Ss.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,(e=>r.persistence.referenceDelegate.removeTarget(e,s)))}catch(e){if(!we(e))throw e;A(vi,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ss=r.Ss.remove(t),r.Ds.delete(s.target)}function Ai(e,t,n){const r=R(e);let s=re.min(),i=Zn();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=R(e),s=r.Ds.get(n);return void 0!==s?ye.resolve(r.Ss.get(s)):r.ai.getTargetData(t,n)}(r,e,_n(t)).next((t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.ai.getMatchingKeysForTargetId(e,t.targetId).next((e=>{i=e}))})).next((()=>r.bs.getDocumentsMatchingQuery(e,t,n?s:re.min(),n?i:Zn()))).next((e=>(ki(r,Bn(t),e),{documents:e,Ns:i})))))}function ki(e,t,n){let r=e.vs.get(t)||re.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.vs.set(t,r)}class Si{constructor(){this.activeTargetIds=tr()}$s(e){this.activeTargetIds=this.activeTargetIds.add(e)}Us(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Qs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fi{constructor(){this.So=new Si,this.Do={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.So.$s(e),this.Do[e]||"not-current"}updateQueryState(e,t,n){this.Do[e]=t}removeLocalQueryTarget(e){this.So.Us(e)}isLocalQueryTarget(e){return this.So.activeTargetIds.has(e)}clearQueryState(e){delete this.Do[e]}getAllActiveQueryTargets(){return this.So.activeTargetIds}isActiveQueryTarget(e){return this.So.activeTargetIds.has(e)}start(){return this.So=new Si,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class _i{vo(e){}shutdown(){}}const Ti="ConnectivityMonitor";class Ii{constructor(){this.Co=()=>this.Fo(),this.Mo=()=>this.xo(),this.Oo=[],this.No()}vo(e){this.Oo.push(e)}shutdown(){window.removeEventListener("online",this.Co),window.removeEventListener("offline",this.Mo)}No(){window.addEventListener("online",this.Co),window.addEventListener("offline",this.Mo)}Fo(){A(Ti,"Network connectivity changed: AVAILABLE");for(const e of this.Oo)e(0)}xo(){A(Ti,"Network connectivity changed: UNAVAILABLE");for(const e of this.Oo)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ri=null;function Pi(){return null===Ri?Ri=268435456+Math.round(2147483648*Math.random()):Ri++,"0x"+Ri.toString(16)}const Oi="RestConnection",Mi={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Li{get Bo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Lo=t+"://"+e.host,this.ko="projects/".concat(n,"/databases/").concat(r),this.qo=this.databaseId.database===Nt?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Qo(e,t,n,r,s){const i=Pi(),a=this.$o(e,t.toUriEncodedString());A(Oi,"Sending RPC '".concat(e,"' ").concat(i,":"),a,n);const o={"google-cloud-resource-prefix":this.ko,"x-goog-request-params":this.qo};this.Uo(o,r,s);const{host:c}=new URL(a),u=(0,l.zJ)(c);return this.Ko(e,a,o,n,u).then((t=>(A(Oi,"Received RPC '".concat(e,"' ").concat(i,": "),t),t)),(t=>{throw S(Oi,"RPC '".concat(e,"' ").concat(i," failed with error: "),t,"url: ",a,"request:",n),t}))}Wo(e,t,n,r,s,i){return this.Qo(e,t,n,r,s)}Uo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+j,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}$o(e,t){const n=Mi[e];return"".concat(this.Lo,"/v1/").concat(t,":").concat(n)}terminate(){}}class Bi{constructor(e){this.Go=e.Go,this.zo=e.zo}jo(e){this.Ho=e}Jo(e){this.Yo=e}Zo(e){this.Xo=e}onMessage(e){this.e_=e}close(){this.zo()}send(e){this.Go(e)}t_(){this.Ho()}n_(){this.Yo()}r_(e){this.Xo(e)}i_(e){this.e_(e)}}const zi="WebChannelConnection";class Ui extends Li{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ko(e,t,n,r,s){const i=Pi();return new Promise(((s,a)=>{const o=new d;o.setWithCredentials(!0),o.listenOnce(m.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case f.NO_ERROR:const t=o.getResponseJson();A(zi,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case f.TIMEOUT:A(zi,"RPC '".concat(e,"' ").concat(i," timed out")),a(new O(P.DEADLINE_EXCEEDED,"Request time out"));break;case f.HTTP_ERROR:const n=o.getStatus();if(A(zi,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(t)>=0?t:P.UNKNOWN}(t.status);a(new O(e,t.message))}else a(new O(P.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new O(P.UNAVAILABLE,"Connection failed."));break;default:_(9055,{s_:e,streamId:i,o_:o.getLastErrorCode(),__:o.getLastError()})}}finally{A(zi,"RPC '".concat(e,"' ").concat(i," completed."))}}));const l=JSON.stringify(r);A(zi,"RPC '".concat(e,"' ").concat(i," sending request:"),r),o.send(t,"POST",l,n,15)}))}a_(e,t,n){const r=Pi(),s=[this.Lo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=x(),a=v(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Uo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=s.join("");A(zi,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=i.createWebChannel(c,o);let d=!1,m=!1;const f=new Bi({Go:t=>{m?A(zi,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(A(zi,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),A(zi,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},zo:()=>u.close()}),y=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return y(u,h.EventType.OPEN,(()=>{m||(A(zi,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.t_())})),y(u,h.EventType.CLOSE,(()=>{m||(m=!0,A(zi,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.r_())})),y(u,h.EventType.ERROR,(t=>{m||(m=!0,S(zi,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),f.r_(new O(P.UNAVAILABLE,"The operation could not be completed")))})),y(u,h.EventType.MESSAGE,(t=>{var n;if(!m){const s=t.data[0];I(!!s,16349);const i=s,a=(null==i?void 0:i.error)||(null===(n=i[0])||void 0===n?void 0:n.error);if(a){A(zi,"RPC '".concat(e,"' stream ").concat(r," received error:"),a);const t=a.status;let n=function(e){const t=Lr[e];if(void 0!==t)return Ur(t)}(t),s=a.message;void 0===n&&(n=P.INTERNAL,s="Unknown error status: "+t+" with message "+a.message),m=!0,f.r_(new O(n,s)),u.close()}else A(zi,"RPC '".concat(e,"' stream ").concat(r," received:"),s),f.i_(s)}})),y(a,g.STAT_EVENT,(t=>{t.stat===p.PROXY?A(zi,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===p.NOPROXY&&A(zi,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((()=>{f.n_()}),0),f}}function qi(){return"undefined"!=typeof document?document:null}function Vi(e){return new as(e,!0)}class Hi{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.bi=e,this.timerId=t,this.u_=n,this.c_=r,this.l_=s,this.h_=0,this.P_=null,this.T_=Date.now(),this.reset()}reset(){this.h_=0}I_(){this.h_=this.l_}E_(e){this.cancel();const t=Math.floor(this.h_+this.d_()),n=Math.max(0,Date.now()-this.T_),r=Math.max(0,t-n);r>0&&A("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.h_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.P_=this.bi.enqueueAfterDelay(this.timerId,r,(()=>(this.T_=Date.now(),e()))),this.h_*=this.c_,this.h_<this.u_&&(this.h_=this.u_),this.h_>this.l_&&(this.h_=this.l_)}A_(){null!==this.P_&&(this.P_.skipDelay(),this.P_=null)}cancel(){null!==this.P_&&(this.P_.cancel(),this.P_=null)}d_(){return(Math.random()-.5)*this.h_}}const Wi="PersistentStream";class Gi{constructor(e,t,n,r,s,i,a,o){this.bi=e,this.R_=n,this.V_=r,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.m_=0,this.f_=null,this.g_=null,this.stream=null,this.p_=0,this.y_=new Hi(e,t)}w_(){return 1===this.state||5===this.state||this.b_()}b_(){return 2===this.state||3===this.state}start(){this.p_=0,4!==this.state?this.auth():this.S_()}async stop(){this.w_()&&await this.close(0)}D_(){this.state=0,this.y_.reset()}v_(){this.b_()&&null===this.f_&&(this.f_=this.bi.enqueueAfterDelay(this.R_,6e4,(()=>this.C_())))}F_(e){this.M_(),this.stream.send(e)}async C_(){if(this.b_())return this.close(0)}M_(){this.f_&&(this.f_.cancel(),this.f_=null)}x_(){this.g_&&(this.g_.cancel(),this.g_=null)}async close(e,t){this.M_(),this.x_(),this.y_.cancel(),this.m_++,4!==e?this.y_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(k(t.toString()),k("Using maximum backoff delay to prevent overloading the backend."),this.y_.I_()):t&&t.code===P.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.O_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zo(t)}O_(){}auth(){this.state=1;const e=this.N_(this.m_),t=this.m_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.m_===t&&this.B_(n,r)}),(t=>{e((()=>{const e=new O(P.UNKNOWN,"Fetching auth token failed: "+t.message);return this.L_(e)}))}))}B_(e,t){const n=this.N_(this.m_);this.stream=this.k_(e,t),this.stream.jo((()=>{n((()=>this.listener.jo()))})),this.stream.Jo((()=>{n((()=>(this.state=2,this.g_=this.bi.enqueueAfterDelay(this.V_,1e4,(()=>(this.b_()&&(this.state=3),Promise.resolve()))),this.listener.Jo())))})),this.stream.Zo((e=>{n((()=>this.L_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.p_?this.q_(e):this.onNext(e)))}))}S_(){this.state=5,this.y_.E_((async()=>{this.state=0,this.start()}))}L_(e){return A(Wi,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}N_(e){return t=>{this.bi.enqueueAndForget((()=>this.m_===e?t():(A(Wi,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ki extends Gi{constructor(e,t,n,r,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}k_(e,t){return this.connection.a_("Listen",e,t)}q_(e){return this.onNext(e)}onNext(e){this.y_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:_(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(I(void 0===t||"string"==typeof t,58123),ut.fromBase64String(t||"")):(I(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),ut.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?P.UNKNOWN:Ur(e.code);return new O(t,e.message||"")}(a);n=new $r(r,s,i,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=gs(e,r.document.name),i=ds(r.document.updateTime),a=r.document.createTime?ds(r.document.createTime):re.min(),o=new Qt({mapValue:{fields:r.document.fields}}),l=Jt.newFoundDocument(s,i,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Jr(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=gs(e,r.document),i=r.readTime?ds(r.readTime):re.min(),a=Jt.newNoDocument(s,i),o=r.removedTargetIds||[];n=new Jr([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=gs(e,r.document),i=r.removedTargetIds||[];n=new Jr([],i,s,null)}else{if(!("filter"in t))return _(11601,{Vt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,i=new Mr(r,s),a=e.targetId;n=new Xr(a,i)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return re.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?re.min():t.readTime?ds(t.readTime):re.min()}(e);return this.listener.Q_(t,n)}U_(e){const t={};t.database=ys(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=jn(r)?{documents:Ns(e,r)}:{query:js(e,r).gt},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=cs(e,t.resumeToken);const r=os(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(re.min())>0){n.readTime=ls(e,t.snapshotVersion.toTimestamp());const r=os(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.F_(t)}K_(e){const t={};t.database=ys(this.serializer),t.removeTarget=e,this.F_(t)}}class Qi extends Gi{constructor(e,t,n,r,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}get W_(){return this.p_>0}start(){this.lastStreamToken=void 0,super.start()}O_(){this.W_&&this.G_([])}k_(e,t){return this.connection.a_("Write",e,t)}q_(e){return I(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,I(!e.writeResults||0===e.writeResults.length,55816),this.listener.z_()}onNext(e){I(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.y_.reset();const t=function(e,t){return e&&e.length>0?(I(void 0!==t,14353),e.map((e=>function(e,t){let n=e.updateTime?ds(e.updateTime):ds(t);return n.isEqual(re.min())&&(n=ds(t)),new xr(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=ds(e.commitTime);return this.listener.j_(n,t)}H_(){const e={};e.database=ys(this.serializer),this.F_(e)}G_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Ds(this.serializer,e)))};this.F_(t)}}class Yi{}class Ji extends Yi{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.J_=!1}Y_(){if(this.J_)throw new O(P.FAILED_PRECONDITION,"The client has already been terminated.")}Qo(e,t,n,r){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[i,a]=s;return this.connection.Qo(e,ms(t,n),r,i,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new O(P.UNKNOWN,e.toString())}))}Wo(e,t,n,r,s){return this.Y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[a,o]=i;return this.connection.Wo(e,ms(t,n),r,a,o,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new O(P.UNKNOWN,e.toString())}))}terminate(){this.J_=!0,this.connection.terminate()}}class Xi{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Z_=0,this.X_=null,this.ea=!0}ta(){0===this.Z_&&(this.na("Unknown"),this.X_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.X_=null,this.ra("Backend didn't respond within 10 seconds."),this.na("Offline"),Promise.resolve()))))}ia(e){"Online"===this.state?this.na("Unknown"):(this.Z_++,this.Z_>=1&&(this.sa(),this.ra("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.na("Offline")))}set(e){this.sa(),this.Z_=0,"Online"===e&&(this.ea=!1),this.na(e)}na(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ra(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.ea?(k(t),this.ea=!1):A("OnlineStateTracker",t)}sa(){null!==this.X_&&(this.X_.cancel(),this.X_=null)}}const $i="RemoteStore";class Zi{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.oa=[],this._a=new Map,this.aa=new Set,this.ua=[],this.ca=s,this.ca.vo((e=>{n.enqueueAndForget((async()=>{la(this)&&(A($i,"Restarting streams for network reachability change."),await async function(e){const t=R(e);t.aa.add(4),await ta(t),t.la.set("Unknown"),t.aa.delete(4),await ea(t)}(this))}))})),this.la=new Xi(n,r)}}async function ea(e){if(la(e))for(const t of e.ua)await t(!0)}async function ta(e){for(const t of e.ua)await t(!1)}function na(e,t){const n=R(e);n._a.has(t.targetId)||(n._a.set(t.targetId,t),oa(n)?aa(n):Aa(n).b_()&&sa(n,t))}function ra(e,t){const n=R(e),r=Aa(n);n._a.delete(t),r.b_()&&ia(n,t),0===n._a.size&&(r.b_()?r.v_():la(n)&&n.la.set("Unknown"))}function sa(e,t){if(e.ha.Ke(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(re.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Aa(e).U_(t)}function ia(e,t){e.ha.Ke(t),Aa(e).K_(t)}function aa(e){e.ha=new es({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Rt:t=>e._a.get(t)||null,Pt:()=>e.datastore.serializer.databaseId}),Aa(e).start(),e.la.ta()}function oa(e){return la(e)&&!Aa(e).w_()&&e._a.size>0}function la(e){return 0===R(e).aa.size}function ca(e){e.ha=void 0}async function ua(e){e.la.set("Online")}async function da(e){e._a.forEach(((t,n)=>{sa(e,t)}))}async function ha(e,t){ca(e),oa(e)?(e.la.ia(t),aa(e)):e.la.set("Unknown")}async function ma(e,t,n){if(e.la.set("Online"),t instanceof $r&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e._a.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e._a.delete(r),e.ha.removeTarget(r))}(e,t)}catch(n){A($i,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await fa(e,n)}else if(t instanceof Jr?e.ha.Xe(t):t instanceof Xr?e.ha.ot(t):e.ha.nt(t),!n.isEqual(re.min()))try{const t=await Di(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.ha.It(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e._a.get(r);s&&e._a.set(r,s.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e._a.get(t);if(!r)return;e._a.set(t,r.withResumeToken(ut.EMPTY_BYTE_STRING,r.snapshotVersion)),ia(e,t);const s=new Ps(r.target,t,n,r.sequenceNumber);sa(e,s)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){A($i,"Failed to raise snapshot:",t),await fa(e,t)}}async function fa(e,t,n){if(!we(t))throw t;e.aa.add(1),await ta(e),e.la.set("Offline"),n||(n=()=>Di(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{A($i,"Retrying IndexedDB access"),await n(),e.aa.delete(1),await ea(e)}))}function pa(e,t){return t().catch((n=>fa(e,n,t)))}async function ga(e){const t=R(e),n=ka(t);let r=t.oa.length>0?t.oa[t.oa.length-1].batchId:Ne;for(;va(t);)try{const e=await ji(t.localStore,r);if(null===e){0===t.oa.length&&n.v_();break}r=e.batchId,xa(t,e)}catch(e){await fa(t,e)}ya(t)&&ba(t)}function va(e){return la(e)&&e.oa.length<10}function xa(e,t){e.oa.push(t);const n=ka(e);n.b_()&&n.W_&&n.G_(t.mutations)}function ya(e){return la(e)&&!ka(e).w_()&&e.oa.length>0}function ba(e){ka(e).start()}async function wa(e){ka(e).H_()}async function Da(e){const t=ka(e);for(const n of e.oa)t.G_(n.mutations)}async function Na(e,t,n){const r=e.oa.shift(),s=Pr.from(r,t,n);await pa(e,(()=>e.remoteSyncer.applySuccessfulWrite(s))),await ga(e)}async function ja(e,t){t&&ka(e).W_&&await async function(e,t){if(function(e){return zr(e)&&e!==P.ABORTED}(t.code)){const n=e.oa.shift();ka(e).D_(),await pa(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ga(e)}}(e,t),ya(e)&&ba(e)}async function Ca(e,t){const n=R(e);n.asyncQueue.verifyOperationInProgress(),A($i,"RemoteStore received new credentials");const r=la(n);n.aa.add(3),await ta(n),r&&n.la.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.aa.delete(3),await ea(n)}async function Ea(e,t){const n=R(e);t?(n.aa.delete(2),await ea(n)):t||(n.aa.add(2),await ta(n),n.la.set("Unknown"))}function Aa(e){return e.Pa||(e.Pa=function(e,t,n){const r=R(e);return r.Y_(),new Ki(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{jo:ua.bind(null,e),Jo:da.bind(null,e),Zo:ha.bind(null,e),Q_:ma.bind(null,e)}),e.ua.push((async t=>{t?(e.Pa.D_(),oa(e)?aa(e):e.la.set("Unknown")):(await e.Pa.stop(),ca(e))}))),e.Pa}function ka(e){return e.Ta||(e.Ta=function(e,t,n){const r=R(e);return r.Y_(),new Qi(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{jo:()=>Promise.resolve(),Jo:wa.bind(null,e),Zo:ja.bind(null,e),z_:Da.bind(null,e),j_:Na.bind(null,e)}),e.ua.push((async t=>{t?(e.Ta.D_(),await ga(e)):(await e.Ta.stop(),e.oa.length>0&&(A($i,"Stopping write stream with ".concat(e.oa.length," pending writes")),e.oa=[]))}))),e.Ta}class Sa{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new M,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,a=new Sa(e,t,i,r,s);return a.start(n),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new O(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Fa(e,t){if(k("AsyncQueue","".concat(t,": ").concat(e)),we(e))return new O(P.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class _a{static emptySet(e){return new _a(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ce.comparator(t.key,n.key):(e,t)=>ce.comparator(e.key,t.key),this.keyedMap=Gn(),this.sortedSet=new rt(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof _a))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new _a;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ta{constructor(){this.Ia=new rt(ce.comparator)}track(e){const t=e.doc.key,n=this.Ia.get(t);n?0!==e.type&&3===n.type?this.Ia=this.Ia.insert(t,e):3===e.type&&1!==n.type?this.Ia=this.Ia.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Ia=this.Ia.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Ia=this.Ia.remove(t):1===e.type&&2===n.type?this.Ia=this.Ia.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Ia=this.Ia.insert(t,{type:2,doc:e.doc}):_(63341,{Vt:e,Ea:n}):this.Ia=this.Ia.insert(t,e)}da(){const e=[];return this.Ia.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Ia{constructor(e,t,n,r,s,i,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,s){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new Ia(e,t,_a.emptySet(t),i,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Ra{constructor(){this.Aa=void 0,this.Ra=[]}Va(){return this.Ra.some((e=>e.ma()))}}class Pa{constructor(){this.queries=Oa(),this.onlineState="Unknown",this.fa=new Set}terminate(){!function(e,t){const n=R(e),r=n.queries;n.queries=Oa(),r.forEach(((e,n)=>{for(const r of n.Ra)r.onError(t)}))}(this,new O(P.ABORTED,"Firestore shutting down"))}}function Oa(){return new qn((e=>On(e)),Pn)}async function Ma(e,t){const n=R(e);let r=3;const s=t.query;let i=n.queries.get(s);i?!i.Va()&&t.ma()&&(r=2):(i=new Ra,r=t.ma()?0:1);try{switch(r){case 0:i.Aa=await n.onListen(s,!0);break;case 1:i.Aa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(e){const n=Fa(e,"Initialization of query '".concat(Mn(t.query),"' failed"));return void t.onError(n)}n.queries.set(s,i),i.Ra.push(t),t.ga(n.onlineState),i.Aa&&t.pa(i.Aa)&&Ua(n)}async function La(e,t){const n=R(e),r=t.query;let s=3;const i=n.queries.get(r);if(i){const e=i.Ra.indexOf(t);e>=0&&(i.Ra.splice(e,1),0===i.Ra.length?s=t.ma()?0:1:!i.Va()&&t.ma()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Ba(e,t){const n=R(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.Ra)e.pa(s)&&(r=!0);t.Aa=s}}r&&Ua(n)}function za(e,t,n){const r=R(e),s=r.queries.get(t);if(s)for(const i of s.Ra)i.onError(n);r.queries.delete(t)}function Ua(e){e.fa.forEach((e=>{e.next()}))}var qa,Va;(Va=qa||(qa={})).ya="default",Va.Cache="cache";class Ha{constructor(e,t,n){this.query=e,this.wa=t,this.ba=!1,this.Sa=null,this.onlineState="Unknown",this.options=n||{}}pa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Ia(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ba?this.Da(e)&&(this.wa.next(e),t=!0):this.va(e,this.onlineState)&&(this.Ca(e),t=!0),this.Sa=e,t}onError(e){this.wa.error(e)}ga(e){this.onlineState=e;let t=!1;return this.Sa&&!this.ba&&this.va(this.Sa,e)&&(this.Ca(this.Sa),t=!0),t}va(e,t){if(!e.fromCache)return!0;if(!this.ma())return!0;const n="Offline"!==t;return(!this.options.Fa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Da(e){if(e.docChanges.length>0)return!0;const t=this.Sa&&this.Sa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Ca(e){e=Ia.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ba=!0,this.wa.next(e)}ma(){return this.options.source!==qa.Cache}}class Wa{constructor(e){this.key=e}}class Ga{constructor(e){this.key=e}}class Ka{constructor(e,t){this.query=e,this.qa=t,this.Qa=null,this.hasCachedResults=!1,this.current=!1,this.$a=Zn(),this.mutatedKeys=Zn(),this.Ua=zn(e),this.Ka=new _a(this.Ua)}get Wa(){return this.qa}Ga(e,t){const n=t?t.za:new Ta,r=t?t.Ka:this.Ka;let s=t?t.mutatedKeys:this.mutatedKeys,i=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=Ln(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let m=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),m=!0):this.ja(c,u)||(n.track({type:2,doc:u}),m=!0,(o&&this.Ua(u,o)>0||l&&this.Ua(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),m=!0):c&&!u&&(n.track({type:1,doc:c}),m=!0,(o||l)&&(a=!0)),m&&(u?(i=i.add(u),s=h?s.add(e):s.delete(e)):(i=i.delete(e),s=s.delete(e)))})),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{Ka:i,za:n,ys:a,mutatedKeys:s}}ja(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.Ka;this.Ka=e.Ka,this.mutatedKeys=e.mutatedKeys;const i=e.za.da();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _(20277,{Vt:e})}};return n(e)-n(t)}(e.type,t.type)||this.Ua(e.doc,t.doc))),this.Ha(n),r=null!=r&&r;const a=t&&!r?this.Ja():[],o=0===this.$a.size&&this.current&&!r?1:0,l=o!==this.Qa;return this.Qa=o,0!==i.length||l?{snapshot:new Ia(this.query,e.Ka,s,i,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ya:a}:{Ya:a}}ga(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ka:this.Ka,za:new Ta,mutatedKeys:this.mutatedKeys,ys:!1},!1)):{Ya:[]}}Za(e){return!this.qa.has(e)&&!!this.Ka.has(e)&&!this.Ka.get(e).hasLocalMutations}Ha(e){e&&(e.addedDocuments.forEach((e=>this.qa=this.qa.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.qa=this.qa.delete(e))),this.current=e.current)}Ja(){if(!this.current)return[];const e=this.$a;this.$a=Zn(),this.Ka.forEach((e=>{this.Za(e.key)&&(this.$a=this.$a.add(e.key))}));const t=[];return e.forEach((e=>{this.$a.has(e)||t.push(new Ga(e))})),this.$a.forEach((n=>{e.has(n)||t.push(new Wa(n))})),t}Xa(e){this.qa=e.Ns,this.$a=Zn();const t=this.Ga(e.documents);return this.applyChanges(t,!0)}eu(){return Ia.fromInitialDocuments(this.query,this.Ka,this.mutatedKeys,0===this.Qa,this.hasCachedResults)}}const Qa="SyncEngine";class Ya{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Ja{constructor(e){this.key=e,this.tu=!1}}class Xa{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.nu={},this.ru=new qn((e=>On(e)),Pn),this.iu=new Map,this.su=new Set,this.ou=new rt(ce.comparator),this._u=new Map,this.au=new si,this.uu={},this.cu=new Map,this.lu=Hs.ir(),this.onlineState="Unknown",this.hu=void 0}get isPrimaryClient(){return!0===this.hu}}async function $a(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=bo(e);let s;const i=r.ru.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.eu()):s=await eo(r,t,n,!0),s}async function Za(e,t){const n=bo(e);await eo(n,t,!0,!1)}async function eo(e,t,n,r){const s=await Ci(e.localStore,_n(t)),i=s.targetId,a=e.sharedClientState.addLocalQueryTarget(i,n);let o;return r&&(o=await to(e,t,i,"current"===a,s.resumeToken)),e.isPrimaryClient&&n&&na(e.remoteStore,s),o}async function to(e,t,n,r,s){e.Pu=(t,n,r)=>async function(e,t,n,r){let s=t.view.Ga(n);s.ys&&(s=await Ai(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.Ga(n,s)})));const i=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(s,e.isPrimaryClient,i,a);return fo(e,t.targetId,o.Ya),o.snapshot}(e,t,n,r);const i=await Ai(e.localStore,t,!0),a=new Ka(t,i.Ns),o=a.Ga(i.documents),l=Yr.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),c=a.applyChanges(o,e.isPrimaryClient,l);fo(e,n,c.Ya);const u=new Ya(t,n,a);return e.ru.set(t,u),e.iu.has(n)?e.iu.get(n).push(t):e.iu.set(n,[t]),c.snapshot}async function no(e,t,n){const r=R(e),s=r.ru.get(t),i=r.iu.get(s.targetId);if(i.length>1)return r.iu.set(s.targetId,i.filter((e=>!Pn(e,t)))),void r.ru.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Ei(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),n&&ra(r.remoteStore,s.targetId),ho(r,s.targetId)})).catch(xe)):(ho(r,s.targetId),await Ei(r.localStore,s.targetId,!0))}async function ro(e,t){const n=R(e),r=n.ru.get(t),s=n.iu.get(r.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ra(n.remoteStore,r.targetId))}async function so(e,t){const n=R(e);try{const e=await function(e,t){const n=R(e),r=t.snapshotVersion;let s=n.Ss;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const i=n.Cs.newChangeBuffer({trackRemovals:!0});s=n.Ss;const a=[];t.targetChanges.forEach(((i,o)=>{const l=s.get(o);if(!l)return;a.push(n.ai.removeMatchingKeys(e,i.removedDocuments,o).next((()=>n.ai.addMatchingKeys(e,i.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(ut.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),s=s.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=xi||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,i)&&a.push(n.ai.updateTargetData(e,c))}));let o=Hn(),l=Zn();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),a.push(Ni(e,i,t.documentUpdates).next((e=>{o=e.xs,l=e.Os}))),!r.isEqual(re.min())){const t=n.ai.getLastRemoteSnapshotVersion(e).next((t=>n.ai.setTargetsMetadata(e,e.currentSequenceNumber,r)));a.push(t)}return ye.waitFor(a).next((()=>i.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.Ss=s,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n._u.get(t);r&&(I(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.tu=!0:e.modifiedDocuments.size>0?I(r.tu,14607):e.removedDocuments.size>0&&(I(r.tu,42227),r.tu=!1))})),await vo(n,e,t)}catch(e){await xe(e)}}function io(e,t,n){const r=R(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ru.forEach(((n,r)=>{const s=r.view.ga(t);s.snapshot&&e.push(s.snapshot)})),function(e,t){const n=R(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const s of n.Ra)s.ga(t)&&(r=!0)})),r&&Ua(n)}(r.eventManager,t),e.length&&r.nu.Q_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function ao(e,t,n){const r=R(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r._u.get(t),i=s&&s.key;if(i){let e=new rt(ce.comparator);e=e.insert(i,Jt.newNoDocument(i,re.min()));const n=Zn().add(i),s=new Qr(re.min(),new Map,new rt(Y),e,n);await so(r,s),r.ou=r.ou.remove(i),r._u.delete(t),go(r)}else await Ei(r.localStore,t,!1).then((()=>ho(r,t,n))).catch(xe)}async function oo(e,t){const n=R(e),r=t.batch.batchId;try{const e=await function(e,t){const n=R(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),s=n.Cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,i=s.keys();let a=ye.resolve();return i.forEach((e=>{a=a.next((()=>r.getEntry(t,e))).next((t=>{const i=n.docVersions.get(e);I(null!==i,48541),t.version.compareTo(i)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),a.next((()=>e.mutationQueue.removeMutationBatch(t,s)))}(n,e,t,s).next((()=>s.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Zn();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);uo(n,r,null),co(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await vo(n,e)}catch(e){await xe(e)}}async function lo(e,t,n){const r=R(e);try{const e=await function(e,t){const n=R(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(I(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);uo(r,t,n),co(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await vo(r,e)}catch(n){await xe(n)}}function co(e,t){(e.cu.get(t)||[]).forEach((e=>{e.resolve()})),e.cu.delete(t)}function uo(e,t,n){const r=R(e);let s=r.uu[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.uu[r.currentUser.toKey()]=s}}function ho(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.iu.get(t))e.ru.delete(r),n&&e.nu.Tu(r,n);e.iu.delete(t),e.isPrimaryClient&&e.au.Ur(t).forEach((t=>{e.au.containsKey(t)||mo(e,t)}))}function mo(e,t){e.su.delete(t.path.canonicalString());const n=e.ou.get(t);null!==n&&(ra(e.remoteStore,n),e.ou=e.ou.remove(t),e._u.delete(n),go(e))}function fo(e,t,n){for(const r of n)r instanceof Wa?(e.au.addReference(r.key,t),po(e,r)):r instanceof Ga?(A(Qa,"Document no longer in limbo: "+r.key),e.au.removeReference(r.key,t),e.au.containsKey(r.key)||mo(e,r.key)):_(19791,{Iu:r})}function po(e,t){const n=t.key,r=n.path.canonicalString();e.ou.get(n)||e.su.has(r)||(A(Qa,"New document in limbo: "+n),e.su.add(r),go(e))}function go(e){for(;e.su.size>0&&e.ou.size<e.maxConcurrentLimboResolutions;){const t=e.su.values().next().value;e.su.delete(t);const n=new ce(ae.fromString(t)),r=e.lu.next();e._u.set(r,new Ja(n)),e.ou=e.ou.insert(n,r),na(e.remoteStore,new Ps(_n(An(n.path)),r,"TargetPurposeLimboResolution",De.le))}}async function vo(e,t,n){const r=R(e),s=[],i=[],a=[];r.ru.isEmpty()||(r.ru.forEach(((e,o)=>{a.push(r.Pu(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const s=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,s?"current":"not-current")}if(e){s.push(e);const t=fi.Ps(o.targetId,e);i.push(t)}})))})),await Promise.all(a),r.nu.Q_(s),await async function(e,t){const n=R(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>ye.forEach(t,(t=>ye.forEach(t.ls,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>ye.forEach(t.hs,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!we(e))throw e;A(vi,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ss.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.Ss=n.Ss.insert(e,s)}}}(r.localStore,i))}async function xo(e,t){const n=R(e);if(!n.currentUser.isEqual(t)){A(Qa,"User change. New user:",t.toKey());const e=await wi(n.localStore,t);n.currentUser=t,function(e,t){e.cu.forEach((e=>{e.forEach((e=>{e.reject(new O(P.CANCELLED,t))}))})),e.cu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await vo(n,e.Ms)}}function yo(e,t){const n=R(e),r=n._u.get(t);if(r&&r.tu)return Zn().add(r.key);{let e=Zn();const r=n.iu.get(t);if(!r)return e;for(const t of r){const r=n.ru.get(t);e=e.unionWith(r.view.Wa)}return e}}function bo(e){const t=R(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=so.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=yo.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=ao.bind(null,t),t.nu.Q_=Ba.bind(null,t.eventManager),t.nu.Tu=za.bind(null,t.eventManager),t}function wo(e){const t=R(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=oo.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=lo.bind(null,t),t}class Do{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vi(e.databaseInfo.databaseId),this.sharedClientState=this.Au(e),this.persistence=this.Ru(e),await this.persistence.start(),this.localStore=this.Vu(e),this.gcScheduler=this.mu(e,this.localStore),this.indexBackfillerScheduler=this.fu(e,this.localStore)}mu(e,t){return null}fu(e,t){return null}Vu(e){return bi(this.persistence,new gi,e.initialUser,this.serializer)}Ru(e){return new ui(hi.Ei,this.serializer)}Au(e){return new Fi}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Do.provider={build:()=>new Do};class No extends Do{constructor(e){super(),this.cacheSizeBytes=e}mu(e,t){I(this.persistence.referenceDelegate instanceof mi,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Ys(n,e.asyncQueue,t)}Ru(e){const t=void 0!==this.cacheSizeBytes?Vs.withCacheSize(this.cacheSizeBytes):Vs.DEFAULT;return new ui((e=>mi.Ei(e,t)),this.serializer)}}class jo{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>io(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=xo.bind(null,this.syncEngine),await Ea(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Pa}createDatastore(e){const t=Vi(e.databaseInfo.databaseId),n=function(e){return new Ui(e)}(e.databaseInfo);return function(e,t,n,r){return new Ji(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,s){return new Zi(e,t,n,r,s)}(this.localStore,this.datastore,e.asyncQueue,(e=>io(this.syncEngine,e,0)),Ii.C()?new Ii:new _i)}createSyncEngine(e,t){return function(e,t,n,r,s,i,a){const o=new Xa(e,t,n,r,s,i);return a&&(o.hu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=R(e);A($i,"RemoteStore shutting down."),t.aa.add(5),await ta(t),t.ca.shutdown(),t.la.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}jo.provider={build:()=>new jo};class Co{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.pu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.pu(this.observer.error,e):k("Uncaught Error in snapshot listener:",e.toString()))}yu(){this.muted=!0}pu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Eo="FirestoreClient";class Ao{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=N.UNAUTHENTICATED,this.clientId=Q.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async e=>{A(Eo,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(A(Eo,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new M;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Fa(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function ko(e,t){e.asyncQueue.verifyOperationInProgress(),A(Eo,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await wi(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function So(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Fo(e);A(Eo,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Ca(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Ca(t.remoteStore,n))),e._onlineComponents=t}async function Fo(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){A(Eo,"Using user provided OfflineComponentProvider");try{await ko(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===P.FAILED_PRECONDITION||e.code===P.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;S("Error using user provided cache. Falling back to memory cache: "+n),await ko(e,new Do)}}else A(Eo,"Using default OfflineComponentProvider"),await ko(e,new No(void 0));return e._offlineComponents}async function _o(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(A(Eo,"Using user provided OnlineComponentProvider"),await So(e,e._uninitializedComponentsProvider._online)):(A(Eo,"Using default OnlineComponentProvider"),await So(e,new jo))),e._onlineComponents}function To(e){return _o(e).then((e=>e.syncEngine))}async function Io(e){const t=await _o(e),n=t.eventManager;return n.onListen=$a.bind(null,t.syncEngine),n.onUnlisten=no.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Za.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=ro.bind(null,t.syncEngine),n}function Ro(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new M;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,s){const i=new Co({next:o=>{i.yu(),t.enqueueAndForget((()=>La(e,a)));const l=o.docs.has(n);!l&&o.fromCache?s.reject(new O(P.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?s.reject(new O(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(o)},error:e=>s.reject(e)}),a=new Ha(An(n.path),i,{includeMetadataChanges:!0,Fa:!0});return Ma(e,a)}(await Io(e),e.asyncQueue,t,n,r))),r.promise}function Po(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new M;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,s){const i=new Co({next:n=>{i.yu(),t.enqueueAndForget((()=>La(e,a))),n.fromCache&&"server"===r.source?s.reject(new O(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),a=new Ha(n,i,{includeMetadataChanges:!0,Fa:!0});return Ma(e,a)}(await Io(e),e.asyncQueue,t,n,r))),r.promise}function Oo(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Mo=new Map;function Lo(e,t,n){if(!n)throw new O(P.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Bo(e){if(!ce.isDocumentKey(e))throw new O(P.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function zo(e){if(ce.isDocumentKey(e))throw new O(P.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Uo(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":_(12329,{type:typeof e})}function qo(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new O(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Uo(e);throw new O(P.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Vo(e,t){if(t<=0)throw new O(P.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}const Ho="firestore.googleapis.com",Wo=!0;class Go{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new O(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ho,this.ssl=Wo}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Wo;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=qs;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Gs)throw new O(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new O(P.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Oo(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new O(P.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new O(P.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new O(P.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ko{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Go({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new O(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new O(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Go(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new B;switch(e.type){case"firstParty":return new V(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new O(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,(0,l.P1)("Firestore",this._settings.isUsingEmulator),this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Mo.get(e);t&&(A("ComponentProvider","Removing Datastore"),Mo.delete(e),t.terminate())}(this),Promise.resolve()}}class Qo{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Qo(this.firestore,e,this._query)}}class Yo{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Jo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yo(this.firestore,e,this._key)}}class Jo extends Qo{constructor(e,t,n){super(e,t,An(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yo(this.firestore,null,new ce(e))}withConverter(e){return new Jo(this.firestore,e,this._path)}}function Xo(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=(0,l.Ku)(e),Lo("collection","path",t),e instanceof Ko){const n=ae.fromString(t,...r);return zo(n),new Jo(e,null,n)}{if(!(e instanceof Yo||e instanceof Jo))throw new O(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ae.fromString(t,...r));return zo(n),new Jo(e.firestore,null,n)}}function $o(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];if(e=(0,l.Ku)(e),1===arguments.length&&(t=Q.newId()),Lo("doc","path",t),e instanceof Ko){const n=ae.fromString(t,...r);return Bo(n),new Yo(e,null,new ce(n))}{if(!(e instanceof Yo||e instanceof Jo))throw new O(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ae.fromString(t,...r));return Bo(n),new Yo(e.firestore,e instanceof Jo?e.converter:null,new ce(n))}}const Zo="AsyncQueue";class el{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Qu=[],this.$u=!1,this.Uu=[],this.Ku=null,this.Wu=!1,this.Gu=!1,this.zu=[],this.y_=new Hi(this,"async_queue_retry"),this.ju=()=>{const e=qi();e&&A(Zo,"Visibility state changed to "+e.visibilityState),this.y_.A_()},this.Hu=e;const t=qi();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ju)}get isShuttingDown(){return this.$u}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ju(),this.Yu(e)}enterRestrictedMode(e){if(!this.$u){this.$u=!0,this.Gu=e||!1;const t=qi();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ju)}}enqueue(e){if(this.Ju(),this.$u)return new Promise((()=>{}));const t=new M;return this.Yu((()=>this.$u&&this.Gu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Qu.push(e),this.Zu())))}async Zu(){if(0!==this.Qu.length){try{await this.Qu[0](),this.Qu.shift(),this.y_.reset()}catch(e){if(!we(e))throw e;A(Zo,"Operation failed with retryable error: "+e)}this.Qu.length>0&&this.y_.E_((()=>this.Zu()))}}Yu(e){const t=this.Hu.then((()=>(this.Wu=!0,e().catch((e=>{throw this.Ku=e,this.Wu=!1,k("INTERNAL UNHANDLED ERROR: ",tl(e)),e})).then((e=>(this.Wu=!1,e))))));return this.Hu=t,t}enqueueAfterDelay(e,t,n){this.Ju(),this.zu.indexOf(e)>-1&&(t=0);const r=Sa.createAndSchedule(this,e,t,n,(e=>this.Xu(e)));return this.Uu.push(r),r}Ju(){this.Ku&&_(47125,{ec:tl(this.Ku)})}verifyOperationInProgress(){}async tc(){let e;do{e=this.Hu,await e}while(e!==this.Hu)}nc(e){for(const t of this.Uu)if(t.timerId===e)return!0;return!1}rc(e){return this.tc().then((()=>{this.Uu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Uu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.tc()}))}sc(e){this.zu.push(e)}Xu(e){const t=this.Uu.indexOf(e);this.Uu.splice(t,1)}}function tl(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function nl(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class rl extends Ko{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new el,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new el(e),this._firestoreClient=void 0,await e}}}function sl(e,t){const n="object"==typeof e?e:(0,i.Sx)(),r="string"==typeof e?e:t||Nt,s=(0,i.j6)(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const e=(0,l.yU)("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var s;e=qo(e,Ko);const i=(0,l.zJ)(t),a=e._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:e._getEmulatorOptions()}),c="".concat(t,":").concat(n);a.host!==Ho&&a.host!==c&&S("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},a),{host:c,ssl:i,emulatorOptions:r});if(!(0,l.bD)(u,o)&&(e._setSettings(u),i&&((0,l.gE)("https://".concat(c)),(0,l.P1)("Firestore",!0)),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=N.MOCK_USER;else{t=(0,l.Fy)(r.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new O(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new N(i)}e._authCredentials=new z(new L(t,n))}}(s,...e)}return s}function il(e){if(e._terminated)throw new O(P.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||al(e),e._firestoreClient}function al(e){var t,n,r;const s=e._freezeSettings(),i=function(e,t,n,r){return new Dt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Oo(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,s);e._componentsProvider||(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=s.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),e._firestoreClient=new Ao(e._authCredentials,e._appCheckCredentials,e._queue,i,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class ol{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ol(ut.fromBase64String(e))}catch(e){throw new O(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new ol(ut.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ll{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new O(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new le(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cl{constructor(e){this._methodName=e}}class ul{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new O(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new O(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}}class dl{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const hl=/^__.*__$/;class ml{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new kr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ar(e,this.data,t,this.fieldTransforms)}}class fl{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new kr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function pl(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _(40011,{oc:e})}}class gl{constructor(e,t,n,r,s,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this._c(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get oc(){return this.settings.oc}ac(e){return new gl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}uc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ac({path:n,cc:!1});return r.lc(e),r}hc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ac({path:n,cc:!1});return r._c(),r}Pc(e){return this.ac({path:void 0,cc:!0})}Tc(e){return Pl(e,this.settings.methodName,this.settings.Ic||!1,this.path,this.settings.Ec)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}_c(){if(this.path)for(let e=0;e<this.path.length;e++)this.lc(this.path.get(e))}lc(e){if(0===e.length)throw this.Tc("Document fields must not be empty");if(pl(this.oc)&&hl.test(e))throw this.Tc('Document fields cannot begin and end with "__"')}}class vl{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Vi(e)}dc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new gl({oc:e,methodName:t,Ec:n,path:le.emptyPath(),cc:!1,Ic:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function xl(e){const t=e._freezeSettings(),n=Vi(e._databaseId);return new vl(e._databaseId,!!t.ignoreUndefinedProperties,n)}function yl(e,t,n,r,s){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.dc(i.merge||i.mergeFields?2:0,t,n,s);_l("Data must be an object, but it was:",a,r);const o=Sl(r,a);let l,c;if(i.merge)l=new lt(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const s=Tl(t,r,n);if(!a.contains(s))throw new O(P.INVALID_ARGUMENT,"Field '".concat(s,"' is specified in your field mask but missing from your input data."));Ol(e,s)||e.push(s)}l=new lt(e),c=a.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=a.fieldTransforms;return new ml(new Qt(o),l,c)}class bl extends cl{_toFieldTransform(e){if(2!==e.oc)throw 1===e.oc?e.Tc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Tc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof bl}}function wl(e,t,n){return new gl({oc:3,Ec:t.settings.Ec,methodName:e._methodName,cc:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Dl extends cl{_toFieldTransform(e){return new vr(e.path,new cr)}isEqual(e){return e instanceof Dl}}class Nl extends cl{constructor(e,t){super(e),this.Ac=t}_toFieldTransform(e){const t=wl(this,e,!0),n=this.Ac.map((e=>kl(e,t))),r=new ur(n);return new vr(e.path,r)}isEqual(e){return e instanceof Nl&&(0,l.bD)(this.Ac,e.Ac)}}class jl extends cl{constructor(e,t){super(e),this.Rc=t}_toFieldTransform(e){const t=new fr(e.serializer,sr(e.serializer,this.Rc));return new vr(e.path,t)}isEqual(e){return e instanceof jl&&this.Rc===e.Rc}}function Cl(e,t,n,r){const s=e.dc(1,t,n);_l("Data must be an object, but it was:",s,r);const i=[],a=Qt.empty();tt(r,((e,r)=>{const o=Rl(t,e,n);r=(0,l.Ku)(r);const c=s.hc(o);if(r instanceof bl)i.push(o);else{const e=kl(r,c);null!=e&&(i.push(o),a.set(o,e))}}));const o=new lt(i);return new fl(a,o,s.fieldTransforms)}function El(e,t,n,r,s,i){const a=e.dc(1,t,n),o=[Tl(t,r,n)],c=[s];if(i.length%2!=0)throw new O(P.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let l=0;l<i.length;l+=2)o.push(Tl(t,i[l])),c.push(i[l+1]);const u=[],d=Qt.empty();for(let m=o.length-1;m>=0;--m)if(!Ol(u,o[m])){const e=o[m];let t=c[m];t=(0,l.Ku)(t);const n=a.hc(e);if(t instanceof bl)u.push(e);else{const r=kl(t,n);null!=r&&(u.push(e),d.set(e,r))}}const h=new lt(u);return new fl(d,h,a.fieldTransforms)}function Al(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return kl(n,e.dc(r?4:3,t))}function kl(e,t){if(Fl(e=(0,l.Ku)(e)))return _l("Unsupported field value:",t,e),Sl(e,t);if(e instanceof cl)return function(e,t){if(!pl(t.oc))throw t.Tc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Tc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.cc&&4!==t.oc)throw t.Tc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=kl(s,t.Pc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,l.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return sr(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ne.fromDate(e);return{timestampValue:ls(t.serializer,n)}}if(e instanceof ne){const n=new ne(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ls(t.serializer,n)}}if(e instanceof ul)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof ol)return{bytesValue:cs(t.serializer,e._byteString)};if(e instanceof Yo){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Tc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:hs(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof dl)return function(e,t){return{mapValue:{fields:{[Ct]:{stringValue:kt},[St]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Tc("VectorValues must only contain numeric values.");return nr(t.serializer,e)}))}}}}}}(e,t);throw t.Tc("Unsupported field value: ".concat(Uo(e)))}(e,t)}function Sl(e,t){const n={};return nt(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):tt(e,((e,r)=>{const s=kl(r,t.uc(e));null!=s&&(n[e]=s)})),{mapValue:{fields:n}}}function Fl(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ne||e instanceof ul||e instanceof ol||e instanceof Yo||e instanceof cl||e instanceof dl)}function _l(e,t,n){if(!Fl(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Uo(n);throw"an object"===r?t.Tc(e+" a custom object"):t.Tc(e+" "+r)}}function Tl(e,t,n){if((t=(0,l.Ku)(t))instanceof ll)return t._internalPath;if("string"==typeof t)return Rl(e,t);throw Pl("Field path arguments must be of type string or ",e,!1,void 0,n)}const Il=new RegExp("[~\\*/\\[\\]]");function Rl(e,t,n){if(t.search(Il)>=0)throw Pl("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new ll(...t.split("."))._internalPath}catch(r){throw Pl("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Pl(e,t,n,r,s){const i=r&&!r.isEmpty(),a=void 0!==s;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=" in field ".concat(r)),a&&(l+=" in document ".concat(s)),l+=")"),new O(P.INVALID_ARGUMENT,o+e+l)}function Ol(e,t){return e.some((e=>e.isEqual(t)))}class Ml{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Yo(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Ll(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Bl("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Ll extends Ml{data(){return super.data()}}function Bl(e,t){return"string"==typeof t?Rl(e,t):t instanceof ll?t._internalPath:t._delegate._internalPath}function zl(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new O(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ul{}class ql extends Ul{}function Vl(e,t){let n=[];for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];t instanceof Ul&&n.push(t),n=n.concat(s),function(e){const t=e.filter((e=>e instanceof Gl)).length,n=e.filter((e=>e instanceof Hl)).length;if(t>1||t>0&&n>0)throw new O(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class Hl extends ql{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Hl(e,t,n)}_apply(e){const t=this._parse(e);return nc(e._query,t),new Qo(e.firestore,e.converter,In(e._query,t))}_parse(e){const t=xl(e.firestore),n=function(e,t,n,r,s,i,a){let o;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new O(P.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(i,"' queries on documentId()."));if("in"===i||"not-in"===i){tc(a,i);const t=[];for(const n of a)t.push(ec(r,e,n));o={arrayValue:{values:t}}}else o=ec(r,e,a)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||tc(a,i),o=Al(n,t,a,"in"===i||"not-in"===i);return rn.create(s,i,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Wl(e,t,n){const r=t,s=Bl("where",e);return Hl._create(s,r,n)}class Gl extends Ul{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Gl(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:sn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const s of r)nc(n,s),n=In(n,s)}(e._query,t),new Qo(e.firestore,e.converter,In(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Kl extends ql{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Kl(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new O(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new O(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new en(t,n)}(e._query,this._field,this._direction);return new Qo(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Cn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Ql(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Bl("orderBy",e);return Kl._create(n,t)}class Yl extends ql{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Yl(e,t,n)}_apply(e){return new Qo(e.firestore,e.converter,Rn(e._query,this._limit,this._limitType))}}function Jl(e){return Vo("limit",e),Yl._create("limit",e,"F")}class Xl extends ql{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Xl(e,t,n)}_apply(e){const t=Zl(e,this.type,this._docOrFields,this._inclusive);return new Qo(e.firestore,e.converter,function(e,t){return new Cn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function $l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Xl._create("startAfter",t,!1)}function Zl(e,t,n,r){if(n[0]=(0,l.Ku)(n[0]),n[0]instanceof Ml)return function(e,t,n,r,s){if(!r)throw new O(P.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const i=[];for(const a of Fn(e))if(a.field.isKeyField())i.push(Bt(t,r.key));else{const e=r.data.field(a.field);if(yt(e))throw new O(P.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=a.field.canonicalString();throw new O(P.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}i.push(e)}return new Xt(i,s)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const s=xl(e.firestore);return function(e,t,n,r,s,i){const a=e.explicitOrderBy;if(s.length>a.length)throw new O(P.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const o=[];for(let l=0;l<s.length;l++){const i=s[l];if(a[l].field.isKeyField()){if("string"!=typeof i)throw new O(P.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof i));if(!Sn(e)&&-1!==i.indexOf("/"))throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(i,"' contains a slash."));const n=e.path.child(ae.fromString(i));if(!ce.isDocumentKey(n))throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const s=new ce(n);o.push(Bt(t,s))}else{const e=Al(n,r,i);o.push(e)}}return new Xt(o,i)}(e._query,e.firestore._databaseId,s,t,n,r)}}function ec(e,t,n){if("string"==typeof(n=(0,l.Ku)(n))){if(""===n)throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sn(t)&&-1!==n.indexOf("/"))throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(ae.fromString(n));if(!ce.isDocumentKey(r))throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Bt(e,new ce(r))}if(n instanceof Yo)return Bt(e,n._key);throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Uo(n),"."))}function tc(e,t){if(!Array.isArray(e)||0===e.length)throw new O(P.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function nc(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new O(P.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new O(P.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class rc{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Ft(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ft(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw _(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return tt(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const s=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t[St].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>mt(e.doubleValue)));return new dl(s)}convertGeoPoint(e){return new ul(mt(e.latitude),mt(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=bt(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(wt(e));default:return null}}convertTimestamp(e){const t=ht(e);return new ne(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ae.fromString(e);I(Rs(n),9688,{name:e});const r=new jt(n.get(1),n.get(3)),s=new ce(n.popFirst(5));return r.isEqual(t)||k("Document ".concat(s," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),s}}function sc(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class ic{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ac extends Ml{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new oc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Bl("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class oc extends ac{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class lc{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ic(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new oc(this._firestore,this._userDataWriter,n.key,n,new ic(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new O(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new oc(e._firestore,e._userDataWriter,n.doc.key,n.doc,new ic(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new oc(e._firestore,e._userDataWriter,t.doc.key,t.doc,new ic(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:cc(t.type),doc:r,oldIndex:s,newIndex:i}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function cc(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _(61501,{type:e})}}function uc(e){e=qo(e,Yo);const t=qo(e.firestore,rl);return Ro(il(t),e._key).then((n=>yc(t,e,n)))}class dc extends rc{constructor(e){super(),this.firestore=e}convertBytes(e){return new ol(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yo(this.firestore,null,t)}}function hc(e){e=qo(e,Qo);const t=qo(e.firestore,rl),n=il(t),r=new dc(t);return zl(e._query),Po(n,e._query).then((n=>new lc(t,r,e,n)))}function mc(e,t,n){e=qo(e,Yo);const r=qo(e.firestore,rl),s=sc(e.converter,t,n);return xc(r,[yl(xl(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,yr.none())])}function fc(e,t,n){e=qo(e,Yo);const r=qo(e.firestore,rl),s=xl(r);let i;for(var a=arguments.length,o=new Array(a>3?a-3:0),c=3;c<a;c++)o[c-3]=arguments[c];return i="string"==typeof(t=(0,l.Ku)(t))||t instanceof ll?El(s,"updateDoc",e._key,t,n,o):Cl(s,"updateDoc",e._key,t),xc(r,[i.toMutation(e._key,yr.exists(!0))])}function pc(e){return xc(qo(e.firestore,rl),[new Tr(e._key,yr.none())])}function gc(e,t){const n=qo(e.firestore,rl),r=$o(e),s=sc(e.converter,t);return xc(n,[yl(xl(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,yr.exists(!1))]).then((()=>r))}function vc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s,i,a;e=(0,l.Ku)(e);let o={includeMetadataChanges:!1,source:"default"},c=0;"object"!=typeof n[c]||nl(n[c])||(o=n[c],c++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(nl(n[c])){const e=n[c];n[c]=null===(s=e.next)||void 0===s?void 0:s.bind(e),n[c+1]=null===(i=e.error)||void 0===i?void 0:i.bind(e),n[c+2]=null===(a=e.complete)||void 0===a?void 0:a.bind(e)}let d,h,m;if(e instanceof Yo)h=qo(e.firestore,rl),m=An(e._key.path),d={next:t=>{n[c]&&n[c](yc(h,e,t))},error:n[c+1],complete:n[c+2]};else{const t=qo(e,Qo);h=qo(t.firestore,rl),m=t._query;const r=new dc(h);d={next:e=>{n[c]&&n[c](new lc(h,r,t,e))},error:n[c+1],complete:n[c+2]},zl(e._query)}return function(e,t,n,r){const s=new Co(r),i=new Ha(t,s,n);return e.asyncQueue.enqueueAndForget((async()=>Ma(await Io(e),i))),()=>{s.yu(),e.asyncQueue.enqueueAndForget((async()=>La(await Io(e),i)))}}(il(h),m,u,d)}function xc(e,t){return function(e,t){const n=new M;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=wo(e);try{const e=await function(e,t){const n=R(e),r=ne.now(),s=t.reduce(((e,t)=>e.add(t.key)),Zn());let i,a;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=Hn(),l=Zn();return n.Cs.getEntries(e,s).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((s=>{i=s;const a=[];for(const e of t){const t=Cr(e,i.get(e.key).overlayedDocument);null!=t&&a.push(new kr(e.key,t,Yt(t.value.mapValue),yr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)})).next((t=>{a=t;const r=t.applyToLocalDocumentSet(i,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:a.batchId,changes:Kn(i)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.uu[e.currentUser.toKey()];r||(r=new rt(Y)),r=r.insert(t,n),e.uu[e.currentUser.toKey()]=r}(r,e.batchId,n),await vo(r,e.changes),await ga(r.remoteStore)}catch(e){const t=Fa(e,"Failed to persist write");n.reject(t)}}(await To(e),t,n))),n.promise}(il(e),t)}function yc(e,t,n){const r=n.docs.get(t._key),s=new dc(e);return new ac(e,s,t._key,r,new ic(n.hasPendingWrites,n.fromCache),t.converter)}class bc{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=xl(e)}set(e,t,n){this._verifyNotCommitted();const r=wc(e,this._firestore),s=sc(r.converter,t,n),i=yl(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,n);return this._mutations.push(i.toMutation(r._key,yr.none())),this}update(e,t,n){this._verifyNotCommitted();const r=wc(e,this._firestore);let s;for(var i=arguments.length,a=new Array(i>3?i-3:0),o=3;o<i;o++)a[o-3]=arguments[o];return s="string"==typeof(t=(0,l.Ku)(t))||t instanceof ll?El(this._dataReader,"WriteBatch.update",r._key,t,n,a):Cl(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(s.toMutation(r._key,yr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=wc(e,this._firestore);return this._mutations=this._mutations.concat(new Tr(t._key,yr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new O(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function wc(e,t){if((e=(0,l.Ku)(e)).firestore!==t)throw new O(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function Dc(){return new bl("deleteField")}function Nc(){return new Dl("serverTimestamp")}function jc(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Nl("arrayUnion",t)}function Cc(e){return new jl("increment",e)}function Ec(e){return il(e=qo(e,rl)),new bc(e,(t=>xc(e,t)))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){j=e}(i.MF),(0,i.om)(new a.uA("firestore",((e,n)=>{let{instanceIdentifier:r,options:s}=n;const i=e.getProvider("app").getImmediate(),a=new rl(new U(e.getProvider("auth-internal")),new W(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new O(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jt(e.options.projectId,t)}(i,r),i);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a}),"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(w,D,e),(0,i.KO)(w,D,"esm2017")}()},5662:(e,t,n)=>{"use strict";n.d(t,{j2:()=>l,db:()=>c,IG:()=>u});var r=n(7150);(0,r.KO)("firebase","11.7.3","app");var s=n(6493),i=n(5472),a=n(8147);const o=(0,r.Wp)({apiKey:"AIzaSyBi6wQMNZGMUIa5JL9A8xxbR2IWjvDfo3U",authDomain:"uww-buddies.firebaseapp.com",projectId:"uww-buddies",storageBucket:"uww-buddies.firebasestorage.app",messagingSenderId:"528108258916",appId:"1:528108258916:web:9816a187fe4781b9c8c171",measurementId:"G-434G3N3WJW"}),l=(0,s.xI)(o);(0,s.oM)(l,s.F0).catch((e=>{console.error("Auth persistence error:",e)}));const c=(0,i.aU)(o),u=(0,a.c7)(o)},5865:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5179),s=n(1616),i=n(8859),a=n(3159),o=n(6825),l=n(2546),c=n(2956),u=n(1257);t.default={CODE39:r.CODE39,CODE128:s.CODE128,CODE128A:s.CODE128A,CODE128B:s.CODE128B,CODE128C:s.CODE128C,EAN13:i.EAN13,EAN8:i.EAN8,EAN5:i.EAN5,EAN2:i.EAN2,UPC:i.UPC,UPCE:i.UPCE,ITF14:a.ITF14,ITF:a.ITF,MSI:o.MSI,MSI10:o.MSI10,MSI11:o.MSI11,MSI1010:o.MSI1010,MSI1110:o.MSI1110,pharmacode:l.pharmacode,codabar:c.codabar,GenericBarcode:u.GenericBarcode}},5938:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=n(3498),i=(r=s)&&r.__esModule?r:{default:r},a=n(8997);var o=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e+=(0,a.mod10)(e),e+=(0,a.mod10)(e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(i.default);t.default=o},6190:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5301),a=(r=i)&&r.__esModule?r:{default:r},o=n(1029);var l=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.substring(1),n));return r.bytes=e.split("").map((function(e){return e.charCodeAt(0)})),r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var e=this.bytes,n=e.shift()-105,r=o.SET_BY_CODE[n];if(void 0===r)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&e.unshift(o.FNC1);var s=t.next(e,1,r);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:t.getBar(n)+s.result+t.getBar((s.checksum+n)%o.MODULO)+t.getBar(o.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var e=this.options.ean128||!1;return"string"===typeof e&&(e="true"===e.toLowerCase()),e}}],[{key:"getBar",value:function(e){return o.BARS[e]?o.BARS[e].toString():""}},{key:"correctIndex",value:function(e,t){if(t===o.SET_A){var n=e.shift();return n<32?n+64:n-32}return t===o.SET_B?e.shift()-32:10*(e.shift()-48)+e.shift()-48}},{key:"next",value:function(e,n,r){if(!e.length)return{result:"",checksum:0};var s=void 0,i=void 0;if(e[0]>=200){i=e.shift()-105;var a=o.SWAP[i];void 0!==a?s=t.next(e,n+1,a):(r!==o.SET_A&&r!==o.SET_B||i!==o.SHIFT||(e[0]=r===o.SET_A?e[0]>95?e[0]-96:e[0]:e[0]<32?e[0]+96:e[0]),s=t.next(e,n+1,r))}else i=t.correctIndex(e,r),s=t.next(e,n+1,r);var l=i*n;return{result:t.getBar(i)+s.result,checksum:l+s.checksum}}}]),t}(a.default);t.default=l},6326:(e,t,n)=>{"use strict";n.d(t,{Cl:()=>r,Tt:()=>s,fX:()=>i});var r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},r.apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n}Object.create;function i(e,t,n){if(n||2===arguments.length)for(var r,s=0,i=t.length;s<i;s++)!r&&s in t||(r||(r=Array.prototype.slice.call(t,0,s)),r[s]=t[s]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;"function"===typeof SuppressedError&&SuppressedError},6431:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MessageTypes:()=>d.l,default:()=>m});var r=n(3986),s=n(9526),i=n(7051),a=n(5662),o=n(5472),l=n(8147),c=n(9766),u=n(4733),d=n(4857);const h=50;const m=class{static async fetchOlderMessages(e,t){try{let n;n="course"===e.type?(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("courseId","==",e.courseId),(0,o._M)("type","==",e.messageType),(0,o.My)("timestamp","desc"),...t?[(0,o.HM)(t.timestamp)]:[],(0,o.AB)(25)):"trip"===e.type?(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("tripId","==",e.tripId),(0,o._M)("type","==",e.messageType),(0,o.My)("timestamp","desc"),...t?[(0,o.HM)(t.timestamp)]:[],(0,o.AB)(25)):(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("chatId","==",e.chatId),(0,o._M)("type","==",d.l.CHAT),(0,o.My)("timestamp","desc"),...t?[(0,o.HM)(t.timestamp)]:[],(0,o.AB)(25));const r=(await(0,o.GG)(n)).docs.map((e=>{var t;const n=e.data();return(0,i.A)((0,i.A)({id:e.id},n),{},{timestamp:(null===(t=n.timestamp)||void 0===t?void 0:t.toDate())||new Date})}));return{messages:r,hasMore:25===r.length}}catch(n){throw console.error("Error fetching older messages:",n),new Error("Failed to load older messages")}}static subscribeToTypingStatus(e,t){try{const n=(0,o.rJ)(a.db,"typingStatus");let r;if(e.courseId)r=(0,o.P)(n,(0,o._M)("type","==","course"),(0,o._M)("contextId","==",e.courseId),(0,o._M)("messageType","==",e.messageType),(0,o._M)("isTyping","==",!0));else if(e.tripId)r=(0,o.P)(n,(0,o._M)("type","==","trip"),(0,o._M)("contextId","==",e.tripId),(0,o._M)("messageType","==",e.messageType),(0,o._M)("isTyping","==",!0));else{if(!e.chatId)return console.error("Invalid typing status parameters"),t([]),()=>{};r=(0,o.P)(n,(0,o._M)("type","==","chat"),(0,o._M)("contextId","==",e.chatId),(0,o._M)("isTyping","==",!0))}return(0,o.aQ)(r,(e=>{const n=e.docs.map((e=>e.data().userId));t(n)}),(e=>{console.error("Error in typing status subscription:",e),t([])}))}catch(n){return console.error("Error setting up typing subscription:",n),t([]),()=>{}}}static async addReaction(e,t,n,l){try{var c,u;if(!e||!t||!n)throw console.error("Missing required parameters for addReaction:",{messageId:e,userId:t,emoji:n}),new Error("Missing required reaction parameters");const m=l||"Unknown User",f=(0,o.H9)(a.db,"messages",e),p=await(0,o.x7)(f);if(!p.exists())throw new Error("Message not found");const g=p.data();let v=(0,i.A)({},g.reactions||{});if(null===(c=v[n])||void 0===c||null===(u=c.users)||void 0===u?void 0:u[t]){const e=(0,i.A)({},v[n].users);delete e[t];const a=Math.max(0,(v[n].count||1)-1);if(0===a){const{[n]:e}=v;v=(0,r.A)(v,[n].map(s.A))}else v[n]={count:a,users:e}}else{var d,h;v[n]={count:((null===(d=v[n])||void 0===d?void 0:d.count)||0)+1,users:(0,i.A)((0,i.A)({},(null===(h=v[n])||void 0===h?void 0:h.users)||{}),{},{[t]:{name:m,timestamp:new Date}})}}return await(0,o.mZ)(f,{reactions:v}),{id:e,reactions:v}}catch(m){throw console.error("Error in addReaction:",m),new Error("Failed to add reaction")}}static getCommonEmojis(){return["\ud83d\udc4d","\u2764\ufe0f","\ud83d\ude02","\ud83c\udf89","\ud83d\ude0d","\ud83d\udc4f","\ud83d\ude4c","\ud83d\udd25","\u2705","\ud83d\udc4c","\ud83e\udd14","\ud83d\ude0a","\ud83d\ude4f","\ud83d\udc40","\ud83d\ude2d","\ud83d\ude22","\ud83e\udd73","\ud83e\udd29","\ud83d\ude33","\ud83d\ude42"]}static getUsersForReaction(e){return e&&e.users?Object.entries(e.users).map((e=>{let[t,n]=e;return{id:t,name:n.name,timestamp:n.timestamp}})):[]}static getSortedReactions(e){return e?Object.entries(e).map((e=>{let[t,n]=e;return{emoji:t,count:n.count,users:this.getUsersForReaction(n)}})).sort(((e,t)=>t.count-e.count)):[]}static async uploadFile(e,t){try{if(!e)throw new c.uV("File is required",c.wU.VALIDATION);if(!t)throw new c.uV("Upload path is required",c.wU.VALIDATION);const s=e.name.replace(/[^a-zA-Z0-9.-]/g,"_"),i=(0,l.KR)(a.IG,"".concat(t,"/").concat(s,"_").concat(Date.now())),o={contentType:e.type,customMetadata:{originalName:e.name,size:e.size.toString()}};try{const t=await(0,l.D)(i,e,o);return{url:await(0,l.qk)(t.ref),path:t.ref.fullPath,name:e.name,type:e.type,size:e.size}}catch(r){var n;throw"storage/unauthorized"===r.code?new c.uV("You do not have permission to upload this file",c.wU.PERMISSION,r):null!==(n=r.code)&&void 0!==n&&n.includes("network")?new c.uV("Network error occurred while uploading the file. Please check your connection.",c.wU.NETWORK,r):(0,c.H4)(r,"uploadFile:storage")}}catch(s){throw(0,c.H4)(s,"uploadFile")}}static async sendMessageWithFile(e,t){let n=null;try{if(!e.text&&!t||!e.senderId)throw new c.uV("Message or file and sender information are required",c.wU.VALIDATION);if(t){if(t.size>10485760)throw new c.uV("File size must be less than 10MB",c.wU.VALIDATION);const r=e.courseId?"courses/".concat(e.courseId,"/files"):e.tripId?"trips/".concat(e.tripId,"/files"):"chats/".concat(e.chatId,"/files");try{n=await this.uploadFile(t,r)}catch(s){throw(0,c.H4)(s,"sendMessageWithFile:uploadFile")}}const l=(0,i.A)((0,i.A)({},e),{},{fileAttachment:n?(0,i.A)((0,i.A)({},n),{},{timestamp:new Date}):null});try{return await this.sendMessage(l)}catch(a){var r;if(null!==(r=n)&&void 0!==r&&r.path)try{await this.deleteFile(n.path)}catch(o){console.error("Error cleaning up file:",o)}throw(0,c.H4)(a,"sendMessageWithFile:sendMessage")}}catch(l){throw(0,c.H4)(l,"sendMessageWithFile")}}static async deleteFile(e){try{const t=(0,l.KR)(a.IG,e);await(0,l.XR)(t)}catch(t){throw console.error("Error deleting file:",t),new Error("Failed to delete file")}}static getFileIcon(e){return e.startsWith("image/")?"image":e.startsWith("video/")?"video":e.startsWith("audio/")?"audio":e.includes("pdf")?"pdf":e.includes("word")?"word":e.includes("excel")||e.includes("spreadsheet")?"excel":e.includes("presentation")||e.includes("powerpoint")?"powerpoint":"file"}static getFileSize(e){if(0===e)return"0 Byte";const t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}static async setTypingStatus(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{if(!t||!e)return;let s="unknown",i="unknown";if(e.courseId)s="course",i=e.courseId;else if(e.tripId)s="trip",i=e.tripId;else{if(!e.chatId)return;s="chat",i=e.chatId}const l="".concat(s,"_").concat(i,"_").concat(e.messageType||"unknown","_").concat(t),c=(0,o.H9)(a.db,"typingStatus",l);if(n)await(0,o.BN)(c,{userId:t,type:s,contextId:i,messageType:e.messageType||"unknown",isTyping:!0,timestamp:(0,o.O5)()},{merge:!0});else try{await(0,o.kd)(c)}catch(r){console.log("No typing status to delete:",r.message)}}catch(s){console.log("Error setting typing status (non-critical):",s.message)}}static subscribeToMessages(e,t){let n;return console.log("Subscribing to messages with params:",e),n="course"===e.type?e.messageType===d.l.COURSE_BROADCAST?(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("courseId","==",e.courseId),(0,o._M)("type","==",d.l.COURSE_BROADCAST),(0,o.My)("timestamp","desc"),(0,o.AB)(h)):(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("courseId","==",e.courseId),(0,o._M)("type","==",e.messageType||d.l.COURSE_DISCUSSION),(0,o.My)("timestamp","desc"),(0,o.AB)(h)):"trip"===e.type?e.messageType===d.l.TRIP_BROADCAST?(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("tripId","==",e.tripId),(0,o._M)("type","==",d.l.TRIP_BROADCAST),(0,o.My)("timestamp","desc"),(0,o.AB)(h)):(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("tripId","==",e.tripId),(0,o._M)("type","==",e.messageType||d.l.TRIP_DISCUSSION),(0,o.My)("timestamp","desc"),(0,o.AB)(h)):(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("chatId","==",e.chatId),(0,o._M)("type","==",d.l.CHAT),(0,o.My)("timestamp","desc"),(0,o.AB)(h)),(0,o.aQ)(n,(e=>{console.log("Message snapshot received:",e.docs.length,"messages");const n=e.docs.map((e=>{var t;const n=e.data();return(0,i.A)((0,i.A)({id:e.id},n),{},{timestamp:(null===(t=n.timestamp)||void 0===t?void 0:t.toDate())||new Date})})).reverse();t({messages:n,hasMore:e.docs.length===h})}),(e=>{console.error("Error in message subscription:",e),t({error:"Failed to load messages"})}))}static async getBuddies(e){try{const t=(0,o.H9)(a.db,"profiles",e),n=await(0,o.x7)(t),r=n.exists()&&n.data().buddyList||{};return Object.entries(r).filter((e=>{let[t,n]=e;return"accepted"===n.status})).map((e=>{let[t,n]=e;return t}))}catch(t){return console.error("Error getting buddies:",t),[]}}static async editMessage(e,t,n){try{const r=(0,o.H9)(a.db,"messages",e),s=await(0,o.x7)(r);if(!s.exists())throw new Error("Message not found");const l=s.data();if(l.senderId!==n)throw new Error("Not authorized to edit this message");const c=l.editHistory||[];return c.push({previousText:l.text,editedAt:new Date,editedBy:n}),await(0,o.mZ)(r,{text:t,editHistory:c,lastEditedAt:(0,o.O5)(),isEdited:!0}),(0,i.A)((0,i.A)({},l),{},{text:t,editHistory:c,lastEditedAt:new Date,isEdited:!0})}catch(r){throw console.error("Error editing message:",r),new Error("Failed to edit message")}}static async updateMessage(e,t){try{var n;const r=(0,o.H9)(a.db,"messages",e);await(0,o.mZ)(r,t);const s=await(0,o.x7)(r);return(0,i.A)((0,i.A)({id:e},s.data()),{},{timestamp:(null===(n=s.data().timestamp)||void 0===n?void 0:n.toDate())||new Date})}catch(r){throw console.error("Error updating message:",r),new Error("Failed to update message")}}static isMessageEditable(e,t){var n,r,s,i;if(e.senderId!==t)return!1;if(null!==(n=e.type)&&void 0!==n&&n.includes("broadcast"))return!1;if(null!==(r=e.deletedFor)&&void 0!==r&&r.includes(t))return!1;const a=(null===(s=e.timestamp)||void 0===s||null===(i=s.toDate)||void 0===i?void 0:i.call(s))||e.timestamp;return!(Date.now()-a>864e5)}static async checkBuddyStatus(e,t){try{const r=(0,o.H9)(a.db,"profiles",e),s=await(0,o.x7)(r);if(s.exists()){var n;return"accepted"===(null===(n=(s.data().buddyList||{})[t])||void 0===n?void 0:n.status)}return!1}catch(r){return console.error("Error checking buddy status:",r),!1}}static async getOrCreateBuddyChat(e,t){try{var n;const r=(0,o.H9)(a.db,"profiles",e),s=await(0,o.x7)(r),i=s.exists()&&s.data().buddyList||{};if(!("accepted"===(null===(n=i[t])||void 0===n?void 0:n.status)))throw new Error("Users must be buddies to create a chat");const l=(0,o.H9)(a.db,"profiles",e),c=await(0,o.x7)(l),u=c.exists()?c.data():null,d=(0,o.H9)(a.db,"profiles",t),h=await(0,o.x7)(d),m=h.exists()?h.data():null;let f="Unknown User";null!==u&&void 0!==u&&u.name?f=u.name:null!==u&&void 0!==u&&u.displayName&&(f=u.displayName);let p="Unknown User";null!==m&&void 0!==m&&m.name?p=m.name:null!==m&&void 0!==m&&m.displayName&&(p=m.displayName);const g=(0,o.P)((0,o.rJ)(a.db,"chats"),(0,o._M)("activeParticipants","array-contains",e)),v=(await(0,o.GG)(g)).docs.find((e=>{const n=e.data();return n.activeParticipants.includes(t)&&2===n.activeParticipants.length}));if(v)return v.id;return(await(0,o.gS)((0,o.rJ)(a.db,"chats"),{type:"direct",participants:{[e]:{joined:(0,o.O5)(),active:!0,displayName:f},[t]:{joined:(0,o.O5)(),active:!0,displayName:p}},activeParticipants:[e,t],createdAt:(0,o.O5)(),createdBy:e,lastMessageAt:(0,o.O5)()})).id}catch(r){throw console.error("Error creating buddy chat:",r),new Error("Failed to create buddy chat")}}static async sendMessage(e){try{const x=(0,o.H9)(a.db,"profiles",e.senderId),y=await(0,o.x7)(x),b=y.exists()?y.data():null;let w="Unknown User";null!==b&&void 0!==b&&b.name?w=b.name:null!==b&&void 0!==b&&b.displayName?w=b.displayName:e.senderName&&(w=e.senderName);const D={timestamp:(0,o.O5)(),readBy:[e.senderId],deletedFor:[],senderName:w};if(e.tripId){var t;const c=await(0,o.x7)((0,o.H9)(a.db,"trips",e.tripId));if(!c.exists())throw new Error("Trip not found");const h=c.data(),m=h.instructorId===e.senderId,f=null===(t=h.participants)||void 0===t?void 0:t.some((t=>t.uid===e.senderId));if(e.type===d.l.TRIP_BROADCAST&&!m)throw new Error("Only trip leaders can send broadcast messages");if(!m&&!f)throw new Error("Not authorized to send messages in this trip");if(e.type===d.l.TRIP_PRIVATE){if(!(m||e.recipientId===h.instructorId)){var n;const t=(0,o.H9)(a.db,"profiles",e.senderId),r=await(0,o.x7)(t),s=r.exists()&&r.data().buddyList||{};if("accepted"===(null===(n=s[e.recipientId])||void 0===n?void 0:n.status)){const t=await this.getOrCreateBuddyChat(e.senderId,e.recipientId);return this.sendMessage((0,i.A)((0,i.A)({},e),{},{type:d.l.CHAT,chatId:t,tripId:null}))}throw new Error("Participants can only message trip leaders directly")}}const p=(0,i.A)((0,i.A)({},D),e);if(!p.allowedReaders&&(p.type===d.l.TRIP_DISCUSSION||p.type===d.l.TRIP_BROADCAST||p.type===d.l.TRIP_PRIVATE)){var r;const e=(null===(r=h.participants)||void 0===r?void 0:r.map((e=>e.uid)))||[];p.allowedReaders=[p.senderId,h.instructorId,...e],p.allowedReaders=[...new Set(p.allowedReaders)],console.log("Added allowedReaders to trip message:",p.type,p.allowedReaders)}const g=await(0,o.gS)((0,o.rJ)(a.db,"messages"),p);console.log("Message added with ID:",g.id);let v=[];var s;if(e.type===d.l.TRIP_BROADCAST)v=(null===(s=h.participants)||void 0===s?void 0:s.map((e=>e.uid)))||[];else if(e.type===d.l.TRIP_DISCUSSION){var l;v=(null===(l=h.participants)||void 0===l?void 0:l.map((e=>e.uid)))||[],v=v.filter((t=>t!==e.senderId))}else e.recipientId&&(v=[e.recipientId]);return console.log("Creating trip message notifications:",{messageType:e.type,senderId:e.senderId,tripId:e.tripId,recipientsCount:v.length,recipients:v}),await Promise.all(v.map((t=>u.default.createMessageNotification({id:g.id,type:e.type,senderId:e.senderId,senderName:w,text:e.text,tripId:e.tripId,tripName:h.name||h.location},t)))),(0,i.A)({id:g.id},p)}if(e.courseId){var c,h;const t=await(0,o.x7)((0,o.H9)(a.db,"courses",e.courseId));if(!t.exists())throw new Error("Course not found");const n=t.data(),r=n.instructorId===e.senderId,s=null===(c=n.assistants)||void 0===c?void 0:c.some((t=>t.uid===e.senderId)),l=null===(h=n.students)||void 0===h?void 0:h.some((t=>t.uid===e.senderId));if(e.type===d.l.COURSE_BROADCAST&&!r)throw new Error("Only instructors can send broadcast messages");if(!r&&!s&&!l)throw new Error("Not authorized to send messages in this course");if(e.type===d.l.COURSE_PRIVATE){console.log("COURSE_PRIVATE MESSAGE:",{senderId:e.senderId,recipientId:e.recipientId,instructorId:n.instructorId});const t=String(e.senderId)===String(n.instructorId),r=String(e.recipientId)===String(n.instructorId);let s=t||r;if(!e.recipientId&&l&&(s=!0,e.recipientId=n.instructorId,console.log("Added missing recipientId for student message:",n.instructorId)),console.log("INSTRUCTOR INVOLVEMENT CHECK:",{senderIsInstructor:t,recipientIsInstructor:r,isInstructorInvolved:s,adjustedRecipientId:e.recipientId}),!s){var m;console.log("Checking buddy status for student-to-student chat");const t=(0,o.H9)(a.db,"profiles",e.senderId),n=await(0,o.x7)(t),r=n.exists()&&n.data().buddyList||{};if("accepted"===(null===(m=r[e.recipientId])||void 0===m?void 0:m.status)){const t=await this.getOrCreateBuddyChat(e.senderId,e.recipientId);return this.sendMessage((0,i.A)((0,i.A)({},e),{},{type:d.l.CHAT,chatId:t,courseId:null}))}throw console.error("Rejecting student-to-student message (not buddies):",{senderId:e.senderId,recipientId:e.recipientId}),new Error("Students can only message instructors directly")}console.log("Allowing instructor-involved message")}const x=(0,i.A)((0,i.A)({},D),e),y=await(0,o.gS)((0,o.rJ)(a.db,"messages"),x);let b=[];var f,p;if(e.type===d.l.COURSE_BROADCAST)b=[...(null===(f=n.students)||void 0===f?void 0:f.map((e=>e.uid)))||[],...(null===(p=n.assistants)||void 0===p?void 0:p.map((e=>e.uid)))||[]];else if(e.type===d.l.COURSE_DISCUSSION){var g,v;b=[...(null===(g=n.students)||void 0===g?void 0:g.map((e=>e.uid)))||[],...(null===(v=n.assistants)||void 0===v?void 0:v.map((e=>e.uid)))||[]].filter((t=>t!==e.senderId))}else e.recipientId&&(b=[e.recipientId]);return await Promise.all(b.map((t=>u.default.createMessageNotification({id:y.id,type:e.type,senderId:e.senderId,senderName:w,text:e.text,courseId:e.courseId,courseName:n.name},t)))),(0,i.A)({id:y.id},x)}{console.log("MessageService - Checking Chat:",e.chatId);const t=await(0,o.x7)((0,o.H9)(a.db,"chats",e.chatId));if(!t.exists())throw new Error("Chat not found");const n=t.data();if(!n.activeParticipants.includes(e.senderId))throw new Error("Not authorized to send messages in this chat");if("buddy"===n.type){const t=await this.getBuddies(e.senderId),r=n.activeParticipants.filter((t=>t!==e.senderId));if(!r.every((e=>t.includes(e))))throw new Error("Can only chat with buddies")}const r=(0,i.A)((0,i.A)((0,i.A)({},D),e),{},{type:d.l.CHAT}),s=await(0,o.gS)((0,o.rJ)(a.db,"messages"),r),l=n.activeParticipants.filter((t=>t!==e.senderId));return await Promise.all(l.map((t=>u.default.createMessageNotification({id:s.id,type:d.l.CHAT,senderId:e.senderId,senderName:w,text:e.text,chatId:e.chatId},t)))),await(0,o.mZ)((0,o.H9)(a.db,"chats",e.chatId),{lastMessageAt:(0,o.O5)(),lastMessage:{text:e.text,senderId:e.senderId,senderName:w}}),(0,i.A)({id:s.id},r)}}catch(x){throw console.error("MessageService - Detailed error:",x),console.error("MessageService - Error stack:",x.stack),new Error("Failed to send message")}}static async markAsRead(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{const i=(0,o.H9)(a.db,"messages",e);if(n){var r,s;const e=(await(0,o.x7)(i)).data();null!==(r=e.readStatus)&&void 0!==r&&null!==(s=r[t])&&void 0!==s&&s.read||await(0,o.mZ)(i,{["readStatus.".concat(t)]:{read:!0,readAt:(0,o.O5)()},readCount:(e.readCount||0)+1,readBy:(0,o.hq)(t)})}else await(0,o.mZ)(i,{readBy:(0,o.hq)(t)})}catch(i){throw console.error("Error marking message as read:",i),new Error("Failed to mark message as read")}}static async deleteMessage(e,t){try{const n=(0,o.H9)(a.db,"messages",e);await(0,o.mZ)(n,{deletedFor:(0,o.hq)(t)})}catch(n){throw console.error("Error deleting message:",n),new Error("Failed to delete message")}}static async searchMessages(e){try{let t;const n=50;t="course"===e.type?(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("courseId","==",e.courseId),(0,o._M)("type","==",e.messageType),(0,o.My)("text"),(0,o.My)("timestamp","desc"),(0,o.AB)(n)):"trip"===e.type?(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("tripId","==",e.tripId),(0,o._M)("type","==",e.messageType),(0,o.My)("text"),(0,o.My)("timestamp","desc"),(0,o.AB)(n)):(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("chatId","==",e.chatId),(0,o._M)("type","==",d.l.CHAT),(0,o.My)("text"),(0,o.My)("timestamp","desc"),(0,o.AB)(n));const r=(await(0,o.GG)(t)).docs.map((e=>{var t;return(0,i.A)((0,i.A)({id:e.id},e.data()),{},{timestamp:(null===(t=e.data().timestamp)||void 0===t?void 0:t.toDate())||new Date})})).filter((t=>{const n=e.searchText.toLowerCase(),r=t.text.toLowerCase(),s=t.senderName.toLowerCase();return r.includes(n)||s.includes(n)})).filter((t=>{var n;return!(null!==(n=t.deletedFor)&&void 0!==n&&n.includes(e.userId))}));return{messages:r,hasMore:r.length===n}}catch(t){throw console.error("Error searching messages:",t),new Error("Failed to search messages")}}static async deleteChat(e,t){try{const n=await(0,o.x7)((0,o.H9)(a.db,"chats",e));if(!n.exists())throw new Error("Chat not found");const r=n.data();if(!r.activeParticipants.includes(t))throw new Error("Not authorized to access this chat");const s=(0,o.wP)(a.db),i=(0,o.H9)(a.db,"chats",e),l=r.activeParticipants.filter((e=>e!==t));if(0===l.length){s.delete(i);const t=(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("chatId","==",e));(await(0,o.GG)(t)).forEach((e=>{s.delete((0,o.H9)(a.db,"messages",e.id))}))}else{s.update(i,{activeParticipants:l});const n=(0,o.P)((0,o.rJ)(a.db,"messages"),(0,o._M)("chatId","==",e));(await(0,o.GG)(n)).forEach((e=>{s.update((0,o.H9)(a.db,"messages",e.id),{deletedFor:(0,o.hq)(t)})}))}await s.commit()}catch(n){throw console.error("Error deleting chat:",n),new Error("Failed to delete chat")}}}},6441:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1029),s=function(e){return e.match(new RegExp("^"+r.A_CHARS+"*"))[0].length},i=function(e){return e.match(new RegExp("^"+r.B_CHARS+"*"))[0].length},a=function(e){return e.match(new RegExp("^"+r.C_CHARS+"*"))[0]};function o(e,t){var n=t?r.A_CHARS:r.B_CHARS,s=e.match(new RegExp("^("+n+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(s)return s[1]+String.fromCharCode(204)+l(e.substring(s[1].length));var i=e.match(new RegExp("^"+n+"+"))[0];return i.length===e.length?e:i+String.fromCharCode(t?205:206)+o(e.substring(i.length),!t)}function l(e){var t=a(e),n=t.length;if(n===e.length)return e;e=e.substring(n);var r=s(e)>=i(e);return t+String.fromCharCode(r?206:205)+o(e,r)}t.default=function(e){var t=void 0;if(a(e).length>=2)t=r.C_START_CHAR+l(e);else{var n=s(e)>i(e);t=(n?r.A_START_CHAR:r.B_START_CHAR)+o(e,n)}return t.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,(function(e,t){return String.fromCharCode(203)+t}))}},6493:(e,t,n)=>{"use strict";n.d(t,{IX:()=>Qe,HF:()=>$e,F0:()=>At,eJ:()=>ft,xI:()=>Gn,hg:()=>wt,kZ:()=>ut,gA:()=>gt,J1:()=>mt,oM:()=>bt,x9:()=>pt,df:()=>on,CI:()=>Dt,f3:()=>xt,r7:()=>vt});var r=n(7150),s=n(1529),i=n(443),a=n(6326),o=n(8812);function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const c=l,u=new s.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),d=new i.Vy("@firebase/auth");function h(e){if(d.logLevel<=i.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];d.error("Auth (".concat(r.MF,"): ").concat(e),...n)}}function m(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw x(e,...n)}function f(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x(e,...n)}function p(e,t,n){const r=Object.assign(Object.assign({},c()),{[t]:n});return new s.FA("auth","Firebase",r).create(t,{appName:e.name})}function g(e){return p(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function v(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&m(e,"argument-error"),p(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function x(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return u.create(e,...n)}function y(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];throw x(t,...r)}}function b(e){const t="INTERNAL ASSERTION FAILED: "+e;throw h(t),new Error(t)}function w(e,t){e||b(t)}function D(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function N(){return"http:"===j()||"https:"===j()}function j(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class C{constructor(e,t){this.shortDelay=e,this.longDelay=t,w(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,s.jZ)()||(0,s.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(N()||(0,s.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function E(e,t){w(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class A{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void b("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void b("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void b("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const k={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},S=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],F=new C(3e4,6e4);function _(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function T(e,t,n,r){return I(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},a={};r&&("GET"===t?a=r:i={body:JSON.stringify(r)});const o=(0,s.Am)(Object.assign({key:e.config.apiKey},a)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},i);return(0,s.c1)()||(c.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,s.zJ)(e.emulatorConfig.host)&&(c.credentials="include"),A.fetch()(await P(e,e.config.apiHost,n,o),c)}))}async function I(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},k),t);try{const t=new M(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await s.json();if("needConfirmation"in i)throw L(e,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;{const t=s.ok?i.errorMessage:i.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw L(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw L(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw L(e,"user-disabled",i);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw p(e,o,a);m(e,o)}}catch(i){if(i instanceof s.g)throw i;m(e,"network-request-failed",{message:String(i)})}}async function R(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const i=await T(e,t,n,r,s);return"mfaPendingCredential"in i&&m(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function P(e,t,n,r){const s="".concat(t).concat(n,"?").concat(r),i=e,a=i.config.emulator?E(e.config,s):"".concat(e.config.apiScheme,"://").concat(s);if(S.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(a).toString()}return a}function O(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class M{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(f(this.auth,"network-request-failed"))),F.get())}))}}function L(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=f(e,t,r);return s.customData._tokenResponse=n,s}function B(e){return void 0!==e&&void 0!==e.enterprise}class z{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return O(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function U(e,t){return T(e,"GET","/v2/recaptchaConfig",_(e,t))}async function q(e,t){return T(e,"POST","/v1/accounts:lookup",t)}function V(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function H(e){return 1e3*Number(e)}function W(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return h("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,s.u)(n);return e?JSON.parse(e):(h("Failed to decode base64 JWT payload"),null)}catch(i){return h("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function G(e){const t=W(e);return y(t,"internal-error"),y("undefined"!==typeof t.exp,"internal-error"),y("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function K(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof s.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Q{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Y{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=V(this.lastLoginAt),this.creationTime=V(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function J(e){var t;const n=e.auth,r=await e.getIdToken(),s=await K(e,q(n,{idToken:r}));y(null===s||void 0===s?void 0:s.users.length,n,"internal-error");const i=s.users[0];e._notifyReloadListener(i);const a=(null===(t=i.providerUserInfo)||void 0===t?void 0:t.length)?X(i.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&i.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Y(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,m)}function X(e){return e.map((e=>{var{providerId:t}=e,n=(0,a.Tt)(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class ${constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){y(e.idToken,"internal-error"),y("undefined"!==typeof e.idToken,"internal-error"),y("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):G(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){y(0!==e.length,"internal-error");const t=G(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(y(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await I(e,{},(async()=>{const n=(0,s.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,a=await P(e,r,"/v1/token","key=".concat(i)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",A.fetch()(a,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,i=new $;return n&&(y("string"===typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(y("string"===typeof r,"internal-error",{appName:e}),i.accessToken=r),s&&(y("number"===typeof s,"internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $,this.toJSON())}_performRefresh(){return b("not implemented")}}function Z(e,t){y("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class ee{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=(0,a.Tt)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Q(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Y(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await K(this,this.stsTokenManager.getToken(this.auth,e));return y(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,s.Ku)(e),r=await n.getIdToken(t),i=W(r);y(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a="object"===typeof i.firebase?i.firebase:void 0,o=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:i,token:r,authTime:V(H(i.auth_time)),issuedAtTime:V(H(i.iat)),expirationTime:V(H(i.exp)),signInProvider:o||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,s.Ku)(e);await J(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(y(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ee(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){y(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await J(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,r.xZ)(this.auth.app))return Promise.reject(g(this.auth));const e=await this.getIdToken();return await K(this,async function(e,t){return T(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,i,a,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,m=null!==(i=t.photoURL)&&void 0!==i?i:void 0,f=null!==(a=t.tenantId)&&void 0!==a?a:void 0,p=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:x,emailVerified:b,isAnonymous:w,providerData:D,stsTokenManager:N}=t;y(x&&N,e,"internal-error");const j=$.fromJSON(this.name,N);y("string"===typeof x,e,"internal-error"),Z(u,e.name),Z(d,e.name),y("boolean"===typeof b,e,"internal-error"),y("boolean"===typeof w,e,"internal-error"),Z(h,e.name),Z(m,e.name),Z(f,e.name),Z(p,e.name),Z(g,e.name),Z(v,e.name);const C=new ee({uid:x,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:w,photoURL:m,phoneNumber:h,tenantId:f,stsTokenManager:j,createdAt:g,lastLoginAt:v});return D&&Array.isArray(D)&&(C.providerData=D.map((e=>Object.assign({},e)))),p&&(C._redirectEventId=p),C}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new $;r.updateFromServerResponse(t);const s=new ee({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await J(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];y(void 0!==r.localId,"internal-error");const s=void 0!==r.providerUserInfo?X(r.providerUserInfo):[],i=!(r.email&&r.passwordHash)&&!(null===s||void 0===s?void 0:s.length),a=new $;a.updateFromIdToken(n);const o=new ee({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:i}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new Y(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===s||void 0===s?void 0:s.length)};return Object.assign(o,l),o}}const te=new Map;function ne(e){w(e instanceof Function,"Expected a class definition");let t=te.get(e);return t?(w(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,te.set(e,t),t)}class re{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}re.type="NONE";const se=re;function ie(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class ae{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=ie(this.userKey,r.apiKey,s),this.fullPersistenceKey=ie("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await q(this.auth,{idToken:e}).catch((()=>{}));return t?ee._fromGetAccountInfoResponse(this.auth,t,e):null}return ee._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ae(ne(se),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let s=r[0]||ne(se);const i=ie(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(i);if(t){let n;if("string"===typeof t){const r=await q(e,{idToken:t}).catch((()=>{}));if(!r)break;n=await ee._fromGetAccountInfoResponse(e,r,t)}else n=ee._fromJSON(e,t);c!==s&&(a=n),s=c;break}}catch(l){}const o=r.filter((e=>e._shouldAllowMigration));return s._shouldAllowMigration&&o.length?(s=o[0],a&&await s._set(i,a.toJSON()),await Promise.all(t.map((async e=>{if(e!==s)try{await e._remove(i)}catch(l){}}))),new ae(s,e,n)):new ae(s,e,n)}}function oe(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(de(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(le(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(me(t))return"Blackberry";if(fe(t))return"Webos";if(ce(t))return"Safari";if((t.includes("chrome/")||ue(t))&&!t.includes("edge/"))return"Chrome";if(he(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function le(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/firefox\//i.test(e)}function ce(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/crios\//i.test(e)}function de(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/iemobile/i.test(e)}function he(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/android/i.test(e)}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/blackberry/i.test(e)}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/webos/i.test(e)}function pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ge(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)();return pe(e)||he(e)||fe(e)||me(e)||/windows phone/i.test(e)||de(e)}function ve(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=oe((0,s.ZQ)());break;case"Worker":t="".concat(oe((0,s.ZQ)()),"-").concat(e);break;default:t=e}const i=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(r.MF,"/").concat(i)}class xe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(s){r(s)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class ye{constructor(e){var t,n,r,s;const i=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=i.minPasswordLength)&&void 0!==t?t:6,i.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=i.maxPasswordLength),void 0!==i.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=i.containsLowercaseCharacter),void 0!==i.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=i.containsUppercaseCharacter),void 0!==i.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=i.containsNumericCharacter),void 0!==i.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=i.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(s=e.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,s,i,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(s=o.containsUppercaseLetter)||void 0===s||s),o.isValid&&(o.isValid=null===(i=o.containsNumericCharacter)||void 0===i||i),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class be{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new De(this),this.idTokenSubscription=new De(this),this.beforeStateQueue=new xe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=u,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ne(t)),this._initializationPromise=this.queue((async()=>{var n,r,s;if(!this._deleted&&(this.persistenceManager=await ae.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null===(r=this._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(s=this.currentUser)||void 0===s?void 0:s.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await q(this,{idToken:e}),n=await ee._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,r.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null===s||void 0===s?void 0:s._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==r||!(null===a||void 0===a?void 0:a.user)||(s=a.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(a)))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return y(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await J(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,r.xZ)(this.app))return Promise.reject(g(this));const t=e?(0,s.Ku)(e):null;return t&&y(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&y(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(0,r.xZ)(this.app)?Promise.reject(g(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,r.xZ)(this.app)?Promise.reject(g(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(ne(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return T(e,"GET","/v2/passwordPolicy",_(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new ye(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new s.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return T(e,"POST","/v2/accounts:revokeToken",_(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ne(e)||this._popupRedirectResolver;y(t,this,"argument-error"),this.redirectPersistenceManager=await ae.create(this,[ne(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"===typeof t?t:t.next.bind(t);let i=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(y(a,this,"internal-error"),a.then((()=>{i||s(this.currentUser)})),"function"===typeof t){const s=e.addObserver(t,n,r);return()=>{i=!0,s()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return y(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ve(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if((0,r.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(d.logLevel<=i.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];d.warn("Auth (".concat(r.MF,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function we(e){return(0,s.Ku)(e)}class De{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,s.tD)((e=>this.observer=e))}get next(){return y(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ne={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function je(e){return Ne.loadJS(e)}function Ce(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Ee{constructor(){this.enterprise=new Ae}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Ae{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const ke="NO_RECAPTCHA";class Se{constructor(e){this.type="recaptcha-enterprise",this.auth=we(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const s=window.grecaptcha;B(s)?s.enterprise.ready((()=>{s.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(ke)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Ee).execute("siteKey",{action:"verify"})}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{U(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new z(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((s=>{if(!t&&B(window.grecaptcha))n(s,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Ne.recaptchaEnterpriseScript;0!==t.length&&(t+=s),je(t).then((()=>{n(s,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Fe(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new Se(e);let a;if(s)a=ke;else try{a=await i.verify(n)}catch(l){a=await i.verify(n,!0)}const o=Object.assign({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function _e(e,t,n,r,s){var i,a;if("EMAIL_PASSWORD_PROVIDER"===s){if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Fe(e,t,n,"getOobCode"===n);return r(e,s)}return r(e,t).catch((async s=>{if(s.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const s=await Fe(e,t,n,"getOobCode"===n);return r(e,s)}return Promise.reject(s)}))}if("PHONE_PROVIDER"===s){if(null===(a=e._getRecaptchaConfig())||void 0===a?void 0:a.isProviderEnabled("PHONE_PROVIDER")){const s=await Fe(e,t,n);return r(e,s).catch((async s=>{var i;if("AUDIT"===(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.getProviderEnforcementState("PHONE_PROVIDER"))&&(s.code==="auth/".concat("missing-recaptcha-token")||s.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const s=await Fe(e,t,n,!1,!0);return r(e,s)}return Promise.reject(s)}))}{const s=await Fe(e,t,n,!1,!0);return r(e,s)}}return Promise.reject(s+" provider is not supported.")}async function Te(e){const t=we(e),n=await U(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new z(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Se(t).verify()}}function Ie(e,t,n){const r=we(e);y(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=Re(t),{host:o,port:l}=function(e){const t=Re(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:Pe(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Pe(t)}}}(t),c=null===l?"":":".concat(l),u={url:"".concat(a,"//").concat(o).concat(c,"/")},d=Object.freeze({host:o,port:l,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return y(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void y((0,s.bD)(u,r.config.emulator)&&(0,s.bD)(d,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,(0,s.zJ)(o)?((0,s.P1)("Auth",!0),(0,s.gE)("".concat(a,"//").concat(o).concat(c))):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Re(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Pe(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Oe{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return b("not implemented")}_getIdTokenResponse(e){return b("not implemented")}_linkToIdToken(e,t){return b("not implemented")}_getReauthenticationResolver(e){return b("not implemented")}}async function Me(e,t){return T(e,"POST","/v1/accounts:signUp",t)}async function Le(e,t){return R(e,"POST","/v1/accounts:signInWithPassword",_(e,t))}async function Be(e,t){return T(e,"POST","/v1/accounts:sendOobCode",_(e,t))}async function ze(e,t){return Be(e,t)}class Ue extends Oe{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Ue(e,t,"password")}static _fromEmailAndCode(e,t){return new Ue(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return _e(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Le,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return R(e,"POST","/v1/accounts:signInWithEmailLink",_(e,t))}(e,{email:this._email,oobCode:this._password});default:m(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return _e(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Me,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return R(e,"POST","/v1/accounts:signInWithEmailLink",_(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:m(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function qe(e,t){return R(e,"POST","/v1/accounts:signInWithIdp",_(e,t))}class Ve extends Oe{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ve(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):m("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=(0,a.Tt)(t,["providerId","signInMethod"]);if(!n||!r)return null;const i=new Ve(n,r);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return qe(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,qe(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,qe(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,s.Am)(t)}return e}}async function He(e,t){return T(e,"POST","/v1/accounts:sendVerificationCode",_(e,t))}const We={USER_NOT_FOUND:"user-not-found"};class Ge extends Oe{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ge({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ge({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return R(e,"POST","/v1/accounts:signInWithPhoneNumber",_(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await R(e,"POST","/v1/accounts:signInWithPhoneNumber",_(e,t));if(n.temporaryProof)throw L(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return R(e,"POST","/v1/accounts:signInWithPhoneNumber",_(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),We)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}=e;return n||t||r||s?new Ge({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:s}):null}}class Ke{constructor(e){var t,n,r,i,a,o;const l=(0,s.I9)((0,s.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,u=null!==(n=l.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);y(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=null!==(i=l.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(a=l.lang)&&void 0!==a?a:null,this.tenantId=null!==(o=l.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=(0,s.I9)((0,s.hp)(e)).link,n=t?(0,s.I9)((0,s.hp)(t)).deep_link_id:null,r=(0,s.I9)((0,s.hp)(e)).deep_link_id;return(r?(0,s.I9)((0,s.hp)(r)).link:null)||r||n||t||e}(e);try{return new Ke(t)}catch(n){return null}}}class Qe{constructor(){this.providerId=Qe.PROVIDER_ID}static credential(e,t){return Ue._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ke.parseLink(t);return y(n,"argument-error"),Ue._fromEmailAndCode(e,n.code,n.tenantId)}}Qe.PROVIDER_ID="password",Qe.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Qe.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ye{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Je extends Ye{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Xe extends Je{constructor(){super("facebook.com")}static credential(e){return Ve._fromParams({providerId:Xe.PROVIDER_ID,signInMethod:Xe.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xe.credentialFromTaggedObject(e)}static credentialFromError(e){return Xe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Xe.credential(t.oauthAccessToken)}catch(n){return null}}}Xe.FACEBOOK_SIGN_IN_METHOD="facebook.com",Xe.PROVIDER_ID="facebook.com";class $e extends Je{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ve._fromParams({providerId:$e.PROVIDER_ID,signInMethod:$e.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return $e.credentialFromTaggedObject(e)}static credentialFromError(e){return $e.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return $e.credential(n,r)}catch(s){return null}}}$e.GOOGLE_SIGN_IN_METHOD="google.com",$e.PROVIDER_ID="google.com";class Ze extends Je{constructor(){super("github.com")}static credential(e){return Ve._fromParams({providerId:Ze.PROVIDER_ID,signInMethod:Ze.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ze.credentialFromTaggedObject(e)}static credentialFromError(e){return Ze.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ze.credential(t.oauthAccessToken)}catch(n){return null}}}Ze.GITHUB_SIGN_IN_METHOD="github.com",Ze.PROVIDER_ID="github.com";class et extends Je{constructor(){super("twitter.com")}static credential(e,t){return Ve._fromParams({providerId:et.PROVIDER_ID,signInMethod:et.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return et.credentialFromTaggedObject(e)}static credentialFromError(e){return et.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return et.credential(n,r)}catch(s){return null}}}async function tt(e,t){return R(e,"POST","/v1/accounts:signUp",_(e,t))}et.TWITTER_SIGN_IN_METHOD="twitter.com",et.PROVIDER_ID="twitter.com";class nt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const s=await ee._fromIdTokenResponse(e,n,r),i=rt(n);return new nt({user:s,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=rt(n);return new nt({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function rt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class st extends s.g{constructor(e,t,n,r){var s;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,st.prototype),this.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new st(e,t,n,r)}}function it(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw st._fromErrorAndOperation(e,n,t,r);throw n}))}async function at(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await K(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return nt._forOperation(e,"link",r)}async function ot(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:s}=e;if((0,r.xZ)(s.app))return Promise.reject(g(s));const i="reauthenticate";try{const r=await K(e,it(s,i,t,e),n);y(r.idToken,s,"internal-error");const a=W(r.idToken);y(a,s,"internal-error");const{sub:o}=a;return y(e.uid===o,s,"user-mismatch"),nt._forOperation(e,i,r)}catch(a){throw(null===a||void 0===a?void 0:a.code)==="auth/".concat("user-not-found")&&m(s,"user-mismatch"),a}}async function lt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,r.xZ)(e.app))return Promise.reject(g(e));const s="signIn",i=await it(e,s,t),a=await nt._fromIdTokenResponse(e,s,i);return n||await e._updateCurrentUser(a.user),a}async function ct(e,t){return lt(we(e),t)}async function ut(e,t){return ot((0,s.Ku)(e),t)}function dt(e,t,n){var r;y((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),y("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),y("undefined"===typeof n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(y(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(y(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function ht(e){const t=we(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function mt(e,t,n){const r=we(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&dt(r,s,n),await _e(r,s,"getOobCode",ze,"EMAIL_PASSWORD_PROVIDER")}async function ft(e,t,n){if((0,r.xZ)(e.app))return Promise.reject(g(e));const s=we(e),i=_e(s,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",tt,"EMAIL_PASSWORD_PROVIDER"),a=await i.catch((t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&ht(e),t})),o=await nt._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(o.user),o}function pt(e,t,n){return(0,r.xZ)(e.app)?Promise.reject(g(e)):ct((0,s.Ku)(e),Qe.credential(t,n)).catch((async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&ht(e),t}))}async function gt(e,t){const n=(0,s.Ku)(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&dt(n.auth,r,t);const{email:i}=await async function(e,t){return Be(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function vt(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const i=(0,s.Ku)(e),a={idToken:await i.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},o=await K(i,async function(e,t){return T(e,"POST","/v1/accounts:update",t)}(i.auth,a));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const l=i.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));l&&(l.displayName=i.displayName,l.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function xt(e,t){return yt((0,s.Ku)(e),null,t)}async function yt(e,t,n){const{auth:r}=e,s={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(s.email=t),n&&(s.password=n);const i=await K(e,async function(e,t){return T(e,"POST","/v1/accounts:update",t)}(r,s));await e._updateTokensIfNecessary(i,!0)}function bt(e,t){return(0,s.Ku)(e).setPersistence(t)}function wt(e,t,n,r){return(0,s.Ku)(e).onAuthStateChanged(t,n,r)}function Dt(e){return(0,s.Ku)(e).signOut()}function Nt(e,t){return T(e,"POST","/v2/accounts/mfaEnrollment:start",_(e,t))}new WeakMap;const jt="__sak";class Ct{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(jt,"1"),this.storage.removeItem(jt),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Et extends Ct{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ge(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);(0,s.lT)()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Et.type="LOCAL";const At=Et;function kt(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),s=RegExp("".concat(r,"=([^;]+)"));return null!==(n=null===(t=document.cookie.match(s))||void 0===t?void 0:t[1])&&void 0!==n?n:null}function St(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class Ft{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=St(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return kt(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=St(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch((()=>{}))}_addListener(e,t){if(!this._isAvailable())return;const n=St(e);if(window.cookieStore){const e=e=>{const r=e.changed.find((e=>e.name===n));r&&t(r.value);e.deleted.find((e=>e.name===n))&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=kt(n);const s=setInterval((()=>{const e=kt(n);e!==r&&(t(e),r=e)}),1e3);this.listenerUnsubscribes.set(t,(()=>clearInterval(s)))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Ft.type="COOKIE";class _t extends Ct{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}_t.type="SESSION";const Tt=_t;class It{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new It(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,i=this.handlersMap[r];if(!(null===i||void 0===i?void 0:i.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(i).map((async e=>e(t.origin,s))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Rt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}It.receivers=[];class Pt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,i;return new Promise(((a,o)=>{const l=Rt("",20);r.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),s=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),a(t.data.response);break;default:clearTimeout(c),clearTimeout(s),o(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{i&&this.removeMessageHandler(i)}))}}function Ot(){return window}function Mt(){return"undefined"!==typeof Ot().WorkerGlobalScope&&"function"===typeof Ot().importScripts}const Lt="firebaseLocalStorageDb",Bt="firebaseLocalStorage",zt="fbase_key";class Ut{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function qt(e,t){return e.transaction([Bt],t?"readwrite":"readonly").objectStore(Bt)}function Vt(){const e=indexedDB.open(Lt,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Bt,{keyPath:zt})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Bt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Lt);return new Ut(e).toPromise()}(),t(await Vt()))}))}))}async function Ht(e,t,n){const r=qt(e,!0).put({[zt]:t,value:n});return new Ut(r).toPromise()}function Wt(e,t){const n=qt(e,!0).delete(t);return new Ut(n).toPromise()}class Gt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Vt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Mt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=It._getInstance(Mt()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Pt(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vt();return await Ht(e,jt,"1"),await Wt(e,jt),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Ht(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=qt(e,!1).get(t),r=await new Ut(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Wt(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=qt(e,!1).getAll();return new Ut(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Gt.type="LOCAL";const Kt=Gt;function Qt(e,t){return T(e,"POST","/v2/accounts/mfaSignIn:start",_(e,t))}Ce("rcb"),new C(3e4,6e4);const Yt="recaptcha";async function Jt(e,t,n){var r;if(!e._getRecaptchaConfig())try{await Te(e)}catch(s){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let s;if(s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){y("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},i=_e(e,r,"mfaSmsEnrollment",(async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===ke){y((null===n||void 0===n?void 0:n.type)===Yt,e,"argument-error");return Nt(e,await Xt(e,t,n))}return Nt(e,t)}),"PHONE_PROVIDER");return(await i.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{y("signin"===t.type,e,"internal-error");const i=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;y(i,e,"missing-multi-factor-info");const a={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=_e(e,a,"mfaSmsSignIn",(async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===ke){y((null===n||void 0===n?void 0:n.type)===Yt,e,"argument-error");return Qt(e,await Xt(e,t,n))}return Qt(e,t)}),"PHONE_PROVIDER");return(await o.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:s.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=_e(e,t,"sendVerificationCode",(async(e,t)=>{if(t.captchaResponse===ke){y((null===n||void 0===n?void 0:n.type)===Yt,e,"argument-error");return He(e,await Xt(e,t,n))}return He(e,t)}),"PHONE_PROVIDER");return(await r.catch((e=>Promise.reject(e)))).sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Xt(e,t,n){y(n.type===Yt,e,"argument-error");const r=await n.verify();y("string"===typeof r,e,"argument-error");const s=Object.assign({},t);if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.captchaResponse,n=s.phoneEnrollmentInfo.clientType,i=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:i}}),s}if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.captchaResponse,t=s.phoneSignInInfo.clientType,n=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),s}return Object.assign(s,{recaptchaToken:r}),s}class $t{constructor(e){this.providerId=$t.PROVIDER_ID,this.auth=we(e)}verifyPhoneNumber(e,t){return Jt(this.auth,e,(0,s.Ku)(t))}static credential(e,t){return Ge._fromVerification(e,t)}static credentialFromResult(e){const t=e;return $t.credentialFromTaggedObject(t)}static credentialFromError(e){return $t.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Ge._fromTokenResponse(n,r):null}}function Zt(e,t){return t?ne(t):(y(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}$t.PROVIDER_ID="phone",$t.PHONE_SIGN_IN_METHOD="phone";class en extends Oe{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qe(e,this._buildIdpRequest())}_linkToIdToken(e,t){return qe(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return qe(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function tn(e){return lt(e.auth,new en(e),e.bypassAuthState)}function nn(e){const{auth:t,user:n}=e;return y(n,t,"internal-error"),ot(n,new en(e),e.bypassAuthState)}async function rn(e){const{auth:t,user:n}=e;return y(n,t,"internal-error"),at(n,new en(e),e.bypassAuthState)}class sn{constructor(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:i,type:a}=e;if(i)return void this.reject(i);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tn;case"linkViaPopup":case"linkViaRedirect":return rn;case"reauthViaPopup":case"reauthViaRedirect":return nn;default:m(this.auth,"internal-error")}}resolve(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){w(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const an=new C(2e3,1e4);async function on(e,t,n){if((0,r.xZ)(e.app))return Promise.reject(f(e,"operation-not-supported-in-this-environment"));const s=we(e);v(e,t,Ye);const i=Zt(s,n);return new ln(s,"signInViaPopup",t,i).executeNotNull()}class ln extends sn{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,ln.currentPopupAction&&ln.currentPopupAction.cancel(),ln.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return y(e,this.auth,"internal-error"),e}async onExecution(){w(1===this.filter.length,"Popup operations only handle one event");const e=Rt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(f(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(f(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ln.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(f(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,an.get())};e()}}ln.currentPopupAction=null;const cn=new Map;class un extends sn{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=cn.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=mn(t),r=hn(e);if(!await r._isAvailable())return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}cn.set(this.auth._key(),e)}return this.bypassAuthState||cn.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function dn(e,t){cn.set(e._key(),t)}function hn(e){return ne(e._redirectPersistence)}function mn(e){return ie("pendingRedirect",e.config.apiKey,e.name)}async function fn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,r.xZ)(e.app))return Promise.reject(g(e));const s=we(e),i=Zt(s,t),a=new un(s,i,n),o=await a.execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,t)),o}class pn{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vn(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!vn(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(f(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(gn(e))}saveEventToCache(e){this.cachedEventUids.add(gn(e)),this.lastProcessedEventTime=Date.now()}}function gn(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function vn(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const xn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yn=/^https?/;async function bn(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return T(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(wn(r))return}catch(n){}m(e,"unauthorized-domain")}function wn(e){const t=D(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!yn.test(n))return!1;if(xn.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const Dn=new C(3e4,6e4);function Nn(){const e=Ot().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function jn(e){return new Promise(((t,n)=>{var r,s,i;function a(){Nn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Nn(),n(f(e,"network-request-failed"))},timeout:Dn.get()})}if(null===(s=null===(r=Ot().gapi)||void 0===r?void 0:r.iframes)||void 0===s?void 0:s.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=Ot().gapi)||void 0===i?void 0:i.load)){const t=Ce("iframefcb");return Ot()[t]=()=>{gapi.load?a():n(f(e,"network-request-failed"))},je("".concat(Ne.gapiScript,"?onload=").concat(t)).catch((e=>n(e)))}a()}})).catch((e=>{throw Cn=null,e}))}let Cn=null;const En=new C(5e3,15e3),An={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},kn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Sn(e){const t=e.config;y(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?E(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),i={apiKey:t.apiKey,appName:e.name,v:r.MF},a=kn.get(e.config.apiHost);a&&(i.eid=a);const o=e._getFrameworks();return o.length&&(i.fw=o.join(",")),"".concat(n,"?").concat((0,s.Am)(i).slice(1))}async function Fn(e){const t=await function(e){return Cn=Cn||jn(e),Cn}(e),n=Ot().gapi;return y(n,e,"internal-error"),t.open({where:document.body,url:Sn(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:An,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=f(e,"network-request-failed"),i=Ot().setTimeout((()=>{r(s)}),En.get());function a(){Ot().clearTimeout(i),n(t)}t.ping(a).then(a,(()=>{r(s)}))}))))}const _n={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Tn{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function In(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},_n),{width:r.toString(),height:i.toString(),top:a,left:o}),u=(0,s.ZQ)().toLowerCase();n&&(l=ue(u)?"_blank":n),le(u)&&(t=t||"http://localhost",c.scrollbars="yes");const d=Object.entries(c).reduce(((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")}),"");if(function(){var e;return pe(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.ZQ)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==l)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",l),new Tn(null);const h=window.open(t||"",l,d);y(h,e,"popup-blocked");try{h.focus()}catch(m){}return new Tn(h)}const Rn="__/auth/handler",Pn="emulator/auth/handler",On=encodeURIComponent("fac");async function Mn(e,t,n,i,a,o){y(e.config.authDomain,e,"auth-domain-config-required"),y(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:i,v:r.MF,eventId:a};if(t instanceof Ye){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,s.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))l[e]=t}if(t instanceof Je){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const r of Object.keys(c))void 0===c[r]&&delete c[r];const u=await e._getAppCheckToken(),d=u?"#".concat(On,"=").concat(encodeURIComponent(u)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Rn);return E(t,Pn)}(e),"?").concat((0,s.Am)(c).slice(1)).concat(d)}const Ln="webStorageSupport";const Bn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tt,this._completeRedirectFn=fn,this._overrideRedirectResult=dn}async _openPopup(e,t,n,r){var s;w(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");return In(e,await Mn(e,t,n,D(),r),Rt())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Ot().location.href=e}(await Mn(e,t,n,D(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(w(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Fn(e),n=new pn(e);return t.register("authEvent",(t=>{y(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ln,{type:Ln},(n=>{var r;const s=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Ln];void 0!==s&&t(!!s),m(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=bn(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ge()||ce()||pe()}};var zn="@firebase/auth",Un="1.10.4";class qn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){y(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Vn=(0,s.XA)("authIdTokenMaxAge")||300;let Hn=null;const Wn=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Vn)return;const s=null===n||void 0===n?void 0:n.token;Hn!==s&&(Hn=s,await fetch(e,{method:s?"POST":"DELETE",headers:s?{Authorization:"Bearer ".concat(s)}:{}}))};function Gn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)();const t=(0,r.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,r.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,s.bD)(r,null!==t&&void 0!==t?t:{}))return e;m(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Bn,persistence:[Kt,At,Tt]}),i=(0,s.XA)("authTokenSyncURL");if(i&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(i,location.origin);if(location.origin===e.origin){const t=Wn(e.toString());!function(e,t,n){(0,s.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){(0,s.Ku)(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}const a=(0,s.Tj)("auth");return a?Ie(n,"http://".concat(a)):(0,s.P1)("Auth",!1),n}var Kn;!function(e){Ne=e}({loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=f("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Kn="Browser",(0,r.om)(new o.uA("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;y(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:Kn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ve(Kn)},c=new be(r,s,i,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ne);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),(0,r.om)(new o.uA("auth-internal",(e=>(e=>new qn(e))(we(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,r.KO)(zn,Un,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Kn)),(0,r.KO)(zn,Un,"esm2017")},6825:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MSI1110=t.MSI1010=t.MSI11=t.MSI10=t.MSI=void 0;var r=l(n(3498)),s=l(n(4863)),i=l(n(1704)),a=l(n(5938)),o=l(n(1573));function l(e){return e&&e.__esModule?e:{default:e}}t.MSI=r.default,t.MSI10=s.default,t.MSI11=i.default,t.MSI1010=a.default,t.MSI1110=o.default},6843:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,n);if(void 0===s){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in s)return s.value;var a=s.get;return void 0!==a?a.call(r):void 0},a=n(9011),o=(r=a)&&r.__esModule?r:{default:r};var l=function(e){return(10-e.substr(0,7).split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+t:e+3*t}),0)%10)%10},c=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),-1!==e.search(/^[0-9]{7}$/)&&(e+=l(e)),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===l(this.data)}},{key:"leftText",value:function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var e=this.data.substr(0,4);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"leftEncode",this).call(this,e,"LLLL")}},{key:"rightText",value:function(){return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var e=this.data.substr(4,4);return i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"rightEncode",this).call(this,e,"RRRR")}}]),t}(o.default);t.default=c},7051:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var r=n(9526);function s(e,t,n){return(t=(0,r.A)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},7150:(e,t,n)=>{"use strict";n.d(t,{MF:()=>de,j6:()=>ae,xZ:()=>oe,om:()=>ie,Sx:()=>me,Wp:()=>he,KO:()=>fe});var r=n(8812),s=n(443),i=n(1529),a=n(7051);let o,l;const c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,m=new WeakMap;let f={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return v(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function p(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(x(this),n),v(c.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return v(e.apply(x(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];const i=e.call(x(this),t,...r);return d.set(i,t.sort?t.sort():[t]),v(i)}}function g(e){return"function"===typeof e?p(e):(e instanceof IDBTransaction&&function(e){if(u.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)}));u.set(e,t)}(e),t=e,(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,f):e);var t}function v(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(v(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",i)}));return t.then((t=>{t instanceof IDBCursor&&c.set(t,e)})).catch((()=>{})),m.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=g(e);return t!==e&&(h.set(e,t),m.set(t,e)),t}const x=e=>m.get(e);const y=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],w=new Map;function D(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=b.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!y.includes(n))return;const i=async function(e){const t=this.transaction(e,s?"readwrite":"readonly");let i=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return r&&(i=i.index(o.shift())),(await Promise.all([i[n](...o),s&&t.done]))[0]};return w.set(t,i),i}f=(e=>(0,a.A)((0,a.A)({},e),{},{get:(t,n,r)=>D(t,n)||e.get(t,n,r),has:(t,n)=>!!D(t,n)||e.has(t,n)}))(f);class N{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const j="@firebase/app",C="0.12.3",E=new s.Vy("@firebase/app"),A="@firebase/app-compat",k="@firebase/analytics-compat",S="@firebase/analytics",F="@firebase/app-check-compat",_="@firebase/app-check",T="@firebase/auth",I="@firebase/auth-compat",R="@firebase/database",P="@firebase/data-connect",O="@firebase/database-compat",M="@firebase/functions",L="@firebase/functions-compat",B="@firebase/installations",z="@firebase/installations-compat",U="@firebase/messaging",q="@firebase/messaging-compat",V="@firebase/performance",H="@firebase/performance-compat",W="@firebase/remote-config",G="@firebase/remote-config-compat",K="@firebase/storage",Q="@firebase/storage-compat",Y="@firebase/firestore",J="@firebase/vertexai",X="@firebase/firestore-compat",$="firebase",Z="[DEFAULT]",ee={[j]:"fire-core",[A]:"fire-core-compat",[S]:"fire-analytics",[k]:"fire-analytics-compat",[_]:"fire-app-check",[F]:"fire-app-check-compat",[T]:"fire-auth",[I]:"fire-auth-compat",[R]:"fire-rtdb",[P]:"fire-data-connect",[O]:"fire-rtdb-compat",[M]:"fire-fn",[L]:"fire-fn-compat",[B]:"fire-iid",[z]:"fire-iid-compat",[U]:"fire-fcm",[q]:"fire-fcm-compat",[V]:"fire-perf",[H]:"fire-perf-compat",[W]:"fire-rc",[G]:"fire-rc-compat",[K]:"fire-gcs",[Q]:"fire-gcs-compat",[Y]:"fire-fst",[X]:"fire-fst-compat",[J]:"fire-vertex","fire-js":"fire-js",[$]:"fire-js-all"},te=new Map,ne=new Map,re=new Map;function se(e,t){try{e.container.addComponent(t)}catch(n){E.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function ie(e){const t=e.name;if(re.has(t))return E.debug("There were multiple attempts to register component ".concat(t,".")),!1;re.set(t,e);for(const n of te.values())se(n,e);for(const n of ne.values())se(n,e);return!0}function ae(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function oe(e){return null!==e&&void 0!==e&&void 0!==e.settings}const le={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ce=new i.FA("app","Firebase",le);class ue{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ce.create("app-deleted",{appName:this._name})}}const de="11.7.3";function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const s=Object.assign({name:Z,automaticDataCollectionEnabled:!1},t),a=s.name;if("string"!==typeof a||!a)throw ce.create("bad-app-name",{appName:String(a)});if(n||(n=(0,i.T9)()),!n)throw ce.create("no-options");const o=te.get(a);if(o){if((0,i.bD)(n,o.options)&&(0,i.bD)(s,o.config))return o;throw ce.create("duplicate-app",{appName:a})}const l=new r.h1(a);for(const r of re.values())l.addComponent(r);const c=new ue(n,s,l);return te.set(a,c),c}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z;const t=te.get(e);if(!t&&e===Z&&(0,i.T9)())return he();if(!t)throw ce.create("no-app",{appName:e});return t}function fe(e,t,n){var s;let i=null!==(s=ee[e])&&void 0!==s?s:e;n&&(i+="-".concat(n));const a=i.match(/\s|\//),o=t.match(/\s|\//);if(a||o){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void E.warn(e.join(" "))}ie(new r.uA("".concat(i,"-version"),(()=>({library:i,version:t})),"VERSION"))}const pe="firebase-heartbeat-store";let ge=null;function ve(){return ge||(ge=function(e,t){let{blocked:n,upgrade:r,blocking:s,terminated:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=v(a);return r&&a.addEventListener("upgradeneeded",(e=>{r(v(a.result),e.oldVersion,e.newVersion,v(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{i&&e.addEventListener("close",(()=>i())),s&&e.addEventListener("versionchange",(e=>s(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(pe)}catch(n){console.warn(n)}}}).catch((e=>{throw ce.create("idb-open",{originalErrorMessage:e.message})}))),ge}async function xe(e,t){try{const n=(await ve()).transaction(pe,"readwrite"),r=n.objectStore(pe);await r.put(t,ye(e)),await n.done}catch(n){if(n instanceof i.g)E.warn(n.message);else{const e=ce.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});E.warn(e.message)}}}function ye(e){return"".concat(e.name,"!").concat(e.options.appId)}class be{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new De(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=we();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){E.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=we(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const s of e){const e=n.find((e=>e.agent===s.agent));if(e){if(e.dates.push(s.date),Ne(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ne(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),s=(0,i.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return E.warn(t),""}}}function we(){return(new Date).toISOString().substring(0,10)}class De{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,i.zW)()&&(0,i.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ve()).transaction(pe),n=await t.objectStore(pe).get(ye(e));return await t.done,n}catch(t){if(t instanceof i.g)E.warn(t.message);else{const e=ce.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});E.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return xe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return xe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ne(e){return(0,i.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var je;je="",ie(new r.uA("platform-logger",(e=>new N(e)),"PRIVATE")),ie(new r.uA("heartbeat",(e=>new be(e)),"PRIVATE")),fe(j,C,je),fe(j,C,"esm2017"),fe("fire-js","")},7234:(e,t)=>{"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,s=e[r];if(!(0<i(s,t)))break e;e[r]=t,e[n]=s,n=r}}function r(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,s=e.length,a=s>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>i(l,n))c<s&&0>i(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<s&&0>i(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,m=3,f=!1,p=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,x="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)s(u);else{if(!(t.startTime<=e))break;s(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(g=!1,b(e),!p)if(null!==r(c))p=!0,I(D);else{var t=r(u);null!==t&&R(w,t.startTime-e)}}function D(e,n){p=!1,g&&(g=!1,x(E),E=-1),f=!0;var i=m;try{for(b(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!S());){var a=h.callback;if("function"===typeof a){h.callback=null,m=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&s(c),b(n)}else s(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&R(w,d.startTime-n),l=!1}return l}finally{h=null,m=i,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,j=!1,C=null,E=-1,A=5,k=-1;function S(){return!(t.unstable_now()-k<A)}function F(){if(null!==C){var e=t.unstable_now();k=e;var n=!0;try{n=C(!0,e)}finally{n?N():(j=!1,C=null)}}else j=!1}if("function"===typeof y)N=function(){y(F)};else if("undefined"!==typeof MessageChannel){var _=new MessageChannel,T=_.port2;_.port1.onmessage=F,N=function(){T.postMessage(null)}}else N=function(){v(F,0)};function I(e){C=e,j||(j=!0,N())}function R(e,n){E=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,I(D))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var n=m;m=t;try{return e()}finally{m=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=m;m=e;try{return t()}finally{m=n}},t.unstable_scheduleCallback=function(e,s,i){var a=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?a+i:a:i=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:s,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>a?(e.sortIndex=i,n(u,e),null===r(c)&&e===r(u)&&(g?(x(E),E=-1):g=!0,R(w,i-a))):(e.sortIndex=o,n(c,e),p||f||(p=!0,I(D))),e},t.unstable_shouldYield=S,t.unstable_wrapCallback=function(e){var t=m;return function(){var n=m;m=t;try{return e.apply(this,arguments)}finally{m=n}}}},7237:(e,t,n)=>{"use strict";e.exports=n(8365)},7294:function(e,t,n){"use strict";var r=(this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(n(4222)),s=n(8146);function i(e,t){var n={};return e&&"string"===typeof e?((0,r.default)(e,(function(e,r){e&&r&&(n[(0,s.camelCase)(e,t)]=r)})),n):n}i.default=i,e.exports=i},7305:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(799)),s=i(n(2778));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t={};for(var n in s.default)s.default.hasOwnProperty(n)&&(e.hasAttribute("jsbarcode-"+n.toLowerCase())&&(t[n]=e.getAttribute("jsbarcode-"+n.toLowerCase())),e.hasAttribute("data-"+n.toLowerCase())&&(t[n]=e.getAttribute("data-"+n.toLowerCase())));return t.value=e.getAttribute("jsbarcode-value")||e.getAttribute("data-value"),t=(0,r.default)(t)}},7587:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6190),a=(r=i)&&r.__esModule?r:{default:r},o=n(1029);var l=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.A_START_CHAR+e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return new RegExp("^"+o.A_CHARS+"+$").test(this.data)}}]),t}(a.default);t.default=l},7626:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.START_BIN="1010",t.END_BIN="11101",t.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]},7754:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(6190)),s=i(n(6441));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}var o=function(e){function t(e,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),/^[\x00-\x7F\xC8-\xD3]+$/.test(e))var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(0,s.default)(e),n));else r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a(r)}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.default);t.default=o},7908:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.marginTop=e.marginTop||e.margin,e.marginBottom=e.marginBottom||e.margin,e.marginRight=e.marginRight||e.margin,e.marginLeft=e.marginLeft||e.margin,e}},7950:(e,t,n)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(2730)},8146:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.camelCase=void 0;var n=/^--[a-zA-Z0-9_-]+$/,r=/-([a-z])/g,s=/^[^-]+$/,i=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,o=function(e,t){return t.toUpperCase()},l=function(e,t){return"".concat(t,"-")};t.camelCase=function(e,t){return void 0===t&&(t={}),function(e){return!e||s.test(e)||n.test(e)}(e)?e:(e=e.toLowerCase(),(e=t.reactCompat?e.replace(a,l):e.replace(i,l)).replace(r,o))}},8147:(e,t,n)=>{"use strict";n.d(t,{XR:()=>ze,qk:()=>Be,c7:()=>qe,KR:()=>Ue,D:()=>Me,bp:()=>Le});var r=n(7150),s=n(1529),i=n(8812);const a="firebasestorage.googleapis.com",o="storageBucket";class l extends s.g{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(d(e),"Firebase Storage: ".concat(t," (").concat(d(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,l.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return d(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var c,u;function d(e){return"storage/"+e}function h(){return new l(c.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function m(){return new l(c.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function f(){return new l(c.CANCELED,"User canceled the upload/download.")}function p(){return new l(c.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function g(e){return new l(c.INVALID_ARGUMENT,e)}function v(){return new l(c.APP_DELETED,"The Firebase app was deleted.")}function x(e,t){return new l(c.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function y(e){throw new l(c.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(c||(c={}));class b{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=b.makeFromUrl(e,t)}catch(s){return new b(e,"")}if(""===n.path)return n;throw r=e,new l(c.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const s=new RegExp("^gs://"+r+"(/(.*))?$","i");function i(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),u=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:i},{regex:new RegExp("^https?://".concat(t===a?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:i}];for(let a=0;a<u.length;a++){const t=u[a],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let s=r[t.indices.path];s||(s=""),n=new b(e,s),t.postModify(n);break}}if(null==n)throw function(e){return new l(c.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class w{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function D(e){return"string"===typeof e||e instanceof String}function N(e){return j()&&e instanceof Blob}function j(){return"undefined"!==typeof Blob}function C(e,t,n,r){if(r<t)throw g("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw g("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function E(e,t,n){let r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function A(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function k(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),s=-1!==t.indexOf(e);return n||r||s}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(u||(u={}));class S{constructor(e,t,n,r,s,i,a,o,l,c,u){let d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],h=arguments.length>12&&void 0!==arguments[12]&&arguments[12];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=i,this.callback_=a,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=d,this.isUsingEmulator=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new F(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===u.NO_ERROR,s=n.getStatus();if(!t||k(s,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===u.ABORT;return void e(!1,new F(!1,null,t))}const i=-1!==this.successCodes_.indexOf(s);e(!0,new F(i,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,s=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(s,s.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(i){r(i)}else if(null!==s){const e=h();e.serverResponse=s.getErrorText(),this.errorCallback_?r(this.errorCallback_(s,e)):r(e)}else if(t.canceled){r(this.appDelete_?v():f())}else{r(m())}};this.canceled_?t(0,new F(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,s=null,i=null,a=!1,o=0;function l(){return 2===o}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function d(t){s=setTimeout((()=>{s=null,e(m,l())}),t)}function h(){i&&clearTimeout(i)}function m(e){if(c)return void h();for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];if(e)return h(),void u.call(null,e,...n);if(l()||a)return h(),void u.call(null,e,...n);let i;r<64&&(r*=2),1===o?(o=2,i=0):i=1e3*(r+Math.random()),d(i)}let f=!1;function p(e){f||(f=!0,h(),c||(null!==s?(e||(o=2),clearTimeout(s),d(0)):e||(o=1)))}return d(0),i=setTimeout((()=>{a=!0,p(!0)}),n),p}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class F{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function _(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function T(){const e=_();for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){const t=new e;for(let e=0;e<n.length;e++)t.append(n[e]);return t.getBlob()}if(j())return new Blob(n);throw new l(c.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function I(e){if("undefined"===typeof atob)throw t="base-64",new l(c.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const R="raw",P="base64",O="base64url",M="data_url";class L{constructor(e,t){this.data=e,this.contentType=t||null}}function B(e,t){switch(e){case R:return new L(z(t));case P:case O:return new L(U(e,t));case M:return new L(function(e){const t=new q(e);return t.base64?U(P,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw x(M,"Malformed data URL.")}return z(t)}(t.rest)}(t),new q(t).contentType)}throw h()}function z(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function U(e,t){switch(e){case P:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw x(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case O:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw x(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=I(t)}catch(s){if(s.message.includes("polyfill"))throw s;throw x(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class q{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw x(M,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class V{constructor(e,t){let n=0,r="";N(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(N(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new V(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new V(n,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(j()){const e=t.map((e=>e instanceof V?e.data_:e));return new V(T.apply(null,e))}{const e=t.map((e=>D(e)?B(R,e).data:e.data_));let n=0;e.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let s=0;return e.forEach((e=>{for(let t=0;t<e.length;t++)r[s++]=e[t]})),new V(r,!0)}}uploadData(){return this.data_}}function H(e){let t;try{t=JSON.parse(e)}catch(n){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function W(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function G(e,t){return t}class K{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||G}}let Q=null;function Y(){if(Q)return Q;const e=[];e.push(new K("bucket")),e.push(new K("generation")),e.push(new K("metageneration")),e.push(new K("name","fullPath",!0));const t=new K("name");t.xform=function(e,t){return function(e){return!D(e)||e.length<2?e:W(e)}(t)},e.push(t);const n=new K("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new K("timeCreated")),e.push(new K("updated")),e.push(new K("md5Hash",null,!0)),e.push(new K("cacheControl",null,!0)),e.push(new K("contentDisposition",null,!0)),e.push(new K("contentEncoding",null,!0)),e.push(new K("contentLanguage",null,!0)),e.push(new K("contentType",null,!0)),e.push(new K("metadata","customMetadata",!0)),Q=e,Q}function J(e,t,n){const r={type:"file"},s=n.length;for(let i=0;i<s;i++){const e=n[i];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,s=new b(n,r);return t._makeStorageReference(s)}})}(r,e),r}function X(e,t,n){const r=H(t);if(null===r)return null;return J(e,r,n)}function $(e,t){const n={},r=t.length;for(let s=0;s<r;s++){const r=t[s];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class Z{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function ee(e){if(!e)throw h()}function te(e,t){return function(n,r){const s=X(e,r,t);return ee(null!==s),s}}function ne(e,t){return function(n,r){const s=X(e,r,t);return ee(null!==s),function(e,t,n,r){const s=H(t);if(null===s)return null;if(!D(s.downloadTokens))return null;const i=s.downloadTokens;if(0===i.length)return null;const a=encodeURIComponent;return i.split(",").map((t=>{const s=e.bucket,i=e.fullPath;return E("/b/"+a(s)+"/o/"+a(i),n,r)+A({alt:"media",token:t})}))[0]}(s,r,e.host,e._protocol)}}function re(e){return function(t,n){let r;var s,i;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new l(c.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new l(c.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new l(c.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(s=e.path,r=new l(c.UNAUTHORIZED,"User does not have permission to access '"+s+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function se(e){const t=re(e);return function(n,r){let s=t(n,r);var i;return 404===n.getStatus()&&(i=e.path,s=new l(c.OBJECT_NOT_FOUND,"Object '"+i+"' does not exist.")),s.serverResponse=r.serverResponse,s}}function ie(e,t,n){const r=E(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,i=new Z(r,"GET",te(e,n),s);return i.errorHandler=se(t),i}function ae(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function oe(e,t,n,r,s){const i=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};const o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+o;const l=ae(t,r,s),c="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+$(l,n)+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",u="\r\n--"+o+"--",d=V.getBlob(c,r,u);if(null===d)throw p();const h={name:l.fullPath},m=E(i,e.host,e._protocol),f=e.maxUploadRetryTime,g=new Z(m,"POST",te(e,n),f);return g.urlParams=h,g.headers=a,g.body=d.uploadData(),g.errorHandler=re(t),g}class le{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function ce(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){ee(!1)}return ee(!!n&&-1!==(t||["active"]).indexOf(n)),n}const ue=262144;function de(e,t,n,r,s,i,a,o){const u=new le(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new l(c.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");const d=u.total-u.current;let h=d;s>0&&(h=Math.min(h,s));const m=u.current,f=m+h;let g="";g=0===h?"finalize":d===h?"upload, finalize":"upload";const v={"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":"".concat(u.current)},x=r.slice(m,f);if(null===x)throw p();const y=t.maxUploadRetryTime,b=new Z(n,"POST",(function(e,n){const s=ce(e,["active","final"]),a=u.current+h,o=r.size();let l;return l="final"===s?te(t,i)(e,n):null,new le(a,o,"final"===s,l)}),y);return b.headers=v,b.body=x.uploadData(),b.progressCallback=o||null,b.errorHandler=re(e),b}const he="running",me="paused",fe="success",pe="canceled",ge="error";function ve(e){switch(e){case"running":case"pausing":case"canceling":return he;case"paused":return me;case"success":return fe;case"canceled":return pe;default:return ge}}class xe{constructor(e,t,n){if(function(e){return"function"===typeof e}(e)||null!=t||null!=n)this.next=e,this.error=null!==t&&void 0!==t?t:void 0,this.complete=null!==n&&void 0!==n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function ye(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];Promise.resolve().then((()=>e(...n)))}}let be=null;class we{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=u.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=u.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=u.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r,i){if(this.sent_)throw y("cannot .send() more than once");if((0,s.zJ)(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw y("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw y("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw y("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw y("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class De extends we{initXhr(){this.xhr_.responseType="text"}}function Ne(){return be?be():new De}class je{isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=Y(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(c.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if(k(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();e=m()}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(c.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((()=>{this.pendingTimeout=void 0,this._continueUpload()}),this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((t=>{let[n,r]=t;switch(this._state){case"running":e(n,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,s){const i=t.bucketOnlyServerUrl(),a=ae(t,r,s),o={name:a.fullPath},l=E(i,e.host,e._protocol),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":"".concat(r.size()),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},u=$(a,n),d=e.maxUploadRetryTime,h=new Z(l,"POST",(function(e){let t;ce(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(n){ee(!1)}return ee(D(t)),t}),d);return h.urlParams=o,h.headers=c,h.body=u,h.errorHandler=re(t),h}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,Ne,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const s=e.maxUploadRetryTime,i=new Z(n,"POST",(function(e){const t=ce(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(i){ee(!1)}n||ee(!1);const s=Number(n);return ee(!isNaN(s)),new le(s,r.size(),"final"===t)}),s);return i.headers={"X-Goog-Upload-Command":"query"},i.errorHandler=re(t),i}(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(r,Ne,t,n);this._request=s,s.getPromise().then((e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=ue*this._chunkMultiplier,t=new le(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,s)=>{let i;try{i=de(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(o){return this._error=o,void this._transition("error")}const a=this._ref.storage._makeRequest(i,Ne,r,s,!1);this._request=a,a.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){2*(ue*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=ie(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,Ne,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=oe(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,Ne,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=f(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=ve(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const s=new xe(t||void 0,n||void 0,r||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(ve(this._state)){case fe:ye(this._resolve.bind(null,this.snapshot))();break;case pe:case ge:ye(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(ve(this._state)){case he:case me:e.next&&ye(e.next.bind(e,this.snapshot))();break;case fe:e.complete&&ye(e.complete.bind(e))();break;default:e.error&&ye(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Ce{constructor(e,t){this._service=e,this._location=t instanceof b?t:b.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ce(e,t)}get root(){const e=new b(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return W(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new b(this._location.bucket,e);return new Ce(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new l(c.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Ee(e,t,n){e._throwIfRoot("uploadBytes");const r=oe(e.storage,e._location,Y(),new V(t,!0),n);return e.storage.makeRequestWithTokens(r,Ne).then((t=>({metadata:t,ref:e})))}function Ae(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=E(t.fullServerUrl(),e.host,e._protocol),s=e.maxOperationRetryTime,i=new Z(r,"GET",ne(e,n),s);return i.errorHandler=se(t),i}(e.storage,e._location,Y());return e.storage.makeRequestWithTokens(t,Ne).then((e=>{if(null===e)throw new l(c.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function ke(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=E(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,s=new Z(n,"DELETE",(function(e,t){}),r);return s.successCodes=[200,204],s.errorHandler=se(t),s}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,Ne)}function Se(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new b(e._location.bucket,n);return new Ce(e.storage,r)}function Fe(e,t){if(e instanceof Ie){const n=e;if(null==n._bucket)throw new l(c.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+o+"' property when initializing the app?");const r=new Ce(n,n._bucket);return null!=t?Fe(r,t):r}return void 0!==t?Se(e,t):e}function _e(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Ie)return new Ce(e,t);throw g("To use ref(service, url), the first argument must be a Storage instance.")}return Fe(e,t)}function Te(e,t){const n=null===t||void 0===t?void 0:t[o];return null==n?null:b.makeFromBucketSpec(n,e)}class Ie{constructor(e,t,n,r,s){let i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=s,this._isUsingEmulator=i,this._bucket=null,this._host=a,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?b.makeFromBucketSpec(r,this._host):Te(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=b.makeFromBucketSpec(this._url,e):this._bucket=Te(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){C("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){C("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if((0,r.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ce(this,e)}_makeRequest(e,t,n,r){let s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new w(v());{const i=function(e,t,n,r,s,i){let a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=A(e.urlParams),c=e.url+l,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(u,i),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,r),new S(c,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,s,a,o)}(e,this._appId,n,r,t,this._firebaseVersion,s,this._isUsingEmulator);return this._requests.add(i),i.getPromise().then((()=>this._requests.delete(i)),(()=>this._requests.delete(i))),i}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Re="@firebase/storage",Pe="0.13.10",Oe="storage";function Me(e,t,n){return Ee(e=(0,s.Ku)(e),t,n)}function Le(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new je(e,new V(t),n)}(e=(0,s.Ku)(e),t,n)}function Be(e){return Ae(e=(0,s.Ku)(e))}function ze(e){return ke(e=(0,s.Ku)(e))}function Ue(e,t){return _e(e=(0,s.Ku)(e),t)}function qe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,r.Sx)(),t=arguments.length>1?arguments[1]:void 0;e=(0,s.Ku)(e),(0,s.P1)("Storage",!1);const n=(0,r.j6)(e,Oe).getImmediate({identifier:t}),i=(0,s.yU)("storage");return i&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n);const i=(0,s.zJ)(t);i&&((0,s.gE)("https://".concat(e.host)),(0,s.P1)("Storage",!0)),e._isUsingEmulator=!0,e._protocol=i?"https":"http";const{mockUserToken:a}=r;a&&(e._overrideAuthToken="string"===typeof a?a:(0,s.Fy)(a,e.app.options.projectId))}(e,t,n,r)}(n,...i),n}function Ve(e,t){let{instanceIdentifier:n}=t;const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new Ie(s,i,a,n,r.MF)}(0,r.om)(new i.uA(Oe,Ve,"PUBLIC").setMultipleInstances(!0)),(0,r.KO)(Re,Pe,""),(0,r.KO)(Re,Pe,"esm2017")},8176:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(2522)),s=a(n(2978)),i=a(n(1157));function a(e){return e&&e.__esModule?e:{default:e}}t.default={CanvasRenderer:r.default,SVGRenderer:s.default,ObjectRenderer:i.default}},8365:(e,t,n)=>{"use strict";var r=n(5043);var s="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},i=r.useSyncExternalStore,a=r.useRef,o=r.useEffect,l=r.useMemo,c=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,u){var d=a(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=l((function(){function e(e){if(!o){if(o=!0,i=e,e=r(e),void 0!==u&&h.hasValue){var t=h.value;if(u(t,e))return a=t}return a=e}if(t=a,s(i,e))return t;var n=r(e);return void 0!==u&&u(t,n)?(i=e,t):(i=e,a=n)}var i,a,o=!1,l=void 0===n?null:n;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]}),[t,n,r,u]);var m=i(e,d[0],d[1]);return o((function(){h.hasValue=!0,h.value=m}),[m]),c(m),m}},8387:(e,t,n)=>{"use strict";function r(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=r(e[t]))&&(s&&(s+=" "),s+=n)}else for(n in e)e[n]&&(s&&(s+=" "),s+=n);return s}function s(){for(var e,t,n=0,s="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=r(e))&&(s&&(s+=" "),s+=t);return s}n.d(t,{$:()=>s})},8807:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(5310),a=(r=i)&&r.__esModule?r:{default:r};var o=function(e){var t=e.substr(0,13).split("").map((function(e){return parseInt(e,10)})).reduce((function(e,t,n){return e+t*(3-n%2*2)}),0);return 10*Math.ceil(t/10)-t},l=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),-1!==e.search(/^[0-9]{13}$/)&&(e+=o(e)),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===o(this.data)}}]),t}(a.default);t.default=l},8812:(e,t,n)=>{"use strict";n.d(t,{h1:()=>o,uA:()=>s});var r=n(1529);class s{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const i="[DEFAULT]";class a{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:i})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&i.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),s=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===i?void 0:s),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var s;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return this.component?this.component.multipleInstances?e:i:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},8853:(e,t,n)=>{"use strict";e.exports=n(7234)},8859:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPCE=t.UPC=t.EAN2=t.EAN5=t.EAN8=t.EAN13=void 0;var r=c(n(2179)),s=c(n(6843)),i=c(n(2352)),a=c(n(917)),o=c(n(4709)),l=c(n(422));function c(e){return e&&e.__esModule?e:{default:e}}t.EAN13=r.default,t.EAN8=s.default,t.EAN5=i.default,t.EAN2=a.default,t.UPC=o.default,t.UPCE=l.default},8997:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mod10=function(e){for(var t=0,n=0;n<e.length;n++){var r=parseInt(e[n]);(n+e.length)%2===0?t+=r:t+=2*r%10+Math.floor(2*r/10)}return(10-t%10)%10},t.mod11=function(e){for(var t=0,n=[2,3,4,5,6,7],r=0;r<e.length;r++){var s=parseInt(e[e.length-1-r]);t+=n[r%n.length]*s}return(11-t%11)%11}},9007:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9918);t.default=function(e,t,n){var s=e.split("").map((function(e,n){return r.BINARIES[t[n]]})).map((function(t,n){return t?t[e[n]]:""}));if(n){var i=e.length-1;s=s.map((function(e,t){return t<i?e+n:e}))}return s.join("")}},9011:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9918),i=a(n(9007));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.fontSize=!n.flat&&n.fontSize>10*n.width?10*n.width:n.fontSize,r.guardHeight=n.height+r.fontSize/2+n.textMargin,r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(e,t){return this.text.substr(e,t)}},{key:"leftEncode",value:function(e,t){return(0,i.default)(e,t)}},{key:"rightText",value:function(e,t){return this.text.substr(e,t)}},{key:"rightEncode",value:function(e,t){return(0,i.default)(e,t)}},{key:"encodeGuarded",value:function(){var e={fontSize:this.fontSize},t={height:this.guardHeight};return[{data:s.SIDE_BIN,options:t},{data:this.leftEncode(),text:this.leftText(),options:e},{data:s.MIDDLE_BIN,options:t},{data:this.rightEncode(),text:this.rightText(),options:e},{data:s.SIDE_BIN,options:t}]}},{key:"encodeFlat",value:function(){return{data:[s.SIDE_BIN,this.leftEncode(),s.MIDDLE_BIN,this.rightEncode(),s.SIDE_BIN].join(""),text:this.text}}}]),t}(a(n(5301)).default);t.default=o},9224:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.default=function(e,t){return n({},e,t)}},9298:(e,t,n)=>{"use strict";var r=h(n(5865)),s=h(n(9224)),i=h(n(4238)),a=h(n(7908)),o=h(n(2922)),l=h(n(799)),c=h(n(1466)),u=n(3530),d=h(n(2778));function h(e){return e&&e.__esModule?e:{default:e}}var m=function(){},f=function(e,t,n){var r=new m;if("undefined"===typeof e)throw Error("No element to render on was provided.");return r._renderProperties=(0,o.default)(e),r._encodings=[],r._options=d.default,r._errorHandler=new c.default(r),"undefined"!==typeof t&&((n=n||{}).format||(n.format=x()),r.options(n)[n.format](t,n).render()),r};for(var p in f.getModule=function(e){return r.default[e]},r.default)r.default.hasOwnProperty(p)&&g(r.default,p);function g(e,t){m.prototype[t]=m.prototype[t.toUpperCase()]=m.prototype[t.toLowerCase()]=function(n,r){var i=this;return i._errorHandler.wrapBarcodeCall((function(){r.text="undefined"===typeof r.text?void 0:""+r.text;var a=(0,s.default)(i._options,r);a=(0,l.default)(a);var o=e[t],c=v(n,o,a);return i._encodings.push(c),i}))}}function v(e,t,n){var r=new t(e=""+e,n);if(!r.valid())throw new u.InvalidInputException(r.constructor.name,e);var a=r.encode();a=(0,i.default)(a);for(var o=0;o<a.length;o++)a[o].options=(0,s.default)(n,a[o].options);return a}function x(){return r.default.CODE128?"CODE128":Object.keys(r.default)[0]}function y(e,t,n){t=(0,i.default)(t);for(var r=0;r<t.length;r++)t[r].options=(0,s.default)(n,t[r].options),(0,a.default)(t[r].options);(0,a.default)(n),new(0,e.renderer)(e.element,t,n).render(),e.afterRender&&e.afterRender()}m.prototype.options=function(e){return this._options=(0,s.default)(this._options,e),this},m.prototype.blank=function(e){var t=new Array(e+1).join("0");return this._encodings.push({data:t}),this},m.prototype.init=function(){var e;if(this._renderProperties)for(var t in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){e=this._renderProperties[t];var n=(0,s.default)(this._options,e.options);"auto"==n.format&&(n.format=x()),this._errorHandler.wrapBarcodeCall((function(){var t=v(n.value,r.default[n.format.toUpperCase()],n);y(e,t,n)}))}},m.prototype.render=function(){if(!this._renderProperties)throw new u.NoElementException;if(Array.isArray(this._renderProperties))for(var e=0;e<this._renderProperties.length;e++)y(this._renderProperties[e],this._encodings,this._options);else y(this._renderProperties,this._encodings,this._options);return this},m.prototype._defaults=d.default,"undefined"!==typeof window&&(window.JsBarcode=f),"undefined"!==typeof jQuery&&(jQuery.fn.JsBarcode=function(e,t){var n=[];return jQuery(this).each((function(){n.push(this)})),f(n,e,t)}),e.exports=f},9526:(e,t,n)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function s(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=r(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}n.d(t,{A:()=>s})},9766:(e,t,n)=>{"use strict";n.d(t,{uV:()=>ee,wU:()=>Z,cn:()=>$,H4:()=>te});var r=n(8387),s=n(7051);const i=(e,t)=>{var n;if(0===e.length)return t.classGroupId;const r=e[0],s=t.nextPart.get(r),a=s?i(e.slice(1),s):void 0;if(a)return a;if(0===t.validators.length)return;const o=e.join("-");return null===(n=t.validators.find((e=>{let{validator:t}=e;return t(o)})))||void 0===n?void 0:n.classGroupId},a=/^\[(.+)\]$/,o=e=>{if(a.test(e)){const t=a.exec(e)[1],n=null===t||void 0===t?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},l=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return h(Object.entries(e.classGroups),n).forEach((e=>{let[n,s]=e;c(s,r,n,t)})),r},c=(e,t,n,r)=>{e.forEach((e=>{if("string"!==typeof e){if("function"===typeof e)return d(e)?void c(e(r),t,n,r):void t.validators.push({validator:e,classGroupId:n});Object.entries(e).forEach((e=>{let[s,i]=e;c(i,u(t,s),n,r)}))}else{(""===e?t:u(t,e)).classGroupId=n}}))},u=(e,t)=>{let n=e;return t.split("-").forEach((e=>{n.nextPart.has(e)||n.nextPart.set(e,{nextPart:new Map,validators:[]}),n=n.nextPart.get(e)})),n},d=e=>e.isThemeGetter,h=(e,t)=>t?e.map((e=>{let[n,r]=e;return[n,r.map((e=>"string"===typeof e?t+e:"object"===typeof e?Object.fromEntries(Object.entries(e).map((e=>{let[n,r]=e;return[t+n,r]}))):e))]})):e,m=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(s,i)=>{n.set(s,i),t++,t>e&&(t=0,r=n,n=new Map)};return{get(e){let t=n.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(s(e,t),t):void 0},set(e,t){n.has(e)?n.set(e,t):s(e,t)}}},f=e=>{const{separator:t,experimentalParseClassName:n}=e,r=1===t.length,s=t[0],i=t.length,a=e=>{const n=[];let a,o=0,l=0;for(let d=0;d<e.length;d++){let c=e[d];if(0===o){if(c===s&&(r||e.slice(d,d+i)===t)){n.push(e.slice(l,d)),l=d+i;continue}if("/"===c){a=d;continue}}"["===c?o++:"]"===c&&o--}const c=0===n.length?e:e.substring(l),u=c.startsWith("!");return{modifiers:n,hasImportantModifier:u,baseClassName:u?c.substring(1):c,maybePostfixModifierPosition:a&&a>l?a-l:void 0}};return n?e=>n({className:e,parseClassName:a}):a},p=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach((e=>{"["===e[0]?(t.push(...n.sort(),e),n=[]):n.push(e)})),t.push(...n.sort()),t},g=e=>(0,s.A)({cache:m(e.cacheSize),parseClassName:f(e)},(e=>{const t=l(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:e=>{const n=e.split("-");return""===n[0]&&1!==n.length&&n.shift(),i(n,t)||o(e)},getConflictingClassGroupIds:(e,t)=>{const s=n[e]||[];return t&&r[e]?[...s,...r[e]]:s}}})(e)),v=/\s+/;function x(){let e,t,n=0,r="";for(;n<arguments.length;)(e=arguments[n++])&&(t=y(e))&&(r&&(r+=" "),r+=t);return r}const y=e=>{if("string"===typeof e)return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=y(e[r]))&&(n&&(n+=" "),n+=t);return n};function b(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let s,i,a,o=function(t){const r=n.reduce(((e,t)=>t(e)),e());return s=g(r),i=s.cache.get,a=s.cache.set,o=l,l(t)};function l(e){const t=i(e);if(t)return t;const n=((e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=t,i=[],a=e.trim().split(v);let o="";for(let l=a.length-1;l>=0;l-=1){const e=a[l],{modifiers:t,hasImportantModifier:c,baseClassName:u,maybePostfixModifierPosition:d}=n(e);let h=Boolean(d),m=r(h?u.substring(0,d):u);if(!m){if(!h){o=e+(o.length>0?" "+o:o);continue}if(m=r(u),!m){o=e+(o.length>0?" "+o:o);continue}h=!1}const f=p(t).join(":"),g=c?f+"!":f,v=g+m;if(i.includes(v))continue;i.push(v);const x=s(m,h);for(let n=0;n<x.length;++n){const e=x[n];i.push(g+e)}o=e+(o.length>0?" "+o:o)}return o})(e,s);return a(e,n),n}return function(){return o(x.apply(null,arguments))}}const w=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},D=/^\[(?:([a-z-]+):)?(.+)\]$/i,N=/^\d+\/\d+$/,j=new Set(["px","full","screen"]),C=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,E=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,A=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,k=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,S=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,F=e=>T(e)||j.has(e)||N.test(e),_=e=>W(e,"length",G),T=e=>Boolean(e)&&!Number.isNaN(Number(e)),I=e=>W(e,"number",T),R=e=>Boolean(e)&&Number.isInteger(Number(e)),P=e=>e.endsWith("%")&&T(e.slice(0,-1)),O=e=>D.test(e),M=e=>C.test(e),L=new Set(["length","size","percentage"]),B=e=>W(e,L,K),z=e=>W(e,"position",K),U=new Set(["image","url"]),q=e=>W(e,U,Y),V=e=>W(e,"",Q),H=()=>!0,W=(e,t,n)=>{const r=D.exec(e);return!!r&&(r[1]?"string"===typeof t?r[1]===t:t.has(r[1]):n(r[2]))},G=e=>E.test(e)&&!A.test(e),K=()=>!1,Q=e=>k.test(e),Y=e=>S.test(e),J=(Symbol.toStringTag,()=>{const e=w("colors"),t=w("spacing"),n=w("blur"),r=w("brightness"),s=w("borderColor"),i=w("borderRadius"),a=w("borderSpacing"),o=w("borderWidth"),l=w("contrast"),c=w("grayscale"),u=w("hueRotate"),d=w("invert"),h=w("gap"),m=w("gradientColorStops"),f=w("gradientColorStopPositions"),p=w("inset"),g=w("margin"),v=w("opacity"),x=w("padding"),y=w("saturate"),b=w("scale"),D=w("sepia"),N=w("skew"),j=w("space"),C=w("translate"),E=()=>["auto",O,t],A=()=>[O,t],k=()=>["",F,_],S=()=>["auto",T,O],L=()=>["","0",O],U=()=>[T,O];return{cacheSize:500,separator:":",theme:{colors:[H],spacing:[F,_],blur:["none","",M,O],brightness:U(),borderColor:[e],borderRadius:["none","","full",M,O],borderSpacing:A(),borderWidth:k(),contrast:U(),grayscale:L(),hueRotate:U(),invert:L(),gap:A(),gradientColorStops:[e],gradientColorStopPositions:[P,_],inset:E(),margin:E(),opacity:U(),padding:A(),saturate:U(),scale:U(),sepia:L(),skew:U(),space:A(),translate:A()},classGroups:{aspect:[{aspect:["auto","square","video",O]}],container:["container"],columns:[{columns:[M]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",O]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",R,O]}],basis:[{basis:E()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",O]}],grow:[{grow:L()}],shrink:[{shrink:L()}],order:[{order:["first","last","none",R,O]}],"grid-cols":[{"grid-cols":[H]}],"col-start-end":[{col:["auto",{span:["full",R,O]},O]}],"col-start":[{"col-start":S()}],"col-end":[{"col-end":S()}],"grid-rows":[{"grid-rows":[H]}],"row-start-end":[{row:["auto",{span:[R,O]},O]}],"row-start":[{"row-start":S()}],"row-end":[{"row-end":S()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",O]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",O]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[j]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[j]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",O,t]}],"min-w":[{"min-w":[O,t,"min","max","fit"]}],"max-w":[{"max-w":[O,t,"none","full","min","max","fit","prose",{screen:[M]},M]}],h:[{h:[O,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[O,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[O,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[O,t,"auto","min","max","fit"]}],"font-size":[{text:["base",M,_]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",I]}],"font-family":[{font:[H]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",O]}],"line-clamp":[{"line-clamp":["none",T,I]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",F,O]}],"list-image":[{"list-image":["none",O]}],"list-style-type":[{list:["none","disc","decimal",O]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",F,_]}],"underline-offset":[{"underline-offset":["auto",F,O]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:A()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",O]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",O]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",z]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",B]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},q]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[F,O]}],"outline-w":[{outline:[F,_]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:k()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[F,_]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",M,V]}],"shadow-color":[{shadow:[H]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",M,O]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[y]}],sepia:[{sepia:[D]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[D]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",O]}],duration:[{duration:U()}],ease:[{ease:["linear","in","out","in-out",O]}],delay:[{delay:U()}],animate:[{animate:["none","spin","ping","pulse","bounce",O]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[R,O]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",O]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",O]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":A()}],"scroll-mx":[{"scroll-mx":A()}],"scroll-my":[{"scroll-my":A()}],"scroll-ms":[{"scroll-ms":A()}],"scroll-me":[{"scroll-me":A()}],"scroll-mt":[{"scroll-mt":A()}],"scroll-mr":[{"scroll-mr":A()}],"scroll-mb":[{"scroll-mb":A()}],"scroll-ml":[{"scroll-ml":A()}],"scroll-p":[{"scroll-p":A()}],"scroll-px":[{"scroll-px":A()}],"scroll-py":[{"scroll-py":A()}],"scroll-ps":[{"scroll-ps":A()}],"scroll-pe":[{"scroll-pe":A()}],"scroll-pt":[{"scroll-pt":A()}],"scroll-pr":[{"scroll-pr":A()}],"scroll-pb":[{"scroll-pb":A()}],"scroll-pl":[{"scroll-pl":A()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",O]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[F,_,I]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}),X=b(J);function $(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return X((0,r.$)(t))}const Z={NETWORK:"network",PERMISSION:"permission",NOT_FOUND:"not_found",VALIDATION:"validation",SERVER:"server",UNKNOWN:"unknown"};class ee extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.UNKNOWN,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(e),this.name="AppError",this.type=t,this.originalError=n}}const te=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e instanceof ee?e:(e=>{const t=(null===e||void 0===e?void 0:e.code)||"";return t.includes("permission-denied")?new ee("You don't have permission to perform this action",Z.PERMISSION,e):t.includes("unavailable")||t.includes("network-request-failed")?new ee("Network connection issue. Please check your internet connection",Z.NETWORK,e):t.includes("not-found")?new ee("The requested resource was not found",Z.NOT_FOUND,e):t.includes("invalid-argument")?new ee("Invalid input provided",Z.VALIDATION,e):t.includes("internal")?new ee("Server error occurred. Please try again later",Z.SERVER,e):new ee((null===e||void 0===e?void 0:e.message)||"An unexpected error occurred",Z.UNKNOWN,e)})(e);return console.error("Error in ".concat(t,":"),n),n.originalError&&console.error("Original error:",n.originalError),n}},9918:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SIDE_BIN="101",t.MIDDLE_BIN="01010",t.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},t.EAN2_STRUCTURE=["LL","LG","GL","GG"],t.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],t.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,s){if(1&s&&(r=this(r)),8&s)return r;if("object"===typeof r&&r){if(4&s&&r.__esModule)return r;if(16&s&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var o=2&s&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,n.d(i,a),i}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,(()=>{"use strict";var e={};n.r(e),n.d(e,{boolean:()=>Jp,booleanish:()=>Xp,commaOrSpaceSeparated:()=>ng,commaSeparated:()=>tg,number:()=>Zp,overloadedBoolean:()=>$p,spaceSeparated:()=>eg});var t={};n.r(t),n.d(t,{attentionMarkers:()=>Fx,contentInitial:()=>jx,disable:()=>_x,document:()=>Nx,flow:()=>Ex,flowInitial:()=>Cx,insideSpan:()=>Sx,string:()=>Ax,text:()=>kx});var r=n(5043),s=n.t(r,2),i=n(4391),a=n(3986),o=n(7051);n(3175);const l=["sri"],c=["page"],u=["page","matches"],d=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],h=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],m=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var f="popstate";function p(){return D((function(e,t){let{pathname:n,search:r,hash:s}=e.location;return y("",{pathname:n,search:r,hash:s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:b(t)}),null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function g(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function v(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Jh){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function y(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return(0,o.A)((0,o.A)({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?w(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function b(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function w(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function D(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,l="POP",c=null,u=d();function d(){return(a.state||{idx:null}).idx}function h(){l="POP";let e=d(),t=null==e?null:e-u;u=e,c&&c({action:l,location:p.location,delta:t})}function m(e){return N(e)}null==u&&(u=0,a.replaceState((0,o.A)((0,o.A)({},a.state),{},{idx:u}),""));let p={get action(){return l},get location(){return e(s,a)},listen(e){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(f,h),c=e,()=>{s.removeEventListener(f,h),c=null}},createHref:e=>t(s,e),createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let r=y(p.location,e,t);n&&n(r,e),u=d()+1;let o=x(r,u),h=p.createHref(r);try{a.pushState(o,"",h)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;s.location.assign(h)}i&&c&&c({action:l,location:p.location,delta:1})},replace:function(e,t){l="REPLACE";let r=y(p.location,e,t);n&&n(r,e),u=d();let s=x(r,u),o=p.createHref(r);a.replaceState(s,"",o),i&&c&&c({action:l,location:p.location,delta:0})},go:e=>a.go(e)};return p}function N(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),g(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:b(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function j(e,t){return C(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function C(e,t,n,r){let s=z(("string"===typeof t?w(t):t).pathname||"/",n);if(null==s)return null;let i=E(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let a=null;for(let o=0;null==a&&o<i.length;++o){let e=B(s);a=O(i[o],e,r)}return a}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=(e,s,i)=>{let a={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};a.relativePath.startsWith("/")&&(g(a.relativePath.startsWith(r),'Absolute route path "'.concat(a.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),a.relativePath=a.relativePath.slice(r.length));let o=W([r,a.relativePath]),l=n.concat(a);e.children&&e.children.length>0&&(g(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(o,'".')),E(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:P(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of A(e.path))s(e,t,r);else s(e,t)})),t}function A(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(0===r.length)return s?[i,""]:[i];let a=A(r.join("/")),o=[];return o.push(...a.map((e=>""===e?i:[i,e].join("/")))),s&&o.push(...a),o.map((t=>e.startsWith("/")&&""===t?"/":t))}var k=/^:[\w-]+$/,S=3,F=2,_=1,T=10,I=-2,R=e=>"*"===e;function P(e,t){let n=e.split("/"),r=n.length;return n.some(R)&&(r+=I),t&&(r+=F),n.filter((e=>!R(e))).reduce(((e,t)=>e+(k.test(t)?S:""===t?_:T)),r)}function O(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,s={},i="/",a=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===i?t:t.slice(i.length)||"/",u=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),d=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=M({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(s,u.params),a.push({params:s,pathname:W([i,u.pathname]),pathnameBase:G(W([i,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(i=W([i,u.pathnameBase]))}return a}function M(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=L(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1),l=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:s}=t;if("*"===r){let e=o[n]||"";a=i.slice(0,i.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=s&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:i,pathnameBase:a,pattern:e}}function L(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];v("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));return e.endsWith("*")?(r.push({paramName:"*"}),s+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":""!==e&&"/"!==e&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function B(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return v(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function z(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function U(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function q(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function V(e){let t=q(e);return t.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase))}function H(e,t,n){let r,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=w(e):(r=(0,o.A)({},e),g(!r.pathname||!r.pathname.includes("?"),U("?","pathname","search",r)),g(!r.pathname||!r.pathname.includes("#"),U("#","pathname","hash",r)),g(!r.search||!r.search.includes("#"),U("#","search","hash",r)));let i,a=""===e||""===r.pathname,l=a?"/":r.pathname;if(null==l)i=n;else{let e=t.length-1;if(!s&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}i=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:r="",hash:s=""}="string"===typeof e?w(e):e,i=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:i,search:K(r),hash:Q(s)}}(r,i),u=l&&"/"!==l&&l.endsWith("/"),d=(a||"."===l)&&n.endsWith("/");return c.pathname.endsWith("/")||!u&&!d||(c.pathname+="/"),c}var W=e=>e.join("/").replace(/\/\/+/g,"/"),G=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),K=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function Y(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var J=["POST","PUT","PATCH","DELETE"],X=(new Set(J),["GET",...J]);new Set(X),Symbol("ResetLoaderData");var $=r.createContext(null);$.displayName="DataRouter";var Z=r.createContext(null);Z.displayName="DataRouterState";var ee=r.createContext({isTransitioning:!1});ee.displayName="ViewTransition";var te=r.createContext(new Map);te.displayName="Fetchers";var ne=r.createContext(null);ne.displayName="Await";var re=r.createContext(null);re.displayName="Navigation";var se=r.createContext(null);se.displayName="Location";var ie=r.createContext({outlet:null,matches:[],isDataRoute:!1});ie.displayName="Route";var ae=r.createContext(null);ae.displayName="RouteError";function oe(){return null!=r.useContext(se)}function le(){return g(oe(),"useLocation() may be used only in the context of a <Router> component."),r.useContext(se).location}var ce="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ue(e){r.useContext(re).static||r.useLayoutEffect(e)}function de(){let{isDataRoute:e}=r.useContext(ie);return e?function(){let{router:e}=we("useNavigate"),t=Ne("useNavigate"),n=r.useRef(!1);ue((()=>{n.current=!0}));let s=r.useCallback((async function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};v(n.current,ce),n.current&&("number"===typeof r?e.navigate(r):await e.navigate(r,(0,o.A)({fromRouteId:t},s)))}),[e,t]);return s}():function(){g(oe(),"useNavigate() may be used only in the context of a <Router> component.");let e=r.useContext($),{basename:t,navigator:n}=r.useContext(re),{matches:s}=r.useContext(ie),{pathname:i}=le(),a=JSON.stringify(V(s)),o=r.useRef(!1);ue((()=>{o.current=!0}));let l=r.useCallback((function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(v(o.current,ce),!o.current)return;if("number"===typeof r)return void n.go(r);let l=H(r,JSON.parse(a),i,"path"===s.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:W([t,l.pathname])),(s.replace?n.replace:n.push)(l,s.state,s)}),[t,n,a,i,e]);return l}()}r.createContext(null);function he(){let{matches:e}=r.useContext(ie),t=e[e.length-1];return t?t.params:{}}function me(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=r.useContext(ie),{pathname:s}=le(),i=JSON.stringify(V(n));return r.useMemo((()=>H(e,JSON.parse(i),s,"path"===t)),[e,i,s,t])}function fe(e,t,n,s){g(oe(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:a}=r.useContext(re),{matches:l}=r.useContext(ie),c=l[l.length-1],u=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",m=c&&c.route;{let e=m&&m.path||"";Ee(d,!m||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(d,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,p=le();if(t){var x;let e="string"===typeof t?w(t):t;g("/"===h||(null===(x=e.pathname)||void 0===x?void 0:x.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=p;let y=f.pathname||"/",b=y;if("/"!==h){let e=h.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let D=!a&&n&&n.matches&&n.matches.length>0?n.matches:j(e,{pathname:b});v(m||null!=D,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),v(null==D||void 0!==D[D.length-1].route.element||void 0!==D[D.length-1].route.Component||void 0!==D[D.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let N=ye(D&&D.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:W([h,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:W([h,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,s);return t&&N?r.createElement(se.Provider,{value:{location:(0,o.A)({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},N):N}function pe(){let e=je(),t=Y(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},a={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=r.createElement(r.Fragment,null,r.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),r.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",r.createElement("code",{style:a},"ErrorBoundary")," or"," ",r.createElement("code",{style:a},"errorElement")," prop on your route.")),r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),n?r.createElement("pre",{style:i},n):null,o)}var ge=r.createElement(pe,null),ve=class extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(ie.Provider,{value:this.props.routeContext},r.createElement(ae.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function xe(e){let{routeContext:t,match:n,children:s}=e,i=r.useContext($);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),r.createElement(ie.Provider,{value:t},s)}function ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let s=e,i=null===n||void 0===n?void 0:n.errors;if(null!=i){let e=s.findIndex((e=>e.route.id&&void 0!==(null===i||void 0===i?void 0:i[e.route.id])));g(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(i).join(","))),s=s.slice(0,Math.min(s.length,e+1))}let a=!1,o=-1;if(n)for(let r=0;r<s.length;r++){let e=s[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(o=r),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){a=!0,s=o>=0?s.slice(0,o+1):[s[0]];break}}}return s.reduceRight(((e,l,c)=>{let u,d=!1,h=null,m=null;n&&(u=i&&l.route.id?i[l.route.id]:void 0,h=l.route.errorElement||ge,a&&(o<0&&0===c?(Ee("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,m=null):o===c&&(d=!0,m=l.route.hydrateFallbackElement||null)));let f=t.concat(s.slice(0,c+1)),p=()=>{let t;return t=u?h:d?m:l.route.Component?r.createElement(l.route.Component,null):l.route.element?l.route.element:e,r.createElement(xe,{match:l,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?r.createElement(ve,{location:n.location,revalidation:n.revalidation,component:h,error:u,children:p(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):p()}),null)}function be(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function we(e){let t=r.useContext($);return g(t,be(e)),t}function De(e){let t=r.useContext(Z);return g(t,be(e)),t}function Ne(e){let t=function(e){let t=r.useContext(ie);return g(t,be(e)),t}(e),n=t.matches[t.matches.length-1];return g(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function je(){var e;let t=r.useContext(ae),n=De("useRouteError"),s=Ne("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[s]}var Ce={};function Ee(e,t,n){t||Ce[e]||(Ce[e]=!0,v(!1,n))}r.memo((function(e){let{routes:t,future:n,state:r}=e;return fe(t,void 0,r,n)}));function Ae(e){let{to:t,replace:n,state:s,relative:i}=e;g(oe(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=r.useContext(re);v(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=r.useContext(ie),{pathname:l}=le(),c=de(),u=H(t,V(o),l,"path"===i),d=JSON.stringify(u);return r.useEffect((()=>{c(JSON.parse(d),{replace:n,state:s,relative:i})}),[c,d,i,n,s]),null}function ke(e){g(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Se(e){let{basename:t="/",children:n=null,location:s,navigationType:i="POP",navigator:a,static:o=!1}=e;g(!oe(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=r.useMemo((()=>({basename:l,navigator:a,static:o,future:{}})),[l,a,o]);"string"===typeof s&&(s=w(s));let{pathname:u="/",search:d="",hash:h="",state:m=null,key:f="default"}=s,p=r.useMemo((()=>{let e=z(u,l);return null==e?null:{location:{pathname:e,search:d,hash:h,state:m,key:f},navigationType:i}}),[l,u,d,h,m,f,i]);return v(null!=p,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==p?null:r.createElement(re.Provider,{value:c},r.createElement(se.Provider,{children:n,value:p}))}function Fe(e){let{children:t,location:n}=e;return fe(_e(t),n)}r.Component;function _e(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return r.Children.forEach(e,((e,s)=>{if(!r.isValidElement(e))return;let i=[...t,s];if(e.type===r.Fragment)return void n.push.apply(n,_e(e.props.children,i));g(e.type===ke,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),g(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=_e(e.props.children,i)),n.push(a)})),n}var Te="get",Ie="application/x-www-form-urlencoded";function Re(e){return null!=e&&"string"===typeof e.tagName}var Pe=null;var Oe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Me(e){return null==e||Oe.has(e)?e:(v(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Ie,'"')),null)}function Le(e,t){let n,r,s,i,a;if(Re(o=e)&&"form"===o.tagName.toLowerCase()){let a=e.getAttribute("action");r=a?z(a,t):null,n=e.getAttribute("method")||Te,s=Me(e.getAttribute("enctype"))||Ie,i=new FormData(e)}else if(function(e){return Re(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Re(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||a.getAttribute("action");if(r=o?z(o,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||Te,s=Me(e.getAttribute("formenctype"))||Me(a.getAttribute("enctype"))||Ie,i=new FormData(a,e),!function(){if(null===Pe)try{new FormData(document.createElement("form"),0),Pe=!1}catch(Jh){Pe=!0}return Pe}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";i.append("".concat(e,"x"),"0"),i.append("".concat(e,"y"),"0")}else t&&i.append(t,r)}}else{if(Re(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Te,r=null,s=Ie,a=e}var o;return i&&"text/plain"===s&&(a=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:a}}function Be(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}async function ze(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}function Ue(e){return null!=e&&"string"===typeof e.page}function qe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ve(e,t,n,r,s,i){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===i?t.filter(((e,t)=>a(e,t)||o(e,t))):"data"===i?t.filter(((t,i)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(a(t,i)||o(t,i))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0})):[]}function He(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map((e=>{let r=t.routes[e.route.id];if(!r)return[];let s=[r.module];return r.clientActionModule&&(s=s.concat(r.clientActionModule)),r.clientLoaderModule&&(s=s.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(s=s.concat(r.hydrateFallbackModule)),r.imports&&(s=s.concat(r.imports)),s})).flat(1),[...new Set(r)];var r}function We(e,t){let n=new Set,r=new Set(t);return e.reduce(((e,s)=>{if(t&&!Ue(s)&&"script"===s.as&&s.href&&r.has(s.href))return e;let i=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(s));return n.has(i)||(n.add(i),e.push({key:i,link:s})),e}),[])}function Ge(e){return{__html:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;Symbol("SingleFetchRedirect");var Ke=new Set([100,101,204,205]);function Qe(e,t){let n="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===n.pathname?n.pathname="_root.data":t&&"/"===z(n.pathname,t)?n.pathname="".concat(t.replace(/\/$/,""),"/_root.data"):n.pathname="".concat(n.pathname.replace(/\/$/,""),".data"),n}r.Component;function Ye(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let s,i=r.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(Y(t))return r.createElement(Je,{title:"Unhandled Thrown Response!"},r.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),i);if(t instanceof Error)0;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);new Error(e)}return r.createElement(Je,{title:"Application Error!",isOutsideRemixApp:n},r.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),r.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},s.stack),i)}function Je(e){var t;let{title:n,renderScripts:s,isOutsideRemixApp:i,children:a}=e,{routeModules:o}=tt();return null!==o.root&&void 0!==t&&t.Layout&&!i?a:r.createElement("html",{lang:"en"},r.createElement("head",null,r.createElement("meta",{charSet:"utf-8"}),r.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),r.createElement("title",null,n)),r.createElement("body",null,r.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,s?r.createElement(lt,null):null)))}function Xe(e,t){return"lazy"===e.mode&&!0===t}function $e(){let e=r.useContext($);return Be(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ze(){let e=r.useContext(Z);return Be(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var et=r.createContext(void 0);function tt(){let e=r.useContext(et);return Be(e,"You must render this element inside a <HydratedRouter> element"),e}function nt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function rt(e,t,n){if(n&&!ot)return[e[0]];if(t){let n=e.findIndex((e=>void 0!==t[e.route.id]));return e.slice(0,n+1)}return e}function st(e){let{page:t}=e,n=(0,a.A)(e,c),{router:s}=$e(),i=r.useMemo((()=>j(s.routes,t,s.basename)),[s.routes,t,s.basename]);return i?r.createElement(at,(0,o.A)({page:t,matches:i},n)):null}function it(e){let{manifest:t,routeModules:n}=tt(),[s,i]=r.useState([]);return r.useEffect((()=>{let r=!1;return async function(e,t,n){let r=await Promise.all(e.map((async e=>{let r=t.routes[e.route.id];if(r){let e=await ze(r,n);return e.links?e.links():[]}return[]})));return We(r.flat(1).filter(qe).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?(0,o.A)((0,o.A)({},e),{},{rel:"prefetch",as:"style"}):(0,o.A)((0,o.A)({},e),{},{rel:"prefetch"}))))}(e,t,n).then((e=>{r||i(e)})),()=>{r=!0}}),[e,t,n]),s}function at(e){let{page:t,matches:n}=e,s=(0,a.A)(e,u),i=le(),{manifest:l,routeModules:c}=tt(),{basename:d}=$e(),{loaderData:h,matches:m}=Ze(),f=r.useMemo((()=>Ve(t,n,m,l,i,"data")),[t,n,m,l,i]),p=r.useMemo((()=>Ve(t,n,m,l,i,"assets")),[t,n,m,l,i]),g=r.useMemo((()=>{if(t===i.pathname+i.search+i.hash)return[];let e=new Set,r=!1;if(n.forEach((t=>{var n;let s=l.routes[t.route.id];s&&s.hasLoader&&(!f.some((e=>e.route.id===t.route.id))&&t.route.id in h&&null!==(n=c[t.route.id])&&void 0!==n&&n.shouldRevalidate||s.hasClientLoader?r=!0:e.add(t.route.id))})),0===e.size)return[];let s=Qe(t,d);return r&&e.size>0&&s.searchParams.set("_routes",n.filter((t=>e.has(t.route.id))).map((e=>e.route.id)).join(",")),[s.pathname+s.search]}),[d,h,i,l,f,n,t,c]),v=r.useMemo((()=>He(p,l)),[p,l]),x=it(p);return r.createElement(r.Fragment,null,g.map((e=>r.createElement("link",(0,o.A)({key:e,rel:"prefetch",as:"fetch",href:e},s)))),v.map((e=>r.createElement("link",(0,o.A)({key:e,rel:"modulepreload",href:e},s)))),x.map((e=>{let{key:t,link:n}=e;return r.createElement("link",(0,o.A)({key:t},n))})))}et.displayName="FrameworkContext";var ot=!1;function lt(e){let{manifest:t,serverHandoffString:n,isSpaMode:s,renderMeta:i,routeDiscovery:c,ssr:u}=tt(),{router:d,static:h,staticContext:m}=$e(),{matches:f}=Ze(),p=Xe(c,u);i&&(i.didRenderScripts=!0);let g=rt(f,null,s);r.useEffect((()=>{0}),[]);let v=r.useMemo((()=>{var s;let i=m?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",c=h?"".concat(null!==t.hmr&&void 0!==s&&s.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(p?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(g.map(((e,n)=>{let r="route".concat(n),s=t.routes[e.route.id];Be(s,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:i,clientLoaderModule:a,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=s,u=[...i?[{module:i,varName:"".concat(r,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(r,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map((e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";'))).join("\n"),"const ".concat(r," = {").concat(u.map((e=>"...".concat(e.varName))).join(","),"};")].join("\n")})).join("\n"),"\n  ").concat(p?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=(0,a.A)(e,l),s=new Set(t.state.matches.map((e=>e.route.id))),i=t.state.location.pathname.split("/").filter(Boolean),c=["/"];for(i.pop();i.length>0;)c.push("/".concat(i.join("/"))),i.pop();c.forEach((e=>{let n=j(t.routes,e,t.basename);n&&n.forEach((e=>s.add(e.route.id)))}));let u=[...s].reduce(((e,t)=>Object.assign(e,{[t]:r.routes[t]})),{});return(0,o.A)((0,o.A)({},r),{},{routes:u,sri:!!n||void 0})}(t,d),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(g.map(((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t))).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return r.createElement(r.Fragment,null,r.createElement("script",(0,o.A)((0,o.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:Ge(i),type:void 0})),r.createElement("script",(0,o.A)((0,o.A)({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:Ge(c),type:"module",async:!0})))}),[]),x=ot?[]:(t.entry.imports.concat(He(g,t,{includeHydrateFallback:!0})),[...new Set(y)]);var y;let b="object"===typeof t.sri?t.sri:{};return ot?null:r.createElement(r.Fragment,null,"object"===typeof t.sri?r.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:b})}}):null,p?null:r.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:b[t.url],suppressHydrationWarning:!0}),r.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:b[t.entry.module],suppressHydrationWarning:!0}),x.map((t=>r.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:b[t],suppressHydrationWarning:!0}))),v)}function ct(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach((t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)}))}}var ut="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ut&&(window.__reactRouterVersion="7.6.0")}catch(Jh){}function dt(e){let{basename:t,children:n,window:s}=e,i=r.useRef();null==i.current&&(i.current=p({window:s,v5Compat:!0}));let a=i.current,[o,l]=r.useState({action:a.action,location:a.location}),c=r.useCallback((e=>{r.startTransition((()=>l(e)))}),[l]);return r.useLayoutEffect((()=>a.listen(c)),[a,c]),r.createElement(Se,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:a})}var ht=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mt=r.forwardRef((function(e,t){let n,{onClick:s,discover:i="render",prefetch:l="none",relative:c,reloadDocument:u,replace:h,state:m,target:f,to:p,preventScrollReset:x,viewTransition:y}=e,w=(0,a.A)(e,d),{basename:D}=r.useContext(re),N="string"===typeof p&&ht.test(p),j=!1;if("string"===typeof p&&N&&(n=p,ut))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),n=z(t.pathname,D);t.origin===e.origin&&null!=n?p=n+t.search+t.hash:j=!0}catch(Jh){v(!1,'<Link to="'.concat(p,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let C=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};g(oe(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=r.useContext(re),{hash:i,pathname:a,search:o}=me(e,{relative:t}),l=a;return"/"!==n&&(l="/"===a?n:W([n,a])),s.createHref({pathname:l,search:o,hash:i})}(p,{relative:c}),[E,A,k]=function(e,t){let n=r.useContext(et),[s,i]=r.useState(!1),[a,o]=r.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,m=r.useRef(null);r.useEffect((()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{o(e.isIntersecting)}))}),{threshold:.5});return m.current&&e.observe(m.current),()=>{e.disconnect()}}}),[e]),r.useEffect((()=>{if(s){let e=setTimeout((()=>{o(!0)}),100);return()=>{clearTimeout(e)}}}),[s]);let f=()=>{i(!0)},p=()=>{i(!1),o(!1)};return n?"intent"!==e?[a,m,{}]:[a,m,{onFocus:nt(l,f),onBlur:nt(c,p),onMouseEnter:nt(u,f),onMouseLeave:nt(d,p),onTouchStart:nt(h,f)}]:[!1,m,{}]}(l,w),S=function(e){let{target:t,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=de(),c=le(),u=me(e,{relative:a});return r.useCallback((r=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(r,t)){r.preventDefault();let t=void 0!==n?n:b(c)===b(u);l(e,{replace:t,state:s,preventScrollReset:i,relative:a,viewTransition:o})}}),[c,l,u,n,s,t,e,i,a,o])}(p,{replace:h,state:m,target:f,preventScrollReset:x,relative:c,viewTransition:y});let F=r.createElement("a",(0,o.A)((0,o.A)((0,o.A)({},w),k),{},{href:n||C,onClick:j||u?s:function(e){s&&s(e),e.defaultPrevented||S(e)},ref:ct(t,A),target:f,"data-discover":N||"render"!==i?void 0:"true"}));return E&&!N?r.createElement(r.Fragment,null,F,r.createElement(st,{page:C})):F}));mt.displayName="Link";var ft=r.forwardRef((function(e,t){let{"aria-current":n="page",caseSensitive:s=!1,className:i="",end:l=!1,style:c,to:u,viewTransition:d,children:m}=e,f=(0,a.A)(e,h),p=me(u,{relative:f.relative}),v=le(),x=r.useContext(Z),{navigator:y,basename:b}=r.useContext(re),w=null!=x&&function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.useContext(ee);g(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=vt("useViewTransitionState"),i=me(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=z(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=z(n.nextLocation.pathname,s)||n.nextLocation.pathname;return null!=M(i.pathname,o)||null!=M(i.pathname,a)}(p)&&!0===d,D=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,N=v.pathname,j=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(N=N.toLowerCase(),j=j?j.toLowerCase():null,D=D.toLowerCase()),j&&b&&(j=z(j,b)||j);const C="/"!==D&&D.endsWith("/")?D.length-1:D.length;let E,A=N===D||!l&&N.startsWith(D)&&"/"===N.charAt(C),k=null!=j&&(j===D||!l&&j.startsWith(D)&&"/"===j.charAt(D.length)),S={isActive:A,isPending:k,isTransitioning:w},F=A?n:void 0;E="function"===typeof i?i(S):[i,A?"active":null,k?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let _="function"===typeof c?c(S):c;return r.createElement(mt,(0,o.A)((0,o.A)({},f),{},{"aria-current":F,className:E,ref:t,style:_,to:u,viewTransition:d}),"function"===typeof m?m(S):m)}));ft.displayName="NavLink";var pt=r.forwardRef(((e,t)=>{let{discover:n="render",fetcherKey:s,navigate:i,reloadDocument:l,replace:c,state:u,method:d=Te,action:h,onSubmit:f,relative:p,preventScrollReset:v,viewTransition:x}=e,y=(0,a.A)(e,m),w=bt(),D=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=r.useContext(re),s=r.useContext(ie);g(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),a=(0,o.A)({},me(e||".",{relative:t})),l=le();if(null==e){a.search=l.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();a.search=n?"?".concat(n):""}}e&&"."!==e||!i.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(a.pathname="/"===a.pathname?n:W([n,a.pathname]));return b(a)}(h,{relative:p}),N="get"===d.toLowerCase()?"get":"post",j="string"===typeof h&&ht.test(h);return r.createElement("form",(0,o.A)((0,o.A)({ref:t,method:N,action:D,onSubmit:l?f:e=>{if(f&&f(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||d;w(t||e.currentTarget,{fetcherKey:s,method:n,navigate:i,replace:c,state:u,relative:p,preventScrollReset:v,viewTransition:x})}},y),{},{"data-discover":j||"render"!==n?void 0:"true"}))}));function gt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function vt(e){let t=r.useContext($);return g(t,gt(e)),t}pt.displayName="Form";var xt=0,yt=()=>"__".concat(String(++xt),"__");function bt(){let{router:e}=vt("useSubmit"),{basename:t}=r.useContext(re),n=Ne("useRouteId");return r.useCallback((async function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:i,method:a,encType:o,formData:l,body:c}=Le(r,t);if(!1===s.navigate){let t=s.fetcherKey||yt();await e.fetch(t,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||a,formEncType:s.encType||o,flushSync:s.flushSync})}else await e.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||a,formEncType:s.encType||o,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})}),[e,t,n])}var wt=n(5662),Dt=n(5472),Nt=n(6493);const jt="uww-buddies-require-verification",Ct=()=>{const e=localStorage.getItem(jt);return null!==e&&"true"===e};var Et=n(579);const At=(0,r.createContext)({}),kt=()=>(0,r.useContext)(At),St=e=>{let{children:t}=e;const[n,s]=(0,r.useState)(null),[i,a]=(0,r.useState)(!0),l=new Nt.HF;(0,r.useEffect)((()=>{const e=(0,Nt.hg)(wt.j2,(async e=>{if(console.log("Auth state changed:",null===e||void 0===e?void 0:e.uid),e){const t=(0,Dt.H9)(wt.db,"profiles",e.uid),n=await(0,Dt.x7)(t);n.exists()?s((0,o.A)((0,o.A)({},e),n.data())):(await c(e),s(e))}else s(null);a(!1)}),(e=>{console.error("Auth state change error:",e),a(!1)}));return e}),[]);const c=async e=>{try{const t=(0,Dt.H9)(wt.db,"users",e.uid);(await(0,Dt.x7)(t)).exists()||await(0,Dt.BN)(t,{displayName:e.displayName||e.email,email:e.email,buddyList:{},createdAt:new Date});const n=(0,Dt.H9)(wt.db,"profiles",e.uid);(await(0,Dt.x7)(n)).exists()||await(0,Dt.BN)(n,{name:e.displayName||e.email,email:e.email,photoURL:e.photoURL||"",phone:"",bio:"",city:"",state:"",certificationLevel:"Student Diver",specialties:[],divingStats:{totalDives:0,maxDepth:0,totalTime:0},syncWithLogbook:!1,instructorCertifications:[],diveTrips:[],favoritePlace:"",favoriteDivesite:"",emergencyContact:{name:"",relationship:"",phone:"",email:""},socialLinks:{instagram:"",facebook:"",youtube:"",twitter:""},privacySettings:{hideEmail:!1,hidePhone:!1,hideLocation:!1,hideStats:!1,hideSocial:!1},lifetimePoints:0,redeemablePoints:0,transactions:[],joinDate:(new Date).toISOString(),createdAt:(new Date).toISOString(),emailVerified:e.emailVerified||!1})}catch(t){console.error("Error creating user documents:",t)}},u={user:n,login:(e,t)=>(0,Nt.x9)(wt.j2,e,t),signup:async(e,t)=>{try{const n=await(0,Nt.eJ)(wt.j2,e,t);return Ct()&&await(0,Nt.gA)(n.user),await c(n.user),n}catch(n){throw console.error("Error during signup:",n),n}},signInWithGoogle:async()=>{try{return await(0,Nt.df)(wt.j2,l)}catch(e){throw console.error("Error signing in with Google:",e),e}},logout:()=>(0,Nt.CI)(wt.j2),updateUserProfile:async(e,t)=>{if(n)try{await(0,Nt.r7)(n,{displayName:e||n.displayName,photoURL:t||n.photoURL});const r=(0,Dt.H9)(wt.db,"users",n.uid);await(0,Dt.BN)(r,{displayName:e||n.displayName},{merge:!0});const i=(0,Dt.H9)(wt.db,"profiles",n.uid);await(0,Dt.BN)(i,{name:e||n.displayName},{merge:!0}),s((0,o.A)((0,o.A)({},n),{},{displayName:e,photoURL:t}))}catch(r){throw console.error("Error updating profile:",r),r}},sendVerificationEmail:async()=>{if(!wt.j2.currentUser)throw new Error("No authenticated user found");try{return await(0,Nt.gA)(wt.j2.currentUser),!0}catch(e){throw console.error("Error sending verification email:",e),e}},resetPassword:async e=>{try{return await(0,Nt.J1)(wt.j2,e),!0}catch(t){throw console.error("Error sending password reset email:",t),t}},changePassword:async(e,t)=>{if(!wt.j2.currentUser)throw new Error("No authenticated user found");try{const n=Nt.IX.credential(wt.j2.currentUser.email,e);return await(0,Nt.kZ)(wt.j2.currentUser,n),await(0,Nt.f3)(wt.j2.currentUser,t),!0}catch(n){throw console.error("Error changing password:",n),n}}};return(0,Et.jsx)(At.Provider,{value:u,children:!i&&t})};var Ft=n(8147);const _t=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Tt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t)).join(" ").trim()};var It={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Rt=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],Pt=(0,r.forwardRef)(((e,t)=>{let{color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:u,iconNode:d}=e,h=(0,a.A)(e,Rt);return(0,r.createElement)("svg",(0,o.A)((0,o.A)({ref:t},It),{},{width:s,height:s,stroke:n,strokeWidth:l?24*Number(i)/Number(s):i,className:Tt("lucide",c)},h),[...d.map((e=>{let[t,n]=e;return(0,r.createElement)(t,n)})),...Array.isArray(u)?u:[u]])})),Ot=["className"],Mt=(e,t)=>{const n=(0,r.forwardRef)(((n,s)=>{let{className:i}=n,l=(0,a.A)(n,Ot);return(0,r.createElement)(Pt,(0,o.A)({ref:s,iconNode:t,className:Tt("lucide-".concat(_t(e)),i)},l))}));return n.displayName="".concat(e),n},Lt=Mt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),Bt=Mt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),zt=Mt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Ut=Mt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),qt=Mt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Vt=Mt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Ht=Mt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Wt=Mt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Gt=Mt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),Kt=Mt("Droplet",[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]]),Qt=Mt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Yt=Mt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Jt=Mt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Xt=Mt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),$t=Mt("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),Zt=Mt("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),en=Mt("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),tn=Mt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),nn=Mt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),rn=Mt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),sn=Mt("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),an=Mt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),on=Mt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ln=Mt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),cn=Mt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),un=Mt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),dn={"Student Diver":"Student.png","SCUBA Diver":"SCUBA.png","Advanced SCUBA Diver":"Advanced.png","Rescue Diver":"Rescue.png","Advanced Rescue Diver":"AdvancedRescue.png","Master SCUBA Diver":"Master.png",Divemaster:"Divemaster.png","Assistant Instructor":"Divemaster.png",Instructor:"Instructor.png"},hn={"Nitrox Diver":"Nitrox.png","Deep Diver":"Deep.png","Underwater Navigator":"Navigator.png","Solo Diver":"Solo.png","Drysuit Diver":"Drysuit.png","First Aid/CPR":"FirstAid.png","Emergency Oxygen Provider":"O2.png","Equipment Specialist":"Equipment.png","Night Diver":"Night.png","Wreck Diver":"Wreck.png"},mn=[{count:500,image:"500.png"},{count:450,image:"450.png"},{count:400,image:"400.png"},{count:350,image:"350.png"},{count:300,image:"300.png"},{count:250,image:"250.png"},{count:200,image:"200.png"},{count:150,image:"150.png"},{count:100,image:"100.png"},{count:75,image:"75.png"},{count:50,image:"50.png"},{count:25,image:"25.png"},{count:15,image:"15.png"},{count:10,image:"10.png"},{count:5,image:"5.png"}],fn=e=>{let{name:t,imageName:n,description:r,size:s="full",responsive:i=!1}=e;const a={tiny:"w-10 h-10",small:"w-14 h-14",medium:"w-16 h-16",large:"w-20 h-20",full:"w-24 h-24"},o=i?"w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 lg:w-20 lg:h-20":a[s]||a.full;return(0,Et.jsxs)("div",{className:"relative group",children:[(0,Et.jsx)("div",{className:"rounded-full overflow-hidden ".concat(o),children:(0,Et.jsx)("img",{src:"/images/badges/".concat(n),alt:t,className:"w-full h-full object-contain",onError:e=>{e.target.onerror=null,e.target.src="/images/badges/placeholder.png"}})}),(0,Et.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 hidden group-hover:block z-50",children:(0,Et.jsxs)("div",{className:"bg-gray-800 text-white text-xs rounded py-1 px-2 whitespace-nowrap shadow-lg",children:[(0,Et.jsx)("strong",{children:t}),r&&(0,Et.jsx)("div",{className:"text-gray-300 text-xs font-light",children:r})]})})]})},pn=e=>{let{title:t,badges:n,showTitle:r=!0,size:s,gridLayout:i=!1}=e;return n&&0!==n.length?(0,Et.jsxs)("div",{className:r?"mb-4":"inline",children:[r&&(0,Et.jsx)("h4",{className:"text-xs font-medium text-gray-700 mb-2",children:t}),(0,Et.jsx)("div",{className:i?"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3":"flex flex-wrap gap-3",children:n.map(((e,t)=>(0,Et.jsx)(fn,{name:e.name,imageName:e.image,description:e.description,size:s},t)))})]}):null},gn=e=>{let{certificationLevel:t,specialties:n=[],numberOfDives:r=0,size:s="full",showSections:i=!0,gridLayout:a=!1,responsive:o=!1}=e;const l=t&&dn[t]?[{name:t,image:dn[t],description:"Certified ".concat(t)}]:[],c=n.filter((e=>hn[e])).map((e=>({name:e,image:hn[e],description:"Certified ".concat(e)}))),u=r>=5?mn.find((e=>r>=e.count)):null,d=u?[{name:500===u.count&&r>500?"".concat(u.count,"+ Dives"):"".concat(u.count," Dives"),image:u.image,description:500===u.count&&r>500?"Completed ".concat(u.count,"+ dives"):"Completed ".concat(u.count," dives")}]:[];return 0===l.length&&0===c.length&&0===d.length?null:i?(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Achievements"}),(0,Et.jsx)(pn,{title:"Certification Level",badges:l,size:s,gridLayout:a}),(0,Et.jsx)(pn,{title:"Specialties",badges:c,size:s,gridLayout:a}),(0,Et.jsx)(pn,{title:"Experience",badges:d,size:s,gridLayout:a})]}):(0,Et.jsxs)("div",{className:"flex flex-wrap gap-3 items-center",children:[l.length>0&&(0,Et.jsx)(pn,{badges:l,showTitle:!1,size:s}),c.length>0&&(0,Et.jsx)(pn,{badges:c,showTitle:!1,size:s}),d.length>0&&(0,Et.jsx)(pn,{badges:d,showTitle:!1,size:s})]})};var vn=n(8387);const xn=["class","className"],yn=e=>"boolean"===typeof e?"".concat(e):0===e?"0":e,bn=vn.$,wn=(e,t)=>n=>{var r;if(null==(null===t||void 0===t?void 0:t.variants))return bn(e,null===n||void 0===n?void 0:n.class,null===n||void 0===n?void 0:n.className);const{variants:s,defaultVariants:i}=t,l=Object.keys(s).map((e=>{const t=null===n||void 0===n?void 0:n[e],r=null===i||void 0===i?void 0:i[e];if(null===t)return null;const a=yn(t)||yn(r);return s[e][a]})),c=n&&Object.entries(n).reduce(((e,t)=>{let[n,r]=t;return void 0===r||(e[n]=r),e}),{}),u=null===t||void 0===t||null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce(((e,t)=>{let{class:n,className:r}=t,s=(0,a.A)(t,xn);return Object.entries(s).every((e=>{let[t,n]=e;return Array.isArray(n)?n.includes((0,o.A)((0,o.A)({},i),c)[t]):(0,o.A)((0,o.A)({},i),c)[t]===n}))?[...e,n,r]:e}),[]);return bn(e,l,u,null===n||void 0===n?void 0:n.class,null===n||void 0===n?void 0:n.className)};var Dn=n(9766);const Nn=["className","variant"],jn=["className","children"],Cn=["className"],En=wn("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),An=r.forwardRef(((e,t)=>{let{className:n,variant:r}=e,s=(0,a.A)(e,Nn);return(0,Et.jsx)("div",(0,o.A)({ref:t,role:"alert",className:(0,Dn.cn)(En({variant:r}),n)},s))}));An.displayName="Alert";const kn=r.forwardRef(((e,t)=>{let{className:n,children:r}=e,s=(0,a.A)(e,jn);return(0,Et.jsx)("h5",(0,o.A)((0,o.A)({ref:t,className:(0,Dn.cn)("mb-1 font-medium leading-none tracking-tight",n)},s),{},{children:r||s.title||""}))}));kn.displayName="AlertTitle";const Sn=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,Cn);return(0,Et.jsx)("div",(0,o.A)({ref:t,className:(0,Dn.cn)("text-sm [&_p]:leading-relaxed",n)},r))}));function Fn(e,t){let{checkForDefaultPrevented:n=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(r){if(null===e||void 0===e||e(r),!1===n||!r.defaultPrevented)return null===t||void 0===t?void 0:t(r)}}Sn.displayName="AlertDescription";const _n=["children"],Tn=["scope","children"];function In(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];const s=()=>{const t=n.map((e=>r.createContext(e)));return function(n){const s=(null===n||void 0===n?void 0:n[e])||t;return r.useMemo((()=>({["__scope".concat(e)]:(0,o.A)((0,o.A)({},n),{},{[e]:s})})),[n,s])}};return s.scopeName=e,[function(t,s){const i=r.createContext(s),o=n.length;n=[...n,s];const l=t=>{var n;const{scope:s,children:l}=t,c=(0,a.A)(t,Tn),u=(null===s||void 0===s||null===(n=s[e])||void 0===n?void 0:n[o])||i,d=r.useMemo((()=>c),Object.values(c));return(0,Et.jsx)(u.Provider,{value:d,children:l})};return l.displayName=t+"Provider",[l,function(n,a){var l;const c=(null===a||void 0===a||null===(l=a[e])||void 0===l?void 0:l[o])||i,u=r.useContext(c);if(u)return u;if(void 0!==s)return s;throw new Error("`".concat(n,"` must be used within `").concat(t,"`"))}]},Rn(s,...t)]}function Rn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=t[0];if(1===t.length)return s;const i=()=>{const e=t.map((e=>({useScope:e(),scopeName:e.scopeName})));return function(t){const n=e.reduce(((e,n)=>{let{useScope:r,scopeName:s}=n;const i=r(t)["__scope".concat(s)];return(0,o.A)((0,o.A)({},e),i)}),{});return r.useMemo((()=>({["__scope".concat(s.scopeName)]:n})),[n])}};return i.scopeName=s.scopeName,i}function Pn(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function On(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function Mn(e,t){return e.get(On(e,t))}function Ln(e,t,n){return e.set(On(e,t),n),n}function Bn(e,t){if("function"===typeof e)return e(t);null!==e&&void 0!==e&&(e.current=t)}function zn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.useCallback(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{let n=!1;const r=t.map((t=>{const r=Bn(t,e);return n||"function"!=typeof r||(n=!0),r}));if(n)return()=>{for(let e=0;e<r.length;e++){const n=r[e];"function"==typeof n?n():Bn(t[e],null)}}}}(...t),t)}const Un=["children"],qn=["children"];function Vn(e){const t=Wn(e),n=r.forwardRef(((e,n)=>{const{children:s}=e,i=(0,a.A)(e,Un),l=r.Children.toArray(s),c=l.find(Qn);if(c){const e=c.props.children,s=l.map((t=>t===c?r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null:t));return(0,Et.jsx)(t,(0,o.A)((0,o.A)({},i),{},{ref:n,children:r.isValidElement(e)?r.cloneElement(e,void 0,s):null}))}return(0,Et.jsx)(t,(0,o.A)((0,o.A)({},i),{},{ref:n,children:s}))}));return n.displayName="".concat(e,".Slot"),n}var Hn=Vn("Slot");function Wn(e){const t=r.forwardRef(((e,t)=>{const{children:n}=e,s=(0,a.A)(e,qn),i=zn(r.isValidElement(n)?function(e){var t,n;let r=null===(t=Object.getOwnPropertyDescriptor(e.props,"ref"))||void 0===t?void 0:t.get,s=r&&"isReactWarning"in r&&r.isReactWarning;if(s)return e.ref;if(r=null===(n=Object.getOwnPropertyDescriptor(e,"ref"))||void 0===n?void 0:n.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s)return e.props.ref;return e.props.ref||e.ref}(n):void 0,t);if(r.isValidElement(n)){const e=function(e,t){const n=(0,o.A)({},t);for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=function(){const e=i(...arguments);return s(...arguments),e}:s&&(n[r]=s):"style"===r?n[r]=(0,o.A)((0,o.A)({},s),i):"className"===r&&(n[r]=[s,i].filter(Boolean).join(" "))}return(0,o.A)((0,o.A)({},e),n)}(s,n.props);return n.type!==r.Fragment&&(e.ref=i),r.cloneElement(n,e)}return r.Children.count(n)>1?r.Children.only(null):null}));return t.displayName="".concat(e,".SlotClone"),t}var Gn=Symbol("radix.slottable");var Kn;function Qn(e){return r.isValidElement(e)&&"function"===typeof e.type&&"__radixId"in e.type&&e.type.__radixId===Gn}const Yn=["scope","children"];var Jn=new WeakMap;Kn=new WeakMap,Map;function Xn(e,t){if("at"in Array.prototype)return Array.prototype.at.call(e,t);const n=function(e,t){const n=e.length,r=$n(t),s=r>=0?r:n+r;return s<0||s>=n?-1:s}(e,t);return-1===n?void 0:e[n]}function $n(e){return e!==e||0===e?0:Math.trunc(e)}var Zn=null!==globalThis&&void 0!==globalThis&&globalThis.document?r.useLayoutEffect:()=>{},er=s[" useId ".trim().toString()]||(()=>{}),tr=0;function nr(e){const[t,n]=r.useState(er());return Zn((()=>{e||n((e=>null!==e&&void 0!==e?e:String(tr++)))}),[e]),e||(t?"radix-".concat(t):"")}var rr=n(7950);const sr=["asChild"];var ir=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce(((e,t)=>{const n=Vn("Primitive.".concat(t)),s=r.forwardRef(((e,r)=>{const{asChild:s}=e,i=(0,a.A)(e,sr),l=s?n:t;return"undefined"!==typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,Et.jsx)(l,(0,o.A)((0,o.A)({},i),{},{ref:r}))}));return s.displayName="Primitive.".concat(t),(0,o.A)((0,o.A)({},e),{},{[t]:s})}),{});function ar(e){const t=r.useRef(e);return r.useEffect((()=>{t.current=e})),r.useMemo((()=>function(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return null===(e=t.current)||void 0===e?void 0:e.call(t,...r)}),[])}var or=s[" useInsertionEffect ".trim().toString()]||Zn;function lr(e){let{prop:t,defaultProp:n,onChange:s=()=>{},caller:i}=e;const[a,o,l]=function(e){let{defaultProp:t,onChange:n}=e;const[s,i]=r.useState(t),a=r.useRef(s),o=r.useRef(n);return or((()=>{o.current=n}),[n]),r.useEffect((()=>{var e;a.current!==s&&(null===(e=o.current)||void 0===e||e.call(o,s),a.current=s)}),[s,a]),[s,i,o]}({defaultProp:n,onChange:s}),c=void 0!==t,u=c?t:a;{const e=r.useRef(void 0!==t);r.useEffect((()=>{const t=e.current;if(t!==c){const e=t?"controlled":"uncontrolled",n=c?"controlled":"uncontrolled";console.warn("".concat(i," is changing from ").concat(e," to ").concat(n,". Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component."))}e.current=c}),[c,i])}const d=r.useCallback((e=>{if(c){const r=function(e){return"function"===typeof e}(e)?e(t):e;var n;if(r!==t)null===(n=l.current)||void 0===n||n.call(l,r)}else o(e)}),[c,t,o,l]);return[u,d]}Symbol("RADIX:SYNC_STATE");var cr=r.createContext(void 0);function ur(e){const t=r.useContext(cr);return e||t||"ltr"}const dr=["__scopeRovingFocusGroup","orientation","loop","dir","currentTabStopId","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus","preventScrollOnEntryFocus"],hr=["__scopeRovingFocusGroup","focusable","active","tabStopId","children"];var mr="rovingFocusGroup.onEntryFocus",fr={bubbles:!1,cancelable:!0},pr="RovingFocusGroup",[gr,vr,xr]=function(e){const t=e+"CollectionProvider",[n,s]=In(t),[i,l]=n(t,{collectionRef:{current:null},itemMap:new Map}),c=e=>{const{scope:t,children:n}=e,s=r.useRef(null),a=r.useRef(new Map).current;return(0,Et.jsx)(i,{scope:t,itemMap:a,collectionRef:s,children:n})};c.displayName=t;const u=e+"CollectionSlot",d=Vn(u),h=r.forwardRef(((e,t)=>{const{scope:n,children:r}=e,s=zn(t,l(u,n).collectionRef);return(0,Et.jsx)(d,{ref:s,children:r})}));h.displayName=u;const m=e+"CollectionItemSlot",f="data-radix-collection-item",p=Vn(m),g=r.forwardRef(((e,t)=>{const{scope:n,children:s}=e,i=(0,a.A)(e,Yn),c=r.useRef(null),u=zn(t,c),d=l(m,n);return r.useEffect((()=>(d.itemMap.set(c,(0,o.A)({ref:c},i)),()=>{d.itemMap.delete(c)}))),(0,Et.jsx)(p,(0,o.A)((0,o.A)({},{[f]:""}),{},{ref:u,children:s}))}));return g.displayName=m,[{Provider:c,Slot:h,ItemSlot:g},function(t){const n=l(e+"CollectionConsumer",t),s=r.useCallback((()=>{const e=n.collectionRef.current;if(!e)return[];const t=Array.from(e.querySelectorAll("[".concat(f,"]"))),r=Array.from(n.itemMap.values()).sort(((e,n)=>t.indexOf(e.ref.current)-t.indexOf(n.ref.current)));return r}),[n.collectionRef,n.itemMap]);return s},s]}(pr),[yr,br]=In(pr,[xr]),[wr,Dr]=yr(pr),Nr=r.forwardRef(((e,t)=>(0,Et.jsx)(gr.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,Et.jsx)(gr.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,Et.jsx)(jr,(0,o.A)((0,o.A)({},e),{},{ref:t}))})})));Nr.displayName=pr;var jr=r.forwardRef(((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:i=!1,dir:l,currentTabStopId:c,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:d,onEntryFocus:h,preventScrollOnEntryFocus:m=!1}=e,f=(0,a.A)(e,dr),p=r.useRef(null),g=zn(t,p),v=ur(l),[x,y]=lr({prop:c,defaultProp:null!==u&&void 0!==u?u:null,onChange:d,caller:pr}),[b,w]=r.useState(!1),D=ar(h),N=vr(n),j=r.useRef(!1),[C,E]=r.useState(0);return r.useEffect((()=>{const e=p.current;if(e)return e.addEventListener(mr,D),()=>e.removeEventListener(mr,D)}),[D]),(0,Et.jsx)(wr,{scope:n,orientation:s,dir:v,loop:i,currentTabStopId:x,onItemFocus:r.useCallback((e=>y(e)),[y]),onItemShiftTab:r.useCallback((()=>w(!0)),[]),onFocusableItemAdd:r.useCallback((()=>E((e=>e+1))),[]),onFocusableItemRemove:r.useCallback((()=>E((e=>e-1))),[]),children:(0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({tabIndex:b||0===C?-1:0,"data-orientation":s},f),{},{ref:g,style:(0,o.A)({outline:"none"},e.style),onMouseDown:Fn(e.onMouseDown,(()=>{j.current=!0})),onFocus:Fn(e.onFocus,(e=>{const t=!j.current;if(e.target===e.currentTarget&&t&&!b){const t=new CustomEvent(mr,fr);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){const e=N().filter((e=>e.focusable));kr([e.find((e=>e.active)),e.find((e=>e.id===x)),...e].filter(Boolean).map((e=>e.ref.current)),m)}}j.current=!1})),onBlur:Fn(e.onBlur,(()=>w(!1)))}))})})),Cr="RovingFocusGroupItem",Er=r.forwardRef(((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:i=!1,tabStopId:l,children:c}=e,u=(0,a.A)(e,hr),d=nr(),h=l||d,m=Dr(Cr,n),f=m.currentTabStopId===h,p=vr(n),{onFocusableItemAdd:g,onFocusableItemRemove:v,currentTabStopId:x}=m;return r.useEffect((()=>{if(s)return g(),()=>v()}),[s,g,v]),(0,Et.jsx)(gr.ItemSlot,{scope:n,id:h,focusable:s,active:i,children:(0,Et.jsx)(ir.span,(0,o.A)((0,o.A)({tabIndex:f?0:-1,"data-orientation":m.orientation},u),{},{ref:t,onMouseDown:Fn(e.onMouseDown,(e=>{s?m.onItemFocus(h):e.preventDefault()})),onFocus:Fn(e.onFocus,(()=>m.onItemFocus(h))),onKeyDown:Fn(e.onKeyDown,(e=>{if("Tab"===e.key&&e.shiftKey)return void m.onItemShiftTab();if(e.target!==e.currentTarget)return;const t=function(e,t,n){const r=function(e,t){return"rtl"!==t?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,n);return"vertical"===t&&["ArrowLeft","ArrowRight"].includes(r)||"horizontal"===t&&["ArrowUp","ArrowDown"].includes(r)?void 0:Ar[r]}(e,m.orientation,m.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let s=p().filter((e=>e.focusable)).map((e=>e.ref.current));if("last"===t)s.reverse();else if("prev"===t||"next"===t){"prev"===t&&s.reverse();const i=s.indexOf(e.currentTarget);s=m.loop?(r=i+1,(n=s).map(((e,t)=>n[(r+t)%n.length]))):s.slice(i+1)}setTimeout((()=>kr(s)))}var n,r})),children:"function"===typeof c?c({isCurrentTabStop:f,hasTabStop:null!=x}):c}))})}));Er.displayName=Cr;var Ar={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function kr(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=document.activeElement;for(const r of e){if(r===n)return;if(r.focus({preventScroll:t}),document.activeElement!==n)return}}var Sr=Nr,Fr=Er;var _r=e=>{const{present:t,children:n}=e,s=function(e){const[t,n]=r.useState(),s=r.useRef(null),i=r.useRef(e),a=r.useRef("none"),o=e?"mounted":"unmounted",[l,c]=function(e,t){return r.useReducer(((e,n)=>{const r=t[e][n];return null!==r&&void 0!==r?r:e}),e)}(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return r.useEffect((()=>{const e=Tr(s.current);a.current="mounted"===l?e:"none"}),[l]),Zn((()=>{const t=s.current,n=i.current;if(n!==e){const r=a.current,s=Tr(t);if(e)c("MOUNT");else if("none"===s||"none"===(null===t||void 0===t?void 0:t.display))c("UNMOUNT");else{c(n&&r!==s?"ANIMATION_OUT":"UNMOUNT")}i.current=e}}),[e,c]),Zn((()=>{if(t){var e;let n;const r=null!==(e=t.ownerDocument.defaultView)&&void 0!==e?e:window,o=e=>{const a=Tr(s.current).includes(e.animationName);if(e.target===t&&a&&(c("ANIMATION_END"),!i.current)){const e=t.style.animationFillMode;t.style.animationFillMode="forwards",n=r.setTimeout((()=>{"forwards"===t.style.animationFillMode&&(t.style.animationFillMode=e)}))}},l=e=>{e.target===t&&(a.current=Tr(s.current))};return t.addEventListener("animationstart",l),t.addEventListener("animationcancel",o),t.addEventListener("animationend",o),()=>{r.clearTimeout(n),t.removeEventListener("animationstart",l),t.removeEventListener("animationcancel",o),t.removeEventListener("animationend",o)}}c("ANIMATION_END")}),[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:r.useCallback((e=>{s.current=e?getComputedStyle(e):null,n(e)}),[])}}(t),i="function"===typeof n?n({present:s.isPresent}):r.Children.only(n),a=zn(s.ref,function(e){var t,n;let r=null===(t=Object.getOwnPropertyDescriptor(e.props,"ref"))||void 0===t?void 0:t.get,s=r&&"isReactWarning"in r&&r.isReactWarning;if(s)return e.ref;if(r=null===(n=Object.getOwnPropertyDescriptor(e,"ref"))||void 0===n?void 0:n.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s)return e.props.ref;return e.props.ref||e.ref}(i));return"function"===typeof n||s.isPresent?r.cloneElement(i,{ref:a}):null};function Tr(e){return(null===e||void 0===e?void 0:e.animationName)||"none"}_r.displayName="Presence";const Ir=["__scopeTabs","value","onValueChange","defaultValue","orientation","dir","activationMode"],Rr=["__scopeTabs","loop"],Pr=["__scopeTabs","value","disabled"],Or=["__scopeTabs","value","forceMount","children"];var Mr="Tabs",[Lr,Br]=In(Mr,[br]),zr=br(),[Ur,qr]=Lr(Mr),Vr=r.forwardRef(((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:l="horizontal",dir:c,activationMode:u="automatic"}=e,d=(0,a.A)(e,Ir),h=ur(c),[m,f]=lr({prop:r,onChange:s,defaultProp:null!==i&&void 0!==i?i:"",caller:Mr});return(0,Et.jsx)(Ur,{scope:n,baseId:nr(),value:m,onValueChange:f,orientation:l,dir:h,activationMode:u,children:(0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({dir:h,"data-orientation":l},d),{},{ref:t}))})}));Vr.displayName=Mr;var Hr="TabsList",Wr=r.forwardRef(((e,t)=>{const{__scopeTabs:n,loop:r=!0}=e,s=(0,a.A)(e,Rr),i=qr(Hr,n),l=zr(n);return(0,Et.jsx)(Sr,(0,o.A)((0,o.A)({asChild:!0},l),{},{orientation:i.orientation,dir:i.dir,loop:r,children:(0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({role:"tablist","aria-orientation":i.orientation},s),{},{ref:t}))}))}));Wr.displayName=Hr;var Gr="TabsTrigger",Kr=r.forwardRef(((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1}=e,i=(0,a.A)(e,Pr),l=qr(Gr,n),c=zr(n),u=Jr(l.baseId,r),d=Xr(l.baseId,r),h=r===l.value;return(0,Et.jsx)(Fr,(0,o.A)((0,o.A)({asChild:!0},c),{},{focusable:!s,active:h,children:(0,Et.jsx)(ir.button,(0,o.A)((0,o.A)({type:"button",role:"tab","aria-selected":h,"aria-controls":d,"data-state":h?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:u},i),{},{ref:t,onMouseDown:Fn(e.onMouseDown,(e=>{s||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(r)})),onKeyDown:Fn(e.onKeyDown,(e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(r)})),onFocus:Fn(e.onFocus,(()=>{const e="manual"!==l.activationMode;h||s||!e||l.onValueChange(r)}))}))}))}));Kr.displayName=Gr;var Qr="TabsContent",Yr=r.forwardRef(((e,t)=>{const{__scopeTabs:n,value:s,forceMount:i,children:l}=e,c=(0,a.A)(e,Or),u=qr(Qr,n),d=Jr(u.baseId,s),h=Xr(u.baseId,s),m=s===u.value,f=r.useRef(m);return r.useEffect((()=>{const e=requestAnimationFrame((()=>f.current=!1));return()=>cancelAnimationFrame(e)}),[]),(0,Et.jsx)(_r,{present:i||m,children:n=>{let{present:r}=n;return(0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({"data-state":m?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":d,hidden:!r,id:h,tabIndex:0},c),{},{ref:t,style:(0,o.A)((0,o.A)({},e.style),{},{animationDuration:f.current?"0s":void 0}),children:r&&l}))}})}));function Jr(e,t){return"".concat(e,"-trigger-").concat(t)}function Xr(e,t){return"".concat(e,"-content-").concat(t)}Yr.displayName=Qr;var $r=Wr,Zr=Kr,es=Yr;const ts=["className"],ns=["className"],rs=["className"],ss=Vr,is=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,ts);return(0,Et.jsx)($r,(0,o.A)({ref:t,className:"inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground ".concat(n)},r))}));is.displayName=$r.displayName;const as=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,ns);return(0,Et.jsx)(Zr,(0,o.A)({ref:t,className:"inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow ".concat(n)},r))}));as.displayName=Zr.displayName;const os=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,rs);return(0,Et.jsx)(es,(0,o.A)({ref:t,className:"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ".concat(n)},r))}));os.displayName=es.displayName;const ls=function(){const[e,t]=(0,r.useState)(""),[n,s]=(0,r.useState)(""),[i,a]=(0,r.useState)(""),[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(""),[d,h]=(0,r.useState)(!1),{changePassword:m}=kt();return(0,Et.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,Et.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Change Password"}),(0,Et.jsxs)("form",{onSubmit:async r=>{if(r.preventDefault(),l(""),u(""),n===i)if(n.length<6)u("New password must be at least 6 characters long");else{h(!0);try{await m(e,n),l("Password successfully changed"),t(""),s(""),a("")}catch(c){console.error("Change password error:",c),"auth/wrong-password"===c.code?u("Incorrect current password"):"auth/weak-password"===c.code?u("New password is too weak. It should be at least 6 characters"):"auth/requires-recent-login"===c.code?u("For security reasons, please log out and log back in before changing your password"):u("Failed to change password: "+c.message)}finally{h(!1)}}else u("New passwords do not match")},className:"space-y-4",children:[o&&(0,Et.jsx)("div",{className:"bg-green-50 border-l-4 border-green-400 p-4",children:(0,Et.jsxs)("div",{className:"flex",children:[(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,Et.jsx)("div",{className:"ml-3",children:(0,Et.jsx)("p",{className:"text-sm text-green-700",children:o})})]})}),c&&(0,Et.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4",children:(0,Et.jsxs)("div",{className:"flex",children:[(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,Et.jsx)("div",{className:"ml-3",children:(0,Et.jsx)("p",{className:"text-sm text-red-700",children:c})})]})}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{htmlFor:"current-password",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),(0,Et.jsx)("input",{id:"current-password",name:"current-password",type:"password",autoComplete:"current-password",required:!0,className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:e,onChange:e=>t(e.target.value)})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{htmlFor:"new-password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,Et.jsx)("input",{id:"new-password",name:"new-password",type:"password",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:n,onChange:e=>s(e.target.value)}),(0,Et.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Password must be at least 6 characters long"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,Et.jsx)("input",{id:"confirm-password",name:"confirm-password",type:"password",autoComplete:"new-password",required:!0,className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",value:i,onChange:e=>a(e.target.value)})]}),(0,Et.jsx)("div",{className:"flex justify-end",children:(0,Et.jsx)("button",{type:"submit",disabled:d,className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:d?"Changing...":"Change Password"})})]})]})};const cs=function(){const[e,t]=(0,r.useState)("password");return(0,Et.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden p-6",children:[(0,Et.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Security Settings"}),(0,Et.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,Et.jsxs)("ul",{className:"flex -mb-px",children:[(0,Et.jsx)("li",{className:"mr-2",children:(0,Et.jsx)("button",{className:"inline-block py-2 px-4 text-sm font-medium focus:outline-none ".concat("password"===e?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>t("password"),children:"Password"})}),(0,Et.jsx)("li",{className:"mr-2",children:(0,Et.jsx)("button",{className:"inline-block py-2 px-4 text-sm font-medium focus:outline-none ".concat("sessions"===e?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700 hover:border-gray-300"),onClick:()=>t("sessions"),children:"Active Sessions"})})]})}),"password"===e&&(0,Et.jsx)(ls,{}),"sessions"===e&&(0,Et.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Active Sessions"}),(0,Et.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-4",children:(0,Et.jsx)("div",{className:"flex",children:(0,Et.jsx)("div",{className:"ml-3",children:(0,Et.jsx)("p",{className:"text-sm text-blue-700",children:"This is your current active session."})})})}),(0,Et.jsx)("p",{className:"text-sm text-gray-500",children:"For security reasons, you can't view all your active sessions. If you suspect unauthorized access to your account, change your password immediately and log out of all sessions."}),(0,Et.jsx)("div",{className:"mt-4",children:(0,Et.jsx)("button",{className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Log Out All Other Sessions"})})]})]})},us=Mt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ds=Mt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),hs=Mt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ms=Mt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);var fs=n(3092),ps=n.n(fs);const gs=e=>"INSTRUCTOR"===e?"Instructor":"DIVEMASTER"===e?"Divemaster":null===e||void 0===e?void 0:e.split("_").map((e=>e.charAt(0)+e.slice(1).toLowerCase())).join(" "),vs=e=>{let{tier:t,memberName:n,memberId:s,joinDate:i,certificationLevel:a,redeemablePoints:o,loyaltyCode:l}=e;const[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(null),[m,f]=(0,r.useState)(t),p=(0,r.useMemo)((()=>({OCEANIC_SILVER:"/images/Loyalty/OSM.png",MARINER_GOLD:"/images/Loyalty/MGM.png",NAUTILUS_PLATINUM:"/images/Loyalty/NPM.png",TRIDENT_ELITE:"/images/Loyalty/TEM.png",LIFETIME_ELITE:"/images/Loyalty/TEL.png"})),[]),g=(0,r.useMemo)((()=>({INSTRUCTOR:"/images/Loyalty/INST.png",DIVEMASTER:"/images/Loyalty/DM.png"})),[]);(0,r.useEffect)((()=>{const e="Divemaster"===a;"Instructor"===a||"Assistant Instructor"===a?(f("INSTRUCTOR"),h(g.INSTRUCTOR)):e?(f("DIVEMASTER"),h(g.DIVEMASTER)):(f(t),h(p[t]))}),[t,a,p,g]);const v="number"===typeof o?"".concat(o.toLocaleString()," pts"):"Check your account",x=(l||s||"MEMBER-ID").toUpperCase().replace(/[^A-Z0-9\-./+%$\s]/g,"");return(0,Et.jsxs)("div",{className:"relative w-full cursor-pointer rounded-xl shadow-md overflow-hidden",style:{aspectRatio:"1.6/1"},onClick:()=>{u(!c)},children:[!c&&(0,Et.jsx)("div",{className:"w-full h-full",children:d?(0,Et.jsx)("img",{src:d,alt:"".concat(gs(m)," Membership Card"),className:"w-full h-full object-cover"}):(0,Et.jsx)("div",{className:"w-full h-full bg-blue-600 flex items-center justify-center",children:(0,Et.jsx)("p",{className:"text-white text-xl",children:"Membership Card"})})}),c&&(0,Et.jsx)("div",{className:"w-full h-full bg-white border border-gray-200 p-4 overflow-y-auto",children:(0,Et.jsxs)("div",{className:"flex flex-col justify-between h-full",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center border-b pb-2",children:[(0,Et.jsx)("h3",{className:"font-semibold text-gray-800",children:"Underwater World"}),(0,Et.jsx)("div",{className:"w-8 h-8 flex items-center justify-center",children:(0,Et.jsx)(qt,{className:"w-5 h-5 text-blue-600"})})]}),(0,Et.jsxs)("div",{className:"py-2 space-y-2 flex-grow",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-xs text-gray-500",children:"Name"}),(0,Et.jsx)("p",{className:"font-medium text-gray-800",children:n||"Member"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-xs text-gray-500",children:"Member Since"}),(0,Et.jsx)("p",{className:"font-medium text-gray-800",children:null!==i&&void 0!==i&&i.seconds?new Date(1e3*i.seconds).toLocaleDateString():i instanceof Date?i.toLocaleDateString():"N/A"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-xs text-gray-500",children:"Redeemable Rewards Points"}),(0,Et.jsx)("p",{className:"font-medium text-gray-800",children:v})]})]}),(0,Et.jsx)("div",{className:"mt-1 pt-2 border-t",children:(0,Et.jsx)("div",{className:"flex flex-col items-center",children:(0,Et.jsx)(ps(),{value:x,format:"CODE39",width:3,height:60,displayValue:!0,textMargin:6,fontSize:14,margin:10,background:"#FFFFFF"})})}),(0,Et.jsx)("p",{className:"text-xs text-gray-400 text-center mt-2",children:"Click card to flip"})]})})]})},xs=e=>{let{isOpen:t,onClose:n}=e;return t?(0,Et.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:n}),(0,Et.jsxs)("div",{className:"relative z-50 w-full max-w-2xl max-h-[80vh] overflow-y-auto bg-white rounded-lg shadow-xl m-4",children:[(0,Et.jsxs)("div",{className:"flex items-center justify-between border-b p-4",children:[(0,Et.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"DiveRewards Program"}),(0,Et.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-900 transition-colors",children:(0,Et.jsx)(cn,{className:"h-6 w-6"})})]}),(0,Et.jsxs)("div",{className:"space-y-6 p-6",children:[(0,Et.jsx)("div",{children:(0,Et.jsx)("p",{className:"text-gray-700",children:"Welcome to our exclusive diving community rewards program. Getting started is simple \u2013 download our app and complete your profile to begin earning points on every purchase."})}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Membership Tiers & Benefits"}),(0,Et.jsxs)("div",{className:"space-y-3",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h4",{className:"font-medium",children:"Oceanic Silver (0 - 9,999 points)"}),(0,Et.jsx)("p",{className:"text-gray-600",children:"Base earning rate (1.0x multiplier)"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h4",{className:"font-medium",children:"Mariner Gold (10,000 - 19,999 points)"}),(0,Et.jsx)("p",{className:"text-gray-600",children:"Enhanced earning rate (1.2x multiplier)"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h4",{className:"font-medium",children:"Nautilus Platinum (20,000 - 49,999 points)"}),(0,Et.jsx)("p",{className:"text-gray-600",children:"Premium earning rate (1.5x multiplier)"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h4",{className:"font-medium",children:"Trident Elite (50,000 - 99,999 points)"}),(0,Et.jsx)("p",{className:"text-gray-600",children:"Elite earning rate (2.0x multiplier)"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h4",{className:"font-medium",children:"Lifetime Elite (100,000+ points)"}),(0,Et.jsx)("p",{className:"text-gray-600",children:"Elite earning rate (2.0x multiplier)"}),(0,Et.jsx)("p",{className:"text-gray-600",children:"Points never expire"})]})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Earning Points"}),(0,Et.jsxs)("div",{className:"space-y-2",children:[(0,Et.jsx)("p",{className:"text-gray-700",children:"Earn points on every purchase:"}),(0,Et.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-gray-600",children:[(0,Et.jsx)("li",{children:"Equipment: 5 points per $1"}),(0,Et.jsx)("li",{children:"Service: 10 points per $1"}),(0,Et.jsx)("li",{children:"Courses: 10 points per $1"}),(0,Et.jsx)("li",{children:"Trips: 1 point per $1"}),(0,Et.jsx)("li",{children:"Rentals: 5 points per $1"})]}),(0,Et.jsx)("p",{className:"text-gray-700 mt-2",children:"Points Value: 100 points = $1 in rewards"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Points Categories"}),(0,Et.jsxs)("div",{className:"space-y-2",children:[(0,Et.jsx)("p",{className:"text-gray-700",children:"Your points accumulate in two categories:"}),(0,Et.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-gray-600",children:[(0,Et.jsx)("li",{children:"Lifetime Points: Your total earned points that determine your tier status"}),(0,Et.jsx)("li",{children:"Redeemable Points: Available points for purchases"})]})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Annual Requirements"}),(0,Et.jsx)("p",{className:"text-gray-700",children:"To maintain your tier status and points balance, earn 10% of your minimum tier level annually. If not met, both redeemable and lifetime points will be reduced by 10%. Lifetime Elite members are exempt from this requirement."})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"How to Earn Points"}),(0,Et.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-gray-600",children:[(0,Et.jsx)("li",{children:"In-Store: Present your digital membership card for scanning at checkout"}),(0,Et.jsx)("li",{children:"Online: Include your member number (found in the app) in the order notes"})]}),(0,Et.jsx)("p",{className:"text-gray-700 mt-2",children:"Your points balance and transaction history are always available in the app. Returns will be adjusted from your points balance accordingly."})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"How to Redeem Points"}),(0,Et.jsxs)("ul",{className:"list-disc pl-5 space-y-1 text-gray-600",children:[(0,Et.jsx)("li",{children:"Convert your points into digital gift cards through the app"}),(0,Et.jsx)("li",{children:"Gift cards can be used both in-store and online"}),(0,Et.jsx)("li",{children:"No expiration date on issued gift cards"}),(0,Et.jsx)("li",{children:"Processing time approximately 24 hours"}),(0,Et.jsx)("li",{children:"Request gift cards directly through the app"})]})]})]})]})]}):null},ys=e=>{var t,n,s;let{loyaltyData:i,profile:a,userId:o}=e;const[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1),f=(e,t)=>t.loyaltyCode?t.loyaltyCode:e?e.toUpperCase():"MEMBER-ID";return(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("h2",{className:"text-sm uppercase font-semibold text-gray-700 mb-3 flex items-center tracking-wide",children:[(0,Et.jsx)(rn,{className:"h-4 w-4 text-blue-600 mr-2"}),"DiveRewards"]}),(0,Et.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-white rounded-lg border border-blue-100 shadow-sm p-3 md:p-4",children:(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Et.jsxs)("div",{className:"space-y-3",children:[(0,Et.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Your Points"}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-2.5 shadow-sm border border-gray-100",children:[(0,Et.jsx)("span",{className:"text-gray-500 text-xs",children:"Available"}),(0,Et.jsxs)("p",{className:"font-semibold text-gray-900 text-lg",children:[i.redeemablePoints.toLocaleString(),(0,Et.jsx)("span",{className:"text-xs text-gray-500 ml-1",children:"pts"})]})]}),(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-2.5 shadow-sm border border-gray-100",children:[(0,Et.jsx)("span",{className:"text-gray-500 text-xs",children:"Lifetime"}),(0,Et.jsxs)("p",{className:"font-semibold text-gray-900 text-lg",children:[i.lifetimePoints.toLocaleString(),(0,Et.jsx)("span",{className:"text-xs text-gray-500 ml-1",children:"pts"})]})]})]}),(null===(t=i.transactions)||void 0===t?void 0:t.length)>0&&(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("button",{onClick:()=>c(!l),className:"flex items-center justify-between w-full p-2 text-xs text-gray-600 hover:bg-gray-50 rounded-lg transition-colors border border-gray-100",children:[(0,Et.jsx)("span",{className:"font-medium text-gray-700",children:"Transaction History"}),l?(0,Et.jsx)(us,{className:"h-3.5 w-3.5"}):(0,Et.jsx)(ds,{className:"h-3.5 w-3.5"})]}),l&&(0,Et.jsx)("div",{className:"mt-2 space-y-1 max-h-36 overflow-y-auto",children:i.transactions.map(((e,t)=>{var n;return(0,Et.jsxs)("div",{className:"flex items-center justify-between p-2 text-xs border-b border-gray-100 last:border-b-0",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-gray-800 font-medium",children:"earn"===e.type?"Points Earned":"Points Redeemed"}),(0,Et.jsx)("p",{className:"text-xs text-gray-500",children:null!==(n=e.date)&&void 0!==n&&n.seconds?new Date(1e3*e.date.seconds).toLocaleDateString():(new Date).toLocaleDateString()})]}),(0,Et.jsxs)("span",{className:"font-medium ".concat("earn"===e.type?"text-green-600":"text-red-600"),children:["earn"===e.type?"+":"-",e.points]})]},t)}))})]}),(0,Et.jsxs)("button",{onClick:()=>d(!0),className:"w-full flex items-center justify-between p-2 mt-2 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg transition-colors border border-gray-200 text-xs",children:[(0,Et.jsx)("span",{children:"Program Details"}),(0,Et.jsx)(hs,{className:"h-3.5 w-3.5"})]})]}),(0,Et.jsx)("div",{className:"md:col-span-2",children:(0,Et.jsxs)("div",{className:"flex flex-col h-full",children:[(0,Et.jsx)("div",{className:"flex-1 relative",children:(0,Et.jsxs)("div",{onClick:()=>m(!0),className:"rounded-lg overflow-hidden cursor-pointer relative hover:shadow-md transition-shadow w-full",children:[(0,Et.jsx)(vs,{tier:null===(n=i.currentTier)||void 0===n?void 0:n.tier,memberName:a.name,memberId:f(o,a),loyaltyCode:a.loyaltyCode,joinDate:i.joinDate,certificationLevel:a.certificationLevel,redeemablePoints:i.redeemablePoints}),(0,Et.jsx)("div",{className:"absolute top-2 right-2 bg-black bg-opacity-20 hover:bg-opacity-50 p-1 rounded-full transition-all",children:(0,Et.jsx)(ms,{className:"h-3.5 w-3.5 text-white"})})]})}),(p=a.certificationLevel,("Instructor"===p||"Assistant Instructor"===p||"Divemaster"===p)&&(0,Et.jsx)("div",{className:"bg-blue-50 border-l-3 border-blue-300 p-2.5 rounded text-xs text-blue-700 mt-3",children:(0,Et.jsxs)("p",{children:["As a ",a.certificationLevel,", you cannot earn new loyalty points, but you can still redeem any existing points."]})}))]})})]})}),h&&(0,Et.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",children:(0,Et.jsxs)("div",{className:"relative max-w-xl w-full",children:[(0,Et.jsx)("button",{onClick:()=>m(!1),className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors","aria-label":"Close modal",children:(0,Et.jsx)(cn,{className:"h-6 w-6"})}),(0,Et.jsx)("div",{className:"transform hover:scale-[1.01] transition-transform",children:(0,Et.jsx)(vs,{tier:null===(s=i.currentTier)||void 0===s?void 0:s.tier,memberName:a.name,memberId:f(o,a),loyaltyCode:a.loyaltyCode,joinDate:i.joinDate,certificationLevel:a.certificationLevel,redeemablePoints:i.redeemablePoints})}),(0,Et.jsx)("p",{className:"text-center text-white text-xs mt-3",children:"Click the card to flip for more details"})]})}),(0,Et.jsx)(xs,{isOpen:u,onClose:()=>d(!1)})]});var p},bs={OCEANIC_SILVER:{min:0,max:9999,multiplier:1,name:"Oceanic Silver"},MARINER_GOLD:{min:1e4,max:19999,multiplier:1.2,name:"Mariner Gold"},NAUTILUS_PLATINUM:{min:2e4,max:49999,multiplier:1.5,name:"Nautilus Platinum"},TRIDENT_ELITE:{min:5e4,max:99999,multiplier:2,name:"Trident Elite"},LIFETIME_ELITE:{min:1e5,max:1/0,multiplier:2,name:"Lifetime Elite"}},ws=e=>{var t,n,r,s;let{profile:i,photoURL:a,handleEditClick:o,isEditing:l,onImageChange:c,onDeletePhoto:u}=e;return(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsxs)("div",{className:"h-36 md:h-48 bg-gradient-to-r from-blue-600 via-blue-500 to-cyan-500 rounded-t-lg relative overflow-hidden",children:[(0,Et.jsx)("div",{className:"absolute inset-0 opacity-20 dive-pattern-bg"}),(0,Et.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent to-white/30 mix-blend-overlay"})]}),(0,Et.jsx)("div",{className:"relative px-4 md:px-8 pb-4 md:pb-6 -mt-20 md:-mt-24",children:(0,Et.jsxs)("div",{className:"flex flex-col md:flex-row md:items-end space-y-4 md:space-y-0 md:space-x-6",children:[(0,Et.jsxs)("div",{className:"relative",children:[a&&""!==a.trim()?(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("img",{src:a,alt:i.name||"Profile",className:"w-24 h-24 md:w-32 md:h-32 rounded-xl border-3 border-white object-cover shadow-md",onError:e=>{console.log("Image failed to load:",a),e.target.onerror=null,e.target.style.display="none";try{const t=e.target.parentNode.querySelector(".fallback-avatar");t&&(t.style.display="flex")}catch(t){console.error("Error showing fallback:",t)}}},a),(0,Et.jsx)("div",{className:"w-24 h-24 md:w-32 md:h-32 rounded-xl border-3 border-white bg-gradient-to-br from-blue-100 to-blue-50 items-center justify-center shadow-md fallback-avatar",style:{display:"none"},children:(0,Et.jsx)(Lt,{className:"h-12 w-12 md:h-16 md:w-16 text-blue-500"})})]}):(0,Et.jsx)("div",{className:"w-24 h-24 md:w-32 md:h-32 rounded-xl border-3 border-white bg-gradient-to-br from-blue-100 to-blue-50 flex items-center justify-center shadow-md",children:(0,Et.jsx)(Lt,{className:"h-12 w-12 md:h-16 md:w-16 text-blue-500"})}),l?(0,Et.jsxs)("div",{className:"absolute -bottom-2 -right-2 flex space-x-1",children:[(0,Et.jsxs)("label",{className:"p-1.5 bg-blue-50 text-blue-700 rounded-full cursor-pointer hover:bg-blue-100 transition-colors shadow-sm border border-blue-200",children:[(0,Et.jsx)(Bt,{className:"h-3.5 w-3.5"}),(0,Et.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:c})]}),a&&""!==a.trim()&&(0,Et.jsx)("button",{onClick:u,className:"p-1.5 bg-red-50 text-red-700 rounded-full hover:bg-red-100 transition-colors shadow-sm border border-red-200",children:(0,Et.jsx)(zt,{className:"h-3.5 w-3.5"})})]}):(0,Et.jsx)("button",{onClick:o,className:"absolute -bottom-2 -right-2 p-1.5 bg-blue-50 text-blue-700 rounded-full hover:bg-blue-100 transition-colors shadow-sm border border-blue-200",children:(0,Et.jsx)(Ut,{className:"h-3.5 w-3.5"})})]}),(0,Et.jsxs)("div",{className:"flex-1 pt-3 md:pt-0",children:[(0,Et.jsx)("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:i.name||"New Diver"}),i.certificationLevel&&(0,Et.jsxs)("div",{className:"inline-flex items-center px-2 py-0.5 bg-blue-50 text-blue-700 rounded-full text-xs font-medium my-2 border border-blue-100",children:[(0,Et.jsx)(qt,{className:"h-3.5 w-3.5 mr-1"}),i.certificationLevel]}),(0,Et.jsxs)("div",{className:"flex flex-wrap gap-3 mt-2 text-xs text-gray-600",children:[!(null!==(t=i.privacySettings)&&void 0!==t&&t.hideLocation)&&(i.city||i.state)&&(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)(Vt,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),[i.city,i.state].filter(Boolean).join(", ")]}),!(null!==(n=i.privacySettings)&&void 0!==n&&n.hideEmail)&&i.email&&(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)(Ht,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),i.email]}),!(null!==(r=i.privacySettings)&&void 0!==r&&r.hidePhone)&&i.phone&&(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)(Wt,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),i.phone]})]})]}),!(null!==(s=i.privacySettings)&&void 0!==s&&s.hideStats)&&i.divingStats&&(0,Et.jsxs)("div",{className:"hidden md:flex space-x-3",children:[(0,Et.jsxs)("div",{className:"text-center bg-blue-50 rounded-lg px-3 py-1.5 border border-blue-100",children:[(0,Et.jsxs)("div",{className:"flex items-center justify-center text-blue-600 mb-1",children:[(0,Et.jsx)(Gt,{className:"h-3.5 w-3.5 mr-1"}),(0,Et.jsx)("span",{className:"text-xs font-medium",children:"Dives"})]}),(0,Et.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:i.divingStats.totalDives||0})]}),(0,Et.jsxs)("div",{className:"text-center bg-blue-50 rounded-lg px-3 py-1.5 border border-blue-100",children:[(0,Et.jsxs)("div",{className:"flex items-center justify-center text-blue-600 mb-1",children:[(0,Et.jsx)(Kt,{className:"h-3.5 w-3.5 mr-1"}),(0,Et.jsx)("span",{className:"text-xs font-medium",children:"Max Depth"})]}),(0,Et.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[i.divingStats.maxDepth||0,"ft"]})]}),(0,Et.jsxs)("div",{className:"text-center bg-blue-50 rounded-lg px-3 py-1.5 border border-blue-100",children:[(0,Et.jsxs)("div",{className:"flex items-center justify-center text-blue-600 mb-1",children:[(0,Et.jsx)(Qt,{className:"h-3.5 w-3.5 mr-1"}),(0,Et.jsx)("span",{className:"text-xs font-medium",children:"Hours"})]}),(0,Et.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[i.divingStats.totalTime||0,"h"]})]})]})]})})]})},Ds=e=>{let{profile:t}=e;const n=(()=>{const e=["name","phone","email","photoURL","bio","city","state","certificationLevel","favoritePlace","emergencyContact.name"],n=e.filter((e=>{if(e.includes(".")){var n;const[r,s]=e.split(".");return null===(n=t[r])||void 0===n?void 0:n[s]}return t[e]}));return Math.round(n.length/e.length*100)})();if(100===n)return null;return(0,Et.jsxs)("div",{className:"mb-5 bg-white rounded-lg p-3 md:p-4 border border-gray-100 shadow-sm",children:[(0,Et.jsxs)("div",{className:"flex justify-between mb-2 items-center",children:[(0,Et.jsxs)("span",{className:"text-xs font-medium text-gray-700 flex items-center",children:[(0,Et.jsx)(Gt,{className:"w-3.5 h-3.5 mr-1 text-blue-600"}),"Profile Completion"]}),(0,Et.jsxs)("span",{className:"text-xs font-bold text-gray-800 bg-gray-100 px-2 py-0.5 rounded-full",children:[n,"%"]})]}),(0,Et.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:(0,Et.jsx)("div",{className:"h-2 rounded-full transition-all duration-700 ease-in-out ".concat(n<30?"bg-red-500":n<70?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(n,"%")}})}),n<70?(0,Et.jsxs)("div",{className:"mt-2 text-xs text-gray-600 flex items-center",children:[(0,Et.jsx)(Yt,{className:"h-3 w-3 mr-1 text-yellow-500"}),"Complete your profile to unlock all features"]}):(0,Et.jsxs)("div",{className:"mt-2 text-xs text-gray-600 flex items-center",children:[(0,Et.jsx)(Jt,{className:"h-3 w-3 mr-1 text-green-500"}),"Almost there! Just a few more details to complete."]})]})},Ns=e=>{let{stats:t}=e;return t?(0,Et.jsxs)("div",{className:"grid grid-cols-3 gap-3 p-4 bg-gradient-to-br from-blue-50 to-white rounded-lg border border-blue-100",children:[(0,Et.jsxs)("div",{className:"text-center",children:[(0,Et.jsx)("div",{className:"text-2xl font-bold text-blue-700",children:t.totalDives||0}),(0,Et.jsxs)("div",{className:"text-xs text-gray-600 mt-1 flex items-center justify-center",children:[(0,Et.jsx)(Gt,{className:"w-3 h-3 mr-1"}),"Total Dives"]})]}),(0,Et.jsxs)("div",{className:"text-center",children:[(0,Et.jsxs)("div",{className:"text-2xl font-bold text-blue-700",children:[t.maxDepth||0,"ft"]}),(0,Et.jsxs)("div",{className:"text-xs text-gray-600 mt-1 flex items-center justify-center",children:[(0,Et.jsx)(Kt,{className:"w-3 h-3 mr-1"}),"Max Depth"]})]}),(0,Et.jsxs)("div",{className:"text-center",children:[(0,Et.jsxs)("div",{className:"text-2xl font-bold text-blue-700",children:[t.totalTime||0,"h"]}),(0,Et.jsxs)("div",{className:"text-xs text-gray-600 mt-1 flex items-center justify-center",children:[(0,Et.jsx)(Qt,{className:"w-3 h-3 mr-1"}),"Bottom Time"]})]})]}):null},js=e=>{let{title:t,icon:n,children:r,className:s=""}=e;return(0,Et.jsxs)("div",{className:"bg-white rounded-lg border border-gray-100 shadow-sm p-4 ".concat(s),children:[(0,Et.jsxs)("h2",{className:"text-sm uppercase font-semibold text-gray-700 mb-3 flex items-center tracking-wide",children:[n&&(0,Et.jsx)(n,{className:"h-4 w-4 text-blue-600 mr-2"}),t]}),r]})},Cs=e=>{var t,n,r,s,i,a,o;let{profile:l,loyaltyData:c,handleEditClick:u,isLogbookSynced:d}=e;const{user:h}=kt(),m=(()=>{const e=["name","phone","email","photoURL","bio","city","state","certificationLevel","favoritePlace","emergencyContact.name"],t=e.filter((e=>{if(e.includes(".")){var t;const[n,r]=e.split(".");return null===(t=l[n])||void 0===t?void 0:t[r]}return l[e]}));return Math.round(t.length/e.length*100)})();return(0,Et.jsxs)("div",{className:"bg-gray-50 rounded-lg shadow-sm overflow-hidden border border-gray-100",children:[(0,Et.jsx)(ws,{profile:l,photoURL:l.photoURL,handleEditClick:u,isEditing:!1}),(0,Et.jsxs)("div",{className:"px-4 py-5 space-y-5",children:[m<100&&(0,Et.jsx)(Ds,{profile:l}),!d&&(0,Et.jsx)("div",{className:"md:order-2 md:col-span-2",children:(0,Et.jsxs)(An,{className:"bg-blue-50 border-blue-200 text-sm p-3",children:[(0,Et.jsx)(nn,{className:"h-3.5 w-3.5 text-blue-600"}),(0,Et.jsx)(Sn,{className:"text-blue-700 text-xs ml-2",children:"Your profile dive count is being synced with your logbook."})]})}),(0,Et.jsxs)("div",{className:"flex flex-col md:grid md:grid-cols-2 md:gap-5 space-y-5 md:space-y-0",children:[!(null!==(t=l.privacySettings)&&void 0!==t&&t.hideStats)&&l.divingStats&&(0,Et.jsx)("div",{className:"md:order-1",children:(0,Et.jsx)(js,{title:"Diving Statistics",icon:Gt,children:(0,Et.jsx)(Ns,{stats:l.divingStats})})}),(0,Et.jsx)("div",{className:"md:order-3",children:(0,Et.jsxs)(js,{title:"Certifications",icon:qt,children:[(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Certification Level"}),(0,Et.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,Et.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs bg-blue-50 text-blue-700 font-medium border border-blue-100",children:l.certificationLevel||"Uncertified"}),"Instructor"===l.certificationLevel&&(null===(n=l.instructorCertifications)||void 0===n?void 0:n.map(((e,t)=>(0,Et.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs bg-blue-50 text-blue-700 border border-blue-100",children:[e.agency," #",e.number]},t))))]})]}),(null===(r=l.specialties)||void 0===r?void 0:r.length)>0&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Specialties"}),(0,Et.jsx)("div",{className:"flex flex-wrap gap-2",children:l.specialties.map(((e,t)=>(0,Et.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-lg text-xs bg-green-50 text-green-700 border border-green-100",children:e},t)))})]})]})}),(0,Et.jsx)("div",{className:"md:order-4",children:(0,Et.jsx)(js,{title:"Badges & Achievements",icon:rn,children:(0,Et.jsx)(gn,{certificationLevel:l.certificationLevel,specialties:l.specialties,numberOfDives:null===(s=l.divingStats)||void 0===s?void 0:s.totalDives,size:"small"})})}),(l.favoritePlace||(null===(i=l.diveTrips)||void 0===i?void 0:i.length)>0)&&(0,Et.jsx)("div",{className:"md:order-5",children:(0,Et.jsxs)(js,{title:"Experience",icon:sn,children:[l.favoritePlace&&(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Favorite Location"}),(0,Et.jsx)("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-100",children:(0,Et.jsxs)("p",{className:"text-sm text-gray-800",children:[l.favoritePlace,l.favoriteDivesite&&" - ".concat(l.favoriteDivesite)]})})]}),(null===(a=l.diveTrips)||void 0===a?void 0:a.length)>0&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recent Trips"}),(0,Et.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:l.diveTrips.sort(((e,t)=>t.year-e.year)).slice(0,6).map(((e,t)=>(0,Et.jsxs)("div",{className:"px-3 py-2 rounded-lg text-xs bg-gray-50 border border-gray-100 flex items-center",children:[(0,Et.jsx)(an,{className:"w-3 h-3 mr-2 text-gray-400"}),(0,Et.jsxs)("span",{className:"font-medium",children:[e.year,":"]})," ",e.location]},t)))})]})]})}),l.bio&&(0,Et.jsx)("div",{className:"md:order-6",children:(0,Et.jsx)(js,{title:"About",icon:Lt,children:(0,Et.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:l.bio})})}),!(null!==(o=l.privacySettings)&&void 0!==o&&o.hideSocial)&&l.socialLinks&&Object.entries(l.socialLinks).some((e=>{let[t,n]=e;return Boolean(n)}))&&(0,Et.jsx)("div",{className:"md:order-7",children:(0,Et.jsx)(js,{title:"Connect",icon:tn,children:(0,Et.jsx)("div",{className:"flex flex-wrap gap-3",children:Object.entries(l.socialLinks).map((e=>{let[t,n]=e;if(!n)return null;const r=(e=>{switch(e){case"instagram":return Xt;case"facebook":return $t;case"youtube":return Zt;case"twitter":return en;default:return tn}})(t);return(0,Et.jsxs)("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-lg text-gray-800 flex items-center transition-colors border border-gray-200 text-xs",children:[(0,Et.jsx)(r,{className:"h-3.5 w-3.5 mr-1.5 text-gray-600"}),(0,Et.jsx)("span",{className:"font-medium",children:t.charAt(0).toUpperCase()+t.slice(1)})]},t)}))})})}),(0,Et.jsx)("div",{className:"md:order-8 md:col-span-2",children:(0,Et.jsx)(ys,{loyaltyData:c,profile:l,userId:null===h||void 0===h?void 0:h.uid})})]})]})]})},Es=e=>{let{title:t,icon:n,children:r}=e;return(0,Et.jsxs)("div",{className:"bg-white rounded-lg border border-gray-100 shadow-sm p-4 mb-5",children:[(0,Et.jsxs)("h3",{className:"text-sm uppercase font-semibold text-gray-700 mb-3 flex items-center tracking-wide",children:[n&&(0,Et.jsx)(n,{className:"h-4 w-4 text-blue-600 mr-2"}),t]}),r]})},As=e=>{let{contact:t,onChange:n}=e;return(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Emergency Contact"}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Name"}),(0,Et.jsx)("input",{type:"text",value:(null===t||void 0===t?void 0:t.name)||"",onChange:e=>n("name",e.target.value),className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Emergency Contact Name"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Relationship"}),(0,Et.jsx)("input",{type:"text",value:(null===t||void 0===t?void 0:t.relationship)||"",onChange:e=>n("relationship",e.target.value),className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Spouse, Parent, etc."})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone"}),(0,Et.jsx)("input",{type:"tel",value:(null===t||void 0===t?void 0:t.phone)||"",onChange:e=>n("phone",e.target.value),className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Emergency Contact Phone"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Email"}),(0,Et.jsx)("input",{type:"email",value:(null===t||void 0===t?void 0:t.email)||"",onChange:e=>n("email",e.target.value),className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Emergency Contact Email"})]})]})]})},ks=e=>{let{certifications:t=[],onChange:n}=e;const r=["NAUI","SDI","TDI","PADI","SSI","Other"],s=(e,r,s)=>{const i=[...t];i[e]=(0,o.A)((0,o.A)({},i[e]),{},{[r]:s}),n(i)};return(0,Et.jsxs)("div",{className:"space-y-3",children:[(0,Et.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Instructor Certifications"}),t.map(((e,i)=>(0,Et.jsxs)("div",{className:"flex gap-2 items-start p-2.5 bg-gray-50 rounded-lg border border-gray-100",children:[(0,Et.jsxs)("select",{value:e.agency,onChange:e=>s(i,"agency",e.target.value),className:"flex-1 rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",children:[(0,Et.jsx)("option",{value:"",children:"Select Agency"}),r.map((e=>(0,Et.jsx)("option",{value:e,children:e},e)))]}),(0,Et.jsx)("input",{type:"text",value:e.number,onChange:e=>s(i,"number",e.target.value),placeholder:"Certification Number",className:"flex-1 rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm"}),(0,Et.jsx)("button",{type:"button",onClick:()=>(e=>{const r=t.filter(((t,n)=>n!==e));n(r)})(i),className:"p-1.5 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-full transition-colors",children:(0,Et.jsx)(zt,{className:"h-3.5 w-3.5"})})]},i))),(0,Et.jsxs)("button",{type:"button",onClick:()=>{n([...t,{agency:"",number:""}])},className:"flex items-center text-xs text-blue-600 hover:text-blue-800 py-1 px-2 bg-blue-50 hover:bg-blue-100 rounded-lg border border-blue-100 transition-colors",children:[(0,Et.jsx)(on,{className:"h-3.5 w-3.5 mr-1"}),"Add Certification"]})]})};const Ss=function(){const{user:e}=kt(),[t,n]=(0,r.useState)(!1),[s,i]=(0,r.useState)(!1),[a,l]=(0,r.useState)(null),[c,u]=(0,r.useState)({photoURL:"",name:"",phone:"",email:(null===e||void 0===e?void 0:e.email)||"",bio:"",city:"",state:"",diveTrips:[],favoritePlace:"",favoriteDivesite:"",certificationLevel:"",specialties:[],numberOfDives:0,syncWithLogbook:!1,instructorCertifications:[],emergencyContact:{name:"",relationship:"",phone:"",email:""},socialLinks:{instagram:"",facebook:"",youtube:"",twitter:""},privacySettings:{hideEmail:!1,hidePhone:!1,hideLocation:!1,hideStats:!1,hideSocial:!1},divingStats:{totalDives:0,maxDepth:0,totalTime:0}}),[d,h]=(0,r.useState)({lifetimePoints:0,redeemablePoints:0,currentTier:null,transactions:[],joinDate:null}),[m,f]=(0,r.useState)((0,o.A)({},c)),[p,g]=(0,r.useState)(!0),[v,x]=(0,r.useState)("profile"),y=["Student Diver","SCUBA Diver","Advanced SCUBA Diver","Rescue Diver","Advanced Rescue Diver","Master SCUBA Diver","Divemaster","Assistant Instructor","Instructor"],b=["Nitrox Diver","Drysuit Diver","First Aid/CPR","Emergency Oxygen Provider","Equipment Specialist","Deep Diver","Underwater Navigator","Solo Diver","Night Diver","Wreck Diver"],w=(0,r.useCallback)((e=>Object.entries(bs).reduce(((t,n)=>{let[r,s]=n;return e>=s.min&&e<=s.max?(0,o.A)({tier:r},s):t}),bs.OCEANIC_SILVER)),[]),D=(0,r.useCallback)((async()=>{if(null===e||void 0===e||!e.uid)return null;try{const t=(0,Dt.rJ)(wt.db,"profiles/".concat(e.uid,"/logbook")),n=await(0,Dt.GG)(t);if(!n.empty){const e=n.docs.map((e=>e.data())),t=e.length,r=Math.max(...e.map((e=>e.maxDepth||0))),s=e.reduce(((e,t)=>e+(t.bottomTime||0)),0);return{totalDives:t,maxDepth:r,totalTime:Math.round(s/60*10)/10}}return null}catch(t){return console.error("Error fetching dive stats:",t),null}}),[null===e||void 0===e?void 0:e.uid]);(0,r.useEffect)((()=>{(async()=>{if(null!==e&&void 0!==e&&e.uid)try{console.log("Fetching profile for user:",e.uid);const t=(0,Dt.H9)(wt.db,"profiles",e.uid),r=await(0,Dt.x7)(t);let s;if(r.exists()){s=r.data();const e={lifetimePoints:s.lifetimePoints||0,redeemablePoints:s.redeemablePoints||0,transactions:s.transactions||[],joinDate:s.joinDate||s.createdAt||(new Date).toISOString()},t=w(e.lifetimePoints);h((0,o.A)((0,o.A)({},e),{},{currentTier:t}))}else s={name:"",email:e.email||"",photoURL:"",divingStats:{totalDives:0,maxDepth:0,totalTime:0},createdAt:(new Date).toISOString()},h({lifetimePoints:0,redeemablePoints:0,transactions:[],joinDate:(new Date).toISOString(),currentTier:w(0)}),await(0,Dt.BN)(t,s,{merge:!0}),n(!0);if(s.syncWithLogbook){const e=await D();if(e){const n=JSON.stringify(s.divingStats)!==JSON.stringify(e);g(!n),n&&(s.divingStats=e,await(0,Dt.BN)(t,s,{merge:!0}))}}f(s),u(s)}catch(t){console.error("Error loading profile:",t),alert("Error loading profile: ".concat(t.message))}})()}),[e,D,w]);const N=e=>{const{name:t,value:n,type:r,checked:s}=e.target;if("syncWithLogbook"!==t)if(t.startsWith("divingStats.")){const e=t.split(".")[1];u((t=>(0,o.A)((0,o.A)({},t),{},{divingStats:(0,o.A)((0,o.A)({},t.divingStats),{},{[e]:"number"===r?Number(n):n})})))}else u("divingStats"!==t||"object"!==typeof n?e=>(0,o.A)((0,o.A)({},e),{},{[t]:"checkbox"===r?s:n}):e=>(0,o.A)((0,o.A)({},e),{},{divingStats:(0,o.A)((0,o.A)({},e.divingStats),n)}));else u((e=>(0,o.A)((0,o.A)({},e),{},{syncWithLogbook:s})))},j=(e,t)=>{u((n=>(0,o.A)((0,o.A)({},n),{},{emergencyContact:(0,o.A)((0,o.A)({},n.emergencyContact),{},{[e]:t})})))},C=e=>{u((t=>(0,o.A)((0,o.A)({},t),{},{instructorCertifications:e})))},E=e=>{const t=e.target.files[0],n=(e=>e?e.type.startsWith("image/")?e.size>5242880?"File size must be less than 5MB":null:"File must be an image":"No file selected")(t);if(n)return void alert(n);l(t);const r=URL.createObjectURL(t);u((e=>(0,o.A)((0,o.A)({},e),{},{photoURL:r})))},A=async()=>{if(window.confirm("Are you sure you want to delete your profile picture?"))try{if(m.photoURL){const e=(0,Ft.KR)(wt.IG,m.photoURL);await(0,Ft.XR)(e)}l(null),u((e=>(0,o.A)((0,o.A)({},e),{},{photoURL:""})))}catch(e){console.error("Error deleting photo:",e),alert("Failed to delete profile picture. Please try again.")}},k=()=>{n(!0)},S=()=>{u(m),l(null),n(!1)},F=async t=>{t.preventDefault(),i(!0);try{let t=c.photoURL||"",r=c.divingStats||{totalDives:0,maxDepth:0,totalTime:0};if(a){const n=Date.now(),r="".concat(n,"_").concat(a.name),s=(0,Ft.KR)(wt.IG,"users/".concat(e.uid,"/profile/").concat(r)),i=await a.arrayBuffer();await(0,Ft.D)(s,i),t=await(0,Ft.qk)(s)}if(c.syncWithLogbook){const e=await D();e&&(r=e)}const s=m.loyaltyCode||((e,t)=>{const n=e.trim().split(" "),r=(n.length>1?n[n.length-1]:e).toUpperCase().substring(0,8),s=t.substring(Math.max(0,t.length-6));return"".concat(r).concat(s)})(c.name||"",e.uid),i={name:c.name||"",email:c.email||e.email||"",photoURL:t,phone:c.phone||"",bio:c.bio||"",city:c.city||"",state:c.state||"",loyaltyCode:s,loyaltyAccess:{hasAccess:!0},divingStats:r,certificationLevel:c.certificationLevel||"",specialties:c.specialties||[],syncWithLogbook:Boolean(c.syncWithLogbook),instructorCertifications:c.instructorCertifications||[],diveTrips:c.diveTrips||[],favoritePlace:c.favoritePlace||"",favoriteDivesite:c.favoriteDivesite||"",emergencyContact:c.emergencyContact||{name:"",relationship:"",phone:"",email:""},socialLinks:c.socialLinks||{instagram:"",facebook:"",youtube:"",twitter:""},privacySettings:c.privacySettings||{hideEmail:!1,hidePhone:!1,hideLocation:!1,hideStats:!1,hideSocial:!1},lifetimePoints:d.lifetimePoints||0,redeemablePoints:d.redeemablePoints||0,transactions:d.transactions||[],joinDate:d.joinDate||(new Date).toISOString(),createdAt:m.createdAt||(new Date).toISOString(),updatedAt:(new Date).toISOString()};await(0,Dt.BN)((0,Dt.H9)(wt.db,"profiles",e.uid),i,{merge:!0});const o=await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",e.uid));if(!o.exists())throw new Error("Profile failed to save to database");const h=o.data();f(h),u(h),n(!1),g(!0),l(null)}catch(r){console.error("Error updating profile:",r),alert("Failed to update profile: ".concat(r.message))}i(!1)};return(0,Et.jsx)("div",{className:"max-w-4xl mx-auto p-4 mb-16",children:(0,Et.jsxs)(ss,{defaultValue:"profile",value:v,onValueChange:x,className:"w-full",children:[(0,Et.jsxs)(is,{className:"grid w-full grid-cols-2 mb-5",children:[(0,Et.jsxs)(as,{value:"profile",className:"text-xs py-2 flex items-center justify-center",children:[(0,Et.jsx)(Lt,{className:"h-3.5 w-3.5 mr-2"}),"Profile"]}),(0,Et.jsxs)(as,{value:"security",className:"text-xs py-2 flex items-center justify-center",children:[(0,Et.jsx)(ln,{className:"h-3.5 w-3.5 mr-2"}),"Security"]})]}),(0,Et.jsx)(os,{value:"profile",className:"focus:outline-none",children:t?(()=>{var e,t,n,r;return(0,Et.jsxs)("form",{onSubmit:F,className:"space-y-5",children:[(0,Et.jsxs)(Es,{title:"Profile Information",icon:Lt,children:[(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-5 mb-5",children:[(0,Et.jsxs)("div",{className:"relative",children:[c.photoURL&&""!==c.photoURL.trim()?(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("img",{src:c.photoURL,alt:"Profile",className:"w-24 h-24 rounded-xl border-3 border-white object-cover shadow-md",onError:e=>{e.target.onerror=null,e.target.style.display="none";e.target.parentNode.querySelector(".fallback-avatar").style.display="flex"}}),(0,Et.jsx)("div",{className:"w-24 h-24 rounded-xl border-3 border-white bg-gradient-to-br from-blue-100 to-blue-50 items-center justify-center shadow-md fallback-avatar",style:{display:"none"},children:(0,Et.jsx)(Lt,{className:"h-12 w-12 text-blue-500"})})]}):(0,Et.jsx)("div",{className:"w-24 h-24 rounded-xl border-3 border-white bg-gradient-to-br from-blue-100 to-blue-50 flex items-center justify-center shadow-md",children:(0,Et.jsx)(Lt,{className:"h-12 w-12 text-blue-500"})}),(0,Et.jsxs)("div",{className:"absolute -bottom-2 -right-2 flex space-x-1",children:[(0,Et.jsxs)("label",{className:"p-1.5 bg-blue-50 rounded-full text-blue-700 cursor-pointer hover:bg-blue-100 transition-colors shadow-sm border border-blue-200",children:[(0,Et.jsx)(Bt,{className:"h-3.5 w-3.5"}),(0,Et.jsx)("input",{type:"file",className:"hidden",accept:"image/*",onChange:E})]}),c.photoURL&&""!==c.photoURL.trim()&&(0,Et.jsx)("button",{type:"button",onClick:A,className:"p-1.5 bg-red-50 rounded-full text-red-700 hover:bg-red-100 transition-colors shadow-sm border border-red-200",children:(0,Et.jsx)(zt,{className:"h-3.5 w-3.5"})})]})]}),(0,Et.jsx)("div",{className:"flex-1 grid grid-cols-1 gap-4 w-full",children:(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1",children:"Full Name"}),(0,Et.jsx)("input",{type:"text",name:"name",value:c.name||"",onChange:N,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Your Name"})]})})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 gap-4 mt-4",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1",children:"Email"}),(0,Et.jsx)("input",{type:"email",name:"email",value:c.email||"",onChange:N,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"email@example.com"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1",children:"Phone"}),(0,Et.jsx)("input",{type:"tel",name:"phone",value:c.phone||"",onChange:N,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"(555) 555-5555"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1",children:"Bio"}),(0,Et.jsx)("textarea",{name:"bio",value:c.bio||"",onChange:N,rows:3,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Tell us about your diving experience..."})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1",children:"City"}),(0,Et.jsx)("input",{type:"text",name:"city",value:c.city||"",onChange:N,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Your City"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-xs font-medium text-gray-700 mb-1",children:"State/Country"}),(0,Et.jsx)("input",{type:"text",name:"state",value:c.state||"",onChange:N,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Your State or Country"})]})]})]})]}),(0,Et.jsxs)(Es,{title:"Diving Statistics",icon:Gt,children:[(0,Et.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,Et.jsx)("div",{className:"flex items-center",children:(0,Et.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only peer",name:"syncWithLogbook",checked:c.syncWithLogbook,onChange:N}),(0,Et.jsx)("div",{className:"w-9 h-5 bg-gray-200 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"}),(0,Et.jsx)("span",{className:"ml-2 text-xs font-medium text-gray-700",children:"Sync with Logbook"})]})})}),c.syncWithLogbook?(0,Et.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-3 rounded text-sm",children:(0,Et.jsx)("div",{className:"flex items-center",children:(0,Et.jsx)("div",{className:"ml-3",children:(0,Et.jsx)("p",{className:"text-xs text-blue-700",children:"Statistics will be automatically calculated from your logbook entries."})})})}):(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Total Dives"}),(0,Et.jsx)("input",{type:"number",name:"divingStats.totalDives",value:(null===(e=c.divingStats)||void 0===e?void 0:e.totalDives)||0,onChange:e=>{const t=parseInt(e.target.value,10);N({target:{name:"divingStats",value:(0,o.A)((0,o.A)({},c.divingStats),{},{totalDives:t>=0?t:0})}})},min:"0",className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Max Depth (ft)"}),(0,Et.jsx)("input",{type:"number",name:"divingStats.maxDepth",value:(null===(t=c.divingStats)||void 0===t?void 0:t.maxDepth)||0,onChange:e=>{const t=parseInt(e.target.value,10);N({target:{name:"divingStats",value:(0,o.A)((0,o.A)({},c.divingStats),{},{maxDepth:t>=0?t:0})}})},min:"0",className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bottom Time (hours)"}),(0,Et.jsx)("input",{type:"number",name:"divingStats.totalTime",value:(null===(n=c.divingStats)||void 0===n?void 0:n.totalTime)||0,onChange:e=>{const t=parseFloat(e.target.value);N({target:{name:"divingStats",value:(0,o.A)((0,o.A)({},c.divingStats),{},{totalTime:t>=0?t:0})}})},min:"0",step:"0.1",className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm"})]})]})]}),(0,Et.jsxs)(Es,{title:"Certifications & Skills",icon:qt,children:[(0,Et.jsxs)("div",{className:"mb-5",children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Certification Level"}),(0,Et.jsxs)("select",{name:"certificationLevel",value:c.certificationLevel||"",onChange:N,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",children:[(0,Et.jsx)("option",{value:"",children:"Select Certification Level"}),y.map((e=>(0,Et.jsx)("option",{value:e,children:e},e)))]})]}),(0,Et.jsxs)("div",{className:"mb-5",children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Specialties"}),(0,Et.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:b.map((e=>{var t;return(0,Et.jsxs)("label",{className:"flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors border border-gray-100",children:[(0,Et.jsx)("input",{type:"checkbox",checked:(null===(t=c.specialties)||void 0===t?void 0:t.includes(e))||!1,onChange:()=>(e=>{var t;const n=null!==(t=c.specialties)&&void 0!==t&&t.includes(e)?c.specialties.filter((t=>t!==e)):[...c.specialties||[],e];u((e=>(0,o.A)((0,o.A)({},e),{},{specialties:n})))})(e),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-3.5 w-3.5"}),(0,Et.jsx)("span",{className:"ml-2 text-xs text-gray-700",children:e})]},e)}))})]})]}),(0,Et.jsxs)(Es,{title:"Dive Experience",icon:sn,children:[(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Favorite Place"}),(0,Et.jsx)("input",{type:"text",name:"favoritePlace",value:c.favoritePlace||"",onChange:N,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"e.g., Cozumel, Mexico"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Favorite Dive Site"}),(0,Et.jsx)("input",{type:"text",name:"favoriteDivesite",value:c.favoriteDivesite||"",onChange:N,className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"e.g., Palancar Reef"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Et.jsx)("label",{className:"block text-xs font-medium text-gray-700",children:"Dive Trips"}),(0,Et.jsxs)("button",{type:"button",onClick:()=>{const e=[...c.diveTrips||[],{location:"",year:(new Date).getFullYear()}];N({target:{name:"diveTrips",value:e}})},className:"text-xs text-blue-700 flex items-center bg-blue-50 px-2 py-1 rounded-lg border border-blue-100 hover:bg-blue-100 transition-colors",children:[(0,Et.jsx)(on,{className:"h-3.5 w-3.5 mr-1"}),"Add Trip"]})]}),(0,Et.jsxs)("div",{className:"space-y-2 max-h-64 overflow-y-auto pr-2",children:[(c.diveTrips||[]).map(((e,t)=>(0,Et.jsxs)("div",{className:"flex gap-2 items-center bg-gray-50 p-2 rounded-lg border border-gray-100",children:[(0,Et.jsx)("div",{className:"flex-1",children:(0,Et.jsx)("input",{type:"text",value:e.location||"",onChange:e=>{const n=[...c.diveTrips||[]];n[t]=(0,o.A)((0,o.A)({},n[t]),{},{location:e.target.value}),N({target:{name:"diveTrips",value:n}})},className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Location"})}),(0,Et.jsx)("div",{className:"w-24",children:(0,Et.jsx)("input",{type:"number",value:e.year||(new Date).getFullYear(),onChange:e=>{const n=[...c.diveTrips||[]];n[t]=(0,o.A)((0,o.A)({},n[t]),{},{year:e.target.value}),N({target:{name:"diveTrips",value:n}})},className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm",placeholder:"Year",min:"1900",max:(new Date).getFullYear()})}),(0,Et.jsx)("button",{type:"button",onClick:()=>{const e=[...c.diveTrips||[]].filter(((e,n)=>n!==t));N({target:{name:"diveTrips",value:e}})},className:"p-1.5 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-full transition-colors",children:(0,Et.jsx)(zt,{className:"h-3.5 w-3.5"})})]},t))),!(null!==(r=c.diveTrips)&&void 0!==r&&r.length)&&(0,Et.jsx)("div",{className:"text-center p-3 text-gray-500 italic bg-gray-50 rounded-lg border border-gray-100 text-xs",children:"No trips added yet"})]})]})]}),(0,Et.jsx)(Es,{title:"Privacy Settings",icon:ln,children:(0,Et.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[{id:"hideEmail",label:"Hide email from other divers",icon:Ht},{id:"hidePhone",label:"Hide phone number",icon:Wt},{id:"hideLocation",label:"Hide location",icon:Vt},{id:"hideStats",label:"Hide diving statistics",icon:Gt},{id:"hideSocial",label:"Hide social media links",icon:tn}].map((e=>{var t;let{id:n,label:r,icon:s}=e;return(0,Et.jsxs)("label",{className:"flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors border border-gray-100",children:[(0,Et.jsx)("input",{type:"checkbox",checked:(null===(t=c.privacySettings)||void 0===t?void 0:t[n])||!1,onChange:e=>{return t=n,r=e.target.checked,void u((e=>(0,o.A)((0,o.A)({},e),{},{privacySettings:(0,o.A)((0,o.A)({},e.privacySettings),{},{[t]:r})})));var t,r},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 h-3.5 w-3.5"}),(0,Et.jsxs)("span",{className:"ml-2 text-xs text-gray-700 flex items-center",children:[(0,Et.jsx)(s,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),r]})]},n)}))})}),(0,Et.jsx)(Es,{title:"Emergency Contact",icon:Yt,children:(0,Et.jsx)(As,{contact:c.emergencyContact,onChange:j})}),"Instructor"===c.certificationLevel&&(0,Et.jsx)(Es,{title:"Instructor Certifications",icon:rn,children:(0,Et.jsx)(ks,{certifications:c.instructorCertifications||[],onChange:C})}),(0,Et.jsx)(Es,{title:"Social Media",icon:tn,children:(0,Et.jsx)("div",{className:"space-y-3",children:[{name:"instagram",label:"Instagram",icon:Xt},{name:"facebook",label:"Facebook",icon:$t},{name:"youtube",label:"YouTube",icon:Zt},{name:"twitter",label:"Twitter",icon:en}].map((e=>{var t;let{name:n,label:r,icon:s}=e;return(0,Et.jsx)("div",{className:"flex items-center space-x-2",children:(0,Et.jsxs)("div",{className:"flex-1",children:[(0,Et.jsxs)("label",{className:"text-xs font-medium text-gray-700 mb-1 flex items-center",children:[(0,Et.jsx)(s,{className:"h-3.5 w-3.5 mr-1 text-gray-500"}),r]}),(0,Et.jsx)("input",{type:"text",value:(null===(t=c.socialLinks)||void 0===t?void 0:t[n])||"",onChange:e=>{return t=n,r=e.target.value,void u((e=>(0,o.A)((0,o.A)({},e),{},{socialLinks:(0,o.A)((0,o.A)({},e.socialLinks),{},{[t]:r})})));var t,r},placeholder:"".concat(r," URL"),className:"w-full rounded border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 py-1.5 px-2 text-sm"})]})},n)}))})}),(0,Et.jsxs)("div",{className:"flex justify-end space-x-3 sticky bottom-0 bg-white p-3 shadow-sm rounded-lg border border-gray-100 z-10",children:[(0,Et.jsxs)("button",{type:"button",onClick:S,className:"py-1.5 px-3 text-xs text-gray-700 bg-gray-100 hover:bg-gray-200 border border-gray-200 rounded transition-colors flex items-center",children:[(0,Et.jsx)(cn,{className:"mr-1.5 h-3.5 w-3.5"}),"Cancel"]}),(0,Et.jsx)("button",{type:"submit",disabled:s,className:"py-1.5 px-3 text-xs text-blue-700 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded transition-colors flex items-center",children:s?(0,Et.jsx)(Et.Fragment,{children:"Loading..."}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(un,{className:"mr-1.5 h-3.5 w-3.5"}),"Save Changes"]})})]})]})})():(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Cs,{profile:m,loyaltyData:d,handleEditClick:k,isLogbookSynced:p}),(0,Et.jsx)("div",{className:"mt-5 flex justify-center",children:(0,Et.jsxs)("button",{onClick:k,className:"py-1.5 px-4 bg-blue-50 text-blue-700 text-sm rounded border border-blue-200 hover:bg-blue-100 transition-colors flex items-center shadow-sm",children:[(0,Et.jsx)(Ut,{className:"mr-1.5 h-3.5 w-3.5"}),"Edit Profile"]})})]})}),(0,Et.jsx)(os,{value:"security",children:(0,Et.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden p-4 border border-gray-100",children:(0,Et.jsx)(cs,{})})})]})})};const Fs=function(){const[e,t]=(0,r.useState)(""),[n,s]=(0,r.useState)(""),[i,a]=(0,r.useState)(""),[o,l]=(0,r.useState)(!1),{login:c,signInWithGoogle:u}=kt(),d=de();return(0,Et.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:(0,Et.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,Et.jsx)("div",{children:(0,Et.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to UWW Buddies"})}),(0,Et.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{t.preventDefault(),l(!0),a("");try{await c(e,n),d("/")}catch(i){console.error("Login error:",i),"auth/invalid-credential"===i.code||"auth/wrong-password"===i.code?a("Invalid email or password. Please try again."):"auth/user-not-found"===i.code?a("No account found with this email. Please sign up."):"auth/too-many-requests"===i.code?a("Too many unsuccessful login attempts. Please try again later or reset your password."):a("Failed to login: "+i.message)}finally{l(!1)}},children:[i&&(0,Et.jsx)("div",{className:"text-red-500 text-center",children:i}),(0,Et.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,Et.jsx)("div",{children:(0,Et.jsx)("input",{type:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:e=>t(e.target.value)})}),(0,Et.jsx)("div",{children:(0,Et.jsx)("input",{type:"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:n,onChange:e=>s(e.target.value)})})]}),(0,Et.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,Et.jsx)("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900",children:"Remember me"})]}),(0,Et.jsx)("div",{className:"text-sm",children:(0,Et.jsx)(mt,{to:"/forgot-password",className:"font-medium text-blue-600 hover:text-blue-500",children:"Forgot your password?"})})]}),(0,Et.jsx)("div",{children:(0,Et.jsx)("button",{type:"submit",disabled:o,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:o?"Signing in...":"Sign in"})}),(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,Et.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,Et.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,Et.jsx)("span",{className:"px-2 bg-gray-100 text-gray-500",children:"Or sign in with"})})]}),(0,Et.jsx)("div",{className:"mt-4",children:(0,Et.jsxs)("button",{type:"button",onClick:async()=>{l(!0),a("");try{await u(),d("/")}catch(i){a("Failed to sign in with Google. "+i.message)}finally{l(!1)}},disabled:o,className:"w-full flex justify-center items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,Et.jsx)("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,Et.jsxs)("g",{transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[(0,Et.jsx)("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),(0,Et.jsx)("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),(0,Et.jsx)("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),(0,Et.jsx)("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),"Sign in with Google"]})})]})]}),(0,Et.jsx)("div",{className:"text-center mt-4",children:(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",(0,Et.jsx)(mt,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"Register here"})]})})]})})};const _s=function(){const[e,t]=(0,r.useState)(""),[n,s]=(0,r.useState)(""),[i,a]=(0,r.useState)(""),[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),{signup:d,signInWithGoogle:h}=kt(),m=de();return(0,Et.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:(0,Et.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your UWW Buddies account"}),(0,Et.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"You'll need to verify your email address after registration"})]}),(0,Et.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{if(t.preventDefault(),u(!0),n!==i)return u(!1),l("Passwords do not match");if(n.length<6)return u(!1),l("Password must be at least 6 characters long");try{await d(e,n),m("/verify-email")}catch(o){console.error("Signup error:",o),"auth/email-already-in-use"===o.code?l("An account with this email already exists."):"auth/invalid-email"===o.code?l("Invalid email address format."):"auth/weak-password"===o.code?l("Password is too weak. Please use at least 6 characters."):l("Failed to create account: "+o.message)}finally{u(!1)}},children:[o&&(0,Et.jsx)("div",{className:"text-red-500 text-center",children:o}),(0,Et.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,Et.jsx)("div",{children:(0,Et.jsx)("input",{type:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:e=>t(e.target.value)})}),(0,Et.jsx)("div",{children:(0,Et.jsx)("input",{type:"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:n,onChange:e=>s(e.target.value)})}),(0,Et.jsx)("div",{children:(0,Et.jsx)("input",{type:"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password",value:i,onChange:e=>a(e.target.value)})})]}),(0,Et.jsx)("div",{children:(0,Et.jsx)("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:c?"Creating account...":"Create Account"})}),(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,Et.jsx)("div",{className:"w-full border-t border-gray-300"})}),(0,Et.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,Et.jsx)("span",{className:"px-2 bg-gray-100 text-gray-500",children:"Or sign up with"})})]}),(0,Et.jsx)("div",{className:"mt-4",children:(0,Et.jsxs)("button",{type:"button",onClick:async()=>{u(!0),l("");try{(await h()).user.emailVerified?m("/profile"):m("/verify-email")}catch(o){l("Failed to sign up with Google: "+o.message)}finally{u(!1)}},disabled:c,className:"w-full flex justify-center items-center py-2 px-4 border border-gray-300 rounded-md shadow-sm bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,Et.jsx)("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,Et.jsxs)("g",{transform:"matrix(1, 0, 0, 1, 27.009001, -39.238998)",children:[(0,Et.jsx)("path",{fill:"#4285F4",d:"M -3.264 51.509 C -3.264 50.719 -3.334 49.969 -3.454 49.239 L -14.754 49.239 L -14.754 53.749 L -8.284 53.749 C -8.574 55.229 -9.424 56.479 -10.684 57.329 L -10.684 60.329 L -6.824 60.329 C -4.564 58.239 -3.264 55.159 -3.264 51.509 Z"}),(0,Et.jsx)("path",{fill:"#34A853",d:"M -14.754 63.239 C -11.514 63.239 -8.804 62.159 -6.824 60.329 L -10.684 57.329 C -11.764 58.049 -13.134 58.489 -14.754 58.489 C -17.884 58.489 -20.534 56.379 -21.484 53.529 L -25.464 53.529 L -25.464 56.619 C -23.494 60.539 -19.444 63.239 -14.754 63.239 Z"}),(0,Et.jsx)("path",{fill:"#FBBC05",d:"M -21.484 53.529 C -21.734 52.809 -21.864 52.039 -21.864 51.239 C -21.864 50.439 -21.724 49.669 -21.484 48.949 L -21.484 45.859 L -25.464 45.859 C -26.284 47.479 -26.754 49.299 -26.754 51.239 C -26.754 53.179 -26.284 54.999 -25.464 56.619 L -21.484 53.529 Z"}),(0,Et.jsx)("path",{fill:"#EA4335",d:"M -14.754 43.989 C -12.984 43.989 -11.404 44.599 -10.154 45.789 L -6.734 42.369 C -8.804 40.429 -11.514 39.239 -14.754 39.239 C -19.444 39.239 -23.494 41.939 -25.464 45.859 L -21.484 48.949 C -20.534 46.099 -17.884 43.989 -14.754 43.989 Z"})]})}),"Sign up with Google"]})})]})]}),(0,Et.jsx)("div",{className:"text-center mt-4",children:(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",(0,Et.jsx)(mt,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"Sign in here"})]})})]})})};const Ts=function(){const[e,t]=(0,r.useState)(""),[n,s]=(0,r.useState)(""),[i,a]=(0,r.useState)(""),[o,l]=(0,r.useState)(!1),{resetPassword:c}=kt();return(0,Et.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:(0,Et.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-md",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Reset Your Password"}),(0,Et.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Enter your email address and we'll send you a link to reset your password"})]}),(0,Et.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async n=>{n.preventDefault(),l(!0),s(""),a("");try{await c(e),s("Password reset email sent! Check your inbox for further instructions."),t("")}catch(i){a(i.message||"Failed to send password reset email. Please try again."),console.error("Reset password error:",i)}finally{l(!1)}},children:[n&&(0,Et.jsx)("div",{className:"bg-green-50 border-l-4 border-green-400 p-4",children:(0,Et.jsxs)("div",{className:"flex",children:[(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,Et.jsx)("div",{className:"ml-3",children:(0,Et.jsx)("p",{className:"text-sm text-green-700",children:n})})]})}),i&&(0,Et.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4",children:(0,Et.jsxs)("div",{className:"flex",children:[(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,Et.jsx)("div",{className:"ml-3",children:(0,Et.jsx)("p",{className:"text-sm text-red-700",children:i})})]})}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),(0,Et.jsx)("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-md relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:e=>t(e.target.value)})]}),(0,Et.jsx)("div",{children:(0,Et.jsx)("button",{type:"submit",disabled:o,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:o?"Sending...":"Reset Password"})})]}),(0,Et.jsx)("div",{className:"text-center mt-4",children:(0,Et.jsx)("div",{className:"text-sm",children:(0,Et.jsx)(mt,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"Back to Login"})})})]})})};const Is=function(){const{user:e,sendVerificationEmail:t,logout:n}=kt(),[s,i]=(0,r.useState)(""),[a,o]=(0,r.useState)(""),[l,c]=(0,r.useState)(!1),u=de();return(0,r.useEffect)((()=>{e?e.emailVerified&&u("/"):u("/login")}),[e,u]),e?(0,Et.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:(0,Et.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-md",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h2",{className:"text-center text-3xl font-extrabold text-gray-900",children:"Verify Your Email"}),(0,Et.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["We've sent a verification email to ",(0,Et.jsx)("span",{className:"font-medium",children:null===e||void 0===e?void 0:e.email})]}),(0,Et.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Please check your inbox and click on the link to verify your account."})]}),s&&(0,Et.jsx)("div",{className:"mt-4 bg-green-50 border-l-4 border-green-400 p-4",children:(0,Et.jsxs)("div",{className:"flex",children:[(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,Et.jsx)("div",{className:"ml-3",children:(0,Et.jsx)("p",{className:"text-sm text-green-700",children:s})})]})}),a&&(0,Et.jsx)("div",{className:"mt-4 bg-red-50 border-l-4 border-red-400 p-4",children:(0,Et.jsxs)("div",{className:"flex",children:[(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,Et.jsx)("div",{className:"ml-3",children:(0,Et.jsx)("p",{className:"text-sm text-red-700",children:a})})]})}),(0,Et.jsxs)("div",{className:"mt-6 flex flex-col space-y-4",children:[(0,Et.jsx)("button",{onClick:async()=>{c(!0),i(""),o("");try{await t(),i("Verification email sent! Please check your inbox.")}catch(a){o("Failed to send verification email. Please try again later."),console.error(a)}finally{c(!1)}},disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:l?"Sending...":"Resend Verification Email"}),(0,Et.jsx)("button",{onClick:async()=>{try{await n(),u("/login")}catch(a){o("Failed to log out."),console.error(a)}},className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Log Out"})]})]})}):null};var Rs=n(9526),Ps=n(6431);n(4857);const Os=(0,r.createContext)(),Ms=function(e,t){const n=new Map;e.forEach((e=>n.set(e.id,e))),t.forEach((e=>{var t;const r=n.get(e.id);r&&null!==(t=e.type)&&void 0!==t&&t.includes("broadcast")?n.set(e.id,(0,o.A)((0,o.A)({},e),{},{readStatus:(0,o.A)((0,o.A)({},r.readStatus||{}),e.readStatus||{}),readCount:Math.max(r.readCount||0,e.readCount||0),readBy:Array.from(new Set([...r.readBy||[],...e.readBy||[]]))})):n.set(e.id,e)}));const r=Array.from(n.values()).sort(((e,t)=>{var n,r;return((null===(n=e.timestamp)||void 0===n?void 0:n.getTime())||0)-((null===(r=t.timestamp)||void 0===r?void 0:r.getTime())||0)}));return r},Ls="SET_MESSAGES",Bs="ADD_MESSAGE",zs="ADD_OLDER_MESSAGES",Us="UPDATE_MESSAGE",qs="EDIT_MESSAGE",Vs="UPDATE_MESSAGE_READ_STATUS",Hs="SET_LOADING",Ws="SET_LOADING_MORE",Gs="SET_ERROR",Ks="SET_HAS_MORE",Qs="CLEAR_MESSAGES",Ys="SET_BUDDIES",Js="UPDATE_BUDDY_STATUS",Xs="SET_SEARCH_RESULTS",$s="SET_SEARCH_LOADING",Zs="SET_SEARCH_ERROR",ei="CLEAR_SEARCH",ti="SET_FILE_UPLOAD_PROGRESS",ni="SET_FILE_UPLOAD_ERROR",ri="CLEAR_FILE_UPLOAD",si="UPDATE_MESSAGE_REACTIONS",ii="SET_TYPING_USERS",ai="SET_TYPING_SUBSCRIPTION",oi="SET_MESSAGE_SUBSCRIPTION",li={messages:[],loading:!1,loadingMore:!1,error:null,hasMore:!0,currentChatId:null,currentCourseId:null,currentTripId:null,buddies:[],buddyRequests:[],messageSubscription:null,searchResults:[],searchLoading:!1,searchError:null,isSearching:!1,fileUploadProgress:0,fileUploadError:null,typingUsers:[],typingSubscription:null},ci=(e,t)=>{switch(t.type){case Ls:return(0,o.A)((0,o.A)({},e),{},{messages:Ms(e.messages,t.payload.messages),hasMore:t.payload.hasMore,loading:!1,error:null});case ii:return(0,o.A)((0,o.A)({},e),{},{typingUsers:t.payload});case ai:return(0,o.A)((0,o.A)({},e),{},{typingSubscription:t.payload});case oi:return(0,o.A)((0,o.A)({},e),{},{messageSubscription:t.payload});case Bs:return e.messages.some((e=>e.id===t.payload.id))?e:(0,o.A)((0,o.A)({},e),{},{messages:Ms(e.messages,[t.payload])});case zs:return(0,o.A)((0,o.A)({},e),{},{messages:Ms(e.messages,t.payload.messages,!0),hasMore:t.payload.hasMore,loadingMore:!1});case Us:return(0,o.A)((0,o.A)({},e),{},{messages:e.messages.map((e=>e.id===t.payload.id?(0,o.A)((0,o.A)({},e),t.payload):e))});case qs:return(0,o.A)((0,o.A)({},e),{},{messages:e.messages.map((e=>e.id===t.payload.id?(0,o.A)((0,o.A)({},e),{},{text:t.payload.text,isEdited:!0,lastEditedAt:t.payload.lastEditedAt,editHistory:t.payload.editHistory}):e))});case Vs:return(0,o.A)((0,o.A)({},e),{},{messages:e.messages.map((e=>e.id===t.payload.messageId?(0,o.A)((0,o.A)({},e),{},{readStatus:(0,o.A)((0,o.A)({},e.readStatus),{},{[t.payload.userId]:{read:!0,readAt:t.payload.readAt}}),readCount:(e.readCount||0)+1,readBy:[...e.readBy||[],t.payload.userId]}):e))});case Hs:return(0,o.A)((0,o.A)({},e),{},{loading:t.payload});case Ws:return(0,o.A)((0,o.A)({},e),{},{loadingMore:t.payload});case Gs:return(0,o.A)((0,o.A)({},e),{},{error:"object"===typeof t.payload&&null!==t.payload?t.payload.message||"An unknown error occurred":t.payload,loading:!1,loadingMore:!1});case Ks:return(0,o.A)((0,o.A)({},e),{},{hasMore:t.payload});case Qs:return(0,o.A)((0,o.A)({},e),{},{messages:[],hasMore:!0,error:null});case Ys:return(0,o.A)((0,o.A)({},e),{},{buddies:t.payload});case Js:return(0,o.A)((0,o.A)({},e),{},{buddies:t.payload.isAdding?[...e.buddies,t.payload.buddyId]:e.buddies.filter((e=>e!==t.payload.buddyId))});case si:return(0,o.A)((0,o.A)({},e),{},{messages:e.messages.map((e=>e.id===t.payload.id?(0,o.A)((0,o.A)({},e),{},{reactions:t.payload.reactions}):e))});case Xs:return(0,o.A)((0,o.A)({},e),{},{searchResults:t.payload,searchLoading:!1,isSearching:!0});case $s:return(0,o.A)((0,o.A)({},e),{},{searchLoading:t.payload});case Zs:return(0,o.A)((0,o.A)({},e),{},{searchError:"object"===typeof t.payload&&null!==t.payload?t.payload.message||"Search failed":t.payload,searchLoading:!1});case ei:return(0,o.A)((0,o.A)({},e),{},{searchResults:[],searchError:null,isSearching:!1});case ti:return(0,o.A)((0,o.A)({},e),{},{fileUploadProgress:t.payload,fileUploadError:null});case ni:return(0,o.A)((0,o.A)({},e),{},{fileUploadError:"object"===typeof t.payload&&null!==t.payload?t.payload.message||"File upload failed":t.payload,fileUploadProgress:0});case ri:return(0,o.A)((0,o.A)({},e),{},{fileUploadProgress:0,fileUploadError:null});default:return e}},ui=e=>{let{children:t}=e;const{user:n}=kt(),[s,i]=(0,r.useReducer)(ci,li),l=(0,r.useRef)({messageSubscription:null,typingSubscription:null}),c=(0,r.useCallback)((e=>{const t=l.current[e];if("function"===typeof t)try{t(),l.current[e]=null}catch(n){console.error("Error unsubscribing from ".concat(e,":"),n)}}),[]),u=(0,r.useCallback)((e=>{let{messages:t,error:n,hasMore:r}=e;i(n?{type:Gs,payload:"object"===typeof n&&null!==n?n.message||"Error loading messages":n}:{type:Ls,payload:{messages:t,hasMore:r}})}),[]),d=(0,r.useCallback)((e=>{i({type:ii,payload:Array.isArray(e)?e:[]})}),[]),h=(0,r.useCallback)((e=>{c("typingSubscription");let t=null;try{t=Ps.default.subscribeToTypingStatus(e,d),l.current.typingSubscription=t,i({type:ai,payload:t})}catch(n){console.error("Error in subscribeToTypingStatus:",n),t=()=>{}}return t||(()=>{})}),[d,c]),m=(0,r.useCallback)((async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(null!==n&&void 0!==n&&n.uid)try{await Ps.default.setTypingStatus(e,n.uid,t)}catch(r){console.error("Error setting typing status:",r)}}),[null===n||void 0===n?void 0:n.uid]),f=(0,r.useCallback)((async(e,t)=>{try{if(!e)throw new Dn.uV("Message data is required",Dn.wU.VALIDATION);if(!t)throw new Dn.uV("File is required",Dn.wU.VALIDATION);i({type:ri});const n=await Ps.default.sendMessageWithFile(e,t);return i({type:Bs,payload:n}),n}catch(n){const e=(0,Dn.H4)(n,"sendMessageWithFile");throw i({type:ni,payload:"object"===typeof e&&null!==e?e.message||"Failed to upload file":e||"Failed to upload file"}),e}}),[i]),p=(0,r.useCallback)((async(e,t)=>{if(e&&t)if(n&&n.uid)try{const l=s.messages.findIndex((t=>t.id===e));if(-1===l)return void console.warn("Cannot add reaction to non-existent message");const c=n.displayName||n.email||"Unknown User",u=s.messages[l].reactions||{};let d=(0,o.A)({},u);if(d[t]){var r;if(null===(r=d[t].users)||void 0===r?void 0:r[n.uid]){const e=d[t].users,r=n.uid,{[r]:s}=e,i=(0,a.A)(e,[r].map(Rs.A)),o=Math.max(0,(d[t].count||1)-1);if(0===o){const{[t]:e}=d;d=(0,a.A)(d,[t].map(Rs.A))}else d[t]={count:o,users:i}}else d[t]={count:(d[t].count||0)+1,users:(0,o.A)((0,o.A)({},d[t].users),{},{[n.uid]:{name:c,timestamp:new Date}})}}else d[t]={count:1,users:{[n.uid]:{name:c,timestamp:new Date}}};i({type:si,payload:{id:e,reactions:d}});return await Ps.default.addReaction(e,n.uid,t,c)}catch(l){console.error("Error adding reaction:",l),i({type:Gs,payload:"object"===typeof l&&null!==l&&l.message||"Failed to add reaction"})}else console.warn("User must be logged in to add reactions");else console.warn("Missing parameters for reaction:",{messageId:e,emoji:t})}),[n,s.messages,i]),g=(0,r.useCallback)((async e=>{try{i({type:$s,payload:!0});const t=await Ps.default.searchMessages((0,o.A)((0,o.A)({},e),{},{userId:null===n||void 0===n?void 0:n.uid}));i({type:Xs,payload:t.messages})}catch(t){i({type:Zs,payload:"object"===typeof t&&null!==t?t.message||"Search failed":t||"Search failed"})}}),[null===n||void 0===n?void 0:n.uid,i]),v=(0,r.useCallback)((()=>{i({type:ei})}),[i]),x=(0,r.useCallback)((e=>(c("messageSubscription"),i({type:Qs}),i({type:Hs,payload:!0}),setTimeout((()=>{try{const t=Ps.default.subscribeToMessages(e,u);l.current.messageSubscription=t,i({type:oi,payload:t})}catch(t){console.error("Error creating message subscription:",t),i({type:Gs,payload:"object"===typeof t&&null!==t?t.message||"Failed to subscribe to messages":t||"Failed to subscribe to messages"})}}),50),()=>{c("messageSubscription")})),[u,c]),y=(0,r.useCallback)((async e=>{if(s.hasMore&&!s.loadingMore)try{i({type:Ws,payload:!0});const t=s.messages[0],n=await Ps.default.fetchOlderMessages(e,t);i({type:zs,payload:{messages:n.messages,hasMore:n.hasMore}})}catch(t){i({type:Gs,payload:"object"===typeof t&&null!==t?t.message||"Failed to load more messages":t||"Failed to load more messages"})}}),[s.messages,s.hasMore,s.loadingMore,i]),b=(0,r.useCallback)((async e=>{try{var t;if(!e)throw new Dn.uV("Message data is required",Dn.wU.VALIDATION);null!==(t=e.type)&&void 0!==t&&t.includes("broadcast")&&!e.readStatus&&console.warn("Broadcast message missing readStatus property");const n=await Ps.default.sendMessage(e);return i({type:Bs,payload:n}),n}catch(n){const e=(0,Dn.H4)(n,"MessageContext:sendMessage");throw i({type:Gs,payload:"object"===typeof e&&null!==e?e.message||"Failed to send message":e||"Failed to send message"}),e}}),[i]),w=(0,r.useCallback)((async(e,t,n)=>{try{const r=await Ps.default.editMessage(e,t,n);return i({type:qs,payload:r}),r}catch(r){throw i({type:Gs,payload:"object"===typeof r&&null!==r?r.message||"Failed to edit message":r||"Failed to edit message"}),r}}),[i]),D=(0,r.useCallback)((async(e,t)=>{try{var n,r;const l=s.messages.findIndex((t=>t.id===e));if(-1===l)return;const c=s.messages[l];if(null!==(n=c.readBy)&&void 0!==n&&n.includes(t))return;var a,o;if(null!==(r=c.type)&&void 0!==r&&r.includes("broadcast"))null!==(a=c.readStatus)&&void 0!==a&&null!==(o=a[t])&&void 0!==o&&o.read||(await Ps.default.markAsRead(e,t,!0),i({type:Vs,payload:{messageId:e,userId:t,readAt:new Date}}));else await Ps.default.markAsRead(e,t,!1),i({type:Us,payload:{id:e,readBy:(0,Dt.hq)(t)}})}catch(l){throw i({type:Gs,payload:"object"===typeof l&&null!==l?l.message||"Failed to mark message as read":l||"Failed to mark message as read"}),l}}),[s.messages,i]),N=(0,r.useCallback)((async(e,t)=>{try{await Ps.default.deleteMessage(e,t),i({type:Us,payload:{id:e,deletedFor:(0,Dt.hq)(t)}})}catch(n){throw i({type:Gs,payload:"object"===typeof n&&null!==n?n.message||"Failed to delete message":n||"Failed to delete message"}),n}}),[i]),j=(0,r.useCallback)((async(e,t,n)=>{try{if(!e)throw new Dn.uV("Message ID is required",Dn.wU.VALIDATION);if(!t)throw new Dn.uV("User ID is required",Dn.wU.VALIDATION);if(n)try{await Ps.default.deleteFile(n)}catch(r){console.error("Error deleting file:",r)}await N(e,t)}catch(s){const e=(0,Dn.H4)(s,"deleteMessageWithFile");throw i({type:Gs,payload:"object"===typeof e&&null!==e?e.message||"Failed to delete message with file":e||"Failed to delete message with file"}),e}}),[N,i]),C=(0,r.useCallback)((async(e,t)=>{try{await Ps.default.deleteChat(e,t),i({type:Qs})}catch(n){throw i({type:Gs,payload:"object"===typeof n&&null!==n?n.message||"Failed to delete chat":n||"Failed to delete chat"}),n}}),[i]),E=(0,r.useCallback)((async e=>{try{const t=await Ps.default.getBuddies(e);return i({type:Ys,payload:t}),t}catch(t){throw i({type:Gs,payload:"object"===typeof t&&null!==t?t.message||"Failed to get buddies":t||"Failed to get buddies"}),t}}),[i]),A=(0,r.useCallback)((async(e,t)=>{try{return await Ps.default.checkBuddyStatus(e,t)}catch(n){throw i({type:Gs,payload:"object"===typeof n&&null!==n?n.message||"Failed to check buddy status":n||"Failed to check buddy status"}),n}}),[i]),k=(0,r.useCallback)((async(e,t)=>{try{return await Ps.default.getOrCreateBuddyChat(e,t)}catch(n){throw i({type:Gs,payload:"object"===typeof n&&null!==n?n.message||"Failed to create buddy chat":n||"Failed to create buddy chat"}),n}}),[i]);(0,r.useEffect)((()=>{const e={messageSubscription:l.current.messageSubscription||null,typingSubscription:l.current.typingSubscription||null};return()=>{Object.values(e).forEach((e=>{if("function"===typeof e)try{e()}catch(t){console.error("Error during cleanup:",t)}}))}}),[]);const S=(0,o.A)((0,o.A)({},s),{},{subscribeToMessages:x,loadMoreMessages:y,sendMessage:b,editMessage:w,markAsRead:D,deleteMessage:N,deleteChat:C,getBuddies:E,checkBuddyStatus:A,getOrCreateBuddyChat:k,dispatch:i,searchResults:s.searchResults,searchLoading:s.searchLoading,searchError:s.searchError,isSearching:s.isSearching,searchMessages:g,clearSearch:v,fileUploadProgress:s.fileUploadProgress,fileUploadError:s.fileUploadError,sendMessageWithFile:f,deleteMessageWithFile:j,addReaction:p,getCommonEmojis:()=>Ps.default.getCommonEmojis(),getSortedReactions:e=>e?Object.entries(e).map((e=>{let[t,n]=e;return{emoji:t,count:n.count,users:(r=n,r&&r.users?Object.entries(r.users).map((e=>{let[t,n]=e;return{id:t,name:n.name,timestamp:n.timestamp}})):[])};var r})).sort(((e,t)=>t.count-e.count)):[],typingUsers:s.typingUsers,subscribeToTypingStatus:h,setTypingStatus:m});return(0,Et.jsx)(Os.Provider,{value:S,children:t})},di=()=>{const e=(0,r.useContext)(Os);if(!e)throw new Error("useMessages must be used within a MessageProvider");return e},hi=Mt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),mi=Mt("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),fi=Mt("CloudRain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]),pi=Mt("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]),gi=Mt("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),vi=Mt("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]),xi=Mt("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),yi=e=>{let{formData:t,setFormData:n,readOnly:r,handleTimeChange:s}=e;const i={sunny:(0,Et.jsx)(hi,{className:"w-5 h-5 md:w-6 md:h-6 text-yellow-500"}),cloudy:(0,Et.jsx)(mi,{className:"w-5 h-5 md:w-6 md:h-6 text-gray-500"}),rainy:(0,Et.jsx)(fi,{className:"w-5 h-5 md:w-6 md:h-6 text-blue-500"}),windy:(0,Et.jsx)(pi,{className:"w-5 h-5 md:w-6 md:h-6 text-gray-500"})};return(0,Et.jsx)("div",{className:"bg-gradient-to-b from-blue-50 to-white rounded-xl p-3 sm:p-5 shadow-lg",children:(0,Et.jsxs)("div",{className:"bg-white border border-blue-100 rounded-lg p-4 sm:p-6 md:p-8 shadow-sm",children:[(0,Et.jsxs)("div",{className:"mb-8 border-b border-blue-100 pb-4",children:[(0,Et.jsx)("h2",{className:"text-xl font-bold text-blue-800 mb-4",children:"Dive Log Entry"}),(0,Et.jsx)("div",{className:"flex flex-col sm:flex-row gap-4 mb-2",children:(0,Et.jsxs)("div",{className:"flex gap-3",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Dive #"}),(0,Et.jsx)("input",{type:"number",value:t.diveNumber,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{diveNumber:e.target.value}))),className:"w-20 sm:w-24 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",readOnly:r,min:"1",required:!0})]}),(0,Et.jsxs)("div",{className:"flex-grow",children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Date"}),(0,Et.jsx)("input",{type:"date",value:t.diveDate,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{diveDate:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",readOnly:r,required:!0})]})]})})]}),(0,Et.jsxs)("div",{className:"space-y-8",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 flex flex-col",children:[(0,Et.jsxs)("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[(0,Et.jsx)(Vt,{className:"w-4 h-4 mr-2 text-blue-600"}),"Location"]}),(0,Et.jsx)("input",{type:"text",value:t.location,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{location:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",readOnly:r,required:!0})]}),(0,Et.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 flex flex-col",children:[(0,Et.jsxs)("label",{className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[(0,Et.jsx)(Lt,{className:"w-4 h-4 mr-2 text-blue-600"}),"Dive Buddy"]}),(0,Et.jsx)("input",{type:"text",value:t.buddy,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{buddy:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Enter buddy's name",readOnly:r})]})]}),(0,Et.jsxs)("div",{className:"border border-blue-100 rounded-lg p-5 bg-blue-50",children:[(0,Et.jsxs)("h3",{className:"font-semibold text-blue-800 mb-4 flex items-center",children:[(0,Et.jsx)(Qt,{className:"w-5 h-5 text-blue-600 mr-2"}),"Dive Times"]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Time In (optional)"}),(0,Et.jsx)("input",{type:"time",name:"timeIn",value:t.timeIn,onChange:s,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-all",readOnly:r})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Time Out (optional)"}),(0,Et.jsx)("input",{type:"time",name:"timeOut",value:t.timeOut,onChange:s,className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-all",readOnly:r})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Bottom Time (minutes)"}),(0,Et.jsx)("input",{type:"number",value:t.bottomTime,onChange:e=>{const t=e.target.value;(""===t||/^\d+$/.test(t)&&parseInt(t)>=0)&&n((e=>(0,o.A)((0,o.A)({},e),{},{bottomTime:t},""!==t&&{timeIn:"",timeOut:""})))},className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-all",placeholder:"Enter bottom time",min:"0",required:!0,readOnly:r}),(0,Et.jsx)("p",{className:"text-xs text-gray-500 mt-1 italic",children:"Enter either Time In/Out OR Bottom Time directly"})]})]})]}),(0,Et.jsxs)("div",{className:"border border-blue-100 rounded-lg p-5 bg-white",children:[(0,Et.jsxs)("h3",{className:"font-semibold text-blue-800 mb-4 flex items-center",children:[(0,Et.jsx)(gi,{className:"w-5 h-5 text-blue-600 mr-2"}),"Tank Information"]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Tank Start (PSI)"}),(0,Et.jsx)("input",{type:"number",value:t.tankPressureStart,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{tankPressureStart:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",min:"0",readOnly:r})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Tank End (PSI)"}),(0,Et.jsx)("input",{type:"number",value:t.tankPressureEnd,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{tankPressureEnd:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",min:"0",readOnly:r})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Tank Size (cu ft)"}),(0,Et.jsx)("input",{type:"number",value:t.tankVolume,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{tankVolume:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",min:"0",readOnly:r})]})]})]}),(0,Et.jsxs)("div",{className:"border border-blue-100 rounded-lg p-5 bg-gray-50",children:[(0,Et.jsxs)("h3",{className:"font-semibold text-blue-800 mb-4 flex items-center",children:[(0,Et.jsx)(vi,{className:"w-5 h-5 text-blue-600 mr-2"}),"Dive Type"]}),(0,Et.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.diveType&&Object.entries(t.diveType).map((e=>{let[t,s]=e;return(0,Et.jsxs)("label",{className:"flex items-center p-2 border rounded-md ".concat(s?"bg-blue-100 border-blue-300":"bg-white border-gray-200"),children:[(0,Et.jsx)("input",{type:"checkbox",checked:s,onChange:()=>n((e=>(0,o.A)((0,o.A)({},e),{},{diveType:(0,o.A)((0,o.A)({},e.diveType),{},{[t]:!e.diveType[t]})}))),className:"rounded text-blue-600 border-gray-300 h-4 w-4 focus:ring-blue-500",disabled:r}),(0,Et.jsx)("span",{className:"text-sm ml-2 capitalize",children:t})]},t)}))})]}),(0,Et.jsxs)("div",{className:"border border-blue-100 rounded-lg p-5 bg-blue-50",children:[(0,Et.jsx)("h3",{className:"font-semibold text-blue-800 mb-4",children:"Weather Conditions"}),(0,Et.jsx)("div",{className:"flex flex-wrap gap-4 justify-around mb-5",children:Object.entries(i).map((e=>{let[s,i]=e;return(0,Et.jsxs)("button",{type:"button",onClick:()=>n((e=>(0,o.A)((0,o.A)({},e),{},{weather:(0,o.A)((0,o.A)({},e.weather),{},{condition:s})}))),className:"p-3 rounded-lg transition-all ".concat(t.weather.condition===s?"bg-white shadow-md border border-blue-200 scale-110":"bg-white/50 hover:bg-white hover:shadow-sm"),disabled:r,children:[i,(0,Et.jsx)("span",{className:"block text-xs font-medium capitalize mt-1",children:s})]},s)}))}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Wind Speed (knots)"}),(0,Et.jsx)("input",{type:"number",value:t.weather.windSpeed,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{weather:(0,o.A)((0,o.A)({},t.weather),{},{windSpeed:e.target.value})}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white transition-all",min:"0",readOnly:r})]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,Et.jsxs)("div",{className:"border border-blue-100 rounded-lg p-5 bg-white",children:[(0,Et.jsxs)("h3",{className:"font-semibold text-blue-800 mb-4 flex items-center",children:[(0,Et.jsx)(Kt,{className:"w-5 h-5 text-blue-600 mr-2"}),"Depth Information"]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Max Depth (ft)"}),(0,Et.jsx)("input",{type:"number",value:t.maxDepth,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{maxDepth:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",min:"0",required:!0,readOnly:r})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Visibility (ft)"}),(0,Et.jsx)("input",{type:"number",value:t.visibility,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{visibility:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",min:"0",readOnly:r})]})]})]}),(0,Et.jsxs)("div",{className:"border border-blue-100 rounded-lg p-5 bg-white",children:[(0,Et.jsxs)("h3",{className:"font-semibold text-blue-800 mb-4 flex items-center",children:[(0,Et.jsx)(xi,{className:"w-5 h-5 text-red-500 mr-2"}),"Temperature"]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Water (\xb0F)"}),(0,Et.jsx)("input",{type:"number",value:t.waterTemp,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{waterTemp:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",readOnly:r})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-gray-600 block mb-1",children:"Air (\xb0F)"}),(0,Et.jsx)("input",{type:"number",value:t.airTemp,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{airTemp:e.target.value}))),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",readOnly:r})]})]})]})]}),(0,Et.jsxs)("div",{className:"border border-blue-100 rounded-lg p-5 bg-gray-50",children:[(0,Et.jsx)("h3",{className:"font-semibold text-blue-800 mb-4",children:"Equipment"}),(0,Et.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries(t.equipment).map((e=>{let[t,s]=e;return(0,Et.jsxs)("label",{className:"flex items-center p-2 border rounded-md ".concat(s?"bg-blue-100 border-blue-300":"bg-white border-gray-200"),children:[(0,Et.jsx)("input",{type:"checkbox",checked:s,onChange:()=>n((e=>(0,o.A)((0,o.A)({},e),{},{equipment:(0,o.A)((0,o.A)({},e.equipment),{},{[t]:!e.equipment[t]})}))),className:"rounded text-blue-600 border-gray-300 h-4 w-4 focus:ring-blue-500",disabled:r}),(0,Et.jsx)("span",{className:"text-sm ml-2 capitalize",children:t})]},t)}))})]}),(0,Et.jsxs)("div",{className:"border border-blue-100 rounded-lg p-5 bg-white",children:[(0,Et.jsxs)("label",{className:"flex items-center text-sm font-semibold text-blue-800 mb-3",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Notes & Comments"]}),(0,Et.jsx)("textarea",{value:t.notes,onChange:e=>n((t=>(0,o.A)((0,o.A)({},t),{},{notes:e.target.value}))),className:"w-full p-3 border border-gray-300 rounded-lg min-h-[120px] focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",readOnly:r})]})]})]})})},bi="logbook",wi="stats",Di="newDive",Ni={totalDives:0,maxDepth:0,totalBottomTime:0,lastDive:null},ji={keyword:"",dateFrom:"",dateTo:""},Ci={diveNumber:"",diveDate:(new Date).toISOString().split("T")[0],location:"",bottomTime:"",timeIn:"",timeOut:"",maxDepth:"",buddy:"",notes:"",requiresSignature:!1,signature:null,visibility:"",airTemp:"",waterTemp:"",tankPressureStart:"",tankPressureEnd:"",tankVolume:"",diveType:{lake:!1,river:!1,ocean:!1,shore:!1,boat:!1,wreck:!1,drift:!1,night:!1},weather:{condition:"sunny",windSpeed:""},equipment:{wetsuit:!1,drysuit:!1,hood:!1,gloves:!1}},Ei={code:"",instructorId:"",instructorName:"",signatureDate:null,certificationLevel:""},Ai={logs:!1,submission:!1,signature:!1,delete:!1},ki=()=>{const{user:e}=kt(),[t,n]=(0,r.useState)(wi),[s,i]=(0,r.useState)([]),[a,l]=(0,r.useState)(Ni),[c,u]=(0,r.useState)(ji),[d,h]=(0,r.useState)(null),[m,f]=(0,r.useState)(1),[p,g]=(0,r.useState)(Ei),[v,x]=(0,r.useState)(!1),[y,b]=(0,r.useState)(""),[w,D]=(0,r.useState)(Ci),[N,j]=(0,r.useState)(Ai),[C,E]=(0,r.useState)(""),A=async(e,t)=>{try{const n=(0,Dt.H9)(wt.db,"profiles",e),r=await(0,Dt.x7)(n);if(r.exists()){const e=r.data();e.numberOfDives!==t&&await(0,Dt.BN)(n,(0,o.A)((0,o.A)({},e),{},{numberOfDives:t,updatedAt:(new Date).toISOString()}))}}catch(C){console.error("Error updating profile dive count:",C)}},k=e=>e?Object.entries(e).filter((e=>{let[t,n]=e;return n})).map((e=>{let[t]=e;return t})).join(", ")||"None recorded":"Not specified",S=(0,r.useMemo)((()=>s.filter((e=>{let t=!0,n=!0;if(c.keyword){var r,s,i;const n=c.keyword.toLowerCase();t=(null===(r=e.location)||void 0===r?void 0:r.toLowerCase().includes(n))||(null===(s=e.notes)||void 0===s?void 0:s.toLowerCase().includes(n))||(null===(i=e.buddy)||void 0===i?void 0:i.toLowerCase().includes(n))}if(c.dateFrom){const t=new Date(c.dateFrom);n=e.diveDate>=t}if(c.dateTo){const t=new Date(c.dateTo);t.setHours(23,59,59,999),n=n&&e.diveDate<=t}return t&&n}))),[s,c]),F=(0,r.useCallback)((async()=>{if(null!==e&&void 0!==e&&e.uid)try{const t=await(0,Dt.GG)((0,Dt.P)((0,Dt.rJ)(wt.db,"profiles/".concat(e.uid,"/logbook")),(0,Dt.My)("diveNumber","desc"),(0,Dt._M)("diveNumber",">",0)));if(!t.empty){const e=t.docs[0].data().diveNumber;f(e+1),D((t=>(0,o.A)((0,o.A)({},t),{},{diveNumber:String(e+1)})))}}catch(C){console.error("Error calculating next dive number:",C),E("Failed to calculate next dive number. Please try again.")}}),[null===e||void 0===e?void 0:e.uid]),_=(0,r.useCallback)((e=>{var t;const n=e.map((e=>Number(e.maxDepth))).filter((e=>!isNaN(e))),r=e.reduce(((e,t)=>{const n=t.bottomTime?parseInt(t.bottomTime):0;return isNaN(n)?e:e+n}),0);console.log("Calculating total bottom time:",{logsData:e.map((e=>e.bottomTime)),totalBottomTime:r}),l({totalDives:e.length,maxDepth:n.length?Math.max(...n):0,totalBottomTime:r,lastDive:(null===(t=e[0])||void 0===t?void 0:t.diveDate)||null})}),[]),T=(0,r.useCallback)((async()=>{if(null!==e&&void 0!==e&&e.uid){j((e=>(0,o.A)((0,o.A)({},e),{},{logs:!0}))),E("");try{const t=(0,Dt.rJ)(wt.db,"profiles/".concat(e.uid,"/logbook")),n=(0,Dt.P)(t,(0,Dt.My)("diveDate","desc")),r=(await(0,Dt.GG)(n)).docs.map((e=>(0,o.A)((0,o.A)({id:e.id},e.data()),{},{diveDate:e.data().diveDate.toDate()})));i(r),_(r)}catch(C){console.error("Error fetching logs:",C),E("Failed to fetch dive logs. Please try again.")}finally{j((e=>(0,o.A)((0,o.A)({},e),{},{logs:!1})))}}}),[null===e||void 0===e?void 0:e.uid,_]);(0,r.useEffect)((()=>{null!==e&&void 0!==e&&e.uid&&(T(),F())}),[null===e||void 0===e?void 0:e.uid,T,F]);const I=async e=>{e.preventDefault(),b(""),j((e=>(0,o.A)((0,o.A)({},e),{},{signature:!0})));try{if(!p.code)throw new Error("Please enter a valid signature code");const e=await(async e=>{if(!e)return{verified:!1,error:"Signature code is required"};try{const t=(0,Dt.rJ)(wt.db,"profiles"),n=(0,Dt.P)(t,(0,Dt._M)("role","==","instructor"),(0,Dt._M)("instructorSignature.code","==",e)),r=await(0,Dt.GG)(n);if(!r.empty){const e=r.docs[0].data();return{verified:!0,instructorId:r.docs[0].id,instructorName:e.name||"Instructor",certificationLevel:e.certificationLevel||"Instructor"}}return{verified:!1,error:"Invalid signature code. Please check and try again."}}catch(C){return console.error("Verification error:",C),{verified:!1,error:"permission-denied"===C.code?"Permission denied. Please check your instructor status.":"Error verifying signature code. Please try again."}}})(p.code);if(!e.verified)throw new Error(e.error||"Invalid instructor signature code. Please try again.");{const t=new Date;g((n=>(0,o.A)((0,o.A)({},n),{},{instructorId:e.instructorId,instructorName:e.instructorName,signatureDate:t}))),D((n=>(0,o.A)((0,o.A)({},n),{},{signature:{instructorId:e.instructorId,instructorName:e.instructorName,signatureDate:t,certificationLevel:"Instructor"}}))),x(!1)}}catch(C){b(C.message)}finally{j((e=>(0,o.A)((0,o.A)({},e),{},{signature:!1})))}},R=(0,r.useCallback)(((e,t)=>{if(!e||!t)return 0;const[n,r]=e.split(":").map(Number),[s,i]=t.split(":").map(Number);if(isNaN(n)||isNaN(r)||isNaN(s)||isNaN(i))return 0;return 60*s+i-(60*n+r)}),[]),P=(0,r.useCallback)((e=>{const{name:t,value:n}=e.target;D((e=>{const r=(0,o.A)((0,o.A)({},e),{},{[t]:n}),{timeIn:s,timeOut:i}=r;if(s&&i){const e=R(s,i);e>0&&(r.bottomTime=String(e))}return r}))}),[R]),O=(0,r.useCallback)((e=>{D((0,o.A)((0,o.A)((0,o.A)({},Ci),e),{},{diveDate:new Date(e.diveDate).toISOString().split("T")[0],diveNumber:String(e.diveNumber),requiresSignature:e.requiresSignature||!1,signature:e.signature||null,equipment:e.equipment||Ci.equipment,diveType:e.diveType||Ci.diveType,weather:e.weather||Ci.weather})),h(e),n(Di)}),[]),M=(0,r.useCallback)((()=>{D((0,o.A)((0,o.A)({},Ci),{},{diveNumber:String(m)})),g(Ei),E("")}),[m]),L=(0,r.memo)((e=>{let{isVisible:t}=e;return t?(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"signature-modal-title",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-4 sm:p-6 w-full max-w-md",children:[(0,Et.jsx)("h3",{id:"signature-modal-title",className:"text-lg font-semibold mb-4",children:"Instructor Signature"}),(0,Et.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{htmlFor:"instructor-signature",className:"block text-sm font-medium text-gray-700",children:"Instructor Signature Code"}),(0,Et.jsx)("input",{id:"instructor-signature",type:"text",value:p.code,onChange:e=>g((t=>(0,o.A)((0,o.A)({},t),{},{code:e.target.value}))),className:"mt-1 block w-full p-2 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Enter your signature code",disabled:N.signature,"aria-describedby":"signature-error"})]}),y&&(0,Et.jsx)("p",{id:"signature-error",className:"text-red-600 text-sm",role:"alert",children:y}),(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end sm:space-x-3 space-y-2 sm:space-y-0",children:[(0,Et.jsx)("button",{type:"button",onClick:()=>x(!1),className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md order-2 sm:order-1",disabled:N.signature,children:"Cancel"}),(0,Et.jsx)("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50 order-1 sm:order-2",disabled:N.signature,children:N.signature?"Signing...":"Sign Log"})]})]})]})}):null}));return L.displayName="SignatureModal",(0,Et.jsx)("div",{className:"max-w-6xl mx-auto p-2 sm:p-4",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-3 sm:p-6",children:[C&&(0,Et.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",role:"alert",children:(0,Et.jsx)("p",{className:"text-sm text-red-800",children:C})}),(0,Et.jsxs)("nav",{className:"flex flex-wrap gap-2 mb-6",role:"navigation","aria-label":"Main navigation",children:[(0,Et.jsx)("button",{onClick:()=>n(bi),className:"px-3 py-2 text-sm sm:text-base sm:px-4 rounded-md ".concat(t===bi?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),"aria-current":t===bi?"page":void 0,children:"View Logbook"}),(0,Et.jsx)("button",{onClick:()=>n(wi),className:"px-3 py-2 text-sm sm:text-base sm:px-4 rounded-md ".concat(t===wi?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),"aria-current":t===wi?"page":void 0,children:"Quick Stats"}),(0,Et.jsx)("button",{onClick:()=>{n(Di),h(null),M()},className:"px-3 py-2 text-sm sm:text-base sm:px-4 rounded-md ".concat(t===Di?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),"aria-current":t===Di?"page":void 0,children:"New Dive"})]}),N.logs&&(0,Et.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),t===wi&&!N.logs&&(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 sm:gap-6",role:"region","aria-label":"Dive statistics",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"Total Dives"}),(0,Et.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-blue-600",children:a.totalDives})]}),(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"Max Depth"}),(0,Et.jsxs)("p",{className:"text-2xl sm:text-3xl font-bold text-blue-600",children:[a.maxDepth," ft"]})]}),(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"Total Bottom Time"}),(0,Et.jsxs)("p",{className:"text-2xl sm:text-3xl font-bold text-blue-600",children:[a.totalBottomTime," min"]})]}),(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"Last Dive"}),(0,Et.jsx)("p",{className:"text-2xl sm:text-3xl font-bold text-blue-600",children:a.lastDive?new Date(a.lastDive).toLocaleDateString():"No dives"})]})]}),t===bi&&!N.logs&&(0,Et.jsxs)("div",{role:"region","aria-label":"Dive logs",children:[(0,Et.jsxs)("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Search by location, notes, or buddy",className:"w-full px-3 py-2 border rounded-md",value:c.keyword,onChange:e=>u((t=>(0,o.A)((0,o.A)({},t),{},{keyword:e.target.value}))),"aria-label":"Search dive logs"}),(0,Et.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,Et.jsxs)("div",{className:"w-full sm:w-auto",children:[(0,Et.jsx)("label",{className:"block text-sm text-gray-600",children:"From"}),(0,Et.jsx)("input",{type:"date",className:"w-full sm:w-auto px-3 py-2 border rounded-md",value:c.dateFrom,onChange:e=>u((t=>(0,o.A)((0,o.A)({},t),{},{dateFrom:e.target.value}))),"aria-label":"Filter from date"})]}),(0,Et.jsxs)("div",{className:"w-full sm:w-auto",children:[(0,Et.jsx)("label",{className:"block text-sm text-gray-600",children:"To"}),(0,Et.jsx)("input",{type:"date",className:"w-full sm:w-auto px-3 py-2 border rounded-md",value:c.dateTo,onChange:e=>u((t=>(0,o.A)((0,o.A)({},t),{},{dateTo:e.target.value}))),"aria-label":"Filter to date"})]})]})]}),0===S.length?(0,Et.jsx)("p",{className:"text-center text-gray-600 py-8",children:"No dive logs found matching your criteria."}):(0,Et.jsx)("div",{className:"space-y-4",children:S.map((t=>{var n,r;return(0,Et.jsxs)("div",{className:"border rounded-lg p-3 sm:p-4 hover:shadow-lg transition-shadow bg-white",role:"article","aria-label":"Dive ".concat(t.diveNumber," at ").concat(t.location),children:[(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start mb-3 gap-2",children:[(0,Et.jsx)("div",{children:(0,Et.jsxs)("h3",{className:"text-base sm:text-lg font-semibold text-blue-600 flex flex-wrap items-center gap-2",children:["#",t.diveNumber," \u2022 ",t.location,(0,Et.jsx)("span",{className:"text-sm font-normal text-gray-600",children:new Date(t.diveDate).toLocaleDateString()})]})}),(0,Et.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto justify-end",children:[(0,Et.jsx)("button",{onClick:()=>O(t),className:"px-2.5 py-1 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200","aria-label":"Edit dive ".concat(t.diveNumber),disabled:N.delete,children:"Edit"}),(0,Et.jsx)("button",{onClick:()=>(async t=>{if(window.confirm("Are you sure you want to delete this log entry?")){j((e=>(0,o.A)((0,o.A)({},e),{},{delete:!0}))),E("");try{await(0,Dt.kd)((0,Dt.H9)(wt.db,"profiles/".concat(e.uid,"/logbook/").concat(t))),await T();const n=s.filter((e=>e.id!==t)),r=n.length>0?Math.max(...n.map((e=>e.diveNumber))):0;await A(e.uid,r)}catch(C){console.error("Error deleting log:",C),E("Failed to delete dive log. Please try again.")}finally{j((e=>(0,o.A)((0,o.A)({},e),{},{delete:!1})))}}})(t.id),className:"px-2.5 py-1 text-sm bg-red-100 text-red-700 rounded-md hover:bg-red-200","aria-label":"Delete dive ".concat(t.diveNumber),disabled:N.delete,children:N.delete?"Deleting...":"Delete"})]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-x-4 sm:gap-x-6 gap-y-2 sm:gap-y-3 text-sm",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Buddy:"}),(0,Et.jsx)("span",{className:"ml-2 font-medium",children:t.buddy||"Solo"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Bottom Time:"}),(0,Et.jsxs)("span",{className:"ml-2 font-medium",children:[t.bottomTime," min"]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Max Depth:"}),(0,Et.jsxs)("span",{className:"ml-2 font-medium",children:[t.maxDepth," ft"]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Visibility:"}),(0,Et.jsxs)("span",{className:"ml-2 font-medium",children:[t.visibility," ft"]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Water Temp:"}),(0,Et.jsxs)("span",{className:"ml-2 font-medium",children:[t.waterTemp,"\xb0F"]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Gas Used:"}),(0,Et.jsx)("span",{className:"ml-2 font-medium",children:t.tankPressureStart&&t.tankPressureEnd?"".concat(t.tankPressureStart-t.tankPressureEnd," psi"):"N/A"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Tank Size:"}),(0,Et.jsx)("span",{className:"ml-2 font-medium",children:t.tankVolume||"N/A"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Weather:"}),(0,Et.jsxs)("span",{className:"ml-2 font-medium capitalize",children:[null===(n=t.weather)||void 0===n?void 0:n.condition,null!==(r=t.weather)&&void 0!==r&&r.windSpeed?" (".concat(t.weather.windSpeed,"kt)"):""]})]})]}),(0,Et.jsxs)("div",{className:"mt-3 pt-3 border-t grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,Et.jsxs)("div",{className:"space-y-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Dive Type:"}),(0,Et.jsx)("span",{className:"ml-2",children:k(t.diveType)})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Equipment:"}),(0,Et.jsx)("span",{className:"ml-2",children:k(t.equipment)})]})]}),t.notes&&(0,Et.jsxs)("div",{className:"text-gray-700 bg-gray-50 p-2 rounded",children:[(0,Et.jsx)("span",{className:"text-gray-600 block mb-1",children:"Notes:"}),t.notes]})]}),t.signature&&(0,Et.jsxs)("div",{className:"mt-3 pt-2 border-t text-xs sm:text-sm text-gray-600 break-words",children:["\u2713 Signed by ",t.signature.instructorName," \u2022 ",t.signature.certificationLevel," \u2022",t.signature.signatureDate&&t.signature.signatureDate.toDate?t.signature.signatureDate.toDate().toLocaleDateString():new Date(t.signature.signatureDate).toLocaleDateString()]})]},t.id)}))})]}),t===Di&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h2",{className:"text-xl font-bold mb-6",children:d?"Edit Dive Entry":"New Dive Entry"}),(0,Et.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),j((e=>(0,o.A)((0,o.A)({},e),{},{submission:!0})));try{(e=>{const t=[];e.diveNumber||t.push("Dive number is required"),e.diveDate||t.push("Dive date is required"),e.location||t.push("Location is required"),e.maxDepth||t.push("Maximum depth is required"),e.bottomTime||t.push("Bottom time is required"),e.maxDepth&&Number(e.maxDepth)<=0&&t.push("Maximum depth must be greater than 0"),e.bottomTime&&Number(e.bottomTime)<=0&&t.push("Bottom time must be greater than 0"),e.visibility&&Number(e.visibility)<0&&t.push("Visibility cannot be negative"),e.timeIn&&e.timeOut&&R(e.timeIn,e.timeOut)<=0&&t.push("Time out must be after time in");if(t.length>0)throw new Error(t.join("\n"))})(w);const t={diveNumber:parseInt(w.diveNumber),diveDate:Dt.Dc.fromDate(new Date(w.diveDate)),location:w.location.trim(),buddy:w.buddy.trim(),bottomTime:parseInt(w.bottomTime),maxDepth:parseInt(w.maxDepth),timeIn:w.timeIn||null,timeOut:w.timeOut||null,visibility:w.visibility?parseInt(w.visibility):null,airTemp:w.airTemp?parseInt(w.airTemp):null,waterTemp:w.waterTemp?parseInt(w.waterTemp):null,tankPressureStart:parseInt(w.tankPressureStart)||null,tankPressureEnd:parseInt(w.tankPressureEnd)||null,tankVolume:w.tankVolume?w.tankVolume.trim():null,diveType:w.diveType,weather:{condition:w.weather.condition||"sunny",windSpeed:w.weather.windSpeed?parseInt(w.weather.windSpeed):null},equipment:w.equipment,notes:w.notes.trim(),requiresSignature:w.requiresSignature,signature:w.signature?{instructorId:w.signature.instructorId,instructorName:w.signature.instructorName,signatureDate:Dt.Dc.fromDate(w.signature.signatureDate instanceof Date?w.signature.signatureDate:new Date(w.signature.signatureDate)),certificationLevel:w.signature.certificationLevel}:null};d?await(0,Dt.BN)((0,Dt.H9)(wt.db,"profiles/".concat(e.uid,"/logbook/").concat(d.id)),t):await(0,Dt.gS)((0,Dt.rJ)(wt.db,"profiles/".concat(e.uid,"/logbook")),t),h(null),M(),await T();const r=Math.max(...s.map((e=>e.diveNumber)),parseInt(w.diveNumber));await A(e.uid,r),n(bi)}catch(C){console.error("Error saving log:",C),E(C.message||"Failed to save dive log. Please try again.")}finally{j((e=>(0,o.A)((0,o.A)({},e),{},{submission:!1})))}},children:[w.signature&&(0,Et.jsx)("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,Et.jsx)("p",{className:"text-sm text-yellow-800",children:"\u26a0\ufe0f This dive log is signed and cannot be edited unless the signature is removed."})}),(0,Et.jsx)(yi,{formData:w,setFormData:D,readOnly:!!w.signature,handleTimeChange:P}),(0,Et.jsxs)("div",{className:"mt-6",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Et.jsx)("input",{type:"checkbox",id:"requiresSignature",checked:w.requiresSignature,onChange:e=>D((t=>(0,o.A)((0,o.A)({},t),{},{requiresSignature:e.target.checked}))),readOnly:!!w.signature,className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 ".concat(w.signature?"cursor-not-allowed":"")}),(0,Et.jsx)("label",{htmlFor:"requiresSignature",className:"text-sm font-medium text-gray-700",children:"This dive requires instructor signature"})]}),w.requiresSignature&&!w.signature&&(0,Et.jsx)("button",{type:"button",onClick:()=>x(!0),className:"mt-2 px-4 py-2 text-sm font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 rounded-md",children:"Add Instructor Signature"}),w.signature&&(0,Et.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded-md",children:[(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Signed by: ",w.signature.instructorName,(0,Et.jsx)("br",{}),"Date: ",w.signature.signatureDate instanceof Date?w.signature.signatureDate.toLocaleDateString():new Date(w.signature.signatureDate).toLocaleDateString()]}),(0,Et.jsx)("button",{type:"button",onClick:()=>D((e=>(0,o.A)((0,o.A)({},e),{},{signature:null}))),className:"mt-2 text-sm text-red-600 hover:text-red-700",children:"Remove Signature to Edit"})]})]}),(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-3 mt-6",children:[(0,Et.jsx)("button",{type:"button",onClick:()=>{n(bi),h(null),M()},className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md order-2 sm:order-1",disabled:N.submission,children:"Cancel"}),(0,Et.jsx)("button",{type:"submit",className:"w-full sm:w-auto px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md disabled:opacity-50 order-1 sm:order-2",disabled:N.submission,children:N.submission?"Saving...":d?"Save Changes":"Add Log Entry"})]})]}),(0,Et.jsx)(L,{isVisible:v})]})]})})},Si=Mt("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),Fi=Mt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),_i=Mt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ti=Mt("Paperclip",[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]]),Ii=Mt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),Ri=e=>{let{onFileSelect:t,children:n,isSmallScreen:s=!1}=e;const i=(0,r.useRef)(null),[a,o]=(0,r.useState)(!1);return(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("input",{type:"file",ref:i,onChange:e=>{var n;const r=null===(n=e.target.files)||void 0===n?void 0:n[0];r&&(r.size>10485760?alert("File size must be less than 10MB"):(t(r),e.target.value=""))},className:"hidden",accept:"image/*,video/*,audio/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx"}),(0,Et.jsx)("div",{onClick:()=>{var e;null===(e=i.current)||void 0===e||e.click()},onTouchStart:()=>{o(!0)},onTouchEnd:()=>{o(!1)},className:"".concat(a?"opacity-80":"opacity-100"," transition-opacity ").concat(s?"touch-target":""," no-tap-highlight"),role:"button","aria-label":"Attach file",tabIndex:0,children:n})]})},Pi=e=>{let{onSend:t,disabled:n=!1,placeholder:s="Type a message...",className:i="",isSending:a=!1,sendError:o=null,typingParams:l=null,onTypingStatus:c=null,hasLargerSendButton:u=!1}=e;const[d,h]=(0,r.useState)(""),[m,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)(null),v=(0,r.useRef)(null),x=(0,r.useRef)(0),y=(0,r.useCallback)((e=>{c&&l&&c(l,e)}),[c,l]),b=()=>{v.current&&(clearTimeout(v.current),v.current=null)};(0,r.useEffect)((()=>()=>{b(),y(!1)}),[y]);return(0,Et.jsxs)("div",{className:"p-3 md:p-4 bg-white border-t ".concat(i),children:[o&&(0,Et.jsxs)("div",{className:"mb-2 px-3 py-2 bg-red-50 border border-red-200 rounded-md text-red-700 text-sm",children:[(0,Et.jsxs)("p",{children:["Failed to send message: ",o.message||"Unknown error"]}),(0,Et.jsx)("button",{className:"text-xs text-red-600 underline mt-1 hover:text-red-800",onClick:()=>t(d.trim(),p),children:"Retry"})]}),p&&(0,Et.jsxs)("div",{className:"mb-2 px-4 py-1 bg-gray-50 rounded-full flex items-center justify-between",children:[(0,Et.jsxs)("span",{className:"text-sm text-gray-600 truncate",children:[p.name," (",(p.size/1024).toFixed(1)," KB)"]}),(0,Et.jsx)("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-gray-600 p-1 touch-target","aria-label":"Remove file",children:(0,Et.jsx)(cn,{size:16})})]}),(0,Et.jsxs)("div",{className:"flex gap-2 items-center bg-gray-50 rounded-full px-3 md:px-4 py-2",children:[(0,Et.jsx)(Ri,{onFileSelect:g,selectedFile:p,onClearFile:()=>g(null),isSmallScreen:u,children:(0,Et.jsx)("button",{type:"button",className:"text-gray-400 hover:text-gray-600 ".concat(u?"p-2":"p-1"," touch-target no-tap-highlight"),disabled:n||m||a,"aria-label":"Attach file",children:(0,Et.jsx)(Ti,{size:u?24:20})})}),(0,Et.jsx)("input",{type:"text",value:d,onChange:e=>{const t=e.target.value;if(h(t),c&&l){const e=Date.now();e-x.current>500&&(y(!0),x.current=e),b(),v.current=setTimeout((()=>{y(!1)}),5e3)}},placeholder:a?"Sending...":s,disabled:n||m||a,className:"flex-1 bg-transparent border-0 focus:outline-none text-gray-600 placeholder-gray-500 touch-input"}),(0,Et.jsx)("button",{onClick:async e=>{if(e.preventDefault(),!(!d.trim()&&!p||m||n||a))try{f(!0),y(!1),b(),await t(d.trim(),p),h(""),g(null)}catch(r){console.error("Error sending message:",r)}finally{f(!1)}},disabled:n||m||a||!d.trim()&&!p,className:"\n            text-blue-500 hover:text-blue-600 disabled:text-gray-400 \n            ".concat(u?"p-2":"p-1","\n            ").concat(a?"animate-pulse":"","\n            touch-target no-tap-highlight\n          "),"aria-label":"Send message",children:a?(0,Et.jsx)("div",{className:"rounded-full border-2 border-blue-500 border-t-transparent animate-spin ".concat(u?"h-6 w-6":"h-5 w-5")}):(0,Et.jsx)(Ii,{className:u?"w-6 h-6 rotate-45":"w-5 h-5 rotate-45"})})]})]})},Oi={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Mi(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const Li={date:Mi({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Mi({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Mi({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Bi={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function zi(e){return(t,n)=>{let r;if("formatting"===(null!==n&&void 0!==n&&n.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,s=null!==n&&void 0!==n&&n.width?String(n.width):t;r=e.formattingValues[s]||e.formattingValues[t]}else{const t=e.defaultWidth,s=null!==n&&void 0!==n&&n.width?String(n.width):e.defaultWidth;r=e.values[s]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}const Ui={ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:zi({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:zi({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:zi({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:zi({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:zi({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function qi(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,(e=>e.test(a))):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,(e=>e.test(a)));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;return{value:c,rest:t.slice(a.length)}}}const Vi={ordinalNumber:(Hi={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.match(Hi.matchPattern);if(!n)return null;const r=n[0],s=e.match(Hi.parsePattern);if(!s)return null;let i=Hi.valueCallback?Hi.valueCallback(s[0]):s[0];return i=t.valueCallback?t.valueCallback(i):i,{value:i,rest:e.slice(r.length)}}),era:qi({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:qi({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:qi({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:qi({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:qi({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})};var Hi;const Wi={code:"en-US",formatDistance:(e,t,n)=>{let r;const s=Oi[e];return r="string"===typeof s?s:1===t?s.one:s.other.replace("{{count}}",t.toString()),null!==n&&void 0!==n&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:Li,formatRelative:(e,t,n,r)=>Bi[e],localize:Ui,match:Vi,options:{weekStartsOn:0,firstWeekContainsDate:1}};let Gi={};function Ki(){return Gi}Math.pow(10,8);const Qi=6048e5,Yi=Symbol.for("constructDateFrom");function Ji(e,t){return"function"===typeof e?e(t):e&&"object"===typeof e&&Yi in e?e[Yi](t):e instanceof Date?new e.constructor(t):new Date(t)}function Xi(e,t){return Ji(t||e,e)}function $i(e){const t=Xi(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Zi(e,t){const n=Xi(e,null===t||void 0===t?void 0:t.in);return n.setHours(0,0,0,0),n}function ea(e,t,n){const[r,s]=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const s=Ji.bind(null,e||n.find((e=>"object"===typeof e)));return n.map(s)}(null===n||void 0===n?void 0:n.in,e,t),i=Zi(r),a=Zi(s),o=+i-$i(i),l=+a-$i(a);return Math.round((o-l)/864e5)}function ta(e,t){const n=Xi(e,null===t||void 0===t?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function na(e,t){const n=Xi(e,null===t||void 0===t?void 0:t.in);return ea(n,ta(n))+1}function ra(e,t){var n,r,s,i,a,o;const l=Ki(),c=null!==(n=null!==(r=null!==(s=null!==(i=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==i?i:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.weekStartsOn)&&void 0!==s?s:l.weekStartsOn)&&void 0!==r?r:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==n?n:0,u=Xi(e,null===t||void 0===t?void 0:t.in),d=u.getDay(),h=(d<c?7:0)+d-c;return u.setDate(u.getDate()-h),u.setHours(0,0,0,0),u}function sa(e,t){return ra(e,(0,o.A)((0,o.A)({},t),{},{weekStartsOn:1}))}function ia(e,t){const n=Xi(e,null===t||void 0===t?void 0:t.in),r=n.getFullYear(),s=Ji(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=sa(s),a=Ji(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=sa(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function aa(e,t){const n=ia(e,t),r=Ji((null===t||void 0===t?void 0:t.in)||e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),sa(r)}function oa(e,t){const n=Xi(e,null===t||void 0===t?void 0:t.in),r=+sa(n)-+aa(n);return Math.round(r/Qi)+1}function la(e,t){var n,r,s,i,a,o;const l=Xi(e,null===t||void 0===t?void 0:t.in),c=l.getFullYear(),u=Ki(),d=null!==(n=null!==(r=null!==(s=null!==(i=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==i?i:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==s?s:u.firstWeekContainsDate)&&void 0!==r?r:null===(o=u.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==n?n:1,h=Ji((null===t||void 0===t?void 0:t.in)||e,0);h.setFullYear(c+1,0,d),h.setHours(0,0,0,0);const m=ra(h,t),f=Ji((null===t||void 0===t?void 0:t.in)||e,0);f.setFullYear(c,0,d),f.setHours(0,0,0,0);const p=ra(f,t);return+l>=+m?c+1:+l>=+p?c:c-1}function ca(e,t){var n,r,s,i,a,o;const l=Ki(),c=null!==(n=null!==(r=null!==(s=null!==(i=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==i?i:null===t||void 0===t||null===(a=t.locale)||void 0===a||null===(a=a.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==s?s:l.firstWeekContainsDate)&&void 0!==r?r:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==n?n:1,u=la(e,t),d=Ji((null===t||void 0===t?void 0:t.in)||e,0);d.setFullYear(u,0,c),d.setHours(0,0,0,0);return ra(d,t)}function ua(e,t){const n=Xi(e,null===t||void 0===t?void 0:t.in),r=+ra(n,t)-+ca(n,t);return Math.round(r/Qi)+1}function da(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const ha={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return da("yy"===t?r%100:r,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):da(n+1,2)},d:(e,t)=>da(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>da(e.getHours()%12||12,t.length),H:(e,t)=>da(e.getHours(),t.length),m:(e,t)=>da(e.getMinutes(),t.length),s:(e,t)=>da(e.getSeconds(),t.length),S(e,t){const n=t.length,r=e.getMilliseconds();return da(Math.trunc(r*Math.pow(10,n-3)),t.length)}},ma="midnight",fa="noon",pa="morning",ga="afternoon",va="evening",xa="night",ya={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),r=t>0?t:1-t;return n.ordinalNumber(r,{unit:"year"})}return ha.y(e,t)},Y:function(e,t,n,r){const s=la(e,r),i=s>0?s:1-s;if("YY"===t){return da(i%100,2)}return"Yo"===t?n.ordinalNumber(i,{unit:"year"}):da(i,t.length)},R:function(e,t){return da(ia(e),t.length)},u:function(e,t){return da(e.getFullYear(),t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return da(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return da(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return ha.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return da(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=ua(e,r);return"wo"===t?n.ordinalNumber(s,{unit:"week"}):da(s,t.length)},I:function(e,t,n){const r=oa(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):da(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):ha.d(e,t)},D:function(e,t,n){const r=na(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):da(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return da(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return da(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=0===r?7:r;switch(t){case"i":return String(s);case"ii":return da(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(s=12===r?fa:0===r?ma:r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(s=r>=17?va:r>=12?ga:r>=4?pa:xa,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return ha.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):ha.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):da(r,t.length)},k:function(e,t,n){let r=e.getHours();return 0===r&&(r=24),"ko"===t?n.ordinalNumber(r,{unit:"hour"}):da(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):ha.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):ha.s(e,t)},S:function(e,t){return ha.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(0===r)return"Z";switch(t){case"X":return wa(r);case"XXXX":case"XX":return Da(r);default:return Da(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return wa(r);case"xxxx":case"xx":return Da(r);default:return Da(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+ba(r,":");default:return"GMT"+Da(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+ba(r,":");default:return"GMT"+Da(r,":")}},t:function(e,t,n){return da(Math.trunc(+e/1e3),t.length)},T:function(e,t,n){return da(+e,t.length)}};function ba(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return 0===i?n+String(s):n+String(s)+t+da(i,2)}function wa(e,t){if(e%60===0){return(e>0?"-":"+")+da(Math.abs(e)/60,2)}return Da(e,t)}function Da(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=e>0?"-":"+",r=Math.abs(e);return n+da(Math.trunc(r/60),2)+t+da(r%60,2)}const Na=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},ja=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Ca={p:ja,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return Na(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;default:i=t.dateTime({width:"full"})}return i.replace("{{date}}",Na(r,t)).replace("{{time}}",ja(s,t))}},Ea=/^D+$/,Aa=/^Y+$/,ka=["D","DD","YY","YYYY"];function Sa(e){return e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function Fa(e){return!(!Sa(e)&&"number"!==typeof e||isNaN(+Xi(e)))}const _a=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ta=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Ia=/^'([^]*?)'?$/,Ra=/''/g,Pa=/[a-zA-Z]/;function Oa(e,t,n){var r,s,i,a,o,l,c,u,d,h,m,f,p,g;const v=Ki(),x=null!==(r=null!==(s=null===n||void 0===n?void 0:n.locale)&&void 0!==s?s:v.locale)&&void 0!==r?r:Wi,y=null!==(i=null!==(a=null!==(o=null!==(l=null===n||void 0===n?void 0:n.firstWeekContainsDate)&&void 0!==l?l:null===n||void 0===n||null===(c=n.locale)||void 0===c||null===(c=c.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==o?o:v.firstWeekContainsDate)&&void 0!==a?a:null===(u=v.locale)||void 0===u||null===(u=u.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==i?i:1,b=null!==(d=null!==(h=null!==(m=null!==(f=null===n||void 0===n?void 0:n.weekStartsOn)&&void 0!==f?f:null===n||void 0===n||null===(p=n.locale)||void 0===p||null===(p=p.options)||void 0===p?void 0:p.weekStartsOn)&&void 0!==m?m:v.weekStartsOn)&&void 0!==h?h:null===(g=v.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==d?d:0,w=Xi(e,null===n||void 0===n?void 0:n.in);if(!Fa(w))throw new RangeError("Invalid time value");let D=t.match(Ta).map((e=>{const t=e[0];if("p"===t||"P"===t){return(0,Ca[t])(e,x.formatLong)}return e})).join("").match(_a).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:Ma(e)};if(ya[t])return{isToken:!0,value:e};if(t.match(Pa))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));x.localize.preprocessor&&(D=x.localize.preprocessor(w,D));const N={firstWeekContainsDate:y,weekStartsOn:b,locale:x};return D.map((r=>{if(!r.isToken)return r.value;const s=r.value;(null!==n&&void 0!==n&&n.useAdditionalWeekYearTokens||!function(e){return Aa.test(e)}(s))&&(null!==n&&void 0!==n&&n.useAdditionalDayOfYearTokens||!function(e){return Ea.test(e)}(s))||function(e,t,n){const r=function(e,t,n){const r="Y"===e[0]?"years":"days of the month";return"Use `".concat(e.toLowerCase(),"` instead of `").concat(e,"` (in `").concat(t,"`) for formatting ").concat(r," to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md")}(e,t,n);if(console.warn(r),ka.includes(e))throw new RangeError(r)}(s,t,String(e));return(0,ya[s[0]])(w,s,x.localize,N)})).join("")}function Ma(e){const t=e.match(Ia);return t?t[1].replace(Ra,"'"):e}const La=Mt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const Ba=["disableOutsidePointerEvents","onEscapeKeyDown","onPointerDownOutside","onFocusOutside","onInteractOutside","onDismiss"];var za,Ua="dismissableLayer.update",qa="dismissableLayer.pointerDownOutside",Va="dismissableLayer.focusOutside",Ha=r.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Wa=r.forwardRef(((e,t)=>{var n;const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,onDismiss:d}=e,h=(0,a.A)(e,Ba),m=r.useContext(Ha),[f,p]=r.useState(null),g=null!==(n=null===f||void 0===f?void 0:f.ownerDocument)&&void 0!==n?n:null===globalThis||void 0===globalThis?void 0:globalThis.document,[,v]=r.useState({}),x=zn(t,(e=>p(e))),y=Array.from(m.layers),[b]=[...m.layersWithOutsidePointerEventsDisabled].slice(-1),w=y.indexOf(b),D=f?y.indexOf(f):-1,N=m.layersWithOutsidePointerEventsDisabled.size>0,j=D>=w,C=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document;const n=ar(e),s=r.useRef(!1),i=r.useRef((()=>{}));return r.useEffect((()=>{const e=e=>{if(e.target&&!s.current){let r=function(){Qa(qa,n,s,{discrete:!0})};const s={originalEvent:e};"touch"===e.pointerType?(t.removeEventListener("click",i.current),i.current=r,t.addEventListener("click",i.current,{once:!0})):r()}else t.removeEventListener("click",i.current);s.current=!1},r=window.setTimeout((()=>{t.addEventListener("pointerdown",e)}),0);return()=>{window.clearTimeout(r),t.removeEventListener("pointerdown",e),t.removeEventListener("click",i.current)}}),[t,n]),{onPointerDownCapture:()=>s.current=!0}}((e=>{const t=e.target,n=[...m.branches].some((e=>e.contains(t)));j&&!n&&(null===l||void 0===l||l(e),null===u||void 0===u||u(e),e.defaultPrevented||null===d||void 0===d||d())}),g),E=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document;const n=ar(e),s=r.useRef(!1);return r.useEffect((()=>{const e=e=>{if(e.target&&!s.current){Qa(Va,n,{originalEvent:e},{discrete:!1})}};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)}),[t,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}((e=>{const t=e.target;[...m.branches].some((e=>e.contains(t)))||(null===c||void 0===c||c(e),null===u||void 0===u||u(e),e.defaultPrevented||null===d||void 0===d||d())}),g);return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===globalThis||void 0===globalThis?void 0:globalThis.document;const n=ar(e);r.useEffect((()=>{const e=e=>{"Escape"===e.key&&n(e)};return t.addEventListener("keydown",e,{capture:!0}),()=>t.removeEventListener("keydown",e,{capture:!0})}),[n,t])}((e=>{D===m.layers.size-1&&(null===i||void 0===i||i(e),!e.defaultPrevented&&d&&(e.preventDefault(),d()))}),g),r.useEffect((()=>{if(f)return s&&(0===m.layersWithOutsidePointerEventsDisabled.size&&(za=g.body.style.pointerEvents,g.body.style.pointerEvents="none"),m.layersWithOutsidePointerEventsDisabled.add(f)),m.layers.add(f),Ka(),()=>{s&&1===m.layersWithOutsidePointerEventsDisabled.size&&(g.body.style.pointerEvents=za)}}),[f,g,s,m]),r.useEffect((()=>()=>{f&&(m.layers.delete(f),m.layersWithOutsidePointerEventsDisabled.delete(f),Ka())}),[f,m]),r.useEffect((()=>{const e=()=>v({});return document.addEventListener(Ua,e),()=>document.removeEventListener(Ua,e)}),[]),(0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({},h),{},{ref:x,style:(0,o.A)({pointerEvents:N?j?"auto":"none":void 0},e.style),onFocusCapture:Fn(e.onFocusCapture,E.onFocusCapture),onBlurCapture:Fn(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:Fn(e.onPointerDownCapture,C.onPointerDownCapture)}))}));Wa.displayName="DismissableLayer";var Ga=r.forwardRef(((e,t)=>{const n=r.useContext(Ha),s=r.useRef(null),i=zn(t,s);return r.useEffect((()=>{const e=s.current;if(e)return n.branches.add(e),()=>{n.branches.delete(e)}}),[n.branches]),(0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({},e),{},{ref:i}))}));function Ka(){const e=new CustomEvent(Ua);document.dispatchEvent(e)}function Qa(e,t,n,r){let{discrete:s}=r;const i=n.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),s?function(e,t){e&&rr.flushSync((()=>e.dispatchEvent(t)))}(i,a):i.dispatchEvent(a)}Ga.displayName="DismissableLayerBranch";const Ya=["loop","trapped","onMountAutoFocus","onUnmountAutoFocus"];var Ja="focusScope.autoFocusOnMount",Xa="focusScope.autoFocusOnUnmount",$a={bubbles:!1,cancelable:!0},Za=r.forwardRef(((e,t)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:i,onUnmountAutoFocus:l}=e,c=(0,a.A)(e,Ya),[u,d]=r.useState(null),h=ar(i),m=ar(l),f=r.useRef(null),p=zn(t,(e=>d(e))),g=r.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;r.useEffect((()=>{if(s){let e=function(e){if(g.paused||!u)return;const t=e.target;u.contains(t)?f.current=t:ro(f.current,{select:!0})},t=function(e){if(g.paused||!u)return;const t=e.relatedTarget;null!==t&&(u.contains(t)||ro(f.current,{select:!0}))},n=function(e){if(document.activeElement===document.body)for(const t of e)t.removedNodes.length>0&&ro(u)};document.addEventListener("focusin",e),document.addEventListener("focusout",t);const r=new MutationObserver(n);return u&&r.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",e),document.removeEventListener("focusout",t),r.disconnect()}}}),[s,u,g.paused]),r.useEffect((()=>{if(u){so.add(g);const t=document.activeElement;if(!u.contains(t)){const n=new CustomEvent(Ja,$a);u.addEventListener(Ja,h),u.dispatchEvent(n),n.defaultPrevented||(!function(e){let{select:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=document.activeElement;for(const r of e)if(ro(r,{select:t}),document.activeElement!==n)return}((e=eo(u),e.filter((e=>"A"!==e.tagName))),{select:!0}),document.activeElement===t&&ro(u))}return()=>{u.removeEventListener(Ja,h),setTimeout((()=>{const e=new CustomEvent(Xa,$a);u.addEventListener(Xa,m),u.dispatchEvent(e),e.defaultPrevented||ro(null!==t&&void 0!==t?t:document.body,{select:!0}),u.removeEventListener(Xa,m),so.remove(g)}),0)}}var e}),[u,h,m,g]);const v=r.useCallback((e=>{if(!n&&!s)return;if(g.paused)return;const t="Tab"===e.key&&!e.altKey&&!e.ctrlKey&&!e.metaKey,r=document.activeElement;if(t&&r){const t=e.currentTarget,[s,i]=function(e){const t=eo(e),n=to(t,e),r=to(t.reverse(),e);return[n,r]}(t);s&&i?e.shiftKey||r!==i?e.shiftKey&&r===s&&(e.preventDefault(),n&&ro(i,{select:!0})):(e.preventDefault(),n&&ro(s,{select:!0})):r===t&&e.preventDefault()}}),[n,s,g.paused]);return(0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({tabIndex:-1},c),{},{ref:p,onKeyDown:v}))}));function eo(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const t="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||t?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function to(e,t){for(const n of e)if(!no(n,{upTo:t}))return n}function no(e,t){let{upTo:n}=t;if("hidden"===getComputedStyle(e).visibility)return!0;for(;e;){if(void 0!==n&&e===n)return!1;if("none"===getComputedStyle(e).display)return!0;e=e.parentElement}return!1}function ro(e){let{select:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&function(e){return e instanceof HTMLInputElement&&"select"in e}(e)&&t&&e.select()}}Za.displayName="FocusScope";var so=function(){let e=[];return{add(t){const n=e[0];t!==n&&(null===n||void 0===n||n.pause()),e=io(e,t),e.unshift(t)},remove(t){var n;e=io(e,t),null===(n=e[0])||void 0===n||n.resume()}}}();function io(e,t){const n=[...e],r=n.indexOf(t);return-1!==r&&n.splice(r,1),n}const ao=["container"];var oo=r.forwardRef(((e,t)=>{var n;const{container:s}=e,i=(0,a.A)(e,ao),[l,c]=r.useState(!1);Zn((()=>c(!0)),[]);const u=s||l&&(null===globalThis||void 0===globalThis||null===(n=globalThis.document)||void 0===n?void 0:n.body);return u?rr.createPortal((0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({},i),{},{ref:t})),u):null}));oo.displayName="Portal";var lo=0;function co(){r.useEffect((()=>{var e,t;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(e=n[0])&&void 0!==e?e:uo()),document.body.insertAdjacentElement("beforeend",null!==(t=n[1])&&void 0!==t?t:uo()),lo++,()=>{1===lo&&document.querySelectorAll("[data-radix-focus-guard]").forEach((e=>e.remove())),lo--}}),[])}function uo(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var ho=n(6326),mo="right-scroll-bar-position",fo="width-before-scroll-bar";function po(e,t){return"function"===typeof e?e(t):e&&(e.current=t),e}var go="undefined"!==typeof window?r.useLayoutEffect:r.useEffect,vo=new WeakMap;function xo(e,t){var n=function(e,t){var n=(0,r.useState)((function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(e){var t=n.value;t!==e&&(n.value=e,n.callback(e,t))}}}}))[0];return n.callback=t,n.facade}(t||null,(function(t){return e.forEach((function(e){return po(e,t)}))}));return go((function(){var t=vo.get(n);if(t){var r=new Set(t),s=new Set(e),i=n.current;r.forEach((function(e){s.has(e)||po(e,null)})),s.forEach((function(e){r.has(e)||po(e,i)}))}vo.set(n,e)}),[e]),n}function yo(e){return e}function bo(e,t){void 0===t&&(t=yo);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(e){var s=t(e,r);return n.push(s),function(){n=n.filter((function(e){return e!==s}))}},assignSyncMedium:function(e){for(r=!0;n.length;){var t=n;n=[],t.forEach(e)}n={push:function(t){return e(t)},filter:function(){return n}}},assignMedium:function(e){r=!0;var t=[];if(n.length){var s=n;n=[],s.forEach(e),t=n}var i=function(){var n=t;t=[],n.forEach(e)},a=function(){return Promise.resolve().then(i)};a(),n={push:function(e){t.push(e),a()},filter:function(e){return t=t.filter(e),n}}}};return s}var wo=function(e){void 0===e&&(e={});var t=bo(null);return t.options=(0,ho.Cl)({async:!0,ssr:!1},e),t}(),Do=function(){},No=r.forwardRef((function(e,t){var n=r.useRef(null),s=r.useState({onScrollCapture:Do,onWheelCapture:Do,onTouchMoveCapture:Do}),i=s[0],a=s[1],o=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,h=e.shards,m=e.sideCar,f=e.noRelative,p=e.noIsolation,g=e.inert,v=e.allowPinchZoom,x=e.as,y=void 0===x?"div":x,b=e.gapMode,w=(0,ho.Tt)(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=m,N=xo([n,t]),j=(0,ho.Cl)((0,ho.Cl)({},w),i);return r.createElement(r.Fragment,null,d&&r.createElement(D,{sideCar:wo,removeScrollBar:u,shards:h,noRelative:f,noIsolation:p,inert:g,setCallbacks:a,allowPinchZoom:!!v,lockRef:n,gapMode:b}),o?r.cloneElement(r.Children.only(l),(0,ho.Cl)((0,ho.Cl)({},j),{ref:N})):r.createElement(y,(0,ho.Cl)({},j,{className:c,ref:N}),l))}));No.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},No.classNames={fullWidth:fo,zeroRight:mo};var jo,Co=function(e){var t=e.sideCar,n=(0,ho.Tt)(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw new Error("Sidecar medium not found");return r.createElement(s,(0,ho.Cl)({},n))};Co.isSideCarExport=!0;function Eo(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=jo||n.nc;return t&&e.setAttribute("nonce",t),e}var Ao=function(){var e=0,t=null;return{add:function(n){var r,s;0==e&&(t=Eo())&&(s=n,(r=t).styleSheet?r.styleSheet.cssText=s:r.appendChild(document.createTextNode(s)),function(e){(document.head||document.getElementsByTagName("head")[0]).appendChild(e)}(t)),e++},remove:function(){! --e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},ko=function(){var e=function(){var e=Ao();return function(t,n){r.useEffect((function(){return e.add(t),function(){e.remove()}}),[t&&n])}}();return function(t){var n=t.styles,r=t.dynamic;return e(n,r),null}},So={left:0,top:0,right:0,gap:0},Fo=function(e){return parseInt(e||"",10)||0},_o=function(e){if(void 0===e&&(e="margin"),"undefined"===typeof window)return So;var t=function(e){var t=window.getComputedStyle(document.body),n=t["padding"===e?"paddingLeft":"marginLeft"],r=t["padding"===e?"paddingTop":"marginTop"],s=t["padding"===e?"paddingRight":"marginRight"];return[Fo(n),Fo(r),Fo(s)]}(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},To=ko(),Io="data-scroll-locked",Ro=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return void 0===n&&(n="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(r,";\n   padding-right: ").concat(o,"px ").concat(r,";\n  }\n  body[").concat(Io,"] {\n    overflow: hidden ").concat(r,";\n    overscroll-behavior: contain;\n    ").concat([t&&"position: relative ".concat(r,";"),"margin"===n&&"\n    padding-left: ".concat(s,"px;\n    padding-top: ").concat(i,"px;\n    padding-right: ").concat(a,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(o,"px ").concat(r,";\n    "),"padding"===n&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(mo," {\n    right: ").concat(o,"px ").concat(r,";\n  }\n  \n  .").concat(fo," {\n    margin-right: ").concat(o,"px ").concat(r,";\n  }\n  \n  .").concat(mo," .").concat(mo," {\n    right: 0 ").concat(r,";\n  }\n  \n  .").concat(fo," .").concat(fo," {\n    margin-right: 0 ").concat(r,";\n  }\n  \n  body[").concat(Io,"] {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(o,"px;\n  }\n")},Po=function(){var e=parseInt(document.body.getAttribute(Io)||"0",10);return isFinite(e)?e:0},Oo=function(e){var t=e.noRelative,n=e.noImportant,s=e.gapMode,i=void 0===s?"margin":s;r.useEffect((function(){return document.body.setAttribute(Io,(Po()+1).toString()),function(){var e=Po()-1;e<=0?document.body.removeAttribute(Io):document.body.setAttribute(Io,e.toString())}}),[]);var a=r.useMemo((function(){return _o(i)}),[i]);return r.createElement(To,{styles:Ro(a,!t,i,n?"":"!important")})},Mo=!1;if("undefined"!==typeof window)try{var Lo=Object.defineProperty({},"passive",{get:function(){return Mo=!0,!0}});window.addEventListener("test",Lo,Lo),window.removeEventListener("test",Lo,Lo)}catch(gb){Mo=!1}var Bo=!!Mo&&{passive:!1},zo=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return"hidden"!==n[t]&&!(n.overflowY===n.overflowX&&!function(e){return"TEXTAREA"===e.tagName}(e)&&"visible"===n[t])},Uo=function(e,t){var n=t.ownerDocument,r=t;do{if("undefined"!==typeof ShadowRoot&&r instanceof ShadowRoot&&(r=r.host),qo(e,r)){var s=Vo(e,r);if(s[1]>s[2])return!0}r=r.parentNode}while(r&&r!==n.body);return!1},qo=function(e,t){return"v"===e?function(e){return zo(e,"overflowY")}(t):function(e){return zo(e,"overflowX")}(t)},Vo=function(e,t){return"v"===e?[(n=t).scrollTop,n.scrollHeight,n.clientHeight]:function(e){return[e.scrollLeft,e.scrollWidth,e.clientWidth]}(t);var n},Ho=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Wo=function(e){return[e.deltaX,e.deltaY]},Go=function(e){return e&&"current"in e?e.current:e},Ko=function(e){return"\n  .block-interactivity-".concat(e," {pointer-events: none;}\n  .allow-interactivity-").concat(e," {pointer-events: all;}\n")},Qo=0,Yo=[];function Jo(e){for(var t=null;null!==e;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Xo=($o=function(e){var t=r.useRef([]),n=r.useRef([0,0]),s=r.useRef(),i=r.useState(Qo++)[0],a=r.useState(ko)[0],o=r.useRef(e);r.useEffect((function(){o.current=e}),[e]),r.useEffect((function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var t=(0,ho.fX)([e.lockRef.current],(e.shards||[]).map(Go),!0).filter(Boolean);return t.forEach((function(e){return e.classList.add("allow-interactivity-".concat(i))})),function(){document.body.classList.remove("block-interactivity-".concat(i)),t.forEach((function(e){return e.classList.remove("allow-interactivity-".concat(i))}))}}}),[e.inert,e.lockRef.current,e.shards]);var l=r.useCallback((function(e,t){if("touches"in e&&2===e.touches.length||"wheel"===e.type&&e.ctrlKey)return!o.current.allowPinchZoom;var r,i=Ho(e),a=n.current,l="deltaX"in e?e.deltaX:a[0]-i[0],c="deltaY"in e?e.deltaY:a[1]-i[1],u=e.target,d=Math.abs(l)>Math.abs(c)?"h":"v";if("touches"in e&&"h"===d&&"range"===u.type)return!1;var h=Uo(d,u);if(!h)return!0;if(h?r=d:(r="v"===d?"h":"v",h=Uo(d,u)),!h)return!1;if(!s.current&&"changedTouches"in e&&(l||c)&&(s.current=r),!r)return!0;var m=s.current||r;return function(e,t,n,r,s){var i=function(e,t){return"h"===e&&"rtl"===t?-1:1}(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var m=Vo(e,o),f=m[0],p=m[1]-m[2]-i*f;(f||p)&&qo(e,o)&&(d+=p,h+=f),o=o.parentNode.host||o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&(s&&Math.abs(d)<1||!s&&a>d)||!u&&(s&&Math.abs(h)<1||!s&&-a>h))&&(c=!0),c}(m,t,e,"h"===m?l:c,!0)}),[]),c=r.useCallback((function(e){var n=e;if(Yo.length&&Yo[Yo.length-1]===a){var r="deltaY"in n?Wo(n):Ho(n),s=t.current.filter((function(e){return e.name===n.type&&(e.target===n.target||n.target===e.shadowParent)&&function(e,t){return e[0]===t[0]&&e[1]===t[1]}(e.delta,r)}))[0];if(s&&s.should)n.cancelable&&n.preventDefault();else if(!s){var i=(o.current.shards||[]).map(Go).filter(Boolean).filter((function(e){return e.contains(n.target)}));(i.length>0?l(n,i[0]):!o.current.noIsolation)&&n.cancelable&&n.preventDefault()}}}),[]),u=r.useCallback((function(e,n,r,s){var i={name:e,delta:n,target:r,should:s,shadowParent:Jo(r)};t.current.push(i),setTimeout((function(){t.current=t.current.filter((function(e){return e!==i}))}),1)}),[]),d=r.useCallback((function(e){n.current=Ho(e),s.current=void 0}),[]),h=r.useCallback((function(t){u(t.type,Wo(t),t.target,l(t,e.lockRef.current))}),[]),m=r.useCallback((function(t){u(t.type,Ho(t),t.target,l(t,e.lockRef.current))}),[]);r.useEffect((function(){return Yo.push(a),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:m}),document.addEventListener("wheel",c,Bo),document.addEventListener("touchmove",c,Bo),document.addEventListener("touchstart",d,Bo),function(){Yo=Yo.filter((function(e){return e!==a})),document.removeEventListener("wheel",c,Bo),document.removeEventListener("touchmove",c,Bo),document.removeEventListener("touchstart",d,Bo)}}),[]);var f=e.removeScrollBar,p=e.inert;return r.createElement(r.Fragment,null,p?r.createElement(a,{styles:Ko(i)}):null,f?r.createElement(Oo,{noRelative:e.noRelative,gapMode:e.gapMode}):null)},wo.useMedium($o),Co);var $o,Zo=r.forwardRef((function(e,t){return r.createElement(No,(0,ho.Cl)({},e,{ref:t,sideCar:Xo}))}));Zo.classNames=No.classNames;const el=Zo;var tl=function(e){return"undefined"===typeof document?null:(Array.isArray(e)?e[0]:e).ownerDocument.body},nl=new WeakMap,rl=new WeakMap,sl={},il=0,al=function(e){return e&&(e.host||al(e.parentNode))},ol=function(e,t,n,r){var s=function(e,t){return t.map((function(t){if(e.contains(t))return t;var n=al(t);return n&&e.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",e,". Doing nothing"),null)})).filter((function(e){return Boolean(e)}))}(t,Array.isArray(e)?e:[e]);sl[n]||(sl[n]=new WeakMap);var i=sl[n],a=[],o=new Set,l=new Set(s),c=function(e){e&&!o.has(e)&&(o.add(e),c(e.parentNode))};s.forEach(c);var u=function(e){e&&!l.has(e)&&Array.prototype.forEach.call(e.children,(function(e){if(o.has(e))u(e);else try{var t=e.getAttribute(r),s=null!==t&&"false"!==t,l=(nl.get(e)||0)+1,c=(i.get(e)||0)+1;nl.set(e,l),i.set(e,c),a.push(e),1===l&&s&&rl.set(e,!0),1===c&&e.setAttribute(n,"true"),s||e.setAttribute(r,"true")}catch(Jh){console.error("aria-hidden: cannot operate on ",e,Jh)}}))};return u(t),o.clear(),il++,function(){a.forEach((function(e){var t=nl.get(e)-1,s=i.get(e)-1;nl.set(e,t),i.set(e,s),t||(rl.has(e)||e.removeAttribute(r),rl.delete(e)),s||e.removeAttribute(n)})),--il||(nl=new WeakMap,nl=new WeakMap,rl=new WeakMap,sl={})}},ll=function(e,t,n){void 0===n&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=t||tl(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),ol(r,s,n,"aria-hidden")):function(){return null}};const cl=["__scopeDialog"],ul=["forceMount"],dl=["__scopeDialog"],hl=["forceMount"],ml=["__scopeDialog","trapFocus","onOpenAutoFocus","onCloseAutoFocus"],fl=["__scopeDialog"],pl=["__scopeDialog"],gl=["__scopeDialog"];var vl="Dialog",[xl,yl]=In(vl),[bl,wl]=xl(vl),Dl=e=>{const{__scopeDialog:t,children:n,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=r.useRef(null),c=r.useRef(null),[u,d]=lr({prop:s,defaultProp:null!==i&&void 0!==i&&i,onChange:a,caller:vl});return(0,Et.jsx)(bl,{scope:t,triggerRef:l,contentRef:c,contentId:nr(),titleId:nr(),descriptionId:nr(),open:u,onOpenChange:d,onOpenToggle:r.useCallback((()=>d((e=>!e))),[d]),modal:o,children:n})};Dl.displayName=vl;var Nl="DialogTrigger",jl=r.forwardRef(((e,t)=>{const{__scopeDialog:n}=e,r=(0,a.A)(e,cl),s=wl(Nl,n),i=zn(t,s.triggerRef);return(0,Et.jsx)(ir.button,(0,o.A)((0,o.A)({type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":Hl(s.open)},r),{},{ref:i,onClick:Fn(e.onClick,s.onOpenToggle)}))}));jl.displayName=Nl;var Cl="DialogPortal",[El,Al]=xl(Cl,{forceMount:void 0}),kl=e=>{const{__scopeDialog:t,forceMount:n,children:s,container:i}=e,a=wl(Cl,t);return(0,Et.jsx)(El,{scope:t,forceMount:n,children:r.Children.map(s,(e=>(0,Et.jsx)(_r,{present:n||a.open,children:(0,Et.jsx)(oo,{asChild:!0,container:i,children:e})})))})};kl.displayName=Cl;var Sl="DialogOverlay",Fl=r.forwardRef(((e,t)=>{const n=Al(Sl,e.__scopeDialog),{forceMount:r=n.forceMount}=e,s=(0,a.A)(e,ul),i=wl(Sl,e.__scopeDialog);return i.modal?(0,Et.jsx)(_r,{present:r||i.open,children:(0,Et.jsx)(Tl,(0,o.A)((0,o.A)({},s),{},{ref:t}))}):null}));Fl.displayName=Sl;var _l=Vn("DialogOverlay.RemoveScroll"),Tl=r.forwardRef(((e,t)=>{const{__scopeDialog:n}=e,r=(0,a.A)(e,dl),s=wl(Sl,n);return(0,Et.jsx)(el,{as:_l,allowPinchZoom:!0,shards:[s.contentRef],children:(0,Et.jsx)(ir.div,(0,o.A)((0,o.A)({"data-state":Hl(s.open)},r),{},{ref:t,style:(0,o.A)({pointerEvents:"auto"},r.style)}))})})),Il="DialogContent",Rl=r.forwardRef(((e,t)=>{const n=Al(Il,e.__scopeDialog),{forceMount:r=n.forceMount}=e,s=(0,a.A)(e,hl),i=wl(Il,e.__scopeDialog);return(0,Et.jsx)(_r,{present:r||i.open,children:i.modal?(0,Et.jsx)(Pl,(0,o.A)((0,o.A)({},s),{},{ref:t})):(0,Et.jsx)(Ol,(0,o.A)((0,o.A)({},s),{},{ref:t}))})}));Rl.displayName=Il;var Pl=r.forwardRef(((e,t)=>{const n=wl(Il,e.__scopeDialog),s=r.useRef(null),i=zn(t,n.contentRef,s);return r.useEffect((()=>{const e=s.current;if(e)return ll(e)}),[]),(0,Et.jsx)(Ml,(0,o.A)((0,o.A)({},e),{},{ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Fn(e.onCloseAutoFocus,(e=>{var t;e.preventDefault(),null===(t=n.triggerRef.current)||void 0===t||t.focus()})),onPointerDownOutside:Fn(e.onPointerDownOutside,(e=>{const t=e.detail.originalEvent,n=0===t.button&&!0===t.ctrlKey;(2===t.button||n)&&e.preventDefault()})),onFocusOutside:Fn(e.onFocusOutside,(e=>e.preventDefault()))}))})),Ol=r.forwardRef(((e,t)=>{const n=wl(Il,e.__scopeDialog),s=r.useRef(!1),i=r.useRef(!1);return(0,Et.jsx)(Ml,(0,o.A)((0,o.A)({},e),{},{ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:t=>{var r,a;(null===(r=e.onCloseAutoFocus)||void 0===r||r.call(e,t),t.defaultPrevented)||(s.current||null===(a=n.triggerRef.current)||void 0===a||a.focus(),t.preventDefault());s.current=!1,i.current=!1},onInteractOutside:t=>{var r,a;null===(r=e.onInteractOutside)||void 0===r||r.call(e,t),t.defaultPrevented||(s.current=!0,"pointerdown"===t.detail.originalEvent.type&&(i.current=!0));const o=t.target;(null===(a=n.triggerRef.current)||void 0===a?void 0:a.contains(o))&&t.preventDefault(),"focusin"===t.detail.originalEvent.type&&i.current&&t.preventDefault()}}))})),Ml=r.forwardRef(((e,t)=>{const{__scopeDialog:n,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:l}=e,c=(0,a.A)(e,ml),u=wl(Il,n),d=r.useRef(null),h=zn(t,d);return co(),(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Za,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:i,onUnmountAutoFocus:l,children:(0,Et.jsx)(Wa,(0,o.A)((0,o.A)({role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":Hl(u.open)},c),{},{ref:h,onDismiss:()=>u.onOpenChange(!1)}))}),(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Ql,{titleId:u.titleId}),(0,Et.jsx)(Yl,{contentRef:d,descriptionId:u.descriptionId})]})]})})),Ll="DialogTitle",Bl=r.forwardRef(((e,t)=>{const{__scopeDialog:n}=e,r=(0,a.A)(e,fl),s=wl(Ll,n);return(0,Et.jsx)(ir.h2,(0,o.A)((0,o.A)({id:s.titleId},r),{},{ref:t}))}));Bl.displayName=Ll;var zl="DialogDescription",Ul=r.forwardRef(((e,t)=>{const{__scopeDialog:n}=e,r=(0,a.A)(e,pl),s=wl(zl,n);return(0,Et.jsx)(ir.p,(0,o.A)((0,o.A)({id:s.descriptionId},r),{},{ref:t}))}));Ul.displayName=zl;var ql="DialogClose",Vl=r.forwardRef(((e,t)=>{const{__scopeDialog:n}=e,r=(0,a.A)(e,gl),s=wl(ql,n);return(0,Et.jsx)(ir.button,(0,o.A)((0,o.A)({type:"button"},r),{},{ref:t,onClick:Fn(e.onClick,(()=>s.onOpenChange(!1)))}))}));function Hl(e){return e?"open":"closed"}Vl.displayName=ql;var Wl="DialogTitleWarning",[Gl,Kl]=function(e,t){const n=r.createContext(t),s=e=>{const{children:t}=e,s=(0,a.A)(e,_n),i=r.useMemo((()=>s),Object.values(s));return(0,Et.jsx)(n.Provider,{value:i,children:t})};return s.displayName=e+"Provider",[s,function(s){const i=r.useContext(n);if(i)return i;if(void 0!==t)return t;throw new Error("`".concat(s,"` must be used within `").concat(e,"`"))}]}(Wl,{contentName:Il,titleName:Ll,docsSlug:"dialog"}),Ql=e=>{let{titleId:t}=e;const n=Kl(Wl),s="`".concat(n.contentName,"` requires a `").concat(n.titleName,"` for the component to be accessible for screen reader users.\n\nIf you want to hide the `").concat(n.titleName,"`, you can wrap it with our VisuallyHidden component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/").concat(n.docsSlug);return r.useEffect((()=>{if(t){document.getElementById(t)||console.error(s)}}),[s,t]),null},Yl=e=>{let{contentRef:t,descriptionId:n}=e;const s=Kl("DialogDescriptionWarning"),i="Warning: Missing `Description` or `aria-describedby={undefined}` for {".concat(s.contentName,"}.");return r.useEffect((()=>{var e;const r=null===(e=t.current)||void 0===e?void 0:e.getAttribute("aria-describedby");if(n&&r){document.getElementById(n)||console.warn(i)}}),[i,t,n]),null},Jl=Fl,Xl=Rl,$l=Bl,Zl=Ul,ec=Vl;const tc=["className"],nc=["className","children"],rc=["className"],sc=["className"],ic=["className"],ac=["className"],oc=Dl,lc=jl,cc=kl,uc=ec,dc=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,tc);return(0,Et.jsx)(Jl,(0,o.A)({ref:t,className:(0,Dn.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n)},r))}));dc.displayName=Jl.displayName;const hc=r.forwardRef(((e,t)=>{let{className:n,children:r}=e,s=(0,a.A)(e,nc);return(0,Et.jsxs)(cc,{children:[(0,Et.jsx)(dc,{}),(0,Et.jsxs)(Xl,(0,o.A)((0,o.A)({ref:t,className:(0,Dn.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",n)},s),{},{children:[r,(0,Et.jsxs)(ec,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,Et.jsx)(cn,{className:"h-4 w-4"}),(0,Et.jsx)("span",{className:"sr-only",children:"Close"})]})]}))]})}));hc.displayName=Xl.displayName;const mc=e=>{let{className:t}=e,n=(0,a.A)(e,rc);return(0,Et.jsx)("div",(0,o.A)({className:(0,Dn.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t)},n))};mc.displayName="DialogHeader";const fc=e=>{let{className:t}=e,n=(0,a.A)(e,sc);return(0,Et.jsx)("div",(0,o.A)({className:(0,Dn.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t)},n))};fc.displayName="DialogFooter";const pc=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,ic);return(0,Et.jsx)($l,(0,o.A)({ref:t,className:(0,Dn.cn)("text-lg font-semibold leading-none tracking-tight",n)},r))}));pc.displayName=$l.displayName;const gc=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,ac);return(0,Et.jsx)(Zl,(0,o.A)({ref:t,className:(0,Dn.cn)("text-sm text-muted-foreground",n)},r))}));gc.displayName=Zl.displayName;const vc=e=>{var t;let{message:n,isInstructor:s,isSmallScreen:i=!1}=e;const{user:a}=kt(),{markAsRead:o}=di(),[l,c]=(0,r.useState)(0);if((0,r.useEffect)((()=>{var e,t;if(!n||!a||null===(e=n.type)||void 0===e||!e.includes("broadcast"))return;if(null!==(t=n.readBy)&&void 0!==t&&t.includes(a.uid))return;const r=setTimeout((()=>{o(n.id,a.uid,!0).then((()=>{})).catch((e=>{console.error("Error marking message as read:",e),l<3&&c((e=>e+1))}))}),500);return()=>clearTimeout(r)}),[n,a,o,l]),null===(t=n.type)||void 0===t||!t.includes("broadcast"))return null;const u=n.readStatus?Object.values(n.readStatus).filter((e=>e.read)).length:0,d=n.totalRecipients||0,h=n.readStatus||{};if(!s)return(0,Et.jsxs)("span",{className:"text-xs text-gray-500",children:[u,"/",d," read"]});const m=Object.entries(h).filter((e=>{let[t,n]=e;return n.read})).sort(((e,t)=>{var n,r;const s=e=>{if(!e)return 0;if(e.toDate&&"function"===typeof e.toDate)return e.toDate().getTime();if(e instanceof Date)return e.getTime();try{return new Date(e).getTime()}catch(Jh){return console.warn("Invalid timestamp format:",e),0}},i=s(null===(n=e[1])||void 0===n?void 0:n.readAt);return s(null===(r=t[1])||void 0===r?void 0:r.readAt)-i})),f=Object.entries(h).filter((e=>{let[t,n]=e;return!n.read}));return(0,Et.jsxs)(oc,{children:[(0,Et.jsx)(lc,{asChild:!0,children:(0,Et.jsxs)("button",{className:"flex items-center gap-1 text-xs text-gray-500 hover:text-gray-700 ".concat(i?"p-2 touch-target":""," no-tap-highlight"),children:[(0,Et.jsx)(La,{size:i?16:14}),u,"/",d," read"]})}),(0,Et.jsxs)(hc,{className:"".concat(i?"w-[95%]":"max-w-md"),children:[(0,Et.jsx)(mc,{children:(0,Et.jsx)(pc,{className:"text-lg",children:"Read Receipts"})}),(0,Et.jsxs)("div",{className:"max-h-[60vh] overflow-y-auto smooth-scroll p-1",children:[(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsxs)("h3",{className:"text-sm font-medium text-green-600 mb-2 px-2",children:["Read (",m.length,")"]}),(0,Et.jsxs)("div",{className:"space-y-2",children:[m.map((e=>{var t;let[n,r]=e;return(0,Et.jsxs)("div",{className:"flex justify-between items-center text-sm px-2 py-2 ".concat(i?"hover:bg-gray-50 rounded":""),children:[(0,Et.jsx)("span",{className:"font-medium",children:(null===(t=h[n])||void 0===t?void 0:t.name)||"Unknown User"}),(0,Et.jsx)("span",{className:"text-xs text-gray-500",children:r.readAt?Oa(r.readAt.toDate?r.readAt.toDate():r.readAt instanceof Date?r.readAt:new Date(r.readAt),"MMM d, h:mm a"):"Time unknown"})]},n)})),0===m.length&&(0,Et.jsx)("div",{className:"text-sm text-gray-500 px-2 py-2",children:"No one has read this message yet"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("h3",{className:"text-sm font-medium text-gray-600 mb-2 px-2",children:["Not Yet Read (",f.length,")"]}),(0,Et.jsxs)("div",{className:"space-y-2",children:[f.map((e=>{var t;let[n]=e;return(0,Et.jsx)("div",{className:"text-sm text-gray-500 px-2 py-2 ".concat(i?"hover:bg-gray-50 rounded":""),children:(null===(t=h[n])||void 0===t?void 0:t.name)||"Unknown User"},n)})),0===f.length&&(0,Et.jsx)("div",{className:"text-sm text-gray-500 px-2 py-2",children:"Everyone has read this message"})]})]})]})]})]})},xc=Mt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),yc=Mt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),bc=Mt("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),wc=Mt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Dc=Mt("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),Nc=Mt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),jc=e=>{let{fileAttachment:t,isSmallScreen:n=!1}=e;const[s,i]=(0,r.useState)(!1);if(!t)return null;const{name:a,url:o,type:l,size:c}=t,u=l.startsWith("image/")&&!s,d=l.startsWith("video/")||l.startsWith("audio/");return(0,Et.jsx)("div",{className:"mt-2 max-w-full",children:u?(0,Et.jsxs)("div",{className:"relative overflow-hidden rounded-lg",children:[(0,Et.jsx)("img",{src:o,alt:a,className:"max-w-full max-h-64 object-contain rounded",onError:()=>i(!0)}),(0,Et.jsx)("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"absolute bottom-2 right-2 bg-black/60 text-white ".concat(n?"p-2":"p-1"," rounded-full hover:bg-black/80 touch-target no-tap-highlight"),title:"Download image","aria-label":"Download image",children:(0,Et.jsx)(Nc,{size:n?20:16})})]}):d?(0,Et.jsxs)("div",{className:"max-w-full",children:[l.startsWith("video/")&&(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsxs)("video",{controls:!0,className:"max-w-full max-h-64 rounded",controlsList:"nodownload",playsInline:!0,children:[(0,Et.jsx)("source",{src:o,type:l}),"Your browser does not support the video tag."]}),(0,Et.jsx)("a",{href:o,target:"_blank",rel:"noopener noreferrer",download:!0,className:"absolute bottom-2 right-2 bg-black/60 text-white ".concat(n?"p-2":"p-1"," rounded-full hover:bg-black/80 touch-target no-tap-highlight"),title:"Download video","aria-label":"Download video",children:(0,Et.jsx)(Nc,{size:n?20:16})})]}),l.startsWith("audio/")&&(0,Et.jsxs)("div",{className:"max-w-full relative",children:[(0,Et.jsxs)("audio",{controls:!0,className:"max-w-full rounded w-full bg-gray-100 p-2",children:[(0,Et.jsx)("source",{src:o,type:l}),"Your browser does not support the audio tag."]}),(0,Et.jsxs)("a",{href:o,target:"_blank",rel:"noopener noreferrer",download:!0,className:"inline-flex items-center mt-1 text-blue-500 no-tap-highlight",title:"Download audio","aria-label":"Download audio",children:[(0,Et.jsx)(Nc,{size:16,className:"mr-1"}),(0,Et.jsx)("span",{className:"text-sm",children:"Download"})]})]})]}):(0,Et.jsxs)("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 ".concat(n?"p-4":"p-3"," bg-gray-50 hover:bg-gray-100 rounded-lg border border-gray-200 transition-colors touch-target no-tap-highlight"),download:!0,"aria-label":"Download ".concat(a),children:[(0,Et.jsx)("div",{className:"text-gray-500",children:(()=>{const e=n?28:24;return l.startsWith("image/")?(0,Et.jsx)(xc,{size:e}):l.startsWith("video/")?(0,Et.jsx)(yc,{size:e}):l.startsWith("audio/")?(0,Et.jsx)(bc,{size:e}):l.includes("pdf")?(0,Et.jsx)(wc,{size:e}):(0,Et.jsx)(Dc,{size:e})})()}),(0,Et.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,Et.jsx)("div",{className:"text-sm font-medium text-gray-700 truncate",children:a}),(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:(h=c,h<1024?h+" B":h<1048576?(h/1024).toFixed(1)+" KB":(h/1048576).toFixed(1)+" MB")})]}),(0,Et.jsx)(Nc,{size:n?20:16,className:"text-gray-400"})]})});var h},Cc=Mt("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),Ec=e=>{let{messageId:t,onReactionSelect:n,isOwnMessage:s,isSmallScreen:i=!1}=e;const[a,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)("top"),[u,d]=(0,r.useState)(!1),h=(0,r.useRef)(null),m=(0,r.useRef)(null),{getCommonEmojis:f}=di(),p=f();(0,r.useEffect)((()=>{if(a&&h.current){const e=h.current.getBoundingClientRect(),t=window.innerHeight,n=window.innerWidth,r=e.top,s=t-e.bottom;i&&e.left<120?c("right-bottom"):i&&n-e.right<120?c("left-bottom"):c(s>r?"bottom":"top")}}),[a,i]),(0,r.useEffect)((()=>{const e=e=>{m.current&&!m.current.contains(e.target)&&o(!1)};return a&&(document.addEventListener("mousedown",e),document.addEventListener("touchstart",e)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[a]);const g=()=>{d(!0)},v=()=>{d(!1)};return(0,Et.jsxs)("div",{className:"relative",ref:m,children:[(0,Et.jsx)("button",{ref:h,onClick:()=>{o((e=>!e))},onTouchStart:g,onTouchEnd:v,className:"".concat(s?"text-blue-200 hover:text-white":"text-gray-500 hover:text-gray-700"," ").concat(u?"opacity-80":"opacity-100"," ").concat(i?"p-2 touch-target":""," transition-opacity no-tap-highlight"),"aria-label":"Add reaction",children:(0,Et.jsx)(Cc,{size:i?18:14})}),a&&(0,Et.jsx)("div",{className:"absolute ".concat((()=>{switch(l){case"top":default:return"bottom-full mb-2 left-0";case"bottom":case"right-bottom":return"top-full mt-2 left-0";case"left-bottom":return"top-full mt-2 right-0"}})()," p-3 bg-white rounded-lg shadow-lg z-20 border ").concat(i?"min-w-[250px]":"min-w-[220px]"),style:{maxHeight:i?"250px":"200px",overflowY:"auto"},children:(0,Et.jsx)("div",{className:"grid ".concat(i?"grid-cols-5 gap-3":"grid-cols-6 gap-2"),children:p.map((e=>(0,Et.jsx)("button",{onClick:()=>(e=>{n(e),o(!1),d(!1)})(e),onTouchStart:g,onTouchEnd:v,className:"".concat(i?"w-10 h-10":"w-8 h-8"," flex items-center justify-center hover:bg-gray-100 rounded text-lg transition-colors ").concat(u&&i?"bg-gray-100":""," touch-target no-tap-highlight"),title:"React with ".concat(e),children:e},e)))})})]})},Ac=e=>{let{messages:t,currentUserId:n,onDeleteMessage:s,onEditMessage:i,onReplyMessage:a,onViewThread:o,loading:l,loadingMore:c,error:u,showBroadcastIndicator:d=!1,isInstructor:h=!1,hasMore:m=!1,onLoadMore:f,className:p="",activeThreadId:g=null,touchedMessageId:v=null,setTouchedMessageId:x=null,isSmallScreen:y=!1,isEmbedded:b=!1}=e;const[w,D]=(0,r.useState)(null),[N,j]=(0,r.useState)(""),[C,E]=(0,r.useState)(!1),{addReaction:A,getSortedReactions:k}=di(),S=(0,r.useRef)(null),F=(0,r.useRef)(null),_=(0,r.useRef)(null),T=(0,r.useRef)(null);(0,r.useEffect)((()=>{_.current&&_.current.scrollIntoView({behavior:"smooth"})}),[t]);const I=(0,r.useCallback)((e=>{e[0].isIntersecting&&m&&!c&&f&&f()}),[m,c,f]);(0,r.useEffect)((()=>(S.current=new IntersectionObserver(I,{root:null,rootMargin:"20px",threshold:0}),F.current&&S.current.observe(F.current),()=>{S.current&&S.current.disconnect()})),[I]);const R=()=>{D(null),j("")},P=(e,t)=>{if(e&&t)try{A(e,t).catch((e=>{console.error("Reaction error:",e)}))}catch(u){console.error("Error in reaction handler:",u)}},O=e=>{var t,r,s,i;if(!e||!n)return!1;if(e.senderId!==n)return!1;if(null!==(t=e.type)&&void 0!==t&&t.includes("broadcast"))return!1;if(null!==(r=e.deletedFor)&&void 0!==r&&r.includes(n))return!1;const a=(null===(s=e.timestamp)||void 0===s||null===(i=s.toDate)||void 0===i?void 0:i.call(s))||e.timestamp;return!(Date.now()-a>864e5)},M=()=>{x&&x(null)};if(l)return(0,Et.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,Et.jsx)("div",{className:"text-gray-500",children:"Loading messages..."})});if(u)return(0,Et.jsx)(An,{variant:"destructive",className:"m-4",children:(0,Et.jsx)(Sn,{children:"object"===typeof u&&null!==u?u.message||"An unknown error occurred":u})});const L=t.reduce(((e,t)=>{const n=Oa(new Date(t.timestamp),"yyyy-MM-dd");return e[n]||(e[n]=[]),e[n].push(t),e}),{});return(0,Et.jsxs)("div",{className:"flex-1 overflow-y-auto smooth-scroll ".concat(p),style:{maxHeight:"calc(100vh - 180px)"},ref:T,onScroll:e=>{if(!T.current)return;const t=e.target,n=t.scrollHeight-t.scrollTop>t.clientHeight+100;E(n)},children:[(0,Et.jsxs)("div",{className:"flex flex-col space-y-3 md:space-y-4 p-3 md:p-4",children:[c&&(0,Et.jsx)("div",{className:"flex justify-center py-2",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}),m&&(0,Et.jsx)("div",{ref:F,className:"h-1"}),0===t.length&&(0,Et.jsx)("div",{className:"flex items-center justify-center h-full py-10",children:(0,Et.jsx)("div",{className:"text-gray-500",children:"No messages yet"})}),Object.entries(L).map((e=>{let[t,r]=e;return(0,Et.jsxs)("div",{className:"space-y-3 md:space-y-4",children:[(0,Et.jsx)("div",{className:"sticky top-0 z-10 flex justify-center",children:(0,Et.jsx)("span",{className:"bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full",children:Oa(new Date(t),"MMMM d, yyyy")})}),r.map((e=>{const t=e.senderId===n,r=(e=>{var t;return!0===e.isBroadcast||(null===(t=e.type)||void 0===t?void 0:t.includes("broadcast"))||"trip_broadcast"===e.type||"course_broadcast"===e.type})(e),l=w===e.id,c=(e=>{if(!e||!e.reactions)return[];try{return k(e.reactions)}catch(u){return console.error("Error processing reactions:",u),[]}})(e),m=v===e.id;return(0,Et.jsx)("div",{className:"flex ".concat(t?"justify-end":"justify-start"),onTouchStart:()=>{return t=e.id,void(x&&x(t));var t},onTouchEnd:M,children:(0,Et.jsxs)("div",{className:"relative group max-w-[80%] ".concat(r?"w-full bg-blue-50 border border-blue-100 rounded-lg p-3":t?"bg-[#4460F1] text-white rounded-2xl rounded-tr-sm p-3":"bg-gray-100 rounded-2xl rounded-tl-sm p-3"," ").concat(m?"opacity-80":"opacity-100"," transition-opacity"),children:[r&&d&&(0,Et.jsx)("div",{className:"absolute -left-2 -top-2 bg-blue-500 text-white p-1 rounded-full",children:(0,Et.jsx)(Si,{size:12})}),(!t||r)&&(0,Et.jsxs)("div",{className:"text-sm font-medium mb-1 ".concat(r?"text-blue-700":"text-gray-700"),children:[e.senderName,r&&(0,Et.jsx)("span",{className:"ml-2 text-xs font-normal text-blue-600",children:"Broadcast"})]}),l?(0,Et.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,Et.jsx)("textarea",{value:N,onChange:e=>j(e.target.value),className:"w-full p-2 rounded border text-gray-800 min-h-[60px] resize-none touch-input",autoFocus:!0}),(0,Et.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,Et.jsx)("button",{onClick:R,className:"p-2 hover:bg-gray-100 rounded text-gray-600 touch-target","aria-label":"Cancel edit",children:(0,Et.jsx)(cn,{size:16})}),(0,Et.jsx)("button",{onClick:()=>(async e=>{try{i?await i(e,N):console.warn("Edit message function not provided"),D(null),j("")}catch(u){console.error("Error editing message:",u)}})(e.id),className:"p-2 hover:bg-gray-100 rounded text-green-600 touch-target",disabled:!N.trim(),"aria-label":"Save edit",children:(0,Et.jsx)(Ut,{size:16})})]})]}):(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-sm ".concat(r?"text-gray-800":t?"text-white":"text-gray-800"),children:e.text}),e.fileAttachment&&(0,Et.jsx)("div",{className:"mt-2 max-w-full overflow-hidden",children:(0,Et.jsx)(jc,{fileAttachment:e.fileAttachment})})]}),c.length>0&&(0,Et.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:c.map((t=>(0,Et.jsx)("button",{onClick:()=>P(e.id,t.emoji),className:"px-2 py-1 rounded-full text-xs ".concat(y?"touch-target":""," ").concat(t.users.some((e=>e.id===n))?"bg-blue-100 text-blue-700":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:(0,Et.jsxs)("span",{children:[t.emoji," ",t.count]})},t.emoji)))}),e.replyCount>0&&(0,Et.jsxs)("button",{onClick:()=>o&&o(e.id),className:"mt-1 text-xs underline ".concat(t?"text-blue-100":"text-gray-500"," ").concat(y?"p-1 touch-target":""),children:["View thread (",e.replyCount," ",1===e.replyCount?"reply":"replies",")"]}),(0,Et.jsxs)("div",{className:"flex items-center justify-end gap-2 mt-1 ".concat(r?"text-blue-600":t?"text-blue-200":"text-gray-500"),children:[r&&(0,Et.jsx)(vc,{message:e,isInstructor:h}),!l&&(0,Et.jsxs)("div",{className:"".concat(b||y?"opacity-100":"opacity-0 group-hover:opacity-100"," transition-opacity flex gap-2"),children:[(0,Et.jsx)(Ec,{messageId:e.id,onReactionSelect:t=>{t&&P(e.id,t)},isOwnMessage:t,isSmallScreen:y}),!g&&a&&(0,Et.jsx)("button",{onClick:()=>o&&o(e.id),className:"".concat(r?"text-blue-600 hover:text-blue-800":t?"text-blue-200 hover:text-white":"text-gray-500 hover:text-gray-700"," ").concat(y?"p-2 touch-target":""),"aria-label":"Reply to message",children:(0,Et.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:y?"18":"14",height:y?"18":"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,Et.jsx)("polyline",{points:"15 10 20 15 15 20"}),(0,Et.jsx)("path",{d:"M4 4v7a4 4 0 0 0 4 4h12"})]})}),O(e)&&(0,Et.jsx)("button",{onClick:()=>(e=>{D(e.id),j(e.text)})(e),className:"".concat(r?"text-blue-600 hover:text-blue-800":t?"text-blue-200 hover:text-white":"text-gray-500 hover:text-gray-700"," ").concat(y?"p-2 touch-target":""),"aria-label":"Edit message",children:(0,Et.jsx)(Ut,{size:y?18:14})}),t&&s&&(0,Et.jsx)("button",{onClick:()=>s(e.id),className:"".concat(r?"text-blue-600 hover:text-blue-800":"text-blue-200 hover:text-white"," ").concat(y?"p-2 touch-target":""," ").concat(b?"hover:scale-110 hover:bg-red-50 rounded-full":""),style:b?{zIndex:10}:{},"aria-label":"Delete message",children:(0,Et.jsx)(zt,{size:y?18:14})})]}),e.isEdited&&!l&&(0,Et.jsx)("span",{className:"text-xs italic",children:"(edited)"}),(0,Et.jsx)("span",{className:"text-xs",children:Oa(new Date(e.timestamp),"h:mm a")})]})]})},e.id)}))]},t)})),(0,Et.jsx)("div",{ref:_})]}),C&&(0,Et.jsx)("button",{onClick:()=>{_.current&&_.current.scrollIntoView({behavior:"smooth"})},className:"fixed bottom-24 right-4 bg-white shadow-md rounded-full p-2 z-10","aria-label":"Scroll to bottom",children:(0,Et.jsx)(ds,{size:20,className:"text-gray-600"})})]})},kc=["className"],Sc=["className"],Fc=["className","children"],_c=["className"],Tc=["className"],Ic=["className"],Rc=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,kc);return(0,Et.jsx)("div",(0,o.A)({ref:t,className:"rounded-xl border bg-card text-card-foreground shadow ".concat(n)},r))}));Rc.displayName="Card";const Pc=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,Sc);return(0,Et.jsx)("div",(0,o.A)({ref:t,className:"flex flex-col space-y-1.5 p-6 ".concat(n)},r))}));Pc.displayName="CardHeader";const Oc=r.forwardRef(((e,t)=>{let{className:n,children:r}=e,s=(0,a.A)(e,Fc);return(0,Et.jsx)("h3",(0,o.A)((0,o.A)({ref:t,className:"font-semibold leading-none tracking-tight ".concat(n)},s),{},{children:r||s.title||""}))}));Oc.displayName="CardTitle";r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,_c);return(0,Et.jsx)("p",(0,o.A)({ref:t,className:"text-sm text-muted-foreground ".concat(n)},r))})).displayName="CardDescription";const Mc=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,Tc);return(0,Et.jsx)("div",(0,o.A)({ref:t,className:"p-6 pt-0 ".concat(n)},r))}));Mc.displayName="CardContent";const Lc=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,Ic);return(0,Et.jsx)("div",(0,o.A)({ref:t,className:"flex items-center p-6 pt-0 ".concat(n)},r))}));Lc.displayName="CardFooter";const Bc=Mt("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),zc=Mt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Uc=Mt("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]]),qc=Mt("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),Vc=e=>{let{error:t,onRetry:n,className:r=""}=e;if(!t)return null;const s="string"===typeof t?t:t.message,i=t.type||Dn.wU.UNKNOWN;return(0,Et.jsxs)(An,{variant:"destructive",className:r,children:[(()=>{switch(i){case Dn.wU.NETWORK:return(0,Et.jsx)(Bc,{className:"h-4 w-4"});case Dn.wU.PERMISSION:return(0,Et.jsx)(zc,{className:"h-4 w-4"});case Dn.wU.NOT_FOUND:return(0,Et.jsx)(Uc,{className:"h-4 w-4"});case Dn.wU.SERVER:return(0,Et.jsx)(qc,{className:"h-4 w-4"});default:return(0,Et.jsx)(nn,{className:"h-4 w-4"})}})(),(0,Et.jsx)(kn,{children:(()=>{switch(i){case Dn.wU.NETWORK:return"Network Error";case Dn.wU.PERMISSION:return"Permission Denied";case Dn.wU.NOT_FOUND:return"Not Found";case Dn.wU.VALIDATION:return"Invalid Input";case Dn.wU.SERVER:return"Server Error";default:return"Error"}})()}),(0,Et.jsx)(Sn,{children:(0,Et.jsxs)("div",{className:"flex flex-col",children:[(0,Et.jsx)("p",{children:s}),n&&(0,Et.jsx)("button",{onClick:n,className:"text-sm underline mt-2 text-left hover:text-white",children:"Try Again"})]})})]})},Hc=Mt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Wc=["className","variant","size","asChild"],Gc=wn("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Kc=r.forwardRef(((e,t)=>{let{className:n,variant:r,size:s,asChild:i=!1}=e,l=(0,a.A)(e,Wc);const c=i?Hn:"button";return(0,Et.jsx)(c,(0,o.A)({className:(0,Dn.cn)(Gc({variant:r,size:s,className:n})),ref:t},l))}));Kc.displayName="Button";const Qc=e=>{let{params:t,onSearchComplete:n}=e;const[s,i]=(0,r.useState)(""),{searchMessages:a,clearSearch:l,searchLoading:c}=di(),u=(0,r.useCallback)((async()=>{s.trim()&&(await a((0,o.A)((0,o.A)({},t),{},{searchText:s.trim()})),n&&n())}),[s,t,a,n]);return(0,Et.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[(0,Et.jsxs)("div",{className:"flex-1 flex items-center gap-2 px-3 py-2 bg-white rounded-md border",children:[(0,Et.jsx)(Hc,{className:"text-gray-400",size:16}),(0,Et.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"===e.key&&u()},placeholder:"Search messages...",className:"flex-1 bg-transparent border-none outline-none text-sm text-gray-600 placeholder-gray-400"}),s&&(0,Et.jsx)("button",{onClick:()=>{i(""),l()},className:"text-gray-400 hover:text-gray-600",children:(0,Et.jsx)(cn,{size:16})})]}),(0,Et.jsx)(Kc,{size:"sm",onClick:u,disabled:!s.trim()||c,children:c?"Searching...":"Search"})]})},Yc=e=>{let{currentUserId:t,onDeleteMessage:n,onEditMessage:r,onReplyMessage:s,onViewThread:i,isInstructor:a}=e;const{searchResults:o,searchLoading:l,searchError:c,isSearching:u,clearSearch:d}=di();return l?(0,Et.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})}):c?(0,Et.jsx)(An,{variant:"destructive",className:"m-4",children:(0,Et.jsx)(Sn,{children:c})}):u?0===o.length?(0,Et.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-gray-500",children:[(0,Et.jsx)("p",{children:"No messages found"}),(0,Et.jsx)("button",{onClick:d,className:"mt-2 text-sm text-blue-500 hover:underline",children:"Clear search"})]}):(0,Et.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,Et.jsxs)("div",{className:"sticky top-0 z-10 flex items-center justify-between bg-white p-4 border-b",children:[(0,Et.jsxs)("div",{className:"text-sm text-gray-600",children:["Found ",o.length," messages"]}),(0,Et.jsx)("button",{onClick:d,className:"text-sm text-blue-500 hover:underline",children:"Clear search"})]}),(0,Et.jsx)(Ac,{messages:o,currentUserId:t,onDeleteMessage:n,onEditMessage:r,onReplyMessage:s,onViewThread:i,showThreadIndicator:!0,isInstructor:a})]}):null},Jc=e=>{let{typingUsers:t,userProfiles:n={},currentUserId:r}=e;if(!t||0===t.length)return null;const s=t.filter((e=>e!==r));if(0===s.length)return null;const i=s.slice(0,2).map((e=>(n[e]||{}).displayName||"Someone"));let a="";if(1===i.length)a="".concat(i[0]," is typing");else if(2===i.length)a="".concat(i[0]," and ").concat(i[1]," are typing");else{const e=s.length-2;a="".concat(i.join(", ")," and ").concat(e," more are typing")}return(0,Et.jsxs)("div",{className:"text-xs text-gray-500 italic flex items-center gap-2 p-2 border-t",children:[(0,Et.jsxs)("div",{className:"flex gap-1",children:[(0,Et.jsx)("span",{className:"typing-dot"}),(0,Et.jsx)("span",{className:"typing-dot"}),(0,Et.jsx)("span",{className:"typing-dot"})]}),(0,Et.jsxs)("span",{children:[a,"..."]}),(0,Et.jsx)("style",{jsx:!0,children:"\n        .typing-dot {\n          width: 4px;\n          height: 4px;\n          background-color: #888;\n          border-radius: 50%;\n          display: inline-block;\n          animation: typing-bounce 1.4s infinite both;\n        }\n        \n        .typing-dot:nth-child(2) {\n          animation-delay: 0.2s;\n        }\n        \n        .typing-dot:nth-child(3) {\n          animation-delay: 0.4s;\n        }\n        \n        @keyframes typing-bounce {\n          0%, 80%, 100% {\n            transform: translateY(0);\n          }\n          40% {\n            transform: translateY(-4px);\n          }\n        }\n      "})]})};var Xc=n(4733);const $c=e=>{let{context:t,contextType:s,isOpen:i,onClose:a,defaultTab:l="discussion",recipient:c=null}=e;const{user:u}=kt(),{messages:d,loading:h,loadingMore:m,error:f,hasMore:p,isSearching:g,subscribeToMessages:v,subscribeToTypingStatus:x,setTypingStatus:y,typingUsers:b,loadMoreMessages:w,sendMessage:D,sendMessageWithFile:N,deleteMessage:j,deleteMessageWithFile:C,deleteChat:E,editMessage:A,addReaction:k}=di(),S="personal"===s||!0===i&&"function"===typeof a&&a.toString().includes("() => {}"),[F,_]=(0,r.useState)(l),[T,I]=(0,r.useState)(!1),[R,P]=(0,r.useState)(null),[O,M]=(0,r.useState)(c),[L,B]=(0,r.useState)(""),[z,U]=(0,r.useState)({}),[q,V]=(0,r.useState)(!1),[H,W]=(0,r.useState)(null),[G,K]=(0,r.useState)(!1),Q=(null===t||void 0===t?void 0:t.instructorId)===(null===u||void 0===u?void 0:u.uid),Y=(null===t||void 0===t?void 0:t.id)||("personal"===s?null===t||void 0===t?void 0:t.chatId:null),J="course"===s?(null===t||void 0===t?void 0:t.students)||[]:"trip"===s&&(null===t||void 0===t?void 0:t.participants)||[],X=(0,r.useRef)([]),$=(0,r.useRef)(!0),Z=(0,r.useRef)(!1),ee=(0,r.useRef)(null),te=(0,r.useRef)(null),ne=J.filter((e=>{var t,n;return(null===(t=e.displayName)||void 0===t?void 0:t.toLowerCase().includes(L.toLowerCase()))||(null===(n=e.email)||void 0===n?void 0:n.toLowerCase().includes(L.toLowerCase()))}));(0,r.useEffect)((()=>($.current=!0,ee.current&&clearTimeout(ee.current),ee.current=setTimeout((()=>{$.current&&V(!0)}),500),()=>{$.current=!1,ee.current&&clearTimeout(ee.current),X.current.forEach((e=>{if("function"===typeof e)try{e()}catch(Jh){console.error("Error during unsubscribe:",Jh)}})),X.current=[]})),[]),(0,r.useEffect)((()=>{const e=()=>{K(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>{if(!b||0===b.length||!q)return;(async()=>{const e=(0,o.A)({},z);let t=!1;for(const n of b)if(!z[n])try{const r=(0,Dt.H9)(wt.db,"profiles",n),s=await(0,Dt.x7)(r),i=s.exists()?(0,o.A)((0,o.A)({},s.data()),{},{uid:n}):null;i&&$.current&&(e[n]=i,t=!0)}catch(f){console.error("Error fetching user profile for ".concat(n,":"),f)}t&&$.current&&U(e)})()}),[b,q]),(0,r.useEffect)((()=>{if(!Y||null===u||void 0===u||!u.uid||!q)return;const e=(0,o.A)({type:s,["course"===s?"courseId":"trip"===s?"tripId":"chatId"]:Y,messageType:"".concat(s,"broadcast"===F?"_broadcast":"discussion"===F?"_discussion":"_private")},"private"===F&&O?{recipientId:O.uid}:{});let t;const n=setTimeout((()=>{$.current&&(t=x(e),t&&X.current.push(t))}),100);return()=>{if(clearTimeout(n),t)try{t(),X.current=X.current.filter((e=>e!==t))}catch(Jh){console.error("Error unsubscribing from typing:",Jh)}$.current&&y(e,!1)}}),[Y,null===u||void 0===u?void 0:u.uid,F,s,x,y,q,O]),(0,r.useEffect)((()=>{if(!Y||null===u||void 0===u||!u.uid||!q||!s)return;X.current.filter((e=>"messages"===e.subscriptionType)).forEach((e=>{try{e(),X.current=X.current.filter((t=>t!==e))}catch(Jh){console.error("Error unsubscribing from messages:",Jh)}}));const e=setTimeout((()=>{if(!$.current)return;let e;const n="course"===s?"courseId":"trip"===s?"tripId":"chatId",r={type:s,[n]:Y,messageType:"".concat(s,"broadcast"===F?"_broadcast":"discussion"===F?"_discussion":"_private")};"private"===F&&"personal"!==s&&(Q&&O?r.recipientId=O.uid:Q||(r.recipientId=t.instructorId)),e=v(r),e&&(e.subscriptionType="messages",X.current.push(e))}),100);return()=>{clearTimeout(e)}}),[Y,null===u||void 0===u?void 0:u.uid,v,s,F,Q,q,O,null===t||void 0===t?void 0:t.instructorId]);const re=(0,r.useCallback)((async(e,t)=>{try{await k(e,t)}catch(f){console.error("Error adding reaction:",f)}}),[k]),se=(0,r.useCallback)((()=>{if(!Y)return;const e="course"===s?"courseId":"trip"===s?"tripId":"chatId",t={type:s,[e]:Y,messageType:"".concat(s,"broadcast"===F?"_broadcast":"discussion"===F?"_discussion":"_private")};w(t)}),[w,Y,s,F]),ie=async function(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:F;if((e.trim()||n)&&u&&t){I(!0),P(null);try{const i="course"===s?"courseId":"trip"===s?"tripId":"chatId";let a;switch(r){case"broadcast":a="".concat(s,"_broadcast");break;case"private":a="".concat(s,"_private");break;default:a="personal"===s?"chat":"".concat(s,"_discussion")}let o=u.name||u.displayName||u.email||"Unknown User";"broadcast"===r&&Q&&(o+="course"===s?" (Instructor)":" (Trip Leader)");const l={[i]:Y,senderId:u.uid,senderName:o,text:e.trim(),timestamp:new Date,type:a};if("private"===r&&(Q&&O?l.recipientId=O.uid:Q||(l.recipientId=t.instructorId)),"broadcast"===r){const e="course"===s?[...t.students||[],...t.assistants||[]]:t.participants||[];l.readBy=[u.uid],l.readStatus=e.reduce(((e,t)=>(e[t.uid]={read:!1,readAt:null,name:t.displayName||"Unknown User"},e)),{}),l.totalRecipients=e.length,l.readCount=0}n?await N(l,n):await D(l)}catch(f){console.error("Error sending message:",f),P(f)}finally{I(!1)}}},ae=(0,r.useCallback)((async e=>{if(null!==u&&void 0!==u&&u.uid)try{if(window.confirm("Are you sure you want to delete this message?")){var r;const o=d.find((t=>t.id===e));if("personal"===s){if("function"!==typeof E){console.error("deleteChat is not a function in this component",{deleteChat:E,typeof:typeof E});try{const e=await Promise.resolve().then(n.bind(n,6431)).then((e=>e.default)),r=(null===t||void 0===t?void 0:t.chatId)||(null===o||void 0===o?void 0:o.chatId);if(!r)throw new Error("No chat ID found for deletion");return console.log("Calling MessageService.deleteChat directly for chat ID:",r),await e.deleteChat(r,u.uid),void console.log("Successfully deleted chat using direct MessageService call")}catch(i){return console.error("Error importing or using MessageService directly:",i),void alert("Unable to delete message at this time. This feature is still being implemented for direct chats.")}}try{const e=(null===t||void 0===t?void 0:t.chatId)||(null===o||void 0===o?void 0:o.chatId);if(!e)throw new Error("No chat ID found for deletion");console.log("Deleting chat with ID:",e),await E(e,u.uid),console.log("Successfully deleted chat")}catch(a){throw console.error("Error deleting chat:",a),a}return}null!==o&&void 0!==o&&null!==(r=o.fileAttachment)&&void 0!==r&&r.path?await C(e,u.uid,o.fileAttachment.path):await j(e,u.uid)}}catch(f){console.error("Error deleting message:",f),alert("There was an error deleting this message. Please try again later.")}}),[d,j,C,E,null===u||void 0===u?void 0:u.uid,s,t]),oe=(0,r.useCallback)((async(e,t)=>{if(null!==u&&void 0!==u&&u.uid)try{await A(e,t,u.uid)}catch(f){console.error("Error editing message:",f)}}),[A,null===u||void 0===u?void 0:u.uid]),le=(0,r.useCallback)((async()=>{if(null===u||void 0===u||!u.uid||!Y)return;let e;switch(F){case"broadcast":e="broadcast";break;case"discussion":e="discussion";break;case"private":e="private";break;default:e=F}try{await Xc.default.markTabNotificationsAsRead(u.uid,s,Y,e),Z.current=!0}catch(f){console.error("Error marking notifications as read:",f)}}),[null===u||void 0===u?void 0:u.uid,Y,F,s]),ce=()=>{"function"===typeof a&&(X.current.forEach((e=>{if("function"===typeof e)try{e()}catch(Jh){console.error("Error during unsubscribe on close:",Jh)}})),X.current=[],a())},ue=r.useMemo((()=>"personal"===s?d:d.filter((e=>{switch(F){case"broadcast":return e.type==="".concat(s,"_broadcast");case"discussion":return e.type==="".concat(s,"_discussion");case"private":return e.type==="".concat(s,"_private")&&(Q&&O?e.senderId===(null===u||void 0===u?void 0:u.uid)&&e.recipientId===O.uid||e.senderId===O.uid&&e.recipientId===(null===u||void 0===u?void 0:u.uid):!Q&&(e.senderId===(null===u||void 0===u?void 0:u.uid)&&e.recipientId===t.instructorId||e.senderId===t.instructorId&&e.recipientId===(null===u||void 0===u?void 0:u.uid)));default:return!1}}))),[d,F,s,Q,O,null===u||void 0===u?void 0:u.uid,null===t||void 0===t?void 0:t.instructorId]);return S?(0,Et.jsxs)("div",{className:"flex flex-col h-full",children:["personal"!==s&&(0,Et.jsxs)("div",{className:"flex px-6 border-b",children:[(Q||"broadcast"===F)&&(0,Et.jsxs)("button",{onClick:()=>_("broadcast"),className:"px-5 py-3 flex items-center gap-2 border-b-2 transition-colors\n                  ".concat("broadcast"===F?"border-[#4460F1] text-[#4460F1]":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,Et.jsx)(Si,{size:18}),(0,Et.jsx)("span",{children:"Broadcasts"})]}),(0,Et.jsxs)("button",{onClick:()=>_("discussion"),className:"px-5 py-3 ml-6 flex items-center gap-2 border-b-2 transition-colors\n                ".concat("discussion"===F?"border-[#4460F1] text-[#4460F1]":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,Et.jsx)(Fi,{size:18}),(0,Et.jsx)("span",{children:"course"===s?"Class Discussion":"Trip Discussion"})]}),(0,Et.jsxs)("button",{onClick:()=>_("private"),className:"px-5 py-3 ml-6 flex items-center gap-2 border-b-2 transition-colors\n                ".concat("private"===F?"border-[#4460F1] text-[#4460F1]":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,Et.jsx)(_i,{size:18}),(0,Et.jsx)("span",{children:Q?"Direct Messages":"Message ".concat("course"===s?"Instructor":"Trip Leader")})]})]}),f&&(0,Et.jsx)(Vc,{error:f,className:"mx-4 mt-4",onRetry:()=>{if(Y&&null!==u&&void 0!==u&&u.uid){const e="course"===s?"courseId":"trip"===s?"tripId":"chatId",t={type:s,[e]:Y,messageType:"".concat(s,"broadcast"===F?"_broadcast":"_discussion")};v(t)}}}),(0,Et.jsx)("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:g?(0,Et.jsx)(Yc,{currentUserId:null===u||void 0===u?void 0:u.uid,onDeleteMessage:ae,onEditMessage:oe,isInstructor:Q,isEmbedded:!0}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,Et.jsx)(Ac,{messages:ue,currentUserId:null===u||void 0===u?void 0:u.uid,onDeleteMessage:ae,onEditMessage:oe,onReactionSelect:re,loading:h,loadingMore:m,error:f,showBroadcastIndicator:!1,isInstructor:Q,hasMore:p,onLoadMore:se,touchedMessageId:H,setTouchedMessageId:W,isSmallScreen:G,isEmbedded:!0}),b&&b.length>0&&(0,Et.jsx)(Jc,{typingUsers:b,userProfiles:z,currentUserId:null===u||void 0===u?void 0:u.uid})]}),(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)(Pi,{onSend:(e,t)=>ie(e,t),placeholder:"Type a message...",isSending:T,sendError:R,typingParams:{type:s,["course"===s?"courseId":"trip"===s?"tripId":"chatId"]:Y,messageType:"personal"===s?"chat":"".concat(s,"_discussion")},onTypingStatus:y,hasLargerSendButton:G})})]})})]}):i?!q&&$.current?(0,Et.jsxs)("div",{className:"fixed inset-0 z-50 bg-gray-100",children:[(0,Et.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:ce}),(0,Et.jsx)("div",{className:"relative flex items-center justify-center min-h-screen p-4",children:(0,Et.jsxs)(Rc,{className:"w-full max-w-4xl h-[36rem] flex flex-col overflow-hidden bg-white shadow-lg",children:[(0,Et.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,Et.jsxs)("h2",{className:"text-xl text-gray-800",children:[null===t||void 0===t?void 0:t.name," - Loading..."]}),(0,Et.jsx)("button",{onClick:ce,className:"p-2 hover:bg-gray-100 rounded-full transition-colors touch-target","aria-label":"Close dialog",children:(0,Et.jsx)(cn,{className:"h-5 w-5 text-gray-500"})})]}),(0,Et.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"Loading messages..."})})]})})]}):(0,Et.jsxs)("div",{className:"fixed inset-0 z-50 bg-gray-100",ref:te,children:[(0,Et.jsx)("div",{className:"absolute inset-0 bg-black/30",onClick:ce}),(0,Et.jsx)("div",{className:"relative flex items-center justify-center min-h-screen p-4",children:(0,Et.jsxs)(Rc,{className:"w-full max-w-4xl h-[36rem] flex flex-col overflow-hidden bg-white shadow-lg",children:[(0,Et.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,Et.jsxs)("h2",{className:"text-xl text-gray-800",children:["course"===s?null===t||void 0===t?void 0:t.name:null===t||void 0===t?void 0:t.location," -","course"===s?" Course":"trip"===s?" Trip":" Chat"," Communications"]}),(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("button",{onClick:le,className:"text-xs text-blue-600 hover:text-blue-800 mr-4",children:"Mark All as Read"}),(0,Et.jsx)("button",{onClick:ce,className:"p-2 hover:bg-gray-100 rounded-full transition-colors touch-target","aria-label":"Close dialog",children:(0,Et.jsx)(cn,{className:"h-5 w-5 text-gray-500"})})]})]}),f&&(0,Et.jsx)(Vc,{error:f,className:"mx-4 mt-4",onRetry:()=>{if(Y&&null!==u&&void 0!==u&&u.uid){const e="course"===s?"courseId":"trip"===s?"tripId":"chatId",t={type:s,[e]:Y,messageType:"".concat(s,"broadcast"===F?"_broadcast":"_discussion")};v(t)}}}),"personal"!==s&&(0,Et.jsxs)("div",{className:"flex px-6 border-b",children:[(Q||"broadcast"===F)&&(0,Et.jsxs)("button",{onClick:()=>_("broadcast"),className:"px-5 py-3 flex items-center gap-2 border-b-2 transition-colors\n                    ".concat("broadcast"===F?"border-[#4460F1] text-[#4460F1]":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,Et.jsx)(Si,{size:18}),(0,Et.jsx)("span",{children:"Broadcasts"})]}),(0,Et.jsxs)("button",{onClick:()=>_("discussion"),className:"px-5 py-3 ml-6 flex items-center gap-2 border-b-2 transition-colors\n                  ".concat("discussion"===F?"border-[#4460F1] text-[#4460F1]":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,Et.jsx)(Fi,{size:18}),(0,Et.jsx)("span",{children:"course"===s?"Class Discussion":"Trip Discussion"})]}),(0,Et.jsxs)("button",{onClick:()=>_("private"),className:"px-5 py-3 ml-6 flex items-center gap-2 border-b-2 transition-colors\n                  ".concat("private"===F?"border-[#4460F1] text-[#4460F1]":"border-transparent text-gray-500 hover:text-gray-700"),children:[(0,Et.jsx)(_i,{size:18}),(0,Et.jsx)("span",{children:Q?"Direct Messages":"Message ".concat("course"===s?"Instructor":"Trip Leader")})]})]}),"private"!==F&&"personal"!==s&&(0,Et.jsx)("div",{className:"px-6 py-3 border-b",children:(0,Et.jsx)(Qc,{params:{type:s,["course"===s?"courseId":"tripId"]:Y,messageType:"".concat(s,"broadcast"===F?"_broadcast":"_discussion")}})}),(0,Et.jsx)("div",{className:"flex-1 flex flex-col min-h-0",children:g?(0,Et.jsx)(Yc,{currentUserId:null===u||void 0===u?void 0:u.uid,onDeleteMessage:ae,onEditMessage:oe,isInstructor:Q,isEmbedded:!1}):"broadcast"===F?(0,Et.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,Et.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,Et.jsx)(Ac,{messages:ue.map((e=>(0,o.A)((0,o.A)({},e),{},{isBroadcast:!0}))),currentUserId:null===u||void 0===u?void 0:u.uid,onDeleteMessage:ae,onEditMessage:oe,onReactionSelect:re,loading:h,loadingMore:m,error:f,showBroadcastIndicator:!0,isInstructor:Q,hasMore:p,onLoadMore:se,touchedMessageId:H,setTouchedMessageId:W,isSmallScreen:G,isEmbedded:!1})}),Q&&(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)(Pi,{onSend:(e,t)=>ie(e,t,"broadcast"),placeholder:"Send a broadcast message to all ".concat("course"===s?"students":"participants","..."),isSending:T,sendError:R,typingParams:{type:s,["course"===s?"courseId":"tripId"]:Y,messageType:"".concat(s,"_broadcast")},onTypingStatus:y,hasLargerSendButton:G})})]}):"discussion"===F||"personal"===s?(0,Et.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,Et.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,Et.jsx)(Ac,{messages:ue,currentUserId:null===u||void 0===u?void 0:u.uid,onDeleteMessage:ae,onEditMessage:oe,onReactionSelect:re,loading:h,loadingMore:m,error:f,showBroadcastIndicator:!1,isInstructor:Q,hasMore:p,onLoadMore:se,touchedMessageId:H,setTouchedMessageId:W,isSmallScreen:G,isEmbedded:!1}),b&&b.length>0&&(0,Et.jsx)(Jc,{typingUsers:b,userProfiles:z,currentUserId:null===u||void 0===u?void 0:u.uid})]}),(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)(Pi,{onSend:(e,t)=>ie(e,t,"discussion"),placeholder:Q?"Start a discussion...":"Type a message...",isSending:T,sendError:R,typingParams:{type:s,["course"===s?"courseId":"trip"===s?"tripId":"chatId"]:Y,messageType:"personal"===s?"chat":"".concat(s,"_discussion")},onTypingStatus:y,hasLargerSendButton:G})})]}):(0,Et.jsx)("div",{className:"flex-1 flex overflow-hidden",children:Q?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"w-80 flex-shrink-0 border-r flex flex-col",children:[(0,Et.jsx)("div",{className:"p-4",children:(0,Et.jsx)("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-md",children:(0,Et.jsx)("input",{type:"text",value:L,onChange:e=>B(e.target.value),placeholder:"Search ".concat("course"===s?"students":"participants","..."),className:"flex-1 bg-transparent border-none outline-none text-sm text-gray-600 placeholder-gray-400"})})}),(0,Et.jsx)("div",{className:"flex-1 overflow-y-auto",children:ne.map((e=>{var t;return(0,Et.jsx)("button",{onClick:()=>M(e),className:"w-full text-left px-4 py-2 hover:bg-gray-50 transition-colors\n                              ".concat((null===O||void 0===O?void 0:O.uid)===e.uid?"bg-[#4460F1]/5 hover:bg-[#4460F1]/5":""),children:(0,Et.jsxs)("div",{className:"flex items-center gap-3",children:[(0,Et.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:(0,Et.jsx)("span",{className:"text-sm text-gray-600",children:(null===(t=e.displayName)||void 0===t?void 0:t.split(" ").map((e=>e[0])).join("").toUpperCase().slice(0,2))||"??"})}),(0,Et.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,Et.jsx)("div",{className:"text-sm text-gray-800 truncate",children:e.displayName}),(0,Et.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.email})]})]})},e.uid)}))})]}),(0,Et.jsx)("div",{className:"flex-1 flex flex-col min-w-0 bg-white",children:O?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,Et.jsx)(Ac,{messages:ue,currentUserId:null===u||void 0===u?void 0:u.uid,onDeleteMessage:ae,onEditMessage:oe,onReactionSelect:re,loading:h,loadingMore:m,error:f,showBroadcastIndicator:!1,isInstructor:Q,hasMore:p,onLoadMore:se,touchedMessageId:H,setTouchedMessageId:W,isSmallScreen:G,isEmbedded:!1}),b&&b.length>0&&(0,Et.jsx)(Jc,{typingUsers:b,userProfiles:z,currentUserId:null===u||void 0===u?void 0:u.uid})]}),(0,Et.jsx)("div",{className:"flex-shrink-0",children:(0,Et.jsx)(Pi,{onSend:(e,t)=>ie(e,t,"private",O.uid),placeholder:"Message ".concat(O.displayName,"..."),isSending:T,sendError:R,typingParams:{type:s,["course"===s?"courseId":"tripId"]:Y,messageType:"".concat(s,"_private"),recipientId:O.uid},onTypingStatus:y,hasLargerSendButton:G})})]}):(0,Et.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,Et.jsxs)("div",{className:"text-center",children:[(0,Et.jsx)("div",{className:"text-3xl mb-3",children:"\ud83d\udc4b"}),(0,Et.jsxs)("p",{children:["Select a ","course"===s?"student":"participant"," to start messaging"]})]})})})]}):(0,Et.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,Et.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,Et.jsx)(Ac,{messages:ue,currentUserId:null===u||void 0===u?void 0:u.uid,onDeleteMessage:ae,onEditMessage:oe,onReactionSelect:re,loading:h,loadingMore:m,error:f,showBroadcastIndicator:!1,isInstructor:Q,hasMore:p,onLoadMore:se,touchedMessageId:H,setTouchedMessageId:W,isSmallScreen:G,isEmbedded:!1}),b&&b.length>0&&(0,Et.jsx)(Jc,{typingUsers:b,userProfiles:z,currentUserId:null===u||void 0===u?void 0:u.uid})]}),(0,Et.jsx)(Pi,{onSend:(e,n)=>ie(e,n,"private",t.instructorId),placeholder:"Message ".concat("course"===s?"instructor":"trip leader","..."),isSending:T,sendError:R,typingParams:{type:s,["course"===s?"courseId":"tripId"]:Y,messageType:"".concat(s,"_private"),recipientId:t.instructorId},onTypingStatus:y,hasLargerSendButton:G})]})})})]})})]}):null},Zc=e=>{let{course:t,isOpen:n,onClose:r,isTripMessaging:s=!1,defaultView:i="discussion",messageRecipient:a=null}=e;return(0,Et.jsx)($c,{context:t,contextType:"course",isOpen:n,onClose:r,defaultTab:i,recipient:a})},eu=Mt("Bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),tu=e=>{let{count:t,showIcon:n=!1,size:r="md",className:s="",onClick:i=null,isSmallScreen:a=!1}=e;if(!t||t<=0)return null;let o="",l=t>9?"9+":t;switch(a&&"sm"===r&&(r="md"),r){case"sm":o="w-4 h-4 text-[10px]",l=t>9?"9+":t;break;case"md":o="w-5 h-5 text-xs",l=t>99?"99+":t;break;case"lg":o="w-6 h-6 text-sm",l=t>999?"999+":t;break;default:o="w-5 h-5 text-xs"}const c=()=>(0,Et.jsx)("span",{className:"bg-red-500 text-white rounded-full flex items-center justify-center ".concat(o," ").concat(s," ").concat(a&&i?"touch-target":""," ").concat(i?"no-tap-highlight":""),onClick:i,role:i?"button":void 0,"aria-label":i?"".concat(t," notifications"):void 0,children:l});return n?(0,Et.jsxs)("div",{className:"relative inline-flex ".concat(i?"no-tap-highlight":""),children:[(0,Et.jsx)(eu,{size:"sm"===r?16:"lg"===r?24:20,className:a&&i?"p-1":""}),(0,Et.jsx)("span",{className:"absolute -top-1 -right-1",children:(0,Et.jsx)(c,{})})]}):(0,Et.jsx)(c,{})},nu=()=>{const{user:e}=kt(),[t,n]=(0,r.useState)(!0),[s,i]=(0,r.useState)(""),[a,l]=(0,r.useState)([]),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(null),[m,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)(""),[,v]=(0,r.useState)({});(0,r.useEffect)((()=>{if(!e||!a.length)return;const t=a.map((t=>Xc.default.subscribeToItemNotifications(e.uid,"course",t.courseId,(e=>{v((n=>(0,o.A)((0,o.A)({},n),{},{[t.courseId]:e.totalCount})))}))));return()=>{t.forEach((e=>e&&e()))}}),[e,a]);const x=(0,r.useCallback)((async t=>{if(console.log("Starting cleanup of training data:",t),!t||0===t.length)return console.log("No training data to clean up"),[];const n=[...t],r=[];for(const e of t)try{console.log("Checking course:",{courseId:e.courseId,courseName:e.courseName,status:e.status});const t=(0,Dt.H9)(wt.db,"courses",e.courseId),n=await(0,Dt.x7)(t);if(n.exists()){var s;const t=n.data();console.log("Course exists:",{courseId:e.courseId,status:t.status,students:(null===(s=t.students)||void 0===s?void 0:s.length)||0})}else console.log("Course does not exist:",e.courseId),r.push(e.courseId)}catch(gb){console.log("Error checking course:",{courseId:e.courseId,error:gb.message}),"permission-denied"!==gb.code&&r.push(e.courseId)}if(r.length>0){const t=n.filter((e=>!r.includes(e.courseId)));try{console.log("Removing invalid courses:",{removing:r,remaining:t.length});const n=(0,Dt.H9)(wt.db,"profiles",e.uid);return await(0,Dt.mZ)(n,{training:t}),t}catch(gb){return console.error("Error updating profile:",gb),n}}return n}),[null===e||void 0===e?void 0:e.uid]),y=async t=>{if(c===t)u(null),h(null);else{u(t);try{await b(t),await(async t=>{if(!t)return console.log("No courseId provided"),g("Invalid course ID"),void f(!1);try{console.log("Starting course fetch:",{courseId:t,userId:null===e||void 0===e?void 0:e.uid}),f(!0),g("");const d=(0,Dt.H9)(wt.db,"courses",t),m=await(0,Dt.x7)(d);if(m.exists()){var n,r,s,i,a;const l=m.data();console.log("FULL COURSE DATA:",JSON.stringify(l,null,2)),console.log("Access Check Details:",{courseId:t,userId:e.uid,isUserInStudents:null===(n=l.students)||void 0===n?void 0:n.map((e=>e.uid)),studentCount:null===(r=l.students)||void 0===r?void 0:r.length,firstStudent:null===(s=l.students)||void 0===s?void 0:s[0]});const u=null===(i=l.students)||void 0===i?void 0:i.some((t=>t.uid===e.uid)),d=null===(a=l.assistants)||void 0===a?void 0:a.some((t=>t.uid===e.uid)),f=l.instructorId===e.uid;if(console.log("Access check:",{isStudent:u,isAssistant:d,isInstructor:f,userId:e.uid}),u||d||f){var c;const n=u?null===(c=l.studentRecords)||void 0===c?void 0:c[e.uid]:null;let r=l.instructor||{};if(l.instructorId)try{const e=(0,Dt.H9)(wt.db,"profiles",l.instructorId),t=await(0,Dt.x7)(e);if(t.exists()){const e=t.data();r=(0,o.A)((0,o.A)((0,o.A)({},l.instructor),e),{},{uid:l.instructorId,name:e.name||l.instructor.displayName,displayName:e.name||l.instructor.displayName,instructorCertifications:e.instructorCertifications||[]})}}catch(gb){console.warn("Failed to fetch instructor profile:",gb)}const s=await Promise.all((l.students||[]).map((async e=>{const t=(0,Dt.H9)(wt.db,"profiles",e.uid),n=await(0,Dt.x7)(t),r=n.exists()?n.data():{};return(0,o.A)((0,o.A)({},e),{},{hideEmail:r.hideEmail||!1,hidePhone:r.hidePhone||!1})}))),i=await Promise.all((l.assistants||[]).map((async e=>{const t=(0,Dt.H9)(wt.db,"profiles",e.uid),n=await(0,Dt.x7)(t),r=n.exists()?n.data():{};return(0,o.A)((0,o.A)({},e),{},{hideEmail:r.hideEmail||!1,hidePhone:r.hidePhone||!1})}))),a=(0,o.A)((0,o.A)({},l),{},{id:t,instructor:r,students:s,assistants:i,studentRecords:l.studentRecords||{},trainingRecord:l.trainingRecord});console.log("Course data prepared:",{hasTrainingRecord:!!a.trainingRecord,hasStudentRecords:!!a.studentRecords,studentRecordExists:!!n}),h(a),g("")}else g("You do not have access to this course.")}else try{const n=(0,Dt.H9)(wt.db,"profiles",e.uid),r=await(0,Dt.x7)(n);if(r.exists()){var u;const e=(null===(u=r.data().training)||void 0===u?void 0:u.filter((e=>e.courseId!==t)))||[];await(0,Dt.mZ)(n,{training:e}),l(e)}g("This course has been deleted and removed from your training history.")}catch(gb){console.error("Error cleaning up deleted course:",gb),g("This course no longer exists.")}}catch(gb){console.error("Error fetching course details:",gb),"permission-denied"===gb.code?g("You do not have permission to view this course."):g("Failed to load course details. Please try again.")}finally{f(!1)}})(t)}catch(s){console.error("Toggle details error:",s)}}};(0,r.useEffect)((()=>{(async()=>{if(null!==e&&void 0!==e&&e.uid){console.log("Fetching training for user:",e.uid);try{const t=(0,Dt.H9)(wt.db,"profiles",e.uid),n=await(0,Dt.x7)(t);if(console.log("User profile exists:",n.exists()),n.exists()){const e=n.data();console.log("Full user profile data:",e),console.log("Training data from profile:",e.training);const t=e.training||[],r=await x(t);l(r)}else console.log("No user profile document found")}catch(gb){console.error("Error fetching training:",gb),i("Error loading training data")}finally{n(!1)}}})()}),[e,x]);const b=async t=>{try{var n,r,i,a;console.log("=== DEBUG START ==="),console.log("Debugging course access for:",t),console.log("Current user:",{uid:null===e||void 0===e?void 0:e.uid,email:null===e||void 0===e?void 0:e.email});const s=(0,Dt.H9)(wt.db,"profiles",e.uid),o=await(0,Dt.x7)(s);console.log("User profile:",{exists:o.exists(),data:o.exists()?o.data():null}),console.log("Training array from profile:",o.exists()?o.data().training:null);const l=(0,Dt.H9)(wt.db,"courses",t),c=await(0,Dt.x7)(l);if(!c.exists())return void console.log("Course does not exist");const u=c.data();console.log("Course data:",{id:t,instructorId:u.instructorId,studentsLength:(null===(n=u.students)||void 0===n?void 0:n.length)||0,assistantsLength:(null===(r=u.assistants)||void 0===r?void 0:r.length)||0,hasStudents:!!u.students,hasAssistants:!!u.assistants}),u.students&&console.log("Student check:",{userUid:e.uid,studentCount:u.students.length,studentUids:u.students.map((e=>e.uid)),isStudentFound:u.students.some((t=>t.uid===e.uid)),firstStudent:u.students[0]}),u.assistants&&console.log("Assistant check:",{userUid:e.uid,assistantCount:u.assistants.length,assistantUids:u.assistants.map((e=>e.uid)),isAssistantFound:u.assistants.some((t=>t.uid===e.uid))}),console.log("Access summary:",{isInstructor:u.instructorId===e.uid,isStudent:(null===(i=u.students)||void 0===i?void 0:i.some((t=>t.uid===e.uid)))||!1,isAssistant:(null===(a=u.assistants)||void 0===a?void 0:a.some((t=>t.uid===e.uid)))||!1}),console.log("=== DEBUG END ===")}catch(s){console.error("Debug error:",{code:s.code,message:s.message,fullError:s,errorStack:s.stack})}},w=e=>{var t,n,s,i,a,o,l,c;let{training:u,isExpanded:d,onToggle:h,details:m,isLoading:f,error:p}=e;const[g,v]=(0,r.useState)(!1),[x,y]=(0,r.useState)("discussion"),[b,w]=(0,r.useState)({broadcasts:0,discussion:0,direct:0}),[D,N]=(0,r.useState)({}),{user:j}=kt();(0,r.useEffect)((()=>{(async()=>{if(m&&j)try{const e=(0,Dt.H9)(wt.db,"profiles",j.uid),t=await(0,Dt.x7)(e),n=t.exists()&&t.data().buddyList||{};N(n)}catch(gb){console.error("Error fetching buddy statuses:",gb)}})()}),[m,j]),(0,r.useEffect)((()=>{if(!u.courseId||!j)return;const e=Xc.default.subscribeToItemNotifications(j.uid,"course",u.courseId,(e=>{w({broadcasts:e.tabCounts.broadcast,discussion:e.tabCounts.discussion,direct:e.tabCounts.direct})}));return()=>e()}),[u.courseId,j]);const C=e=>{y(e),v(!0)},E=async e=>{try{const t=(0,Dt.H9)(wt.db,"profiles",j.uid),n=await(0,Dt.x7)(t);if((n.exists()&&n.data().buddyList||{})[e.uid])return void console.log("Buddy request already exists");await(0,Dt.mZ)(t,{["buddyList.".concat(e.uid)]:{status:"pending",timestamp:(0,Dt.O5)(),initiator:!0}});const r=(0,Dt.H9)(wt.db,"profiles",e.uid);await(0,Dt.mZ)(r,{["buddyList.".concat(j.uid)]:{status:"pending",timestamp:(0,Dt.O5)(),initiator:!1}}),await Xc.default.createBuddyRequestNotification({fromUser:j.uid,fromUserName:j.displayName,toUser:e.uid,requestId:Date.now().toString()})}catch(gb){console.error("Error sending buddy request:",gb)}};return(0,Et.jsxs)("div",{className:"bg-white border rounded-lg shadow-sm overflow-hidden",children:[(0,Et.jsxs)("div",{className:"p-4",children:[(0,Et.jsxs)("div",{className:"mb-2",children:[(0,Et.jsx)("div",{className:"flex items-start gap-2",children:(0,Et.jsx)("h4",{className:"text-lg font-semibold",children:u.courseName})}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:[u.location," \u2022 ",new Date(u.startDate).toLocaleDateString()," - ",new Date(u.endDate).toLocaleDateString(),"completed"===u.status&&u.completedAt&&" \u2022 Completed ".concat(new Date(u.completedAt).toLocaleDateString())]})]}),(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsx)("button",{onClick:h,className:"text-sm text-gray-600 hover:text-blue-600 flex items-center gap-1",children:d?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Hide Details"]}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})}),"View Details"]})}),(0,Et.jsxs)("button",{onClick:()=>v(!0),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-2 relative",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z",clipRule:"evenodd"})}),"Course Messages",(b.broadcasts>0||b.discussion>0||b.direct>0)&&(0,Et.jsx)("div",{className:"absolute -top-2 -right-2",children:(0,Et.jsx)(tu,{count:b.broadcasts+b.discussion+b.direct,size:"sm"})})]})]})]}),d&&(0,Et.jsx)("div",{className:"border-t bg-gray-50",children:f?(0,Et.jsx)("div",{className:"p-4 text-center text-gray-600",children:"Loading..."}):p?(0,Et.jsx)("div",{className:"p-4 text-center text-red-600",children:p}):m?(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"border-b",children:(0,Et.jsxs)("nav",{className:"flex",children:[(0,Et.jsx)("button",{onClick:()=>C("discussion"),className:"px-4 py-2 text-sm font-medium border-b-2 border-blue-500 text-blue-600",children:"Details"}),(null===m||void 0===m?void 0:m.trainingRecord)&&(0,Et.jsx)("button",{onClick:()=>C("training"),className:"px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300",children:"Training Record"})]})}),(0,Et.jsxs)("div",{className:"p-4 space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Instructor"}),m.instructor?(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Et.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:m.instructor.photoURL?(0,Et.jsx)("img",{src:m.instructor.photoURL,alt:m.instructor.displayName,className:"w-full h-full rounded-full"}):(0,Et.jsx)("span",{className:"text-gray-600",children:null===(t=m.instructor.displayName)||void 0===t?void 0:t.charAt(0)})}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"font-medium",children:m.instructor.displayName}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:m.instructor.email})]})]}),m.instructor.uid!==j.uid&&("accepted"===(null===(n=D[m.instructor.uid])||void 0===n?void 0:n.status)?(0,Et.jsx)("button",{onClick:()=>C("private"),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Message Instructor"}):"pending"===(null===(s=D[m.instructor.uid])||void 0===s?void 0:s.status)?(0,Et.jsx)("span",{className:"text-sm text-gray-500 italic",children:"Buddy Request Pending"}):(0,Et.jsx)("button",{onClick:()=>E(m.instructor),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Add Buddy"}))]}):(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Instructor information not available"})]}),(null===(i=m.assistants)||void 0===i?void 0:i.length)>0&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Course Assistants"}),(0,Et.jsx)("div",{className:"border rounded max-h-40 overflow-y-auto",children:m.assistants.map((e=>{var t,n,r;return(0,Et.jsxs)("div",{className:"p-2 hover:bg-gray-50 flex justify-between items-center border-b last:border-b-0",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Et.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.photoURL?(0,Et.jsx)("img",{src:e.photoURL,alt:e.displayName,className:"w-full h-full rounded-full"}):(0,Et.jsx)("span",{className:"text-gray-600",children:null===(t=e.displayName)||void 0===t?void 0:t.charAt(0)})}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:e.displayName}),!e.hideEmail&&e.email&&(0,Et.jsx)("div",{className:"text-sm text-gray-600",children:e.email}),!e.hidePhone&&e.phone&&(0,Et.jsxs)("div",{className:"text-sm text-gray-600",children:["Phone: ",e.phone]})]})]}),"accepted"===(null===(n=D[e.uid])||void 0===n?void 0:n.status)?(0,Et.jsx)("button",{onClick:()=>C("private"),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Message Buddy"}):"pending"===(null===(r=D[e.uid])||void 0===r?void 0:r.status)?(0,Et.jsx)("span",{className:"text-sm text-gray-500 italic",children:"Buddy Request Pending"}):(0,Et.jsx)("button",{onClick:()=>E(e),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Add Buddy"})]},e.uid)}))})]}),(null===(a=m.students)||void 0===a?void 0:a.length)>0&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Fellow Students"}),(0,Et.jsx)("div",{className:"border rounded max-h-60 overflow-y-auto",children:m.students.filter((e=>e.uid!==j.uid)).map((e=>{var t,n,r;return(0,Et.jsxs)("div",{className:"p-2 hover:bg-gray-50 flex justify-between items-start border-b last:border-b-0",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Et.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.photoURL?(0,Et.jsx)("img",{src:e.photoURL,alt:e.displayName,className:"w-full h-full rounded-full"}):(0,Et.jsx)("span",{className:"text-gray-600",children:null===(t=e.displayName)||void 0===t?void 0:t.charAt(0)})}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:e.displayName}),(0,Et.jsx)(gn,{certificationLevel:e.certificationLevel,specialties:e.specialties,numberOfDives:e.numberOfDives,size:"small",showSections:!1}),!e.hideEmail&&e.email&&(0,Et.jsx)("div",{className:"text-sm text-gray-600",children:e.email}),!e.hidePhone&&e.phone&&(0,Et.jsxs)("div",{className:"text-sm text-gray-600",children:["Phone: ",e.phone]})]})]}),"accepted"===(null===(n=D[e.uid])||void 0===n?void 0:n.status)?(0,Et.jsx)("button",{onClick:()=>C("private"),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Message Buddy"}):"pending"===(null===(r=D[e.uid])||void 0===r?void 0:r.status)?(0,Et.jsx)("span",{className:"text-sm text-gray-500 italic",children:"Buddy Request Pending"}):(0,Et.jsx)("button",{onClick:()=>E(e),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Add Buddy"})]},e.uid)}))})]})]})]}):(0,Et.jsx)("div",{className:"p-4 text-center text-gray-600",children:"No details available"})}),g&&(0,Et.jsx)(Zc,{course:{id:u.courseId,name:u.courseName,instructor:{id:null===m||void 0===m||null===(o=m.instructor)||void 0===o?void 0:o.uid,displayName:null===m||void 0===m||null===(l=m.instructor)||void 0===l?void 0:l.displayName,email:null===m||void 0===m||null===(c=m.instructor)||void 0===c?void 0:c.email},instructorId:null===m||void 0===m?void 0:m.instructorId,students:null===m||void 0===m?void 0:m.students,assistants:null===m||void 0===m?void 0:m.assistants},isOpen:g,onClose:()=>{v(!1),j&&u.courseId&&(Xc.default.markTabNotificationsAsRead(j.uid,"course",u.courseId,"broadcast"),Xc.default.markTabNotificationsAsRead(j.uid,"course",u.courseId,"discussion"),Xc.default.markTabNotificationsAsRead(j.uid,"course",u.courseId,"private"))},defaultView:x})]})};return t?(0,Et.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Et.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):s?(0,Et.jsx)("div",{className:"max-w-2xl mx-auto p-4",children:(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,Et.jsx)("p",{className:"text-red-600",children:s})})}):(0,Et.jsx)("div",{className:"max-w-6xl mx-auto p-4",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Et.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"My Training"}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Current Training"}),(0,Et.jsx)("div",{className:"space-y-4",children:0===a.filter((e=>"active"===e.status)).length?(0,Et.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-600",children:"No active training courses."})}):a.filter((e=>"active"===e.status)).map((e=>(0,Et.jsx)(w,{training:e,isExpanded:c===e.courseId,onToggle:()=>y(e.courseId),details:c===e.courseId?d:null,isLoading:m,error:p},e.courseId)))})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Completed Training"}),(0,Et.jsx)("div",{className:"space-y-4",children:0===a.filter((e=>"completed"===e.status)).length?(0,Et.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-600",children:"No completed training courses."})}):a.filter((e=>"completed"===e.status)).map((e=>(0,Et.jsx)(w,{training:e,isExpanded:c===e.courseId,onToggle:()=>y(e.courseId),details:c===e.courseId?d:null,isLoading:m,error:p},e.courseId)))})]})]})]})})},ru=e=>{let{children:t}=e;const{user:n}=kt(),s=de(),[i,a]=(0,r.useState)(!0),[o,l]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{(async()=>{if(n){try{var e;const t=(await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",n.uid))).data(),r=null===t||void 0===t||null===(e=t.instructorAccess)||void 0===e?void 0:e.hasAccess;l(r),r||(localStorage.setItem("instructorAccessError","The Instructor Portal is only available for Underwater World Instructors."),s("/"))}catch(t){console.error("Error checking instructor access:",t),l(!1),localStorage.setItem("instructorAccessError","Error checking instructor access. Please try again."),s("/")}a(!1)}else a(!1)})()}),[n,s]),i?(0,Et.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Et.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):n&&o?t:null},su=e=>{var t;let{user:n,instructorProfile:s}=e;const[i,a]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[u,d]=(0,r.useState)(""),[h,m]=(0,r.useState)(!1),[f,p]=(0,r.useState)(null),[g,v]=(0,r.useState)({isOpen:!1,participant:null}),[x,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1),[D,N]=(0,r.useState)(null),j=(0,r.useRef)([]),[C,E]=(0,r.useState)(""),[A,k]=(0,r.useState)([]),[S,F]=(0,r.useState)({isOpen:!1,participant:null}),[_,T]=(0,r.useState)({name:"",isDiver:!1,age:"",relationship:"",waiverSubmitted:!1}),[I,R]=(0,r.useState)({isOpen:!1,trip:null,recipient:null}),[P,O]=(0,r.useState)({location:"",resort:"",startDate:"",endDate:"",description:"",requirements:"",waiverLink:"https://app.waiverforever.com/pending/dC3UBXG7ZZ1684272159"}),[M,L]=(0,r.useState)({totalParticipants:0,totalDivers:0,totalNonDivers:0}),[B,z]=(0,r.useState)({}),U=e=>e?("string"!==typeof e&&(e=String(e)),e.match(/^\d{4}-\d{2}-\d{2}$/)?e:e.split("T")[0]):"",q=(0,r.useCallback)((async e=>{const t=new Date(e.endDate),n=new Date(t);n.setDate(n.getDate()+1);const r=(new Date).toLocaleString("en-US",{timeZone:"America/New_York"});if(new Date(r)>=n&&"upcoming"===e.status)try{var s,i;const t=(0,Dt.H9)(wt.db,"trips",e.id),r=n,a=null===(s=e.participants)||void 0===s?void 0:s.map((async t=>{const n=(0,Dt.H9)(wt.db,"profiles",t.uid),s=await(0,Dt.x7)(n);if(s.exists()){const t=s.data().trips.map((t=>t.tripId===e.id?(0,o.A)((0,o.A)({},t),{},{status:"completed",completedAt:r}):t));return(0,Dt.mZ)(n,{trips:t})}})),l=null===(i=e.participants)||void 0===i?void 0:i.map((t=>{var n;return(0,Dt.gS)((0,Dt.rJ)(wt.db,"notifications"),{type:"trip_completed",toUser:t.uid,fromUser:e.instructorId,fromUserName:(null===(n=e.instructor)||void 0===n?void 0:n.name)||"Unknown Instructor",tripName:e.location,timestamp:(0,Dt.O5)(),read:!1})}));return await Promise.all([(0,Dt.mZ)(t,{status:"completed",completedAt:r}),...a||[],...l||[]]),(0,o.A)((0,o.A)({},e),{},{status:"completed",completedAt:r})}catch(gb){return console.error("Error auto-completing trip:",gb),e}return e}),[]),V=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";if(null!==n&&void 0!==n&&n.uid&&e)try{"all"===t?(await Xc.default.markTabNotificationsAsRead(n.uid,"trip",e,"broadcast"),await Xc.default.markTabNotificationsAsRead(n.uid,"trip",e,"discussion"),await Xc.default.markTabNotificationsAsRead(n.uid,"trip",e,"direct")):await Xc.default.markTabNotificationsAsRead(n.uid,"trip",e,t)}catch(gb){console.error("Error clearing trip notifications:",gb)}};(0,r.useEffect)((()=>{(async()=>{if(null!==n&&void 0!==n&&n.uid)try{const e=(0,Dt.rJ)(wt.db,"trips"),t=(0,Dt.P)(e,(0,Dt._M)("instructorId","==",n.uid));let r=(await(0,Dt.GG)(t)).docs.map((e=>(0,o.A)({id:e.id},e.data())));const s=await Promise.all(r.map((e=>q(e))));a(s),s.forEach((e=>{H(e)}))}catch(gb){console.error("Error loading trips:",gb),d("Error loading trips")}finally{c(!1)}})();const e=setInterval((async()=>{if(j.current.length>0)try{const e=await Promise.all(j.current.map((e=>q(e))));a(e)}catch(u){console.error("Error updating trips in interval:",u)}}),36e5);return()=>clearInterval(e)}),[n,q]),(0,r.useEffect)((()=>{if(null===n||void 0===n||!n.uid||!i.length)return;const e={};return i.forEach((t=>{e[t.id]=Xc.default.subscribeToItemNotifications(n.uid,"trip",t.id,(e=>{z((n=>(0,o.A)((0,o.A)({},n),{},{[t.id]:e})))}))})),()=>{Object.values(e).forEach((e=>e()))}}),[n,i]),(0,r.useEffect)((()=>{j.current=i}),[i]);const H=e=>{var t;let n=0,r=0,s=0;null===(t=e.participants)||void 0===t||t.forEach((e=>{var t;s++,e.isDiver?n++:r++,null===(t=e.companions)||void 0===t||t.forEach((e=>{s++,e.isDiver?n++:r++}))})),L({totalParticipants:s,totalDivers:n,totalNonDivers:r})},W=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const r=(0,Dt.H9)(wt.db,"trips",D.id),s=D.participants.map((r=>{if(t&&r.uid===e){const e=r.companions.map((e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{isDiver:!e.isDiver}):e));return(0,o.A)((0,o.A)({},r),{},{companions:e})}return t||r.uid!==e?r:(0,o.A)((0,o.A)({},r),{},{isDiver:!r.isDiver})}));await(0,Dt.mZ)(r,{participants:s}),N((0,o.A)((0,o.A)({},D),{},{participants:s}))}catch(gb){console.error("Error toggling diver status:",gb),d("Failed to update diver status")}},G=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const r=(0,Dt.H9)(wt.db,"trips",D.id),s=D.participants.map((r=>{if(t&&r.uid===e){const e=r.companions.map((e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{waiverSubmitted:!e.waiverSubmitted}):e));return(0,o.A)((0,o.A)({},r),{},{companions:e})}return t||r.uid!==e?r:(0,o.A)((0,o.A)({},r),{},{waiverSubmitted:!r.waiverSubmitted})}));await(0,Dt.mZ)(r,{participants:s}),N((0,o.A)((0,o.A)({},D),{},{participants:s}))}catch(gb){console.error("Error toggling waiver status:",gb),d("Failed to update waiver status")}},K=e=>{N(e),w(!0),V(e.id,"all")};return l?(0,Et.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Et.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):u?(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,Et.jsx)("p",{className:"text-red-600",children:u})}):(0,Et.jsxs)("div",{className:"space-y-6",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Trips"}),(0,Et.jsxs)("button",{onClick:()=>y(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Create New Trip"]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upcoming Trips"}),(0,Et.jsx)("div",{className:"space-y-4",children:0===i.filter((e=>"upcoming"===e.status)).length?(0,Et.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-600",children:"No upcoming trips yet."})}):i.filter((e=>"upcoming"===e.status)).map((e=>{var t,n,r,s;return(0,Et.jsxs)("div",{className:"bg-white border rounded-lg shadow-sm p-4",children:[(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsxs)("h4",{className:"text-lg font-semibold",children:[e.location,(null===(t=B[e.id])||void 0===t?void 0:t.totalCount)>0&&(0,Et.jsx)("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:B[e.id].totalCount})]}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:[e.resort," \u2022 ",U(e.startDate)," - ",U(e.endDate),"                      "]}),(0,Et.jsxs)("div",{className:"mt-2 flex flex-wrap gap-3",children:[(0,Et.jsxs)("span",{className:"text-sm text-gray-600",children:["Total Participants: ",e.currentParticipants]}),(0,Et.jsxs)("span",{className:"text-sm text-blue-600",children:["Divers: ",null===(n=e.participants)||void 0===n?void 0:n.reduce(((e,t)=>{var n,r;return e+(t.isDiver?1:0)+((null===(n=t.companions)||void 0===n||null===(r=n.filter((e=>e.isDiver)))||void 0===r?void 0:r.length)||0)}),0)]}),(0,Et.jsxs)("span",{className:"text-sm text-green-600",children:["Non-Divers: ",null===(r=e.participants)||void 0===r?void 0:r.reduce(((e,t)=>{var n,r;return e+(t.isDiver?0:1)+((null===(n=t.companions)||void 0===n||null===(r=n.filter((e=>!e.isDiver)))||void 0===r?void 0:r.length)||0)}),0)]})]})]}),(0,Et.jsx)("div",{className:"flex justify-between items-center",children:(0,Et.jsxs)("div",{className:"flex gap-4",children:[(0,Et.jsx)("button",{onClick:()=>K(e),className:"text-sm text-gray-600 hover:text-blue-600",children:"Manage Trip"}),(0,Et.jsxs)("button",{onClick:()=>{R({isOpen:!0,trip:e,recipient:null}),V(e.id,"all")},className:"text-sm text-gray-600 hover:text-blue-600 relative",children:["Message Participants",(null===(s=B[e.id])||void 0===s?void 0:s.totalCount)>0&&(0,Et.jsxs)("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[(0,Et.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),(0,Et.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]})]})]})})]},e.id)}))})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Completed Trips"}),(0,Et.jsx)("div",{className:"space-y-4",children:0===i.filter((e=>"completed"===e.status)).length?(0,Et.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-600",children:"No completed trips yet."})}):i.filter((e=>"completed"===e.status)).map((e=>(0,Et.jsxs)("div",{className:"bg-gray-50 border rounded-lg p-4",children:[(0,Et.jsxs)("div",{className:"mb-2",children:[(0,Et.jsx)("h4",{className:"text-lg font-semibold",children:e.location}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:[e.resort," \u2022 Completed ",e.completedAt?U(e.completedAt):"Date not available"]}),(0,Et.jsx)("div",{className:"mt-2 flex flex-wrap gap-3",children:(0,Et.jsxs)("span",{className:"text-sm text-gray-600",children:["Final Participants: ",e.currentParticipants]})})]}),(0,Et.jsx)("div",{className:"flex gap-4",children:(0,Et.jsx)("button",{onClick:()=>K(e),className:"text-sm text-gray-600 hover:text-blue-600",children:"View Details"})})]},e.id)))})]})]}),x&&(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold",children:"Create New Trip"}),(0,Et.jsx)("button",{onClick:()=>y(!1),className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Location",className:"w-full p-2 border rounded",value:P.location,onChange:e=>O((0,o.A)((0,o.A)({},P),{},{location:e.target.value}))}),(0,Et.jsx)("input",{type:"text",placeholder:"Resort",className:"w-full p-2 border rounded",value:P.resort,onChange:e=>O((0,o.A)((0,o.A)({},P),{},{resort:e.target.value}))}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsx)("input",{type:"date",className:"p-2 border rounded",value:P.startDate,onChange:e=>O((0,o.A)((0,o.A)({},P),{},{startDate:e.target.value}))}),(0,Et.jsx)("input",{type:"date",className:"p-2 border rounded",value:P.endDate,onChange:e=>O((0,o.A)((0,o.A)({},P),{},{endDate:e.target.value}))})]}),(0,Et.jsx)("textarea",{placeholder:"Trip Description",className:"w-full p-2 border rounded",rows:"3",value:P.description,onChange:e=>O((0,o.A)((0,o.A)({},P),{},{description:e.target.value}))}),(0,Et.jsx)("textarea",{placeholder:"Requirements (e.g., certifications, equipment)",className:"w-full p-2 border rounded",rows:"3",value:P.requirements,onChange:e=>O((0,o.A)((0,o.A)({},P),{},{requirements:e.target.value}))}),(0,Et.jsx)("button",{onClick:async()=>{try{const e=(0,o.A)((0,o.A)({},P),{},{startDate:P.startDate,endDate:P.endDate,instructorId:n.uid,instructor:{uid:n.uid,email:s.email,displayName:s.name||"Unnamed Instructor",name:s.name||"Unnamed Instructor"},status:"upcoming",participants:[],createdAt:(new Date).toISOString().split("T")[0],currentParticipants:0}),t=await(0,Dt.gS)((0,Dt.rJ)(wt.db,"trips"),e),r=(0,o.A)({id:t.id},e);a((e=>[...e,r])),y(!1),O({location:"",resort:"",startDate:"",endDate:"",description:"",requirements:"",waiverLink:"https://app.waiverforever.com/pending/dC3UBXG7ZZ1684272159"})}catch(gb){console.error("Error creating trip:",gb),d(gb.message||"Failed to create trip")}},className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Create Trip"})]})]})}),h&&f&&(0,Et.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:["          ",(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold",children:"Edit Trip"}),(0,Et.jsx)("button",{onClick:()=>{m(!1),p(null)},className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Location",className:"w-full p-2 border rounded",value:f.location,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{location:e.target.value}))}),(0,Et.jsx)("input",{type:"text",placeholder:"Resort",className:"w-full p-2 border rounded",value:f.resort,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{resort:e.target.value}))}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsx)("input",{type:"date",className:"p-2 border rounded",value:f.startDate.split("T")[0],onChange:e=>p((0,o.A)((0,o.A)({},f),{},{startDate:e.target.value}))}),(0,Et.jsx)("input",{type:"date",className:"p-2 border rounded",value:f.endDate.split("T")[0],onChange:e=>p((0,o.A)((0,o.A)({},f),{},{endDate:e.target.value}))})]}),(0,Et.jsx)("textarea",{placeholder:"Trip Description",className:"w-full p-2 border rounded",rows:"3",value:f.description,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{description:e.target.value}))}),(0,Et.jsx)("textarea",{placeholder:"Requirements",className:"w-full p-2 border rounded",rows:"3",value:f.requirements,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{requirements:e.target.value}))}),(0,Et.jsx)("button",{onClick:async()=>{try{if(null===f||void 0===f||!f.id)throw new Error("No trip selected for editing");const e=(0,o.A)((0,o.A)({},f),{},{startDate:f.startDate.split("T")[0],endDate:f.endDate.split("T")[0]}),t=(0,Dt.H9)(wt.db,"trips",f.id);await(0,Dt.mZ)(t,e),a((t=>t.map((t=>t.id===f.id?e:t)))),m(!1),p(null)}catch(gb){console.error("Error updating trip:",gb),d(gb.message||"Failed to update trip")}},className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Update Trip"})]})]})]}),b&&D&&(0,Et.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[50]",children:["  ","          ",(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsxs)("h3",{className:"text-lg font-semibold",children:["Manage Trip: ",D.location]}),(0,Et.jsx)("button",{onClick:()=>{w(!1),N(null),k([]),E("")},className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"space-y-6",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Et.jsx)("h4",{className:"font-medium",children:"Trip Information"}),(0,Et.jsx)("button",{onClick:()=>{p(D),m(!0),w(!1)},className:"text-blue-600 hover:text-blue-700 text-sm",children:"Edit Trip"})]}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Location: ",D.location||"N/A",(0,Et.jsx)("br",{}),"Resort: ",D.resort||"N/A",(0,Et.jsx)("br",{}),"Start Date: ",U(D.startDate),(0,Et.jsx)("br",{}),"End Date: ",U(D.endDate),(0,Et.jsx)("br",{}),"Total Participants: ",D.currentParticipants||0,(0,Et.jsx)("br",{}),"Requirements: ",D.requirements||"None",(0,Et.jsx)("br",{}),"Description: ",D.description||"No description available"]})]}),(0,Et.jsxs)("div",{className:"border-t pt-4",children:[(0,Et.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,Et.jsx)("h4",{className:"text-md font-semibold",children:"Manage Participants"})}),(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Search participants by name or email",className:"w-full p-2 border rounded",value:C,onChange:e=>{E(e.target.value),(async e=>{if(e.trim())try{const t=(0,Dt.rJ)(wt.db,"profiles"),n=e.toLowerCase(),r=await(0,Dt.GG)(t),s=[];r.forEach((e=>{var t,r,i;const a=e.data();!(null===D||void 0===D||null===(t=D.participants)||void 0===t?void 0:t.some((t=>t.uid===e.id)))&&"instructor"!==a.role&&(null!==(r=a.email)&&void 0!==r&&r.toLowerCase().includes(n)||null!==(i=a.name)&&void 0!==i&&i.toLowerCase().includes(n))&&s.push({uid:e.id,email:a.email,phone:a.phone||"",displayName:a.name||"Unnamed User"})})),k(s)}catch(gb){console.error("Error searching for users:",gb),d("Failed to search for users")}else k([])})(e.target.value)}}),A.length>0&&(0,Et.jsx)("div",{className:"mt-2 border rounded max-h-40 overflow-y-auto",children:A.map((e=>(0,Et.jsxs)("div",{className:"p-2 hover:bg-gray-50 flex justify-between items-center border-b last:border-b-0",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:e.displayName}),(0,Et.jsx)("div",{className:"text-sm text-gray-600",children:e.email})]}),(0,Et.jsx)("button",{onClick:()=>(async e=>{try{const n=(0,Dt.H9)(wt.db,"profiles",e.uid),r=await(0,Dt.x7)(n),i=r.data(),a=(0,Dt.H9)(wt.db,"trips",D.id),l=(await(0,Dt.x7)(a)).data(),c={uid:e.uid,displayName:i.name||e.displayName||"Unnamed User",email:e.email,phone:i.phone||"",name:i.name||e.displayName||"Unnamed User",isDiver:!1,waiverSubmitted:!1,notes:"",companions:[]},u=(0,o.A)((0,o.A)({},l),{},{participants:[...l.participants||[],c],currentParticipants:(l.currentParticipants||0)+1});if(await(0,Dt.mZ)(a,u),r.exists()){var t;const r=i.trips||[];await(0,Dt.mZ)(n,{trips:[...r,{tripId:D.id,tripName:l.resort||l.name,status:"upcoming",startDate:l.startDate,endDate:l.endDate,location:l.location,instructorId:l.instructorId,instructorEmail:null===(t=l.instructor)||void 0===t?void 0:t.email}]}),await(0,Dt.gS)((0,Dt.rJ)(wt.db,"notifications"),{type:"trip_enrollment",toUser:e.uid,fromUser:s.uid,fromUserName:s.name||"Unknown Instructor",tripName:l.location,timestamp:(0,Dt.O5)(),read:!1})}N((0,o.A)((0,o.A)({},D),{},{participants:u.participants,currentParticipants:u.currentParticipants})),H(u),k([]),E("")}catch(gb){console.error("Error in addParticipantToTrip:",gb),d(gb.message||"Failed to add participant to trip")}})(e),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Add to Trip"})]},e.uid)))})]}),(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Participants"}),(0,Et.jsx)("div",{className:"border rounded max-h-[400px] overflow-y-auto",children:(null===(t=D.participants)||void 0===t?void 0:t.length)>0?D.participants.map((e=>{var t;return(0,Et.jsxs)("div",{className:"p-4 border-b last:border-b-0",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:e.displayName}),(0,Et.jsxs)("div",{className:"text-sm text-gray-600",children:[e.email,e.phone&&(0,Et.jsxs)("div",{children:["Phone: ",e.phone]})]}),e.notes&&(0,Et.jsx)("div",{className:"mt-1",children:(0,Et.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Has Notes"})})]}),(0,Et.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,Et.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Et.jsx)("label",{className:"text-sm text-gray-600",children:"Waiver"}),(0,Et.jsx)("input",{type:"checkbox",checked:e.waiverSubmitted,onChange:()=>G(e.uid),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"})]}),(0,Et.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Et.jsx)("label",{className:"text-sm text-gray-600",children:"Diver"}),(0,Et.jsx)("input",{type:"checkbox",checked:e.isDiver,onChange:()=>W(e.uid),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]}),(0,Et.jsx)("button",{onClick:()=>v({isOpen:!0,participant:e}),className:"text-blue-600 hover:text-blue-700 text-sm",children:e.notes?"Edit Notes":"Add Notes"}),(0,Et.jsx)("button",{onClick:()=>F({isOpen:!0,participant:e}),className:"text-blue-600 hover:text-blue-700 text-sm",children:"Add Companion"}),(0,Et.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to remove this participant and their companions from the trip?"))try{var t;const n=(0,Dt.H9)(wt.db,"trips",D.id),r=D.participants.filter((t=>t.uid!==e.uid)),l=(null===(t=e.companions)||void 0===t?void 0:t.length)||0,c=(0,o.A)((0,o.A)({},D),{},{participants:r,currentParticipants:D.currentParticipants-(1+l)});await(0,Dt.mZ)(n,{participants:r,currentParticipants:c.currentParticipants});const u=(0,Dt.H9)(wt.db,"profiles",e.uid),d=await(0,Dt.x7)(u);if(d.exists()){const t=(d.data().trips||[]).filter((e=>e.tripId!==D.id));await(0,Dt.mZ)(u,{trips:t}),await(0,Dt.gS)((0,Dt.rJ)(wt.db,"notifications"),{type:"trip_removal",toUser:e.uid,fromUser:s.uid,fromUserName:s.name||"Unknown Instructor",tripName:D.location,timestamp:(0,Dt.O5)(),read:!1})}a(i.map((e=>e.id===D.id?c:e))),N(c),H(c)}catch(gb){console.error("Error removing participant from trip:",gb),d("Failed to remove participant from trip")}})(e),className:"text-red-600 hover:text-red-700 text-sm",children:"Remove"})]})]}),(null===(t=e.companions)||void 0===t?void 0:t.length)>0&&(0,Et.jsxs)("div",{className:"ml-4 mt-2 space-y-2",children:[(0,Et.jsx)("div",{className:"text-sm font-medium text-gray-600",children:"Traveling With:"}),e.companions.map((t=>(0,Et.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,Et.jsx)("div",{children:(0,Et.jsxs)("div",{className:"text-sm",children:[(0,Et.jsx)("span",{className:"font-medium",children:t.name}),(0,Et.jsxs)("span",{className:"text-gray-600 ml-2",children:["\u2022 ",t.relationship]})]})}),(0,Et.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,Et.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Et.jsx)("label",{className:"text-sm text-gray-600",children:"Waiver"}),(0,Et.jsx)("input",{type:"checkbox",checked:t.waiverSubmitted,onChange:()=>G(e.uid,!0,t.id),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"})]}),(0,Et.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Et.jsx)("label",{className:"text-sm text-gray-600",children:"Diver"}),(0,Et.jsx)("input",{type:"checkbox",checked:t.isDiver,onChange:()=>W(e.uid,!0,t.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]}),(0,Et.jsx)("button",{onClick:()=>(async(e,t)=>{try{const n=(0,Dt.H9)(wt.db,"trips",D.id),r=(await(0,Dt.x7)(n)).data(),s=r.participants.map((n=>n.uid===e.uid?(0,o.A)((0,o.A)({},n),{},{companions:(n.companions||[]).filter((e=>e.id!==t))}):n)),i=(0,o.A)((0,o.A)({},r),{},{participants:s,currentParticipants:r.currentParticipants-1});await(0,Dt.mZ)(n,i),N((0,o.A)((0,o.A)({},D),{},{participants:s,currentParticipants:D.currentParticipants-1})),H(i)}catch(gb){console.error("Error removing companion:",gb),d("Failed to remove companion")}})(e,t.id),className:"text-red-600 hover:text-red-700 text-sm",children:"Remove"})]})]},t.id)))]})]},e.uid)})):(0,Et.jsx)("div",{className:"p-4 text-gray-600",children:"No participants added yet."})})]})]}),(0,Et.jsxs)("div",{className:"border-t pt-4 space-y-2",children:[(0,Et.jsx)("button",{onClick:()=>{R({isOpen:!0,trip:D,recipient:null}),w(!1)},className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Message All Participants"}),(0,Et.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this trip? This action cannot be undone."))try{const n=(0,Dt.H9)(wt.db,"trips",e),r=await(0,Dt.x7)(n);if(r.exists()){var t;const s=r.data(),o=[];(null===(t=s.participants)||void 0===t?void 0:t.length)>0&&s.participants.forEach((t=>{const n=(0,Dt.H9)(wt.db,"profiles",t.uid);o.push((0,Dt.x7)(n).then((t=>{if(t.exists()){const r=(t.data().trips||[]).filter((t=>t.tripId!==e));return(0,Dt.mZ)(n,{trips:r})}})))})),await Promise.all(o),await(0,Dt.kd)(n),a(i.filter((t=>t.id!==e))),w(!1),N(null)}}catch(gb){console.error("Error deleting trip:",gb),d("Failed to delete trip")}})(D.id),className:"w-full bg-red-600 text-white p-2 rounded hover:bg-red-700",children:"Delete Trip"})]})]})]})]}),g.isOpen&&g.participant&&(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold",children:"Participant Notes"}),(0,Et.jsx)("button",{onClick:()=>v({isOpen:!1,participant:null}),className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsx)("textarea",{placeholder:"Add private notes about this participant...",className:"w-full p-2 border rounded",rows:"6",value:g.participant.notes||"",onChange:e=>v((0,o.A)((0,o.A)({},g),{},{participant:(0,o.A)((0,o.A)({},g.participant),{},{notes:e.target.value})}))}),(0,Et.jsx)("button",{onClick:()=>(async(e,t)=>{try{const n=(0,Dt.H9)(wt.db,"trips",D.id),r=D.participants.map((n=>n.uid===e?(0,o.A)((0,o.A)({},n),{},{notes:t}):n));await(0,Dt.mZ)(n,{participants:r}),N((0,o.A)((0,o.A)({},D),{},{participants:r})),v({isOpen:!1,participant:null})}catch(gb){console.error("Error updating participant notes:",gb),d("Failed to update participant notes")}})(g.participant.uid,g.participant.notes),className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Save Notes"})]})]})}),S.isOpen&&(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold",children:"Add Travel Companion"}),(0,Et.jsx)("button",{onClick:()=>F({isOpen:!1,participant:null}),className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("input",{type:"text",placeholder:"Name *",className:"w-full p-2 border rounded",value:_.name,onChange:e=>T((0,o.A)((0,o.A)({},_),{},{name:e.target.value}))}),(0,Et.jsx)("span",{className:"text-xs text-gray-500",children:"Required"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("select",{className:"w-full p-2 border rounded",value:_.relationship,onChange:e=>T((0,o.A)((0,o.A)({},_),{},{relationship:e.target.value})),children:[(0,Et.jsx)("option",{value:"",children:"Select Relationship *"}),(0,Et.jsx)("option",{value:"Partner",children:"Partner"}),(0,Et.jsx)("option",{value:"Spouse",children:"Spouse"}),(0,Et.jsx)("option",{value:"Son/Daughter",children:"Son/Daughter"}),(0,Et.jsx)("option",{value:"Other",children:"Other"})]}),(0,Et.jsx)("span",{className:"text-xs text-gray-500",children:"Required"})]}),(0,Et.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Et.jsx)("label",{className:"text-sm text-gray-600",children:"Is this companion a diver?"}),(0,Et.jsx)("input",{type:"checkbox",checked:_.isDiver,onChange:e=>T((0,o.A)((0,o.A)({},_),{},{isDiver:e.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]}),(0,Et.jsx)("button",{onClick:()=>(async e=>{try{if(!_.name)throw new Error("Companion name is required");const t=(0,Dt.H9)(wt.db,"trips",D.id),n=(await(0,Dt.x7)(t)).data(),r=n.participants.map((t=>t.uid===e.uid?(0,o.A)((0,o.A)({},t),{},{companions:[...t.companions||[],(0,o.A)((0,o.A)({},_),{},{id:Date.now().toString(),isDiver:_.isDiver||!1,waiverSubmitted:!1})]}):t)),s=(0,o.A)((0,o.A)({},n),{},{participants:r,currentParticipants:n.currentParticipants+1});await(0,Dt.mZ)(t,s),N((0,o.A)((0,o.A)({},D),{},{participants:r,currentParticipants:D.currentParticipants+1})),H(s),T({name:"",isDiver:!1,age:"",relationship:""}),F({isOpen:!1,participant:null})}catch(gb){console.error("Error adding companion:",gb),d(gb.message||"Failed to add companion")}})(S.participant),className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Add Companion"})]})]})}),I.isOpen&&I.trip&&(0,Et.jsx)($c,{context:I.trip,contextType:"trip",isOpen:I.isOpen,onClose:()=>{R({isOpen:!1,trip:null,recipient:null})},recipient:I.recipient,defaultTab:I.recipient?"private":"discussion"})]})},iu=[{id:"certification-dive",name:"Certification Dive Addendum",description:"Basic certification dive requirements and verification",sections:[{title:"Pre-Dive Verification",skills:["Confined Water Training Passed, Verification","Written Test Passed, Verification","Medical Waiver Checked","Liability Waiver w/ Certifying Instructor Listed"]},{title:"Open Water Dives",diveFormat:!0,dives:[{title:"Open Water Dive #1",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Open Water Dive #2",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Open Water Dive #3",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Open Water Dive #4",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]}],skills:["Open Water Dive #1","Open Water Dive #2","Open Water Dive #3","Open Water Dive #4"]}],notes:{title:"Instructor Notes and Observations",type:"textarea"}},{id:"naui-scuba",name:"Open Water SCUBA Diver, NAUI",description:"NAUI SCUBA certification requirements",sections:[{title:"Academics",skills:["Applied Sciences","Diving Equipment","Diving Safety","Diving Environment","Diving Activities","Continuing Education","eLearning","Final Written Exam"]},{title:"Swimming Skills",skills:["15 Cont. Stroke Cycles","10min Survival Swim","50ft U/W, 1 Breath"]},{title:"Skin Diving Skills",subheader:"Using Proper Skin Diving Techniques",skills:["450yds, Nonstop w/ Mask, Fins, Snorkel","Recover Diver from 10ft","Water Entries & Exits","Surface Dives","Clearing the Snorkel","Ditching the Weights","Buoyancy Control","U/W Swim & Surface"]},{title:"SCUBA Diving Skills",subsections:[{title:"Pre-Post Dive Skills",skills:["Select, check assemble and don equipment","Pre-dive gear check for self and buddy","Defog mask","Doff, rinse and care for equipment"]},{title:"Surface Skills",skills:["Perform surface buoyancy check","Surface Communication","Orally Inflate/Deflate BCD","Remove/Replace Equipment","Face Submerged, Breath Through Snorkel, Rest/Swim","Face Submerged, Breath Through Water in Snorkel","Regulator/Snorkel Exchange while Swimming","Release Simulated Cramp for Self and Buddy","Deploy/Retrieve an SMB","Remove/Replace SCUBA Unit on Surface","Demonstrate Proper Use of Selected Weight System"]},{title:"Ascent/Descent Skills",skills:["Control Pressure in Air Spaces","Controlled Feet First Descent w/ Breath and BCD","Controlled Ascent w/ Safety Stop"]},{title:"Planning Skills",skills:["SAC Rate Calculation","Plan & Make a No Deco Dive Between 40-60ft","Calc. a No Deco Repetitive Dive w/ Tables or Computer"]},{title:"Environmental Skills",skills:["Diving w/ Min Impact on Environ.","Marine Life Identification"]},{title:"Underwater Skills",skills:["Give, Recognize and Respond to U/W Signals","Mask Clearing Including Removal and Replacement","Breath from SCUBA U/W w/o Mask","Demonstrate Comfort U/W w/o Mask","Remove, Replace & Clear Regulator","Primary Regulator Recovery","Proper Power Inflator Usage","Environmentally Appropriate Buoyancy Control","Hover w/o Support","U/W Swimming w/ Proper Position and Trim","Environmentally Appropriate Propulsion Techniques","Remove/Replace SCUBA Unit","Ballast Remove/Replace/Adjust","Use of Buddy System","Monitor Instruments and Communicate Effectively","Environmental Compass Nav","Compass Nav/Bearing/Reciprocal"]},{title:"Emergency Skills",skills:["Problem Solving Underwater","Transport Simulated Exhausted Buddy 50yards","Share Air as Donor/Receiver while Stationary","Perform Controlled Emergency Swimming Ascent","Share Air as Donor/Receiver while Ascending","Retrieve Unconscious Diver from 10ft"]}]}],notes:{title:"Instructor Notes and Observations",type:"textarea"}},{id:"sdi-scuba",name:"Open Water SCUBA Diver, SDI",description:"SDI SCUBA certification requirements",sections:[{title:"Academics",skills:["Aquatic Environment","Marine Life Injuries","Physics & Physiology","SCUBA Equipment","Dive Planning","Underwater Navigation","eLearning","Final Written Exam"]},{title:"Swimming Evaluation",skills:["Distance Swim, 300m Nonstop, w/ Mask Fins and Snorkel","10min Survival Swim"]},{title:"SCUBA Skills",subsections:[{title:"Pre-Dive Skills",skills:["SCUBA System Assembly/Disassembly","Pre-Dive Check Self/Buddy","Weight System Adjustment w/ Proper Weighting"]},{title:"In-Water Skills",skills:["Removal/Replacement of Weights on Surface","Removal/Replacement of Weights at Depth","Partial Mask Clear at Depth","Full Mask Clear at Depth","Breathing & Swimming U/W w/o Mask","Underwater Swimming w/ Proper Use of Fins","Snorkel Use; Adjustment","Snorkel Use; Clearing Blast Method","Snorkel Use; Regulator Exchange on the Surface","Surface Snorkel Swim in Full SCUBA Equipment"]},{title:"Buoyancy Skills",skills:["BCD; Inflate/Deflate on Surface","BCD; Inflate/Deflate at Depth","BCD; Don/Doff on the Surface","BCD;Don/Doff at Depth","Buoyancy Control; Hovering","Buoyancy Control; Ascent","Buoyancy Control; Descent"]},{title:"Regulator Skills",skills:["Regulator, Breath, Clear and Recover on Surface","Regulator Breath, Clear and Recover at Depth"]},{title:"Exits and Entry Skills",skills:["Entries/Exits; Controlled Seated Entry","Entries/Exits; Giant Stride Entry","Entries/Exits; Shallow Water Exit","Entries/Exits; Deep Water Exit"]},{title:"Dive Planning",skills:["Computer Use; Understanding the Functions of Computer","Use of Gauges","Underwater Communication","Underwater Navigation","Calculate a No Deco Repetitive Dive w/ Tables or Computer"]},{title:"Dive Emergencies",skills:["Rescue Techniques; Tired Diver Tows","Rescue Techniques; Cramp Relief","Out of Air Emergency; Cont. Swimming Ascent","Out of Air Emergency; Alternate Air Source Use"]}]}],notes:{title:"Instructor Notes and Observation",type:"textarea"}},{id:"naui-advanced-scuba",name:"Advanced SCUBA Diver, NAUI",description:"NAUI Advanced SCUBA certification requirements",sections:[{title:"Academics",skills:["Intro to Navigation, Planning and Debriefing","Intro to Night/Low Visibility, Planning and Debriefing","Intro to Deep Diving, Planning and Debriefing","Intro to ___________________, Planning and Debriefing","Intro to ___________________, Planning and Debriefing","Intro to ___________________, Planning and Debriefing","eLearning","Final Written Exam"]},{title:"Practical Skills",skills:["Review Dive Planning, Rescue Skills and Assist Skills","Record Dives in Logbooks","Conduct Appropriate Skills for all Dives"]},{title:"Required Dives",diveFormat:!0,dives:[{title:"Navigation",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Night/Low Visibility",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Deep Dive (130' Max)",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]}],skills:["Navigation","Night/Low Visibility","Deep Dive (130' Max)"]},{title:"Elective Dives",diveFormat:!0,dives:[{title:"Elective Dive #1",fields:[{name:"Dive Type",type:"text"},{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Elective Dive #2",fields:[{name:"Dive Type",type:"text"},{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Elective Dive #3",fields:[{name:"Dive Type",type:"text"},{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]}],skills:["Elective Dive #1","Elective Dive #2","Elective Dive #3"]}],notes:{title:"Instructor Notes and Observations",type:"textarea"}},{id:"sdi-advanced-scuba",name:"Advanced Adventurer SCUBA Diver, SDI",description:"SDI Advanced Adventurer certification requirements",sections:[{title:"Academics",subsections:[{title:"Deep Diver Academics",skills:["Diving Tables & Computers","Speciality Equipment","Physics and Physiology","Emergency Procedures","Review of First Aid"]},{title:"Navigation Academics",skills:["Aquatic Environment","Natural Navigation","Compass Understanding","Use of Compass","Estimating Distance Underwater"]},{title:"Elective Academics",skills:["Intro/Overview of ___________________","Intro/Overview of ___________________","Intro/Overview of ___________________"]}]},{title:"Practical Skills",subsections:[{title:"Deep Dive",skills:["Test and Check All Equipment","Familiarization of the Dive Area","Descend to Planned Depth and Do Not Exceed any Limits","Dive According to Plan and Do Not Exceed 100ft","Ascend and Complete a Safety Stop"]},{title:"Navigation Dive",skills:["Plan a Dive","Enter Water from Boat or Shore","Practice Out and Back Technique","Squares and Triangles on the Surface","Squares and Triangles on the Bottom","Ascend and Exit the Water"]},{title:"Speciality Dive Skills",skills:["Dive 1 Skills from Speciality #1","Dive 1 Skills from Speciality #2","Dive 1 Skills from Speciality #3"]}]},{title:"Required Dives",diveFormat:!0,dives:[{title:"Deep Dive",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Navigation Dive",fields:[{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Speciality Dive #1",fields:[{name:"Speciality Type",type:"text"},{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Speciality Dive #2",fields:[{name:"Speciality Type",type:"text"},{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]},{title:"Speciality Dive #3",fields:[{name:"Speciality Type",type:"text"},{name:"Dive Date",type:"date"},{name:"Dive Location",type:"text"},{name:"Max Depth",type:"number"},{name:"Dive Time",type:"text"}]}],skills:["Deep Dive","Navigation Dive","Speciality Dive #1","Speciality Dive #2","Speciality Dive #3"]}],notes:{title:"Instructor Notes and Observations",type:"textarea"}}],au=e=>{let{isOpen:t,onClose:n,onSelect:r}=e;return(0,Et.jsx)(oc,{open:t,onOpenChange:n,children:(0,Et.jsxs)(hc,{className:"sm:max-w-[600px]",children:[(0,Et.jsxs)(mc,{children:[(0,Et.jsx)(pc,{children:"Select Training Record Type"}),(0,Et.jsx)(gc,{children:"Choose a training record template for this course. You can change this later."})]}),(0,Et.jsx)("div",{className:"grid gap-4 py-4",children:iu.map((e=>(0,Et.jsxs)(Rc,{className:"p-4 cursor-pointer hover:bg-gray-50",onClick:()=>r(e),children:[(0,Et.jsx)("h3",{className:"font-semibold mb-2",children:e.name}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]},e.id)))}),(0,Et.jsx)(fc,{children:(0,Et.jsx)(Kc,{variant:"outline",onClick:n,children:"Cancel"})})]})})},ou=(e,t,n,r,s,i,a)=>{var o;console.log("Generating PDF with instructor:",a);const l=window.open("","_blank"),c=(e,t)=>"Open Water Dives"===e&&"certification-dive"===n.id?'\n        <div class="skills-section">\n          '.concat(n.sections.find((e=>"Open Water Dives"===e.title)).dives.map((t=>{var n;return'\n              <div class="skill-item">\n                <div class="skill-content">\n                  <span class="skill-name">'.concat(t.title,"</span>\n                  ").concat(null!==(n=r[e])&&void 0!==n&&n[t.title]?((e,t)=>{if(!t)return"";const n=t.fields||{};return'\n      <div class="dive-fields">\n        <div class="dive-header">\n          <span class="verification">\n            <span class="checkmark">\u2713</span>\n            '.concat(new Date(t.date).toLocaleDateString()," \u2022 ").concat(t.instructorName,'\n          </span>\n        </div>\n        <div class="dive-details">\n          ').concat(n["Dive Date"]?"<div><strong>Date:</strong> ".concat(n["Dive Date"],"</div>"):"","\n          ").concat(n["Dive Location"]?"<div><strong>Location:</strong> ".concat(n["Dive Location"],"</div>"):"","\n          ").concat(n["Max Depth"]?"<div><strong>Max Depth:</strong> ".concat(n["Max Depth"],"</div>"):"","\n          ").concat(n["Dive Time"]?"<div><strong>Time:</strong> ".concat(n["Dive Time"],"</div>"):"","\n        </div>\n      </div>\n    ")})(t.title,r[e][t.title]):"","\n                </div>\n              </div>\n            ")})).join(""),"\n        </div>\n      "):'\n      <div class="skills-section">\n        '.concat(t.map((t=>{var n,s;return'\n          <div class="skill-item">\n            <div class="skill-content">\n              <span class="skill-name">'.concat(t,"</span>\n              ").concat(null!==(n=r[e])&&void 0!==n&&n[t]?(s=r[e][t])?'\n      <span class="verification">\n        <span class="checkmark">\u2713</span>\n        '.concat(new Date(s.date).toLocaleDateString()," \u2022 ").concat(s.instructorName,"\n      </span>\n    "):"":"","\n            </div>\n          </div>\n        ")})).join(""),"\n      </div>\n    "),u=(e=>{var t;return null!==e&&void 0!==e&&null!==(t=e.instructorCertifications)&&void 0!==t&&t.length?e.instructorCertifications.map((e=>"".concat(e.agency," Instructor #").concat(e.number))).join("\n"):(console.log("No instructor certifications found"),"")})(a);console.log("Formatted instructor certs:",u);const d="\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <title>Training Record - ".concat(null===e||void 0===e?void 0:e.name,'</title>\n        <style>\n          @media print {\n            @page { margin: 0.5in; }\n            body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }\n            .navigation-controls { display: none; }\n          }\n          body {\n            font-family: Arial, sans-serif;\n            line-height: 1.4;\n            margin: 0;\n            padding: 0;\n            color: #333;\n          }\n          .header {\n            background-color: #0066B3;\n            padding: 20px;\n            margin-bottom: 30px;\n            text-align: center;\n          }\n          .header img {\n            max-width: 400px;\n          }\n          .content {\n            padding: 0 40px;\n            max-width: 800px;\n            margin: 0 auto;\n          }\n          .course-info {\n            margin-bottom: 30px;\n            font-size: 14px;\n          }\n          .course-info > div {\n            margin: 5px 0;\n          }\n          .instructor-cert {\n            white-space: pre-line;\n          }\n          .section {\n            margin: 20px 0;\n          }\n          .section-title {\n            color: #0066B3;\n            font-size: 16px;\n            font-weight: bold;\n            margin: 15px 0;\n            border-bottom: 2px solid #0066B3;\n            padding-bottom: 5px;\n          }\n          .skills-section {\n            margin-left: 20px;\n          }\n          .skill-item {\n            padding: 8px 0;\n            display: flex;\n            align-items: center;\n          }\n          .skill-content {\n            display: flex;\n            justify-content: space-between;\n            width: 100%;\n          }\n          .verification {\n            color: #28a745;\n            font-size: 0.9em;\n          }\n          .checkmark {\n            color: #28a745;\n            font-weight: bold;\n            margin-right: 5px;\n          }\n          .notes {\n            margin: 30px 0;\n            padding: 15px;\n            background: #f8f9fa;\n            border-radius: 5px;\n          }\n          .sign-off {\n            margin-top: 30px;\n            border-top: 2px solid #0066B3;\n            padding-top: 20px;\n          }\n          .dive-fields {\n            margin-top: 8px;\n            padding: 8px;\n            background-color: #f9fafb;\n            border-radius: 4px;\n          }\n          .dive-header {\n            margin-bottom: 8px;\n          }\n          .dive-details {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 8px;\n            font-size: 0.9em;\n            color: #4b5563;\n          }\n          /* Navigation controls */\n          .navigation-controls {\n            position: fixed;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            background-color: #0066B3;\n            color: white;\n            padding: 12px 20px;\n            display: flex;\n            justify-content: space-between;\n            z-index: 1000;\n            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);\n          }\n          .nav-button {\n            background-color: white;\n            color: #0066B3;\n            border: none;\n            border-radius: 4px;\n            padding: 10px 20px;\n            font-size: 16px;\n            font-weight: bold;\n            cursor: pointer;\n          }\n          .nav-button:hover {\n            background-color: #f0f0f0;\n          }\n          .print-button {\n            background-color: #28a745;\n            color: white;\n          }\n          .print-button:hover {\n            background-color: #218838;\n          }\n          /* Add some bottom padding to ensure content isn\'t hidden behind the navigation bar */\n          body {\n            padding-bottom: 70px;\n          }\n        </style>\n      </head>\n      <body>\n        <div class="header">\n          <img src="/logo.png" alt="Underwater World" />\n        </div>\n        <div class="content">\n          <div class="course-info">\n            <h2>').concat(null===n||void 0===n?void 0:n.name,"</h2>\n            <div>").concat(null===e||void 0===e?void 0:e.location," \u2022 ").concat(new Date(null===e||void 0===e?void 0:e.startDate).toLocaleDateString()," - ").concat(new Date(null===e||void 0===e?void 0:e.endDate).toLocaleDateString(),"</div>\n            <div>Instructor: ").concat((null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.displayName)||"",'</div>\n            <div class="instructor-cert" style="white-space: pre-line;">').concat(u,"</div>\n            <div>Student: ").concat((null===t||void 0===t?void 0:t.displayName)||"","</div>\n            <div>Email: ").concat((null===t||void 0===t?void 0:t.email)||"","</div>\n          </div>\n\n          ").concat(null===n||void 0===n?void 0:n.sections.map((e=>'\n            <div class="section">\n              <div class="section-title">'.concat(e.title,"</div>\n              ").concat(e.subheader?'<div class="section-subheader">'.concat(e.subheader,"</div>"):"","\n              ").concat(e.subsections?e.subsections.map((e=>'\n                  <div class="subsection">\n                    <h4>'.concat(e.title,"</h4>\n                    ").concat(c(e.title,e.skills),"\n                  </div>\n                "))).join(""):c(e.title,e.skills),"\n            </div>\n          "))).join(""),"\n\n          ").concat(i?'\n            <div class="notes">\n              <div class="section-title">'.concat((null===(o=n.notes)||void 0===o?void 0:o.title)||"Instructor Comments","</div>\n              <p>").concat(i,"</p>\n            </div>\n          "):"","\n\n          ").concat(s?'\n            <div class="sign-off">\n              <div class="section-title">Instructor Sign Off</div>\n              <p>I certify that I have completed the training or verified the completion of the training on this record and that the student has performed all the skills listed to a satisfactory level.</p>\n              <p>\n                '.concat((null===a||void 0===a?void 0:a.name)||(null===a||void 0===a?void 0:a.displayName)||"",'<br>\n                <span class="instructor-cert">').concat(u,"</span><br>\n                Date: ").concat(new Date(s.date).toLocaleDateString(),"\n              </p>\n            </div>\n          "):"","\n        </div>\n        \n        \x3c!-- Fixed navigation bar at the bottom with Back and Print buttons --\x3e\n        <div class=\"navigation-controls\">\n          <button class=\"nav-button back-button\" onclick=\"attemptNavBack()\">\u2190 Back to App</button>\n          <button class=\"nav-button print-button\" onclick=\"window.print()\">Print Document</button>\n        </div>\n\n        <script>\n          // Function to handle back navigation - tries multiple approaches\n          function attemptNavBack() {\n            // Try various methods to go back, in order of preference\n            if (window.opener && !window.opener.closed) {\n              // If opened from another window that's still available\n              window.close();\n            } else if (history.length > 1) {\n              // If there's history to go back to\n              history.back();\n            } else if (navigator.standalone || window.matchMedia('(display-mode: standalone)').matches) {\n              // If in PWA standalone mode, try to open the main app\n              // This uses the current origin/domain\n              window.location.href = '/';\n            } else {\n              // Last resort - just try to close\n              window.close();\n              // If we're still here after trying to close, show a message\n              setTimeout(function() {\n                alert(\"Please use your browser's back button or close this tab to return to the app.\");\n              }, 300);\n            }\n          }\n\n          // Detect if coming from print dialog and show a notification\n          window.addEventListener('afterprint', function() {\n            const notification = document.createElement('div');\n            notification.style.position = 'fixed';\n            notification.style.top = '20px';\n            notification.style.left = '50%';\n            notification.style.transform = 'translateX(-50%)';\n            notification.style.backgroundColor = '#28a745';\n            notification.style.color = 'white';\n            notification.style.padding = '10px 20px';\n            notification.style.borderRadius = '4px';\n            notification.style.boxShadow = '0 2px 10px rgba(0,0,0,0.2)';\n            notification.style.zIndex = '2000';\n            notification.textContent = 'Print complete! You can now return to the app.';\n            document.body.appendChild(notification);\n            \n            setTimeout(function() {\n              notification.style.opacity = '0';\n              notification.style.transition = 'opacity 0.5s ease';\n              setTimeout(function() {\n                document.body.removeChild(notification);\n              }, 500);\n            }, 3000);\n          });\n        <\/script>\n      </body>\n    </html>\n  ");l.document.write(d),l.document.close(),l.onload=()=>{}},lu=e=>{var t;let{isOpen:n,onClose:s,student:i,course:a,trainingRecord:l,instructorProfile:c,onProgressUpdate:u,readOnly:d=!1}=e;const[h,m]=(0,r.useState)({}),[f,p]=(0,r.useState)(!0),[g,v]=(0,r.useState)(null),[x,y]=(0,r.useState)(""),[b,w]=(0,r.useState)(!1),[D,N]=(0,r.useState)(!1),[j,C]=(0,r.useState)(""),[E,A]=(0,r.useState)(!1),[k,S]=(0,r.useState)(null),[F,_]=(0,r.useState)(null),[T,I]=(0,r.useState)({}),[R,P]=(0,r.useState)({});(0,r.useEffect)((()=>{n&&(async()=>{if(null===a||void 0===a||!a.id)return console.error("No valid course ID found:",a),void v("Invalid course data");try{const n=(0,Dt.H9)(wt.db,"courses",a.id),r=await(0,Dt.x7)(n);if(r.exists()){var e,t;const n=r.data();if(n.instructorId){const e=(0,Dt.H9)(wt.db,"profiles",n.instructorId),t=await(0,Dt.x7)(e);if(t.exists()){const e=t.data();console.log("Loaded instructor profile:",e),n.instructor=(0,o.A)((0,o.A)((0,o.A)({},n.instructor),e),{},{uid:n.instructorId,name:e.name,displayName:e.name||e.displayName,instructorCertifications:e.instructorCertifications||[]})}}const s=null===(e=n.studentRecords)||void 0===e?void 0:e[i.uid];m((null===s||void 0===s?void 0:s.progress)||{}),y((null===s||void 0===s?void 0:s.notes)||""),A(!(null===s||void 0===s||null===(t=s.signOff)||void 0===t||!t.locked)),S(null===s||void 0===s?void 0:s.signOff),_(n);const a={},c=(null===s||void 0===s?void 0:s.progress)||{};if("certification-dive"===(null===l||void 0===l?void 0:l.id)&&null!==l&&void 0!==l&&l.sections){const e=l.sections.find((e=>"Open Water Dives"===e.title));e&&e.dives&&e.dives.forEach((e=>{var t,n;const r=(null===(t=c["Open Water Dives"])||void 0===t||null===(n=t[e.title])||void 0===n?void 0:n.fields)||{};a[e.title]=r}))}I(a)}p(!1)}catch(gb){console.error("Error loading progress:",gb),v("Failed to load training record"),p(!1)}})()}),[n,a,null===i||void 0===i?void 0:i.uid,l]);const O=async(e,t)=>{if(!d)if(E)v("Record is locked. Contact instructor to make changes.");else try{var n,r;const s=new Date,l=(0,o.A)({},h);null!==(n=l[e])&&void 0!==n&&n[t]?(delete l[e][t],0===Object.keys(l[e]).length&&delete l[e]):(l[e]||(l[e]={}),l[e][t]={date:s.toISOString(),instructorName:(null===c||void 0===c?void 0:c.name)||"Unknown Instructor",instructorId:(null===c||void 0===c?void 0:c.uid)||"unknown",verifiedAt:s.toISOString()});const d=(0,Dt.H9)(wt.db,"courses",a.id);await(0,Dt.mZ)(d,{["studentRecords.".concat(i.uid,".progress")]:l}),m(l),u((0,o.A)((0,o.A)({},a),{},{studentRecords:(0,o.A)((0,o.A)({},a.studentRecords),{},{[i.uid]:(0,o.A)((0,o.A)({},null===(r=a.studentRecords)||void 0===r?void 0:r[i.uid]),{},{progress:l})})}))}catch(gb){console.error("Error updating skill:",gb),v("Failed to update skill verification")}},M=(e,t,n)=>{var r;const s=(null===(r=h[e.title])||void 0===r?void 0:r[t.title])||{},l=!!s.date,f=T[t.title]||{},p=R[t.title]||!1;return(0,Et.jsxs)("div",{className:"mb-4 border-b pb-4",children:[(0,Et.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-3",children:[d?(0,Et.jsx)("div",{className:"h-5 w-5 flex items-center justify-center",children:l?(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-600",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}):(0,Et.jsx)("input",{type:"checkbox",checked:l,onChange:()=>O(e.title,t.title),className:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:E}),(0,Et.jsx)("span",{className:"text-gray-900 font-medium",children:t.title})]}),l&&(0,Et.jsxs)("div",{className:"text-sm text-gray-600",children:["Verified ",new Date(s.date).toLocaleDateString()," by ",s.instructorName]})]}),(0,Et.jsx)("div",{className:"ml-8 grid grid-cols-1 md:grid-cols-2 gap-3",children:t.fields.map((e=>(0,Et.jsxs)("div",{className:"flex flex-col",children:[(0,Et.jsx)("label",{className:"text-sm text-gray-600 mb-1",children:e.name}),(0,Et.jsx)("input",{type:e.type,value:f[e.name]||"",onChange:n=>{return r=t.title,s=e.name,i=n.target.value,void I((e=>(0,o.A)((0,o.A)({},e),{},{[r]:(0,o.A)((0,o.A)({},e[r]||{}),{},{[s]:i})})));var r,s,i},className:"p-2 border rounded text-sm",disabled:E||d,placeholder:"date"===e.type?"YYYY-MM-DD":""})]},e.name)))}),!E&&!d&&(0,Et.jsx)("div",{className:"mt-3 flex justify-end ml-8",children:(0,Et.jsx)(Kc,{onClick:()=>(async(e,t)=>{if(d||E)v("Record is locked. Contact instructor to make changes.");else try{var n;P((e=>(0,o.A)((0,o.A)({},e),{},{[t.title]:!0})));const r=(0,o.A)({},h);r[e.title]||(r[e.title]={}),r[e.title][t.title]||(r[e.title][t.title]={date:(new Date).toISOString(),instructorName:(null===c||void 0===c?void 0:c.name)||"Unknown Instructor",instructorId:(null===c||void 0===c?void 0:c.uid)||"unknown",verifiedAt:(new Date).toISOString(),fields:{}}),r[e.title][t.title].fields||(r[e.title][t.title].fields={}),r[e.title][t.title].fields=T[t.title]||{};const s=(0,Dt.H9)(wt.db,"courses",a.id);await(0,Dt.mZ)(s,{["studentRecords.".concat(i.uid,".progress")]:r}),m(r),u((0,o.A)((0,o.A)({},a),{},{studentRecords:(0,o.A)((0,o.A)({},a.studentRecords),{},{[i.uid]:(0,o.A)((0,o.A)({},null===(n=a.studentRecords)||void 0===n?void 0:n[i.uid]),{},{progress:r})})})),v(null),P((e=>(0,o.A)((0,o.A)({},e),{},{[t.title]:!1})))}catch(gb){console.error("Error updating dive fields:",gb),v("Failed to update dive information"),P((e=>(0,o.A)((0,o.A)({},e),{},{[t.title]:!1})))}})(e,t),variant:"outline",className:"bg-white",disabled:p,children:p?"Saving...":"Save Dive Details"})})]},t.title)},L=(e,t,n)=>(0,Et.jsxs)("div",{className:"flex items-center justify-between p-3 border-b last:border-b-0 hover:bg-gray-50 transition-colors bg-white",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-3",children:[d?(0,Et.jsx)("div",{className:"h-5 w-5 flex items-center justify-center",children:n?(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-green-600",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-300",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}):(0,Et.jsx)("input",{type:"checkbox",checked:!!n,onChange:()=>O(e.title,t),className:"h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:E}),(0,Et.jsx)("span",{className:"text-gray-900",children:t})]}),n&&(0,Et.jsxs)("div",{className:"flex items-center space-x-4",children:[!d&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("input",{type:"date",value:n.date.split("T")[0],onChange:n=>(async(e,t,n)=>{if(E)v("Record is locked. Contact instructor to make changes.");else try{var r;const s=(0,o.A)({},h);if(null!==(r=s[e])&&void 0!==r&&r[t]){s[e][t]=(0,o.A)((0,o.A)({},s[e][t]),{},{date:new Date(n).toISOString(),lastModified:(new Date).toISOString()});const r=(0,Dt.H9)(wt.db,"courses",a.id);await(0,Dt.mZ)(r,{["studentRecords.".concat(i.uid,".progress")]:s}),m(s)}}catch(gb){console.error("Error updating date:",gb),v("Failed to update date")}})(e.title,t,n.target.value),className:"text-sm border rounded px-2 py-1",disabled:E}),(0,Et.jsx)("input",{type:"text",value:n.instructorName,onChange:n=>(async(e,t,n)=>{if(E)v("Record is locked. Contact instructor to make changes.");else try{var r;const s=(0,o.A)({},h);if(null!==(r=s[e])&&void 0!==r&&r[t]){s[e][t]=(0,o.A)((0,o.A)({},s[e][t]),{},{instructorName:n,lastModified:(new Date).toISOString()});const r=(0,Dt.H9)(wt.db,"courses",a.id);await(0,Dt.mZ)(r,{["studentRecords.".concat(i.uid,".progress")]:s}),m(s)}}catch(gb){console.error("Error updating instructor:",gb),v("Failed to update instructor")}})(e.title,t,n.target.value),placeholder:"Instructor",className:"text-sm border rounded px-2 py-1 w-32",disabled:E})]}),d&&(0,Et.jsxs)("span",{className:"text-sm text-gray-600",children:["Verified ",new Date(n.date).toLocaleDateString()," by ",n.instructorName]})]})]},t);return f?(0,Et.jsx)("div",{children:"Loading..."}):g?(0,Et.jsx)("div",{className:"text-red-600",children:g}):(0,Et.jsxs)(oc,{open:n,onOpenChange:s,children:[(0,Et.jsx)(hc,{className:"max-w-4xl max-h-[90vh] overflow-y-auto bg-white",children:(0,Et.jsxs)("div",{className:"bg-white",children:[(0,Et.jsxs)(mc,{className:"bg-white border-b pb-4",children:[(0,Et.jsx)(pc,{className:"text-2xl font-bold text-gray-900",children:"Training Record"}),(0,Et.jsxs)(gc,{className:"mt-2 space-y-1",children:[(0,Et.jsx)("span",{className:"text-lg font-semibold text-gray-900 block",children:null===l||void 0===l?void 0:l.name}),(0,Et.jsx)("span",{className:"text-sm text-gray-500 block",children:null===a||void 0===a?void 0:a.name})]})]}),(0,Et.jsxs)("div",{className:"space-y-6 py-4",children:[(0,Et.jsx)("div",{className:"bg-white border rounded-lg shadow-sm",children:(0,Et.jsxs)("div",{className:"px-6 py-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Student Information"}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Name"}),(0,Et.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:null===i||void 0===i?void 0:i.displayName})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,Et.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:null===i||void 0===i?void 0:i.email})]})]})]})}),l.sections.map((e=>(e=>e.diveFormat&&e.dives?(0,Et.jsx)("div",{className:"bg-white border rounded-lg shadow-sm",children:(0,Et.jsxs)("div",{className:"px-6 py-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:e.title}),e.subheader&&(0,Et.jsx)("p",{className:"text-sm text-gray-600 mb-4 italic",children:e.subheader}),(0,Et.jsx)("div",{className:"space-y-4",children:e.dives.map(((t,n)=>M(e,t)))}),(0,Et.jsxs)("div",{className:"mt-2 text-sm text-gray-600 text-right",children:[Object.keys(h[e.title]||{}).length," of ",e.dives.length," dives verified"]})]})},e.title):e.subsections?(0,Et.jsx)("div",{className:"bg-white border rounded-lg shadow-sm",children:(0,Et.jsxs)("div",{className:"px-6 py-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:e.title}),(0,Et.jsx)("div",{className:"space-y-8",children:e.subsections.map((e=>(0,Et.jsxs)("div",{className:"border-l-4 border-gray-200 pl-4",children:[(0,Et.jsx)("h4",{className:"text-base font-semibold text-gray-700 mb-3",children:e.title}),(0,Et.jsx)("div",{className:"divide-y divide-gray-200 rounded-md border bg-white",children:e.skills.map((t=>{var n;return L(e,t,null===(n=h[e.title])||void 0===n?void 0:n[t])}))}),(0,Et.jsxs)("div",{className:"mt-2 text-sm text-gray-600 text-right",children:[Object.keys(h[e.title]||{}).length," of ",e.skills.length," completed"]})]},e.title)))})]})},e.title):(0,Et.jsx)("div",{className:"bg-white border rounded-lg shadow-sm",children:(0,Et.jsxs)("div",{className:"px-6 py-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:e.title}),e.subheader&&(0,Et.jsx)("p",{className:"text-sm text-gray-600 mb-4 italic",children:e.subheader}),(0,Et.jsx)("div",{className:"divide-y divide-gray-200 rounded-md border bg-white",children:e.skills.map((t=>{var n;return L(e,t,null===(n=h[e.title])||void 0===n?void 0:n[t])}))}),(0,Et.jsxs)("div",{className:"mt-2 text-sm text-gray-600 text-right",children:[Object.keys(h[e.title]||{}).length," of ",e.skills.length," completed"]})]})},e.title))(e))),(0,Et.jsx)("div",{className:"bg-white border rounded-lg shadow-sm mt-6",children:(0,Et.jsxs)("div",{className:"px-6 py-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:(null===(t=l.notes)||void 0===t?void 0:t.title)||"Instructor Notes and Observations"}),(0,Et.jsx)("textarea",{value:x,onChange:e=>y(e.target.value),className:"w-full h-32 p-2 border rounded-md",placeholder:"Add notes and observations here...",disabled:E}),!E&&(0,Et.jsx)("div",{className:"mt-3 flex justify-end",children:(0,Et.jsx)(Kc,{onClick:async()=>{if(E)v("Record is locked. Contact instructor to make changes.");else try{w(!0);const e=(0,Dt.H9)(wt.db,"courses",a.id);await(0,Dt.mZ)(e,{["studentRecords.".concat(i.uid,".notes")]:x}),v(null),w(!1)}catch(gb){console.error("Error updating notes:",gb),v("Failed to update notes"),w(!1)}},variant:"outline",className:"bg-white",disabled:b,children:b?"Saving...":"Save Notes"})}),g&&(0,Et.jsx)("p",{className:"text-red-600 text-sm mt-2",children:g})]})}),(0,Et.jsx)("div",{className:"bg-white border rounded-lg shadow-sm mt-6",children:(0,Et.jsxs)("div",{className:"px-6 py-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Instructor Sign Off"}),E?(0,Et.jsxs)("div",{className:"space-y-2",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Record Locked and Signed Off by:"}),(0,Et.jsx)("p",{className:"font-medium",children:null===k||void 0===k?void 0:k.instructorName}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Date: ",new Date(null===k||void 0===k?void 0:k.date).toLocaleDateString()]})]}),(0,Et.jsx)(Kc,{onClick:()=>N(!0),className:"w-full bg-yellow-600 hover:bg-yellow-700 text-white",children:"Unlock Record"})]}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"I certify that I have completed the training or verified the completion of the training on this record and that the student has performed all the skills listed to a satisfactory level."}),(0,Et.jsx)(Kc,{onClick:()=>N(!0),className:"w-full bg-green-600 hover:bg-green-700 text-white",children:"Sign Off Record"})]})]})})]}),(0,Et.jsxs)("div",{className:"mt-5 border-t pt-4 flex justify-end space-x-2 bg-white",children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:s,className:"bg-white",children:"Close"}),(0,Et.jsx)(Kc,{onClick:()=>{var e,t,n,r,s,o,c,u;console.log("Exporting with course data:",F),console.log("Instructor certifications:",null===F||void 0===F||null===(e=F.instructor)||void 0===e?void 0:e.instructorCertifications),ou(F||a,i,l,h,k,x,{name:(null===F||void 0===F||null===(t=F.instructor)||void 0===t?void 0:t.name)||(null===a||void 0===a||null===(n=a.instructor)||void 0===n?void 0:n.name),displayName:(null===F||void 0===F||null===(r=F.instructor)||void 0===r?void 0:r.displayName)||(null===a||void 0===a||null===(s=a.instructor)||void 0===s?void 0:s.displayName),instructorCertifications:(null===F||void 0===F||null===(o=F.instructor)||void 0===o?void 0:o.instructorCertifications)||[],certText:(null===F||void 0===F||null===(c=F.instructor)||void 0===c||null===(u=c.instructorCertifications)||void 0===u?void 0:u.map((e=>"".concat(e.agency," Instructor #").concat(e.number))).join("\n"))||""})},variant:"outline",className:"bg-white",children:"Export Record"})]})]})}),(0,Et.jsx)(oc,{open:D,onOpenChange:N,children:(0,Et.jsxs)(hc,{className:"sm:max-w-[425px]",children:[(0,Et.jsxs)(mc,{children:[(0,Et.jsx)(pc,{children:E?"Unlock Record":"Instructor Sign Off"}),(0,Et.jsx)(gc,{children:E?"Enter your instructor signature code to unlock this student's training record. Once unlocked, you can make changes to the record.":"Enter your instructor signature code to sign off on this student's training record. This will lock the record from further changes."})]}),(0,Et.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Enter signature code",value:j,onChange:e=>C(e.target.value),className:"w-full p-2 border rounded"}),g&&(0,Et.jsx)("p",{className:"text-red-600 text-sm",children:g})]}),(0,Et.jsxs)(fc,{children:[(0,Et.jsx)(Kc,{onClick:()=>N(!1),variant:"outline",children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:E?async()=>{try{var e;const t=(0,Dt.H9)(wt.db,"profiles",c.uid),n=await(0,Dt.x7)(t);if(!n.exists()||(null===(e=n.data().instructorSignature)||void 0===e?void 0:e.code)!==j)return void v("Invalid signature code");const r=(0,Dt.H9)(wt.db,"courses",a.id);await(0,Dt.mZ)(r,{["studentRecords.".concat(i.uid,".signOff.locked")]:!1}),A(!1),N(!1),C("")}catch(gb){console.error("Error unlocking record:",gb),v("Failed to unlock record")}}:async()=>{try{var e,t;if(null===c||void 0===c||!c.uid)return void v("Missing instructor information");const n=(0,Dt.H9)(wt.db,"profiles",String(c.uid)),r=await(0,Dt.x7)(n);if(!r.exists()||(null===(e=r.data().instructorSignature)||void 0===e?void 0:e.code)!==j)return void v("Invalid signature code");const s=(new Date).toISOString(),l={instructorId:c.uid,instructorName:c.name||"Unknown Instructor",date:s,locked:!0,verificationText:"I certify that I have completed the training or verified the completion of the training on this record and that the student has performed all the skills listed to a satisfactory level."},d=(0,Dt.H9)(wt.db,"courses/".concat(String(a.id))),h={["studentRecords.".concat(String(i.uid),".signOff")]:l,["studentRecords.".concat(String(i.uid),".lastModified")]:s};await(0,Dt.mZ)(d,h),S(l),A(!0),u((0,o.A)((0,o.A)({},a),{},{studentRecords:(0,o.A)((0,o.A)({},a.studentRecords),{},{[i.uid]:(0,o.A)((0,o.A)({},(null===(t=a.studentRecords)||void 0===t?void 0:t[i.uid])||{}),{},{signOff:l,lastModified:s})})})),N(!1),C(""),v(null)}catch(gb){console.error("Error in handleSignOff:",gb),v("Failed to sign off record. Please try again.")}},className:E?"bg-yellow-600":"bg-green-600",children:E?"Unlock Record":"Sign Off"})]})]})})]})},cu=e=>{let{isOpen:t,onClose:n,newCourse:s,setNewCourse:i,handleCreateCourse:a,selectedTrainingRecord:l,setIsTrainingRecordSelectorOpen:c}=e;const[u,d]=(0,r.useState)(!1);return t?(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold",children:"Create New Course"}),(0,Et.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("select",{className:"w-full p-2 border rounded mb-2",value:u?"Custom Course":s.name,onChange:e=>{var t;"Custom Course"===(t=e.target.value)?(d(!0),i((0,o.A)((0,o.A)({},s),{},{name:""}))):(d(!1),i((0,o.A)((0,o.A)({},s),{},{name:t})))},children:[(0,Et.jsx)("option",{value:"",children:"Select a Course"}),["Try SCUBA","Open Water SCUBA Diver (NAUI)","Open Water SCUBA Diver (SDI)","Open Water SCUBA Diver Certification Dives","Advanced Open Water Diver (NAUI)","Advanced Open Water Diver (SDI)","Custom Course"].map((e=>(0,Et.jsx)("option",{value:e,children:e},e)))]}),u&&(0,Et.jsx)("input",{type:"text",placeholder:"Enter Custom Course Name",className:"w-full p-2 border rounded",value:s.name,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{name:e.target.value}))})]}),(0,Et.jsx)("input",{type:"text",placeholder:"Location",className:"w-full p-2 border rounded",value:s.location,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{location:e.target.value}))}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsx)("input",{type:"date",className:"p-2 border rounded",value:s.startDate,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{startDate:e.target.value}))}),(0,Et.jsx)("input",{type:"date",className:"p-2 border rounded",value:s.endDate,onChange:e=>i((0,o.A)((0,o.A)({},s),{},{endDate:e.target.value}))})]}),(0,Et.jsxs)("div",{className:"border rounded p-4",children:[(0,Et.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Training Record"}),l?(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsx)("span",{children:l.name}),(0,Et.jsx)("button",{onClick:()=>c(!0),className:"text-blue-600 text-sm",children:"Change"})]}):(0,Et.jsx)("button",{onClick:()=>c(!0),className:"w-full text-center text-blue-600 p-2 border border-dashed rounded hover:bg-blue-50",children:"Select Training Record"})]}),(0,Et.jsx)("button",{onClick:a,disabled:!s.name,className:"w-full p-2 rounded ".concat(s.name?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 cursor-not-allowed"),children:"Create Course"})]})]})}):null},uu=(e,t)=>{var n,r;if(!e||!t||null===t||void 0===t||!t.trainingRecord||null===(n=t.studentRecords)||void 0===n||null===(r=n[e.uid])||void 0===r||!r.progress)return 0;const s=t.studentRecords[e.uid].progress;let i=0,a=0;return t.trainingRecord.sections.forEach((e=>{e.subsections?e.subsections.forEach((e=>{i+=e.skills.length,a+=Object.keys(s[e.title]||{}).length})):(i+=e.skills.length,a+=Object.keys(s[e.title]||{}).length)})),i>0?Math.round(a/i*100):0},du=e=>{var t,n,s;let{course:i,onSubmit:a,onCancel:l}=e;const[c,u]=(0,r.useState)({creditAllocations:(null===(t=i.assistants)||void 0===t?void 0:t.map((e=>({name:e.displayName,uid:e.uid,percentage:""}))))||[],additionalNotes:""}),[d,h]=(0,r.useState)({});return(0,Et.jsxs)("div",{className:"bg-white rounded-lg w-full",children:[(0,Et.jsx)("div",{className:"flex justify-between items-center border-b p-6",children:(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:"Course End Report"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Complete and finalize course details"})]})}),(0,Et.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return c.creditAllocations.reduce(((e,t)=>e+(parseFloat(t.percentage)||0)),0)>100&&(e.creditAllocations="Total credit allocation cannot exceed 100%"),c.creditAllocations.forEach(((t,n)=>{t.percentage&&(isNaN(t.percentage)||t.percentage<0||t.percentage>100)&&(e["percentage_".concat(n)]="Percentage must be between 0 and 100")})),h(e),0===Object.keys(e).length})()&&a({creditAllocations:c.creditAllocations.filter((e=>e.percentage&&parseFloat(e.percentage)>0)),additionalNotes:c.additionalNotes,submittedAt:(new Date).toISOString()})},className:"p-6 space-y-6",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Et.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Course Details"}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Course:"}),(0,Et.jsx)("div",{className:"font-medium text-gray-900",children:i.name})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Location:"}),(0,Et.jsx)("div",{className:"font-medium text-gray-900",children:i.location})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Start Date:"}),(0,Et.jsx)("div",{className:"font-medium text-gray-900",children:new Date(i.startDate).toLocaleDateString()})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"End Date:"}),(0,Et.jsx)("div",{className:"font-medium text-gray-900",children:new Date(i.endDate).toLocaleDateString()})]}),(0,Et.jsxs)("div",{className:"col-span-2",children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Instructor:"}),(0,Et.jsx)("div",{className:"font-medium text-gray-900",children:null===(n=i.instructor)||void 0===n?void 0:n.displayName})]})]})]}),(0,Et.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Et.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Students"}),(0,Et.jsx)("div",{className:"space-y-2",children:null===(s=i.students)||void 0===s?void 0:s.map(((e,t)=>(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("span",{className:"text-gray-900",children:["\u2022 ",e.displayName]}),(0,Et.jsx)("span",{className:"text-gray-600",children:i.trainingRecord?"".concat(uu(e,i),"% Complete"):"No Training Record"})]},t)))})]}),c.creditAllocations.length>0&&(0,Et.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,Et.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Credit Allocation"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Would you like to apply any of your credit to an assistant or DM?"}),d.creditAllocations&&(0,Et.jsx)("div",{className:"bg-red-50 text-red-600 p-3 rounded-md mb-4",children:d.creditAllocations}),c.creditAllocations.map(((e,t)=>(0,Et.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,Et.jsx)("div",{className:"flex-grow",children:(0,Et.jsx)("label",{className:"text-gray-900",children:e.name})}),(0,Et.jsxs)("div",{className:"w-32 flex items-center gap-2",children:[(0,Et.jsx)("input",{type:"number",min:"0",max:"100",placeholder:"0",value:e.percentage,onChange:e=>((e,t)=>{const n=[...c.creditAllocations];if(n[e]=(0,o.A)((0,o.A)({},n[e]),{},{percentage:t}),u((0,o.A)((0,o.A)({},c),{},{creditAllocations:n})),d["percentage_".concat(e)]){const t=(0,o.A)({},d);delete t["percentage_".concat(e)],h(t)}})(t,e.target.value),className:"w-full p-2 border rounded ".concat(d["percentage_".concat(t)]?"border-red-500":"border-gray-200"," focus:outline-none focus:ring-2 focus:ring-blue-500")}),(0,Et.jsx)("span",{className:"text-gray-600",children:"%"})]})]},t)))]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-lg font-semibold text-gray-900 mb-2",children:"Additional Notes"}),(0,Et.jsx)("textarea",{value:c.additionalNotes,onChange:e=>u((0,o.A)((0,o.A)({},c),{},{additionalNotes:e.target.value})),placeholder:"Any additional comments or observations?",className:"w-full p-2 border border-gray-200 rounded-lg min-h-[100px] focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,Et.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[(0,Et.jsx)("button",{type:"button",onClick:l,className:"px-4 py-2 text-gray-700 bg-white border border-gray-200 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,Et.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Complete Course"})]})]})]})},hu=e=>{var t,n,s,i,a,l,c;let{user:u,instructorProfile:d}=e;const[h,m]=(0,r.useState)([]),[f,p]=(0,r.useState)(!0),[g,v]=(0,r.useState)(""),[x,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(!1),[D,N]=(0,r.useState)("student"),[j,C]=(0,r.useState)(""),[E,A]=(0,r.useState)([]),[k,S]=(0,r.useState)(null),[F,_]=(0,r.useState)(!1),[T,I]=(0,r.useState)({name:"",location:"",startDate:"",endDate:""}),[R,P]=(0,r.useState)({isOpen:!1,course:null,recipient:null}),[O,M]=(0,r.useState)(!1),[L,B]=(0,r.useState)(null),[z,U]=(0,r.useState)(!1),[q,V]=(0,r.useState)(null),[H,W]=(0,r.useState)(!1),[G,K]=(0,r.useState)(null),[Q,Y]=(0,r.useState)({});(0,r.useEffect)((()=>{(async()=>{if(null!==u&&void 0!==u&&u.uid)try{const e=(0,Dt.rJ)(wt.db,"courses"),t=(0,Dt.P)(e,(0,Dt._M)("instructorId","==",u.uid)),n=(await(0,Dt.GG)(t)).docs.map((e=>(0,o.A)({id:e.id},e.data())));m(n)}catch(gb){console.error("Error loading courses:",gb),v("Error loading courses")}finally{p(!1)}})()}),[u]),(0,r.useEffect)((()=>{if(null===u||void 0===u||!u.uid||!h.length)return;const e={};return h.forEach((t=>{e[t.id]=Xc.default.subscribeToItemNotifications(u.uid,"course",t.id,(e=>{Y((n=>(0,o.A)((0,o.A)({},n),{},{[t.id]:e})))}))})),()=>{Object.values(e).forEach((e=>e()))}}),[u,h]);const J=(e,t)=>{var n,r;if(!e||!t||null===t||void 0===t||!t.trainingRecord||null===(n=t.studentRecords)||void 0===n||null===(r=n[e.uid])||void 0===r||!r.progress)return 0;const s=t.studentRecords[e.uid].progress;let i=0,a=0;return t.trainingRecord.sections.forEach((e=>{e.subsections?e.subsections.forEach((e=>{i+=e.skills.length,a+=Object.keys(s[e.title]||{}).length})):(i+=e.skills.length,a+=Object.keys(s[e.title]||{}).length)})),i>0?Math.round(a/i*100):0},X=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";if(null!==u&&void 0!==u&&u.uid&&e)try{"all"===t?(await Xc.default.markTabNotificationsAsRead(u.uid,"course",e,"broadcast"),await Xc.default.markTabNotificationsAsRead(u.uid,"course",e,"discussion"),await Xc.default.markTabNotificationsAsRead(u.uid,"course",e,"direct")):await Xc.default.markTabNotificationsAsRead(u.uid,"course",e,t)}catch(gb){console.error("Error clearing course notifications:",gb)}},$=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"student";if(window.confirm("Are you sure you want to remove this ".concat(t," from the course?")))try{const n=(0,Dt.H9)(wt.db,"courses",k.id);let r;if("assistant"===t){const t=k.assistants.filter((t=>t.uid!==e.uid));r=(0,o.A)((0,o.A)({},k),{},{assistants:t}),await(0,Dt.mZ)(n,{assistants:t})}else{const t=k.students.filter((t=>t.uid!==e.uid));r=(0,o.A)((0,o.A)({},k),{},{students:t}),await(0,Dt.mZ)(n,{students:t})}m(h.map((e=>e.id===k.id?r:e))),S(r);const s=(0,Dt.H9)(wt.db,"profiles",e.uid),i=await(0,Dt.x7)(s);if(i.exists()){const t=(i.data().training||[]).filter((e=>e.courseId!==k.id));await(0,Dt.mZ)(s,{training:t}),await(0,Dt.gS)((0,Dt.rJ)(wt.db,"notifications"),{type:"course_removal",toUser:e.uid,fromUser:d.uid,fromUserName:d.name||"Unknown Instructor",courseName:k.name,timestamp:(0,Dt.O5)(),read:!1})}}catch(gb){console.error("Error removing ".concat(t," from course:"),gb),v("Failed to remove ".concat(t," from course"))}},Z=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{const n=h.find((t=>t.id===e));if(!t){return n.students.some((e=>{var t,r;const s=null===(t=n.studentRecords)||void 0===t?void 0:t[e.uid];return!(null!==s&&void 0!==s&&null!==(r=s.signOff)&&void 0!==r&&r.locked)}))?void alert("All student training records must be locked before completing the course."):(B(n),void M(!0))}const r=(new Date).toISOString(),s=(0,Dt.H9)(wt.db,"courses",e),i=n.students.map((async n=>{const s=(0,Dt.H9)(wt.db,"profiles",n.uid),i=await(0,Dt.x7)(s);if(i.exists()){const n=i.data().training.map((n=>n.courseId===e?(0,o.A)((0,o.A)({},n),{},{status:t?"active":"completed",completedAt:t?null:r}):n));return(0,Dt.mZ)(s,{training:n})}}));if(n.assistants){const s=n.assistants.map((async n=>{const s=(0,Dt.H9)(wt.db,"profiles",n.uid),i=await(0,Dt.x7)(s);if(i.exists()){const n=i.data().training.map((n=>n.courseId===e?(0,o.A)((0,o.A)({},n),{},{status:t?"active":"completed",completedAt:t?null:r}):n));return(0,Dt.mZ)(s,{training:n})}}));i.push(...s)}const a=[...n.students||[],...n.assistants||[]].map((e=>(0,Dt.gS)((0,Dt.rJ)(wt.db,"notifications"),{type:"course_completed",toUser:e.uid,fromUser:d.uid,fromUserName:d.name||"Unknown Instructor",courseName:n.name,timestamp:(0,Dt.O5)(),read:!1})));await Promise.all([(0,Dt.mZ)(s,{status:t?"active":"completed",completedAt:t?null:r}),...i,...a]),m(h.map((n=>n.id===e?(0,o.A)((0,o.A)({},n),{},{status:t?"active":"completed",completedAt:t?null:r}):n)))}catch(gb){console.error("Error updating course status:",gb),v("Failed to update course status")}},ee=e=>{S(e),w(!0),X(e.id,"all")};return f?(0,Et.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Et.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):g?(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,Et.jsx)("p",{className:"text-red-600",children:g})}):(0,Et.jsxs)("div",{className:"space-y-6",children:[(0,Et.jsx)("div",{className:"flex justify-between items-center",children:(0,Et.jsxs)("button",{onClick:()=>y(!0),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Create New Course"]})}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Active Courses"}),(0,Et.jsx)("div",{className:"space-y-4",children:0===h.filter((e=>"active"===e.status)).length?(0,Et.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-600",children:"No active courses yet."})}):h.filter((e=>"active"===e.status)).map((e=>{var t,n,r;return(0,Et.jsxs)("div",{className:"bg-white border rounded-lg shadow-sm p-4",children:[(0,Et.jsxs)("div",{className:"mb-2",children:[(0,Et.jsxs)("h4",{className:"text-lg font-semibold",children:[e.name,(null===(t=Q[e.id])||void 0===t?void 0:t.totalCount)>0&&(0,Et.jsx)("span",{className:"ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:Q[e.id].totalCount})]}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:[e.location," \u2022 ",new Date(e.startDate).toLocaleDateString()," - ",new Date(e.endDate).toLocaleDateString()]})]}),(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{className:"flex gap-4",children:[(0,Et.jsxs)("button",{className:"text-sm text-gray-600 hover:text-blue-600",children:[(null===(n=e.students)||void 0===n?void 0:n.length)||0," Students"]}),(0,Et.jsx)("button",{onClick:()=>ee(e),className:"text-sm text-gray-600 hover:text-blue-600",children:"Manage Course"}),(0,Et.jsxs)("button",{onClick:()=>{P({isOpen:!0,course:e,recipient:null}),X(e.id,"all")},className:"text-sm text-gray-600 hover:text-blue-600 relative",children:["Message Course",(null===(r=Q[e.id])||void 0===r?void 0:r.totalCount)>0&&(0,Et.jsxs)("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[(0,Et.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),(0,Et.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]})]})]}),(0,Et.jsx)("button",{onClick:()=>Z(e.id),className:"text-sm text-green-600 hover:text-green-700",children:"Complete Course"})]})]},e.id)}))})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Completed Courses"}),(0,Et.jsx)("div",{className:"space-y-4",children:0===h.filter((e=>"completed"===e.status)).length?(0,Et.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-600",children:"No completed courses yet."})}):h.filter((e=>"completed"===e.status)).map((e=>(0,Et.jsxs)("div",{className:"bg-gray-50 border rounded-lg p-4",children:[(0,Et.jsxs)("div",{className:"mb-2",children:[(0,Et.jsx)("h4",{className:"text-lg font-semibold",children:e.name}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:[e.location," \u2022 Completed ",e.completedAt?new Date(e.completedAt).toLocaleDateString():"Date not available"]})]}),(0,Et.jsxs)("div",{className:"flex gap-4",children:[(0,Et.jsx)("button",{onClick:()=>ee(e),className:"text-sm text-gray-600 hover:text-blue-600",children:"View Details"}),(0,Et.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to reactivate this course?")&&Z(e.id,!0)},className:"text-sm text-green-600 hover:text-green-700",children:"Reactivate Course"})]})]},e.id)))})]})]}),x&&(0,Et.jsx)(cu,{isOpen:x,onClose:()=>y(!1),newCourse:T,setNewCourse:I,handleCreateCourse:async()=>{try{const e=(0,o.A)((0,o.A)({},T),{},{instructorId:u.uid,instructor:{uid:u.uid,email:d.email,displayName:d.name||"Unnamed Instructor"},status:"active",students:[],assistants:[],createdAt:new Date,trainingRecord:q,studentRecords:{}}),t=await(0,Dt.gS)((0,Dt.rJ)(wt.db,"courses"),e),n=(0,o.A)({id:t.id},e);m([...h,n]),y(!1),I({name:"",location:"",startDate:"",endDate:""}),V(null)}catch(gb){console.error("Error creating course:",gb),v("Failed to create course")}},selectedTrainingRecord:q,setIsTrainingRecordSelectorOpen:U}),b&&k&&(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsxs)("h3",{className:"text-lg font-semibold",children:["Manage Course: ",k.name]}),(0,Et.jsx)("button",{onClick:()=>{w(!1),S(null),A([]),C(""),N("student"),W(!1),K(null)},className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,Et.jsx)("h4",{className:"font-medium mb-2",children:"Course Information"}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Location: ",k.location,(0,Et.jsx)("br",{}),"Start Date: ",new Date(k.startDate).toLocaleDateString(),(0,Et.jsx)("br",{}),"End Date: ",new Date(k.endDate).toLocaleDateString(),(0,Et.jsx)("br",{}),"Instructor: ",(null===(t=k.instructor)||void 0===t?void 0:t.displayName)||(null===d||void 0===d?void 0:d.name)||"Unknown","(",(null===(n=k.instructor)||void 0===n?void 0:n.email)||(null===d||void 0===d?void 0:d.email)||"No email",")",(0,Et.jsx)("br",{}),"Students: ",(null===(s=k.students)||void 0===s?void 0:s.length)||0,(0,Et.jsx)("br",{}),"Assistants: ",(null===(i=k.assistants)||void 0===i?void 0:i.length)||0,(0,Et.jsx)("br",{}),"Training Record: ",(null===(a=k.trainingRecord)||void 0===a?void 0:a.name)||"None",(0,Et.jsx)("br",{})]})]}),(0,Et.jsxs)("div",{className:"border-t pt-4",children:[(0,Et.jsx)("h4",{className:"text-md font-semibold mb-4",children:"Training Record"}),(0,Et.jsx)("div",{className:"bg-white border rounded p-4",children:k.trainingRecord?(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"font-medium",children:k.trainingRecord.name}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:k.trainingRecord.description})]}),(0,Et.jsx)("button",{onClick:()=>U(!0),className:"text-blue-600 text-sm",children:"Change"})]}):(0,Et.jsx)("button",{onClick:()=>U(!0),className:"w-full text-center text-blue-600 p-2 border border-dashed rounded hover:bg-blue-50",children:"Add Training Record"})})]}),(0,Et.jsxs)("div",{className:"border-t pt-4",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h4",{className:"text-md font-semibold",children:"Manage Course Users"}),(0,Et.jsxs)("select",{value:D,onChange:e=>N(e.target.value),className:"p-2 border rounded",children:[(0,Et.jsx)("option",{value:"student",children:"Add Student"}),(0,Et.jsx)("option",{value:"assistant",children:"Add Assistant"})]})]}),(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Search ".concat(D,"s by name or email"),className:"w-full p-2 border rounded",value:j,onChange:e=>{C(e.target.value),(async e=>{if(e.trim()){_(!0);try{const t=(0,Dt.rJ)(wt.db,"profiles"),n=e.toLowerCase(),r=await(0,Dt.GG)(t),s=[];r.forEach((e=>{var t,r,i,a;const o=e.data(),l=null===k||void 0===k||null===(t=k.students)||void 0===t?void 0:t.some((t=>t.uid===e.id)),c=null===k||void 0===k||null===(r=k.assistants)||void 0===r?void 0:r.some((t=>t.uid===e.id));l||c||"instructor"===o.role||"student"===D&&"assistant"===o.role||!(null!==(i=o.email)&&void 0!==i&&i.toLowerCase().includes(n)||null!==(a=o.name)&&void 0!==a&&a.toLowerCase().includes(n))||s.push({uid:e.id,email:o.email,phone:o.phone||"",displayName:o.name||"Unnamed User"})})),A(s)}catch(gb){console.error("Error searching for users:",gb),v("Failed to search for users")}finally{_(!1)}}else A([])})(e.target.value)}}),F?(0,Et.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:"Searching..."}):E.length>0?(0,Et.jsx)("div",{className:"mt-2 border rounded max-h-40 overflow-y-auto",children:E.map((e=>(0,Et.jsxs)("div",{className:"p-2 hover:bg-gray-50 flex justify-between items-center border-b last:border-b-0",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:e.displayName}),(0,Et.jsxs)("div",{className:"text-sm text-gray-600",children:[e.email,"student"===D&&e.phone&&(0,Et.jsxs)("div",{className:"text-gray-500",children:["Phone: ",e.phone]})]})]}),(0,Et.jsxs)("button",{onClick:()=>async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"student";try{const r=(0,Dt.H9)(wt.db,"profiles",e.uid),s=await(0,Dt.x7)(r),i=s.data(),a=(0,o.A)((0,o.A)({},e),{},{displayName:i.name||e.displayName||"Unnamed User",phone:i.phone||""}),l=(0,Dt.H9)(wt.db,"courses",k.id);let c;if("assistant"===t){const e=[...k.assistants||[],a];c=(0,o.A)((0,o.A)({},k),{},{assistants:e}),await(0,Dt.mZ)(l,{assistants:e})}else{const e=[...k.students||[],a];c=(0,o.A)((0,o.A)({},k),{},{students:e}),await(0,Dt.mZ)(l,{students:e})}if(m(h.map((e=>e.id===k.id?c:e))),S(c),A([]),C(""),s.exists())try{var n;const s=i.training||[],a={courseId:k.id,courseName:k.name,status:"active",startDate:k.startDate,endDate:k.endDate,location:k.location,role:t,instructorId:k.instructorId,instructorEmail:null===(n=k.instructor)||void 0===n?void 0:n.email,addedAt:(new Date).toISOString()};await(0,Dt.mZ)(r,{training:[...s,a]}),await(0,Dt.gS)((0,Dt.rJ)(wt.db,"notifications"),{type:"course_enrollment",toUser:e.uid,fromUser:d.uid,fromUserName:d.name||"Unknown Instructor",courseName:k.name,timestamp:(0,Dt.O5)(),read:!1})}catch(gb){throw console.error("Error updating training array:",gb),gb}}catch(gb){console.error("Error in addUserToCourse:",gb),v("Failed to add ".concat(t," to course"))}}(e,D),className:"text-blue-600 hover:text-blue-700 text-sm",children:["Add as ",D]})]},e.uid)))}):j&&(0,Et.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:"No users found"})]}),(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Course Assistants"}),(0,Et.jsx)("div",{className:"border rounded max-h-40 overflow-y-auto",children:(null===(l=k.assistants)||void 0===l?void 0:l.length)>0?k.assistants.map((e=>(0,Et.jsxs)("div",{className:"p-2 hover:bg-gray-50 flex justify-between items-center border-b last:border-b-0",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:e.displayName}),(0,Et.jsx)("div",{className:"text-sm text-gray-600",children:e.email})]}),(0,Et.jsxs)("div",{className:"flex gap-2",children:[(0,Et.jsx)("button",{onClick:()=>{P({isOpen:!0,course:k,recipient:e}),w(!1)},className:"text-blue-600 hover:text-blue-700 text-sm",children:"Message"}),(0,Et.jsx)("button",{onClick:()=>$(e,"assistant"),className:"text-red-600 hover:text-red-700 text-sm",children:"Remove"})]})]},e.uid))):(0,Et.jsx)("div",{className:"p-4 text-sm text-gray-600 text-center",children:"No assistants assigned"})})]}),(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Enrolled Students"}),(0,Et.jsx)("div",{className:"border rounded max-h-60 overflow-y-auto",children:(null===(c=k.students)||void 0===c?void 0:c.length)>0?k.students.map((e=>(0,Et.jsxs)("div",{className:"p-2 hover:bg-gray-50 flex justify-between items-start border-b last:border-b-0",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:e.displayName}),(0,Et.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[e.email&&(0,Et.jsxs)("div",{children:[e.email,e.hideEmail&&" (Hidden from other students)"]}),e.phone&&(0,Et.jsxs)("div",{children:["Phone: ",e.phone,e.hidePhone&&" (Hidden from other students)"]})]}),k.trainingRecord&&(0,Et.jsxs)("div",{className:"text-sm font-medium text-gray-900 mt-1",children:["Progress: ",J(e,k),"% Complete"]})]}),(0,Et.jsxs)("div",{className:"flex gap-2",children:[k&&k.trainingRecord&&(0,Et.jsx)("button",{onClick:()=>{K(e),W(!0)},className:"text-green-600 hover:text-green-700 text-sm",children:"Training Record"}),(0,Et.jsx)("button",{onClick:()=>{P({isOpen:!0,course:k,recipient:e}),w(!1)},className:"text-blue-600 hover:text-blue-700 text-sm",children:"Message"}),(0,Et.jsx)("button",{onClick:()=>$(e,"student"),className:"text-red-600 hover:text-red-700 text-sm",children:"Remove"})]})]},e.uid))):(0,Et.jsx)("div",{className:"p-4 text-sm text-gray-600 text-center",children:"No students enrolled yet"})})]})]}),(0,Et.jsxs)("div",{className:"border-t pt-4 space-y-2",children:[(0,Et.jsx)("button",{onClick:()=>{P({isOpen:!0,course:k,recipient:null}),w(!1)},className:"w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700",children:"Message Course"}),(0,Et.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this course? This action cannot be undone."))try{const t=(0,Dt.H9)(wt.db,"courses",e),n=await(0,Dt.x7)(t);if(n.exists()){const r=n.data(),s=[];r.students&&r.students.length>0&&r.students.forEach((t=>{const n=(0,Dt.H9)(wt.db,"profiles",t.uid);s.push((0,Dt.x7)(n).then((t=>{if(t.exists()){const r=(t.data().training||[]).filter((t=>t.courseId!==e));return(0,Dt.mZ)(n,{training:r})}})))})),r.assistants&&r.assistants.length>0&&r.assistants.forEach((t=>{const n=(0,Dt.H9)(wt.db,"profiles",t.uid);s.push((0,Dt.x7)(n).then((t=>{if(t.exists()){const r=(t.data().training||[]).filter((t=>t.courseId!==e));return(0,Dt.mZ)(n,{training:r})}})))})),await Promise.all(s),await(0,Dt.kd)(t),m(h.filter((t=>t.id!==e))),w(!1),S(null)}}catch(gb){console.error("Error deleting course:",gb),v("Failed to delete course")}})(k.id),className:"w-full bg-red-600 text-white p-2 rounded hover:bg-red-700",children:"Delete Course"}),"active"===k.status&&(0,Et.jsx)("button",{onClick:()=>{Z(k.id),w(!1),S(null)},className:"w-full bg-green-600 text-white p-2 rounded hover:bg-green-700",children:"Mark as Complete"})]})]})}),R.course&&(0,Et.jsx)($c,{context:R.course,contextType:"course",isOpen:R.isOpen,onClose:()=>{P({isOpen:!1,course:null,recipient:null})},recipient:R.recipient,defaultTab:R.recipient?"private":"discussion"}),H&&G&&(0,Et.jsx)(lu,{isOpen:H,onClose:()=>{W(!1),K(null)},student:G,course:k,trainingRecord:k.trainingRecord,instructorProfile:d,onProgressUpdate:e=>{S(e),m(h.map((t=>t.id===e.id?e:t)))}}),O&&L&&(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsx)("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:(0,Et.jsx)(du,{course:L,onSubmit:async e=>{try{const t=L.id,n=(new Date).toISOString(),r=(0,Dt.H9)(wt.db,"courses",t),s=L.students.map((async e=>{const r=(0,Dt.H9)(wt.db,"profiles",e.uid),s=await(0,Dt.x7)(r);if(s.exists()){const e=s.data().training.map((e=>e.courseId===t?(0,o.A)((0,o.A)({},e),{},{status:"completed",completedAt:n}):e));return(0,Dt.mZ)(r,{training:e})}}));if(L.assistants){const e=L.assistants.map((async e=>{const r=(0,Dt.H9)(wt.db,"profiles",e.uid),s=await(0,Dt.x7)(r);if(s.exists()){const e=s.data().training.map((e=>e.courseId===t?(0,o.A)((0,o.A)({},e),{},{status:"completed",completedAt:n}):e));return(0,Dt.mZ)(r,{training:e})}}));s.push(...e)}await(0,Dt.mZ)(r,{status:"completed",completedAt:n,courseEndReport:e}),m(h.map((r=>r.id===t?(0,o.A)((0,o.A)({},r),{},{status:"completed",completedAt:n,courseEndReport:e}):r))),M(!1),B(null),w(!1),S(null)}catch(gb){console.error("Error completing course:",gb),v("Failed to complete course")}},onCancel:()=>{M(!1),B(null)}})})}),(0,Et.jsx)(au,{isOpen:z,onClose:()=>U(!1),onSelect:e=>{V(e),U(!1)}})]})},mu=e=>{const t="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let n="";for(let r=0;r<e;r++)n+=t.charAt(Math.floor(32*Math.random()));return n},fu=async(e,t)=>{const n=(0,Dt.rJ)(e,"profiles"),r=(0,Dt.P)(n,(0,Dt._M)("instructorSignature.code","==",t));return!(await(0,Dt.GG)(r)).empty},pu=()=>{var e;const{user:t}=kt(),[n,s]=(0,r.useState)(!0),[i,a]=(0,r.useState)(""),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)("courses"),[h,m]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{if(null!==t&&void 0!==t&&t.uid)try{const e=(0,Dt.H9)(wt.db,"profiles",t.uid),n=await(0,Dt.x7)(e);if(n.exists()){const r=n.data();c((0,o.A)((0,o.A)({},r),{},{uid:t.uid})),r.role&&"instructor"===r.role||await(0,Dt.mZ)(e,{role:"instructor"})}}catch(gb){console.error("Error initializing dashboard:",gb),a("Error loading instructor dashboard")}finally{s(!1)}})()}),[t]);if(n)return(0,Et.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Et.jsx)("div",{className:"text-gray-600",children:"Loading..."})});if(i)return(0,Et.jsx)("div",{className:"max-w-2xl mx-auto p-4",children:(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,Et.jsx)("p",{className:"text-red-600",children:i})})});const f=null===l||void 0===l||null===(e=l.instructorSignature)||void 0===e?void 0:e.code;return(0,Et.jsx)("div",{className:"max-w-6xl mx-auto p-4",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Et.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,Et.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Instructor Dashboard"})}),(0,Et.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Instructor Signature"}),f?(0,Et.jsxs)("div",{className:"space-y-2",children:[(0,Et.jsx)("p",{className:"text-gray-600",children:"Your unique instructor signature is:"}),(0,Et.jsxs)("div",{className:"bg-white p-4 rounded-md border border-gray-200 flex items-center",children:[(0,Et.jsx)("span",{className:"font-mono text-lg font-bold tracking-wider",children:l.instructorSignature.code}),(0,Et.jsx)("div",{className:"ml-4 text-sm text-gray-500",children:"Use this signature to sign certification documents and training records."})]}),(0,Et.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Created on ",new Date(l.instructorSignature.createdAt).toLocaleDateString()]})]}):(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsx)("p",{className:"text-gray-600",children:"You need to generate a unique instructor signature to sign certification documents and training records."}),(0,Et.jsx)("button",{onClick:async()=>{if(null!==t&&void 0!==t&&t.uid)try{m(!0);const e=await(async e=>{let t,n=!1;for(;!n;)t=mu(8),n=!await fu(e,t);return t})(wt.db),n=(0,Dt.H9)(wt.db,"profiles",t.uid);await(0,Dt.mZ)(n,{instructorSignature:{code:e,createdAt:(new Date).toISOString()}}),c((t=>(0,o.A)((0,o.A)({},t),{},{instructorSignature:{code:e,createdAt:(new Date).toISOString()}})))}catch(gb){console.error("Error generating signature:",gb),a("Failed to generate signature. Please try again.")}finally{m(!1)}},disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50",children:h?"Generating...":"Create Signature"})]})]}),(0,Et.jsx)("div",{className:"mb-6 border-b",children:(0,Et.jsxs)("nav",{className:"flex space-x-8","aria-label":"Dashboard sections",children:[(0,Et.jsx)("button",{onClick:()=>d("courses"),className:"pb-4 px-1 border-b-2 font-medium text-sm ".concat("courses"===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Courses"}),(0,Et.jsx)("button",{onClick:()=>d("trips"),className:"pb-4 px-1 border-b-2 font-medium text-sm ".concat("trips"===u?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:"Trips"})]})}),"courses"===u?(0,Et.jsx)(hu,{user:t,instructorProfile:l}):(0,Et.jsx)(su,{user:t,instructorProfile:l})]})})},gu=Mt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),vu=Mt("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]),xu=Mt("Anchor",[["path",{d:"M12 22V8",key:"qkxhtm"}],["path",{d:"M5 12H2a10 10 0 0 0 20 0h-3",key:"1hv3nh"}],["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}]]),yu=Mt("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),bu=Mt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),wu=e=>{switch(e){case"anchor":return(0,Et.jsx)(xu,{size:20,className:"text-blue-500 flex-shrink-0"});case"compass":case"navigation":return(0,Et.jsx)(yu,{size:20,className:"text-blue-500 flex-shrink-0"});case"thermometer":return(0,Et.jsx)(bu,{size:20,className:"text-blue-500 flex-shrink-0"});case"fish":case"weather":case"marine":return(0,Et.jsx)(nn,{size:20,className:"text-blue-500 flex-shrink-0"});case"certification":return(0,Et.jsx)(rn,{size:20,className:"text-blue-500 flex-shrink-0"});default:return(0,Et.jsx)(vu,{size:20,className:"text-blue-500 flex-shrink-0"})}},Du=e=>{let{quizCategories:t,setQuizCategories:n,quizzes:s,setQuizzes:i,db:a}=e;const[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)({title:"",description:"",icon:"book"}),[h,m]=(0,r.useState)(!1);return(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Quiz Categories"}),(0,Et.jsxs)(Kc,{onClick:()=>c(!0),className:"flex items-center gap-2 text-sm sm:text-base",size:"sm",children:[(0,Et.jsx)(gu,{size:16}),(0,Et.jsx)("span",{className:"hidden sm:inline",children:"Add Category"}),(0,Et.jsx)("span",{className:"sm:hidden",children:"Add"})]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[t.map((e=>(0,Et.jsxs)("div",{className:"bg-white border rounded-lg p-3 sm:p-4 shadow-sm hover:shadow-md transition-shadow duration-200 relative",children:[(0,Et.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,Et.jsxs)("h4",{className:"text-base sm:text-lg font-semibold flex items-center pr-6 truncate",children:[wu(e.icon),(0,Et.jsx)("span",{className:"ml-2 truncate",children:e.title})]}),(0,Et.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this category? This will delete all quizzes in this category as well."))try{await(0,Dt.kd)((0,Dt.H9)(a,"quizCategories",e));const r=s.filter((t=>t.categoryId===e));for(const e of r)await(0,Dt.kd)((0,Dt.H9)(a,"quizzes",e.id));n(t.filter((t=>t.id!==e))),i(s.filter((t=>t.categoryId!==e)))}catch(gb){console.error("Error deleting category:",gb),alert("Error deleting category. Please try again.")}})(e.id),className:"text-red-500 hover:text-red-700 absolute top-3 right-3","aria-label":"Delete ".concat(e.title," category"),children:(0,Et.jsx)(zt,{size:16})})]}),(0,Et.jsx)("p",{className:"text-gray-600 text-xs sm:text-sm mb-2 line-clamp-2",children:e.description}),(0,Et.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Et.jsxs)("p",{className:"text-xs sm:text-sm",children:[(0,Et.jsx)("span",{className:"font-medium",children:e.quizCount||0})," ",1===e.quizCount?"quiz":"quizzes"]}),e.quizCount>0&&(0,Et.jsx)("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs text-blue-700 ring-1 ring-inset ring-blue-600/20",children:"Active"})]})]},e.id))),0===t.length&&(0,Et.jsxs)("div",{className:"col-span-full text-center py-8 bg-gray-50 rounded-lg",children:[(0,Et.jsx)(vu,{size:36,className:"mx-auto text-gray-400 mb-2"}),(0,Et.jsx)("p",{className:"text-gray-500 text-sm",children:"No categories available. Create your first category!"})]})]})]}),(0,Et.jsx)(oc,{open:l,onOpenChange:c,children:(0,Et.jsxs)(hc,{className:"bg-white p-0 rounded-lg max-w-md w-full mx-auto",children:[(0,Et.jsxs)("div",{className:"border-b p-4 bg-white rounded-t-lg flex items-center justify-between",children:[(0,Et.jsx)(pc,{className:"text-lg font-semibold",children:"Add New Quiz Category"}),(0,Et.jsx)(uc,{className:"h-6 w-6 rounded-full flex items-center justify-center text-gray-500 hover:text-gray-800",children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"p-5 bg-white space-y-4",children:[(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Category Title ",(0,Et.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Et.jsx)("input",{type:"text",value:u.title,onChange:e=>d((0,o.A)((0,o.A)({},u),{},{title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g. Dive Equipment"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,Et.jsx)("textarea",{value:u.description,onChange:e=>d((0,o.A)((0,o.A)({},u),{},{description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",rows:"3",placeholder:"Describe this quiz category"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icon"}),(0,Et.jsxs)("select",{value:u.icon,onChange:e=>d((0,o.A)((0,o.A)({},u),{},{icon:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,Et.jsx)("option",{value:"book",children:"Book"}),(0,Et.jsx)("option",{value:"anchor",children:"Anchor"}),(0,Et.jsx)("option",{value:"compass",children:"Compass"}),(0,Et.jsx)("option",{value:"thermometer",children:"Thermometer"}),(0,Et.jsx)("option",{value:"fish",children:"Fish"}),(0,Et.jsx)("option",{value:"weather",children:"Weather"}),(0,Et.jsx)("option",{value:"navigation",children:"Navigation"}),(0,Et.jsx)("option",{value:"marine",children:"Marine"}),(0,Et.jsx)("option",{value:"certification",children:"Certification"})]}),(0,Et.jsxs)("div",{className:"mt-2 flex items-center",children:[(0,Et.jsx)("span",{className:"mr-2 text-sm text-gray-600",children:"Preview:"}),wu(u.icon)]})]})]}),(0,Et.jsxs)("div",{className:"flex justify-end pt-4 space-x-3",children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>c(!1),className:"px-4",disabled:h,children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:async()=>{if(u.title.trim()){m(!0);try{const e=u.title.toLowerCase().replace(/\s+/g,"-");await(0,Dt.BN)((0,Dt.H9)(a,"quizCategories",e),{id:e,title:u.title,description:u.description,icon:u.icon,quizCount:0}),n([...t,{id:e,title:u.title,description:u.description,icon:u.icon,quizCount:0}]),d({title:"",description:"",icon:"book"}),c(!1)}catch(gb){console.error("Error creating category:",gb),alert("Error creating category. Please try again.")}finally{m(!1)}}},disabled:!u.title||h,className:"px-4",children:h?(0,Et.jsxs)("span",{className:"flex items-center",children:[(0,Et.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Et.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Et.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Category"})]})]})]})})]})},Nu=Mt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),ju=e=>{let{quizzes:t,setQuizzes:n,quizCategories:s,setQuizCategories:i,db:a,storage:l,user:c}=e;const[u,d]=(0,r.useState)(!1),[h,m]=(0,r.useState)(!1),[f,p]=(0,r.useState)(null),[g,v]=(0,r.useState)({title:"",categoryId:"",difficulty:"beginner",certificationLevel:"all",questions:[{question:"",imageUrl:null,answers:["","","",""],correctAnswer:0,explanation:""}]}),[x,y]=(0,r.useState)(0),[b,w]=(0,r.useState)({}),[D,N]=(0,r.useState)(!1),j=()=>{if(!g.title.trim())return alert("Please enter a quiz title"),!1;if(!g.categoryId)return alert("Please select a category"),!1;if(0===g.questions.length)return alert("Please add at least one question"),!1;for(let e=0;e<g.questions.length;e++){const t=g.questions[e];if(!t.question.trim())return alert("Question ".concat(e+1," is empty. Please enter a question.")),!1;if(t.answers.some((e=>!e.trim())))return alert("Question ".concat(e+1," has empty answer options. Please fill all answers.")),!1}return!0},C=(e,t,n)=>{const r=[...g.questions];if("answer"===t){const[t,s]=n;r[e].answers[t]=s}else r[e][t]=n;v((0,o.A)((0,o.A)({},g),{},{questions:r}))};return(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Quizzes"}),(0,Et.jsxs)(Kc,{onClick:()=>{v({title:"",categoryId:s.length>0?s[0].id:"",difficulty:"beginner",certificationLevel:"all",questions:[{question:"",imageUrl:null,answers:["","","",""],correctAnswer:0,explanation:""}]}),y(0),d(!0)},className:"flex items-center gap-2 text-sm sm:text-base",size:"sm",disabled:0===s.length,children:[(0,Et.jsx)(gu,{size:16}),(0,Et.jsx)("span",{className:"hidden sm:inline",children:"Add Quiz"}),(0,Et.jsx)("span",{className:"sm:hidden",children:"Add"})]})]}),0===s.length&&(0,Et.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4 flex items-start",children:[(0,Et.jsx)(Yt,{size:20,className:"text-amber-500 mt-1 mr-3 flex-shrink-0"}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-amber-800 font-medium text-sm",children:"No categories available"}),(0,Et.jsx)("p",{className:"text-amber-700 text-xs mt-1",children:"Please create at least one category before adding quizzes."})]})]}),(0,Et.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[t.map((e=>{var r,l;const c=s.find((t=>t.id===e.categoryId));return(0,Et.jsx)("div",{className:"bg-white border rounded-lg p-3 sm:p-4 shadow-sm hover:shadow-md transition-shadow duration-200",children:(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start",children:[(0,Et.jsxs)("div",{className:"pr-8 sm:pr-0",children:[(0,Et.jsx)("h4",{className:"text-base sm:text-lg font-semibold text-gray-900",children:e.title}),(0,Et.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:["Category: ",(null===c||void 0===c?void 0:c.title)||"Unknown"]}),(0,Et.jsxs)("div",{className:"flex flex-wrap mt-2 gap-2 sm:gap-3",children:[(0,Et.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:e.difficulty.charAt(0).toUpperCase()+e.difficulty.slice(1)}),e.certificationLevel&&"all"!==e.certificationLevel&&(0,Et.jsx)("span",{className:"bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded",children:e.certificationLevel.charAt(0).toUpperCase()+e.certificationLevel.slice(1)}),(0,Et.jsxs)("span",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:[e.questionCount," ",1===e.questionCount?"question":"questions"]}),(0,Et.jsxs)("span",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:[(null===(r=e.completedBy)||void 0===r?void 0:r.length)||0," ",1===((null===(l=e.completedBy)||void 0===l?void 0:l.length)||0)?"completion":"completions"]})]})]}),(0,Et.jsxs)("div",{className:"absolute top-3 right-3 sm:relative sm:top-0 sm:right-0 flex sm:flex-col space-x-2 sm:space-x-0 sm:space-y-2",children:[(0,Et.jsx)("button",{onClick:()=>(e=>{p(e),v({title:e.title,categoryId:e.categoryId,difficulty:e.difficulty,certificationLevel:e.certificationLevel||"all",questions:[...e.questions]}),y(0),m(!0)})(e),className:"text-blue-500 hover:text-blue-700 p-1","aria-label":"Edit ".concat(e.title),children:(0,Et.jsx)(Nu,{size:16})}),(0,Et.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this quiz?"))try{const r=t.find((t=>t.id===e));if(await(0,Dt.kd)((0,Dt.H9)(a,"quizzes",e)),r){const e=s.find((e=>e.id===r.categoryId));if(e&&e.quizCount>0){const t=(0,Dt.H9)(a,"quizCategories",e.id);await(0,Dt.mZ)(t,{quizCount:e.quizCount-1}),i(s.map((t=>t.id===e.id?(0,o.A)((0,o.A)({},t),{},{quizCount:Math.max(0,t.quizCount-1)}):t)))}}n(t.filter((t=>t.id!==e)))}catch(gb){console.error("Error deleting quiz:",gb),alert("Error deleting quiz. Please try again.")}})(e.id),className:"text-red-500 hover:text-red-700 p-1","aria-label":"Delete ".concat(e.title),children:(0,Et.jsx)(zt,{size:16})})]})]})},e.id)})),0===t.length&&s.length>0&&(0,Et.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,Et.jsx)(vu,{size:36,className:"mx-auto text-gray-400 mb-3"}),(0,Et.jsx)("p",{className:"text-gray-500",children:"No quizzes available. Create your first quiz!"})]})]})]}),(0,Et.jsx)(oc,{open:u||h,onOpenChange:()=>{d(!1),m(!1)},children:(0,Et.jsxs)(hc,{className:"bg-white p-0 rounded-lg max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,Et.jsxs)("div",{className:"border-b p-4 bg-white rounded-t-lg sticky top-0 z-10 flex justify-between items-center",children:[(0,Et.jsx)(pc,{className:"text-xl font-semibold",children:u?"Add New Quiz":"Edit Quiz"}),(0,Et.jsx)(uc,{className:"h-6 w-6 rounded-full flex items-center justify-center text-gray-500 hover:text-gray-800",children:"\xd7"})]}),(0,Et.jsxs)("div",{className:"p-5 overflow-y-auto flex-grow space-y-5",children:[(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Quiz Title ",(0,Et.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Et.jsx)("input",{type:"text",value:g.title,onChange:e=>v((0,o.A)((0,o.A)({},g),{},{title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g. Basic Scuba Equipment"})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Category ",(0,Et.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Et.jsx)("select",{value:g.categoryId,onChange:e=>v((0,o.A)((0,o.A)({},g),{},{categoryId:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:0===s.length?(0,Et.jsx)("option",{value:"",children:"No categories available"}):s.map((e=>(0,Et.jsx)("option",{value:e.id,children:e.title},e.id)))})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Difficulty"}),(0,Et.jsxs)("select",{value:g.difficulty,onChange:e=>v((0,o.A)((0,o.A)({},g),{},{difficulty:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,Et.jsx)("option",{value:"beginner",children:"Beginner"}),(0,Et.jsx)("option",{value:"intermediate",children:"Intermediate"}),(0,Et.jsx)("option",{value:"advanced",children:"Advanced"})]})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Certification Level"}),(0,Et.jsxs)("select",{value:g.certificationLevel,onChange:e=>v((0,o.A)((0,o.A)({},g),{},{certificationLevel:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,Et.jsx)("option",{value:"all",children:"All Levels"}),(0,Et.jsx)("option",{value:"openwater",children:"Open Water"}),(0,Et.jsx)("option",{value:"advanced",children:"Advanced Open Water"}),(0,Et.jsx)("option",{value:"rescue",children:"Rescue Diver"}),(0,Et.jsx)("option",{value:"divemaster",children:"Divemaster"}),(0,Et.jsx)("option",{value:"instructor",children:"Instructor"})]})]})]}),(0,Et.jsxs)("div",{className:"border-t pt-4",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h4",{className:"text-lg font-medium",children:"Questions"}),(0,Et.jsxs)("div",{className:"text-sm text-gray-600",children:[g.questions.length," ",1===g.questions.length?"question":"questions"]})]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[g.questions.map(((e,t)=>(0,Et.jsxs)("div",{className:"border rounded-lg relative",children:[(0,Et.jsxs)("div",{className:"p-3 sm:p-4 cursor-pointer flex justify-between items-center ".concat(x===t?"bg-blue-50 border-b":""),onClick:()=>(e=>{y(x===e?-1:e)})(t),children:[(0,Et.jsxs)("div",{className:"flex-grow pr-12",children:[(0,Et.jsx)("div",{className:"font-medium text-sm sm:text-base",children:e.question?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("span",{className:"text-gray-500",children:["Q",t+1,":"]})," ",e.question]}):(0,Et.jsxs)("span",{className:"text-gray-400 italic",children:["Question ",t+1," (No text yet)"]})}),e.imageUrl&&(0,Et.jsx)("div",{className:"text-xs text-green-600 mt-1",children:(0,Et.jsxs)("span",{className:"flex items-center",children:[(0,Et.jsx)(xc,{size:12,className:"mr-1"})," Image attached"]})})]}),(0,Et.jsxs)("div",{className:"absolute top-3 right-3 flex items-center space-x-2",children:[g.questions.length>1&&(0,Et.jsx)("button",{onClick:e=>{e.stopPropagation(),(e=>{const t=[...g.questions];t.splice(e,1),v((0,o.A)((0,o.A)({},g),{},{questions:t})),x>=t.length&&y(Math.max(0,t.length-1))})(t)},className:"text-red-500 hover:text-red-700 p-1","aria-label":"Remove question ".concat(t+1),children:(0,Et.jsx)(zt,{size:16})}),(0,Et.jsx)("div",{className:"text-blue-500",children:x===t?(0,Et.jsx)(us,{size:18}):(0,Et.jsx)(ds,{size:18})})]})]}),x===t&&(0,Et.jsxs)("div",{className:"p-3 sm:p-4 space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Question Text ",(0,Et.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Et.jsx)("input",{type:"text",value:e.question,onChange:e=>C(t,"question",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g. What is the purpose of a BCD?"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Image (optional)"}),e.imageUrl?(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("img",{src:e.imageUrl,alt:"Question",className:"w-full h-40 object-cover rounded-md mb-2"}),(0,Et.jsx)("button",{type:"button",onClick:()=>(e=>{const t=[...g.questions];t[e].imageUrl=null,v((0,o.A)((0,o.A)({},g),{},{questions:t}))})(t),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600","aria-label":"Remove image",children:(0,Et.jsx)(zt,{size:14})})]}):(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("input",{type:"file",accept:"image/*",id:"image-upload-".concat(t),className:"hidden",onChange:e=>((e,t)=>{if(!t)return;const n=(0,Ft.KR)(l,"quiz_images/".concat(Date.now(),"_").concat(t.name)),r=(0,Ft.bp)(n,t);w((t=>(0,o.A)((0,o.A)({},t),{},{[e]:0}))),r.on("state_changed",(t=>{const n=t.bytesTransferred/t.totalBytes*100;w((t=>(0,o.A)((0,o.A)({},t),{},{[e]:n})))}),(t=>{console.error("Error uploading image:",t),w((t=>(0,o.A)((0,o.A)({},t),{},{[e]:null})))}),(()=>{(0,Ft.qk)(r.snapshot.ref).then((t=>{const n=[...g.questions];n[e].imageUrl=t,v((0,o.A)((0,o.A)({},g),{},{questions:n})),w((t=>(0,o.A)((0,o.A)({},t),{},{[e]:null})))}))}))})(t,e.target.files[0])}),(0,Et.jsxs)("label",{htmlFor:"image-upload-".concat(t),className:"cursor-pointer px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 flex items-center text-sm",children:[(0,Et.jsx)(xc,{size:16,className:"mr-2"}),"Select Image"]}),null!=b[t]&&(0,Et.jsxs)("div",{className:"ml-4 flex-1",children:[(0,Et.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Et.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(b[t],"%")}})}),(0,Et.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[Math.round(b[t]),"% uploaded"]})]})]}),(0,Et.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Add an image to enhance your question (e.g., equipment identification)"})]}),(0,Et.jsxs)("div",{className:"space-y-3",children:[(0,Et.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Answer Options ",(0,Et.jsx)("span",{className:"text-red-500",children:"*"})]}),e.answers.map(((n,r)=>(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("input",{type:"radio",name:"correct-answer-".concat(t),checked:e.correctAnswer===r,onChange:()=>C(t,"correctAnswer",r),className:"mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500",id:"answer-".concat(t,"-").concat(r)}),(0,Et.jsx)("input",{type:"text",value:n,onChange:e=>C(t,"answer",[r,e.target.value]),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Answer option ".concat(r+1)})]},r))),(0,Et.jsxs)("p",{className:"text-sm text-gray-500 italic flex items-center",children:[(0,Et.jsx)(Jt,{size:16,className:"mr-1 text-green-500"}),"Select the radio button next to the correct answer"]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Explanation (shown after answering)"}),(0,Et.jsx)("textarea",{value:e.explanation,onChange:e=>C(t,"explanation",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",rows:"2",placeholder:"Explain why the correct answer is right"})]})]})]},t))),(0,Et.jsxs)(Kc,{onClick:()=>{v((0,o.A)((0,o.A)({},g),{},{questions:[...g.questions,{question:"",imageUrl:null,answers:["","","",""],correctAnswer:0,explanation:""}]})),y(g.questions.length)},variant:"outline",className:"w-full flex items-center justify-center gap-2 py-3",children:[(0,Et.jsx)(gu,{size:16})," Add Another Question"]})]})]})]}),(0,Et.jsxs)("div",{className:"flex justify-end p-4 space-x-3 border-t sticky bottom-0 bg-white mt-auto",children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>{d(!1),m(!1)},disabled:D,children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:u?async()=>{if(j()){N(!0);try{const e=g.title.toLowerCase().replace(/\s+/g,"-"),r=g.questions.length;await(0,Dt.BN)((0,Dt.H9)(a,"quizzes",e),{id:e,title:g.title,categoryId:g.categoryId,difficulty:g.difficulty,certificationLevel:g.certificationLevel,questionCount:r,completedBy:[],questions:g.questions,createdAt:new Date});const l=s.find((e=>e.id===g.categoryId));if(l){const e=(0,Dt.H9)(a,"quizCategories",l.id);await(0,Dt.mZ)(e,{quizCount:(l.quizCount||0)+1}),i(s.map((e=>e.id===l.id?(0,o.A)((0,o.A)({},e),{},{quizCount:(e.quizCount||0)+1}):e)))}n([...t,{id:e,title:g.title,categoryId:g.categoryId,difficulty:g.difficulty,certificationLevel:g.certificationLevel,questionCount:r,completedBy:[],questions:g.questions,createdAt:new Date}]),v({title:"",categoryId:"",difficulty:"beginner",certificationLevel:"all",questions:[{question:"",imageUrl:null,answers:["","","",""],correctAnswer:0,explanation:""}]}),d(!1)}catch(gb){console.error("Error creating quiz:",gb),alert("Error creating quiz. Please try again.")}finally{N(!1)}}}:async()=>{if(j()){N(!0);try{if(!f)return;await(0,Dt.mZ)((0,Dt.H9)(a,"quizzes",f.id),{title:g.title,categoryId:g.categoryId,difficulty:g.difficulty,certificationLevel:g.certificationLevel,questionCount:g.questions.length,questions:g.questions,updatedAt:new Date}),n(t.map((e=>e.id===f.id?(0,o.A)((0,o.A)({},e),{},{title:g.title,categoryId:g.categoryId,difficulty:g.difficulty,certificationLevel:g.certificationLevel,questionCount:g.questions.length,questions:g.questions,updatedAt:new Date}):e))),m(!1),p(null)}catch(gb){console.error("Error updating quiz:",gb),alert("Error updating quiz. Please try again.")}finally{N(!1)}}},disabled:D,children:D?(0,Et.jsxs)("span",{className:"flex items-center",children:[(0,Et.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Et.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Et.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u?"Creating...":"Updating..."]}):u?"Create Quiz":"Update Quiz"})]})]})})]})},Cu=Mt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),Eu=e=>{switch(e){case"html":case"iframe":return(0,Et.jsx)(tn,{size:12,className:"flex-shrink-0"});case"image":return(0,Et.jsx)(xc,{size:12,className:"flex-shrink-0"});default:return(0,Et.jsx)(wc,{size:12,className:"flex-shrink-0"})}},Au=e=>{let{learningResources:t,setLearningResources:n,db:s,storage:i,user:a}=e;const[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!1),[h,m]=(0,r.useState)(null),[f,p]=(0,r.useState)({title:"",description:"",category:"Dive Physics",icon:"book",content:"",contentType:"markdown",imageUrl:null,author:"",certificationLevel:"all",downloadUrl:"",relatedResources:[]}),[g,v]=(0,r.useState)({}),[x,y]=(0,r.useState)(!1),b=()=>f.title.trim()?!!(f.content.trim()||f.imageUrl||f.downloadUrl)||(alert("Please add some content, an image, or a downloadable file"),!1):(alert("Please enter a resource title"),!1),w=e=>{if(!e)return"Unknown date";try{return(e instanceof Dt.Dc?e.toDate():e instanceof Date?e:new Date(e)).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}catch(Jh){return console.error("Date formatting error:",Jh),"Invalid date"}};return(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-xl font-bold text-gray-800",children:"Learning Resources"}),(0,Et.jsxs)(Kc,{onClick:()=>{p({title:"",description:"",category:"Dive Physics",icon:"book",content:"",contentType:"markdown",imageUrl:null,author:a.email,certificationLevel:"all",downloadUrl:"",relatedResources:[]}),c(!0)},className:"flex items-center gap-2 text-sm sm:text-base",size:"sm",children:[(0,Et.jsx)(gu,{size:16}),(0,Et.jsx)("span",{className:"hidden sm:inline",children:"Add Resource"}),(0,Et.jsx)("span",{className:"sm:hidden",children:"Add"})]})]}),(0,Et.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[t.map((e=>(0,Et.jsx)("div",{className:"bg-white border rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 relative overflow-hidden",children:(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row",children:[e.imageUrl&&(0,Et.jsx)("div",{className:"w-full sm:w-1/4 max-w-xs",children:(0,Et.jsx)("img",{src:e.imageUrl,alt:e.title,className:"w-full h-32 sm:h-full object-cover"})}),(0,Et.jsx)("div",{className:"p-3 sm:p-4 flex-grow ".concat(e.imageUrl?"sm:w-3/4":"w-full"),children:(0,Et.jsx)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start",children:(0,Et.jsxs)("div",{className:"pr-10 sm:pr-0",children:[(0,Et.jsx)("h4",{className:"text-base sm:text-lg font-semibold text-gray-900",children:e.title}),(0,Et.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 line-clamp-2 mt-1 mb-2",children:e.description}),(0,Et.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-3 mb-2",children:[(0,Et.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded flex items-center",children:e.category}),(0,Et.jsxs)("span",{className:"flex items-center text-xs text-gray-600 bg-gray-100 px-2 py-1 rounded",children:[Eu(e.contentType),(0,Et.jsx)("span",{className:"ml-1",children:e.contentType.charAt(0).toUpperCase()+e.contentType.slice(1)})]}),e.downloadUrl&&(0,Et.jsxs)("span",{className:"flex items-center text-xs text-green-600 bg-green-50 px-2 py-1 rounded",children:[(0,Et.jsx)(Nc,{size:12,className:"mr-1"}),"Downloadable"]}),e.certificationLevel&&"all"!==e.certificationLevel&&(0,Et.jsxs)("span",{className:"inline-block bg-purple-100 text-purple-800 text-xs px-2 py-1 rounded",children:[e.certificationLevel.charAt(0).toUpperCase()+e.certificationLevel.slice(1)," Level"]})]}),(0,Et.jsxs)("div",{className:"text-xs text-gray-500 mt-1 flex items-center space-x-3",children:[(0,Et.jsxs)("span",{children:["By ",e.author||"Unknown"]}),(0,Et.jsxs)("span",{children:["Created ",w(e.createdAt)]}),(0,Et.jsxs)("span",{children:[e.viewCount||0," views"]})]})]})})}),(0,Et.jsxs)("div",{className:"absolute top-3 right-3 flex space-x-2",children:[(0,Et.jsx)("button",{onClick:()=>(e=>{m(e),p({title:e.title,description:e.description,category:e.category,icon:e.icon||"book",content:e.content,contentType:e.contentType||"markdown",imageUrl:e.imageUrl,author:e.author,certificationLevel:e.certificationLevel||"all",downloadUrl:e.downloadUrl||"",relatedResources:e.relatedResources||[]}),d(!0)})(e),className:"text-blue-500 hover:text-blue-700 p-1","aria-label":"Edit ".concat(e.title),children:(0,Et.jsx)(Nu,{size:16})}),(0,Et.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this resource?"))try{await(0,Dt.kd)((0,Dt.H9)(s,"learningResources",e)),n(t.filter((t=>t.id!==e)))}catch(gb){console.error("Error deleting resource:",gb),alert("Error deleting resource. Please try again.")}})(e.id),className:"text-red-500 hover:text-red-700 p-1","aria-label":"Delete ".concat(e.title),children:(0,Et.jsx)(zt,{size:16})})]})]})},e.id))),0===t.length&&(0,Et.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,Et.jsx)(wc,{size:36,className:"mx-auto text-gray-400 mb-3"}),(0,Et.jsx)("p",{className:"text-gray-500",children:"No learning resources available. Create your first resource!"})]})]})]}),(0,Et.jsx)(oc,{open:l||u,onOpenChange:()=>{c(!1),d(!1)},children:(0,Et.jsxs)(hc,{className:"bg-white p-0 rounded-lg max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,Et.jsxs)("div",{className:"border-b p-4 bg-white rounded-t-lg sticky top-0 z-10 flex justify-between items-center",children:[(0,Et.jsx)(pc,{className:"text-xl font-semibold",children:l?"Add New Learning Resource":"Edit Learning Resource"}),(0,Et.jsx)(uc,{className:"h-6 w-6 rounded-full flex items-center justify-center text-gray-500 hover:text-gray-800",children:"\xd7"})]}),(0,Et.jsx)("div",{className:"p-5 overflow-y-auto flex-grow space-y-5",children:(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Resource Title ",(0,Et.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,Et.jsx)("input",{type:"text",value:f.title,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g. Understanding Dive Tables"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,Et.jsx)("textarea",{value:f.description,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",rows:"2",placeholder:"Brief description of this resource"})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,Et.jsxs)("select",{value:f.category,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{category:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,Et.jsx)("option",{value:"Dive Physics",children:"Dive Physics"}),(0,Et.jsx)("option",{value:"Equipment",children:"Equipment"}),(0,Et.jsx)("option",{value:"Marine Life",children:"Marine Life"}),(0,Et.jsx)("option",{value:"Safety Procedures",children:"Safety Procedures"}),(0,Et.jsx)("option",{value:"Navigation",children:"Navigation"}),(0,Et.jsx)("option",{value:"Dive Planning",children:"Dive Planning"}),(0,Et.jsx)("option",{value:"Environment",children:"Environment"}),(0,Et.jsx)("option",{value:"Techniques",children:"Techniques"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Icon"}),(0,Et.jsxs)("select",{value:f.icon,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{icon:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,Et.jsx)("option",{value:"book",children:"Book"}),(0,Et.jsx)("option",{value:"compass",children:"Compass"}),(0,Et.jsx)("option",{value:"flask",children:"Flask"}),(0,Et.jsx)("option",{value:"droplet",children:"Droplet"}),(0,Et.jsx)("option",{value:"thermometer",children:"Thermometer"}),(0,Et.jsx)("option",{value:"waves",children:"Waves"}),(0,Et.jsx)("option",{value:"shield-alert",children:"Shield Alert"}),(0,Et.jsx)("option",{value:"anchor",children:"Anchor"})]})]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content Type"}),(0,Et.jsxs)("select",{value:f.contentType,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{contentType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,Et.jsx)("option",{value:"markdown",children:"Markdown"}),(0,Et.jsx)("option",{value:"html",children:"HTML"}),(0,Et.jsx)("option",{value:"image",children:"Image URL"}),(0,Et.jsx)("option",{value:"iframe",children:"Embed (iframe)"}),(0,Et.jsx)("option",{value:"text",children:"Plain Text"})]}),(0,Et.jsxs)("div",{className:"flex items-center text-xs text-blue-600 mt-1",children:[(0,Et.jsx)(bu,{size:12,className:"mr-1"}),(0,Et.jsx)("span",{children:"markdown"===f.contentType?"Supports formatting like **bold** and *italic*":"html"===f.contentType?"Supports HTML tags for formatting":"iframe"===f.contentType?"For embedding videos or other content":"Simple text content"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Certification Level"}),(0,Et.jsxs)("select",{value:f.certificationLevel,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{certificationLevel:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[(0,Et.jsx)("option",{value:"all",children:"All Levels"}),(0,Et.jsx)("option",{value:"beginner",children:"Beginner"}),(0,Et.jsx)("option",{value:"intermediate",children:"Intermediate"}),(0,Et.jsx)("option",{value:"advanced",children:"Advanced"}),(0,Et.jsx)("option",{value:"professional",children:"Professional"})]})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Featured Image (optional)"}),f.imageUrl?(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("img",{src:f.imageUrl,alt:"Featured",className:"w-full h-40 object-cover rounded-md mb-2"}),(0,Et.jsx)("button",{type:"button",onClick:()=>p((0,o.A)((0,o.A)({},f),{},{imageUrl:null})),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600","aria-label":"Remove image",children:(0,Et.jsx)(zt,{size:14})})]}):(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("input",{type:"file",accept:"image/*",id:"resource-image-upload",className:"hidden",onChange:e=>(e=>{if(!e)return;const t=(0,Ft.KR)(i,"resource_images/".concat(Date.now(),"_").concat(e.name)),n=(0,Ft.bp)(t,e);v((e=>(0,o.A)((0,o.A)({},e),{},{resourceImage:0}))),n.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;v((e=>(0,o.A)((0,o.A)({},e),{},{resourceImage:t})))}),(e=>{console.error("Error uploading image:",e),v((e=>(0,o.A)((0,o.A)({},e),{},{resourceImage:null})))}),(()=>{(0,Ft.qk)(n.snapshot.ref).then((e=>{p((0,o.A)((0,o.A)({},f),{},{imageUrl:e})),v((e=>(0,o.A)((0,o.A)({},e),{},{resourceImage:null})))}))}))})(e.target.files[0])}),(0,Et.jsxs)("label",{htmlFor:"resource-image-upload",className:"cursor-pointer px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 flex items-center text-sm",children:[(0,Et.jsx)(xc,{size:16,className:"mr-2"}),"Select Image"]})]}),null!=g.resourceImage&&(0,Et.jsxs)("div",{className:"flex-1",children:[(0,Et.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Et.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(g.resourceImage,"%")}})}),(0,Et.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[Math.round(g.resourceImage),"% uploaded"]})]})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Content","markdown"===f.contentType&&(0,Et.jsx)("span",{className:"text-xs text-blue-600 ml-2",children:"(Supports Markdown formatting)"}),"iframe"===f.contentType&&(0,Et.jsxs)("span",{className:"text-xs text-blue-600 ml-2 flex items-center",children:[(0,Et.jsx)(Cu,{size:12,className:"mr-1"}),"(Enter embed URL or full iframe code)"]})]}),(0,Et.jsx)("textarea",{value:f.content,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{content:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",rows:"10",placeholder:"markdown"===f.contentType?"# Title\nContent with **bold** and *italic* text":"html"===f.contentType?"<h1>Title</h1><p>Your content here</p>":"image"===f.contentType?"https://example.com/image.jpg":"iframe"===f.contentType?"https://www.youtube.com/embed/12345":"Your content here"}),"iframe"===f.contentType&&(0,Et.jsxs)("div",{className:"mt-1 p-2 bg-yellow-50 border border-yellow-200 rounded-md flex items-start",children:[(0,Et.jsx)(Yt,{size:16,className:"text-yellow-600 mt-0.5 mr-2 flex-shrink-0"}),(0,Et.jsxs)("p",{className:"text-xs text-yellow-800",children:["For YouTube videos, use the format: ",(0,Et.jsx)("code",{className:"bg-yellow-100 px-1 py-0.5 rounded",children:"https://www.youtube.com/embed/VIDEO_ID"})]})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Downloadable File (optional)"}),f.downloadUrl?(0,Et.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-md",children:[(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)(Nc,{size:18,className:"text-green-600 mr-2 flex-shrink-0"}),(0,Et.jsx)("span",{className:"text-sm text-gray-700 truncate max-w-xs",children:f.downloadUrl.split("/").pop()})]}),(0,Et.jsx)("button",{type:"button",onClick:()=>p((0,o.A)((0,o.A)({},f),{},{downloadUrl:""})),className:"text-red-500 hover:text-red-600 p-1","aria-label":"Remove downloadable file",children:(0,Et.jsx)(zt,{size:16})})]}):(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("input",{type:"file",id:"resource-file-upload",className:"hidden",onChange:e=>(e=>{if(!e)return;const t=(0,Ft.KR)(i,"resource_files/".concat(Date.now(),"_").concat(e.name)),n=(0,Ft.bp)(t,e);v((e=>(0,o.A)((0,o.A)({},e),{},{resourceFile:0}))),n.on("state_changed",(e=>{const t=e.bytesTransferred/e.totalBytes*100;v((e=>(0,o.A)((0,o.A)({},e),{},{resourceFile:t})))}),(e=>{console.error("Error uploading file:",e),v((e=>(0,o.A)((0,o.A)({},e),{},{resourceFile:null})))}),(()=>{(0,Ft.qk)(n.snapshot.ref).then((e=>{p((0,o.A)((0,o.A)({},f),{},{downloadUrl:e})),v((e=>(0,o.A)((0,o.A)({},e),{},{resourceFile:null})))}))}))})(e.target.files[0])}),(0,Et.jsxs)("label",{htmlFor:"resource-file-upload",className:"cursor-pointer px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 flex items-center text-sm",children:[(0,Et.jsx)(Nc,{size:16,className:"mr-2"}),"Select File"]})]}),null!=g.resourceFile&&(0,Et.jsxs)("div",{className:"flex-1",children:[(0,Et.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:(0,Et.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(g.resourceFile,"%")}})}),(0,Et.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[Math.round(g.resourceFile),"% uploaded"]})]})]}),(0,Et.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Upload PDF, DOCX, or other files that users can download"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Author"}),(0,Et.jsx)("input",{type:"text",value:f.author,onChange:e=>p((0,o.A)((0,o.A)({},f),{},{author:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:a.email})]})]})}),(0,Et.jsxs)("div",{className:"flex justify-between p-4 space-x-3 border-t sticky bottom-0 bg-white mt-auto",children:[(0,Et.jsxs)("div",{className:"flex items-center",children:[!f.content&&!f.imageUrl&&!f.downloadUrl&&(0,Et.jsxs)("div",{className:"flex items-center text-amber-600 text-xs",children:[(0,Et.jsx)(Yt,{size:14,className:"mr-1"}),(0,Et.jsx)("span",{children:"Add content, image, or file"})]}),(f.content||f.imageUrl||f.downloadUrl)&&(0,Et.jsxs)("div",{className:"flex items-center text-green-600 text-xs",children:[(0,Et.jsx)(Jt,{size:14,className:"mr-1"}),(0,Et.jsx)("span",{children:"Resource has content"})]})]}),(0,Et.jsxs)("div",{className:"flex space-x-3",children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>{c(!1),d(!1)},disabled:x,children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:l?async()=>{if(b()){y(!0);try{const e=f.title.toLowerCase().replace(/\s+/g,"-");await(0,Dt.BN)((0,Dt.H9)(s,"learningResources",e),{id:e,title:f.title,description:f.description,category:f.category,icon:f.icon,content:f.content,contentType:f.contentType,imageUrl:f.imageUrl,author:f.author||a.email,certificationLevel:f.certificationLevel,downloadUrl:f.downloadUrl,relatedResources:f.relatedResources||[],createdAt:Dt.Dc.now(),updatedAt:Dt.Dc.now(),viewCount:0}),n([...t,{id:e,title:f.title,description:f.description,category:f.category,icon:f.icon,content:f.content,contentType:f.contentType,imageUrl:f.imageUrl,author:f.author||a.email,certificationLevel:f.certificationLevel,downloadUrl:f.downloadUrl,relatedResources:f.relatedResources||[],createdAt:Dt.Dc.now(),updatedAt:Dt.Dc.now(),viewCount:0}]),p({title:"",description:"",category:"Dive Physics",icon:"book",content:"",contentType:"markdown",imageUrl:null,author:"",certificationLevel:"all",downloadUrl:"",relatedResources:[]}),c(!1)}catch(gb){console.error("Error creating resource:",gb),alert("Error creating resource. Please try again.")}finally{y(!1)}}}:async()=>{if(b()){y(!0);try{if(!h)return;await(0,Dt.mZ)((0,Dt.H9)(s,"learningResources",h.id),{title:f.title,description:f.description,category:f.category,icon:f.icon,content:f.content,contentType:f.contentType,imageUrl:f.imageUrl,author:f.author,certificationLevel:f.certificationLevel,downloadUrl:f.downloadUrl,relatedResources:f.relatedResources,updatedAt:Dt.Dc.now()}),n(t.map((e=>e.id===h.id?(0,o.A)((0,o.A)({},e),{},{title:f.title,description:f.description,category:f.category,icon:f.icon,content:f.content,contentType:f.contentType,imageUrl:f.imageUrl,author:f.author,certificationLevel:f.certificationLevel,downloadUrl:f.downloadUrl,relatedResources:f.relatedResources,updatedAt:Dt.Dc.now()}):e))),d(!1),m(null)}catch(gb){console.error("Error updating resource:",gb),alert("Error updating resource. Please try again.")}finally{y(!1)}}},disabled:x||!f.content&&!f.imageUrl&&!f.downloadUrl,children:x?(0,Et.jsxs)("span",{className:"flex items-center",children:[(0,Et.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,Et.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,Et.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l?"Creating...":"Updating..."]}):l?"Create Resource":"Update Resource"})]})]})]})})]})},ku=Mt("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]),Su=Mt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Fu=Mt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),_u=()=>{const[e,t]=(0,r.useState)(!1),[n,s]=(0,r.useState)(null),[i,a]=(0,r.useState)("");return(0,Et.jsxs)(Rc,{className:"bg-white shadow-sm border border-gray-100",children:[(0,Et.jsx)(Pc,{className:"pb-3 border-b bg-gradient-to-r from-blue-50 to-indigo-50",children:(0,Et.jsxs)(Oc,{className:"text-xl font-bold flex items-center",children:[(0,Et.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 mr-2 text-blue-600",children:[(0,Et.jsx)("path",{d:"M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h1"}),(0,Et.jsx)("path",{d:"M17 3h1a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-1"}),(0,Et.jsx)("path",{d:"M3 12v7a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,Et.jsx)("path",{d:"M12 12v8"}),(0,Et.jsx)("path",{d:"M8 16h8"})]}),"Knowledge Creator"]})}),(0,Et.jsxs)(Mc,{className:"pt-6",children:[(0,Et.jsx)("div",{className:"mb-6",children:(0,Et.jsx)(Kc,{onClick:async()=>{t(!0),a("FixCounts"),s(null);try{const e=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"quizCategories"))).docs.map((e=>(0,o.A)({id:e.id},e.data()))),t=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"quizzes"))).docs.map((e=>(0,o.A)({id:e.id,categoryId:e.data().categoryId},e.data()))),n={};e.forEach((e=>{n[e.id]=0})),t.forEach((e=>{e.categoryId&&n.hasOwnProperty(e.categoryId)&&n[e.categoryId]++}));let r=0;const i=[];for(const s of e){const e=s.quizCount||0,t=n[s.id]||0;if(e!==t){const n=(0,Dt.H9)(wt.db,"quizCategories",s.id);await(0,Dt.mZ)(n,{quizCount:t}),i.push('"'.concat(s.title,'": ').concat(e," \u2192 ").concat(t)),r++}}s(r>0?{success:!0,message:"Fixed ".concat(r," categories with incorrect quiz counts:\n").concat(i.join("\n"))}:{success:!0,message:"All quiz counts are correct. No updates needed."})}catch(e){console.error("Error fixing quiz counts:",e),s({success:!1,message:"Error: ".concat(e.message)})}finally{t(!1)}},disabled:e,className:"w-full h-12 relative overflow-hidden group bg-gray-100 hover:bg-gray-200 text-gray-800",variant:"outline",children:(0,Et.jsx)("div",{className:"relative z-10 flex items-center justify-center",children:e&&"FixCounts"===i?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Su,{className:"mr-2 h-5 w-5 animate-spin"}),(0,Et.jsx)("span",{children:"Fixing Quiz Counts..."})]}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Fu,{className:"w-5 h-5 mr-2 text-gray-600"}),(0,Et.jsx)("span",{children:"Fix Quiz Category Counts"})]})})})}),(0,Et.jsx)("div",{className:"text-center text-gray-400 py-8",children:(0,Et.jsx)("p",{children:"Add quiz creation buttons here when needed"})})]}),n&&(0,Et.jsx)(Lc,{className:"pt-0",children:(0,Et.jsxs)("div",{className:"p-4 rounded-md w-full mt-4 flex items-start ".concat(n.success?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"),children:[n.success?(0,Et.jsx)(on,{className:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0"}):(0,Et.jsx)(nn,{className:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0"}),(0,Et.jsx)("div",{className:"whitespace-pre-line",children:n.message})]})})]})},Tu=e=>{let{quizCategories:t,setQuizCategories:n,quizzes:s,setQuizzes:i,learningResources:a,setLearningResources:o,db:l,storage:c,user:u}=e;const[d,h]=(0,r.useState)("quizzes");return(0,Et.jsx)("div",{className:"p-4 pb-6",children:(0,Et.jsx)(Rc,{className:"bg-white border-0 shadow-sm mb-4",children:(0,Et.jsxs)(ss,{value:d,onValueChange:h,className:"w-full",children:[(0,Et.jsxs)(is,{className:"w-full flex border-b border-gray-200 justify-start",children:[(0,Et.jsxs)(as,{value:"quizzes",className:"flex items-center py-3 px-6 text-gray-700 data-[state=active]:border-b-2 data-[state=active]:border-blue-500 data-[state=active]:text-blue-700",children:[(0,Et.jsx)(ku,{size:18,className:"mr-2 hidden sm:inline"}),(0,Et.jsx)("span",{children:"Quiz Management"})]}),(0,Et.jsxs)(as,{value:"resources",className:"flex items-center py-3 px-6 text-gray-700 data-[state=active]:border-b-2 data-[state=active]:border-blue-500 data-[state=active]:text-blue-700",children:[(0,Et.jsx)(wc,{size:18,className:"mr-2 hidden sm:inline"}),(0,Et.jsx)("span",{children:"Learning Resources"})]})]}),(0,Et.jsxs)(os,{value:"quizzes",className:"pt-4",children:[(0,Et.jsx)("div",{className:"mb-6",children:(0,Et.jsx)(_u,{db:l})}),(0,Et.jsx)("div",{className:"mb-8",children:(0,Et.jsx)(Du,{quizCategories:t,setQuizCategories:n,quizzes:s,setQuizzes:i,db:l})}),(0,Et.jsx)("div",{children:(0,Et.jsx)(ju,{quizzes:s,setQuizzes:i,quizCategories:t,setQuizCategories:n,db:l,storage:c,user:u})})]}),(0,Et.jsx)(os,{value:"resources",className:"pt-4",children:(0,Et.jsx)(Au,{learningResources:a,setLearningResources:o,db:l,storage:c,user:u})})]})})})},Iu=Mt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),Ru=()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)(!0),[i,a]=(0,r.useState)(null),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(!1),[h,m]=(0,r.useState)("users"),[f,p]=(0,r.useState)(""),[g,v]=(0,r.useState)("all"),[x,y]=(0,r.useState)([]),[b,w]=(0,r.useState)([]),[D,N]=(0,r.useState)([]),{user:j}=kt(),C=de(),E=e=>e&&e.seconds?new Date(1e3*e.seconds).toLocaleDateString():"N/A",A=e=>{if(!e)return"";const t=e.trim().split(" ");return t.length>1?t[t.length-1]:e};(0,r.useEffect)((()=>{(async()=>{try{const e=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"profiles"))).docs.map((e=>(0,o.A)({id:e.id},e.data()))),n=(0,Dt.P)((0,Dt.rJ)(wt.db,"courses"),(0,Dt._M)("courseEndReport","!=",null)),r=await(0,Dt.GG)(n),s={};r.docs.forEach((e=>{const t=e.data();s[t.instructorId]||(s[t.instructorId]=[]),s[t.instructorId].push((0,o.A)({courseId:e.id},t))}));const i=e.map((e=>(0,o.A)((0,o.A)({},e),{},{courseEndReports:s[e.id]||[]}))),a=i.sort(((e,t)=>{var n,r,s,i,a,o;const l=null!==(n=e.managementRights)&&void 0!==n&&n.hasAccess?4:null!==(r=e.teamAccess)&&void 0!==r&&r.hasAccess?3:null!==(s=e.instructorAccess)&&void 0!==s&&s.hasAccess?2:1,c=null!==(i=t.managementRights)&&void 0!==i&&i.hasAccess?4:null!==(a=t.teamAccess)&&void 0!==a&&a.hasAccess?3:null!==(o=t.instructorAccess)&&void 0!==o&&o.hasAccess?2:1;if(l!==c)return c-l;const u=A(e.name||""),d=A(t.name||"");return u.localeCompare(d)}));t(a)}catch(gb){a("Error loading users"),console.error("Error:",gb)}finally{s(!1)}})()}),[]),(0,r.useEffect)((()=>{"knowledge"===h&&(async()=>{try{const e=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"quizCategories"))).docs.map((e=>(0,o.A)({id:e.id},e.data())));y(e);const t=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"quizzes"))).docs.map((e=>(0,o.A)({id:e.id},e.data())));w(t);const n=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"learningResources"))).docs.map((e=>(0,o.A)({id:e.id},e.data())));N(n)}catch(gb){console.error("Error loading data:",gb)}})()}),[h]);const k=(e,t)=>{var n,r;if(!e||!t||null===t||void 0===t||!t.trainingRecord||null===(n=t.studentRecords)||void 0===n||null===(r=n[e.uid])||void 0===r||!r.progress)return 0;const s=t.studentRecords[e.uid].progress;let i=0,a=0;return t.trainingRecord.sections.forEach((e=>{e.subsections?e.subsections.forEach((e=>{i+=e.skills.length,a+=Object.keys(s[e.title]||{}).length})):(i+=e.skills.length,a+=Object.keys(s[e.title]||{}).length)})),i>0?Math.round(a/i*100):0},S=async(n,r)=>{if(window.confirm(r?"Are you sure you want to revoke loyalty program admin access?":"Are you sure you want to grant loyalty program admin access?"))try{const s=(0,Dt.H9)(wt.db,"profiles",n);let i;i=r?{loyaltyAccess:null}:{loyaltyAccess:{hasAccess:!0,grantedAt:Dt.Dc.now(),grantedBy:j.email},joinDate:Dt.Dc.now(),lifetimePoints:0,redeemablePoints:0,lastExpirationCheck:Dt.Dc.now(),yearlyPointsEarned:{[(new Date).getFullYear()]:0}},await(0,Dt.mZ)(s,i),t(e.map((e=>e.id===n?(0,o.A)((0,o.A)({},e),i):e)))}catch(gb){a("Error updating loyalty program admin access"),console.error("Error:",gb)}},F=async(n,r)=>{if(window.confirm(r?"Are you sure you want to revoke instructor access?":"Are you sure you want to grant instructor access?"))try{const s=(0,Dt.H9)(wt.db,"profiles",n),i={instructorAccess:r?null:{hasAccess:!0,grantedAt:Dt.Dc.now(),grantedBy:j.email}};await(0,Dt.mZ)(s,i),t(e.map((e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{instructorAccess:i.instructorAccess}):e)))}catch(gb){a("Error updating instructor access"),console.error("Error:",gb)}},_=async(n,r)=>{if(window.confirm(r?"Are you sure you want to revoke team portal access?":"Are you sure you want to grant team portal access?"))try{const s=(0,Dt.H9)(wt.db,"profiles",n),i={teamAccess:r?null:{hasAccess:!0,grantedAt:Dt.Dc.now(),grantedBy:j.email}};await(0,Dt.mZ)(s,i),t(e.map((e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{teamAccess:i.teamAccess}):e)))}catch(gb){a("Error updating team access"),console.error("Error:",gb)}},T=async(n,r)=>{if(window.confirm(r?"Are you sure you want to revoke management rights?":"Are you sure you want to grant management rights?"))try{const s=(0,Dt.H9)(wt.db,"profiles",n),i={managementRights:r?null:{hasAccess:!0,grantedAt:Dt.Dc.now(),grantedBy:j.email}};await(0,Dt.mZ)(s,i),t(e.map((e=>e.id===n?(0,o.A)((0,o.A)({},e),{},{managementRights:i.managementRights}):e)))}catch(gb){a("Error updating management rights"),console.error("Error:",gb)}},I=async n=>{if(window.confirm("Are you sure you want to reset this instructor's signature? They will need to generate a new one before they can sign documents."))try{const r=(0,Dt.H9)(wt.db,"profiles",n);await(0,Dt.mZ)(r,{instructorSignature:(0,Dt.CL)(),instructorPin:(0,Dt.CL)()}),t(e.map((e=>{if(e.id===n){const t=(0,o.A)({},e);return delete t.instructorSignature,delete t.instructorPin,t}return e})))}catch(gb){a("Error resetting instructor signature"),console.error("Error:",gb)}},R=e=>{c(e),d(!0)},P=e.filter((e=>{var t,n;const r=(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(f.toLowerCase()))||(null===(n=e.email)||void 0===n?void 0:n.toLowerCase().includes(f.toLowerCase()));var s,i,a,o,l;return"instructors"===g?r&&(null===(s=e.instructorAccess)||void 0===s?void 0:s.hasAccess):"pending-reports"===g?r&&(null===(i=e.instructorAccess)||void 0===i?void 0:i.hasAccess)&&e.courseEndReports.some((e=>{var t;return!(null!==(t=e.courseEndReport)&&void 0!==t&&t.finalized)})):"loyalty"===g?r&&(null===(a=e.loyaltyAccess)||void 0===a?void 0:a.hasAccess):"team"===g?r&&(null===(o=e.teamAccess)||void 0===o?void 0:o.hasAccess):"management"===g?r&&(null===(l=e.managementRights)||void 0===l?void 0:l.hasAccess):r}));return n?(0,Et.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Et.jsxs)("div",{className:"text-gray-600 flex flex-col items-center",children:[(0,Et.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-800 mb-4"}),(0,Et.jsx)("p",{children:"Loading dashboard..."})]})}):i?(0,Et.jsx)("div",{className:"max-w-2xl mx-auto p-4",children:(0,Et.jsx)(Rc,{className:"border-red-200",children:(0,Et.jsx)(Mc,{className:"pt-6",children:(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,Et.jsx)("p",{className:"text-red-600",children:i})})})})}):(0,Et.jsxs)("div",{className:"w-full px-4 pb-6 sm:px-6 lg:px-8",children:[(0,Et.jsxs)(Rc,{className:"border-0 shadow-md bg-white",children:[(0,Et.jsx)(Pc,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-lg",children:(0,Et.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:(0,Et.jsx)(Oc,{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"})})}),(0,Et.jsx)(Mc,{className:"p-0",children:(0,Et.jsxs)(ss,{defaultValue:"users",value:h,onValueChange:m,className:"w-full",children:[(0,Et.jsxs)(is,{className:"w-full flex border-b justify-start overflow-x-auto no-scrollbar mt-2 p-0",children:[(0,Et.jsxs)(as,{value:"users",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(_i,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"User Management"})]}),(0,Et.jsxs)(as,{value:"knowledge",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(Iu,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"Knowledge"})]}),(0,Et.jsxs)(as,{value:"loyalty",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",onClick:e=>{e.preventDefault(),C("/loyalty")},children:[(0,Et.jsx)(rn,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"Loyalty"})]})]}),(0,Et.jsxs)(os,{value:"users",className:"p-4",children:[(0,Et.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[(0,Et.jsx)("div",{className:"w-full md:w-3/4",children:(0,Et.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:f,onChange:e=>p(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),(0,Et.jsxs)("div",{className:"flex flex-wrap gap-2 w-full md:w-auto",children:[(0,Et.jsx)(Kc,{variant:"all"===g?"default":"outline",onClick:()=>v("all"),size:"sm",className:"flex-grow md:flex-grow-0",children:"All"}),(0,Et.jsxs)(Kc,{variant:"instructors"===g?"default":"outline",onClick:()=>v("instructors"),size:"sm",className:"flex-grow md:flex-grow-0",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:(0,Et.jsx)("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"})}),"Instructors"]}),(0,Et.jsxs)(Kc,{variant:"pending-reports"===g?"default":"outline",onClick:()=>v("pending-reports"),size:"sm",className:"flex-grow md:flex-grow-0",children:[(0,Et.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,Et.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,Et.jsx)("polyline",{points:"14 2 14 8 20 8"}),(0,Et.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,Et.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),(0,Et.jsx)("polyline",{points:"10 9 9 9 8 9"})]}),"Pending Reports"]}),(0,Et.jsxs)(Kc,{variant:"loyalty"===g?"default":"outline",onClick:()=>v("loyalty"),size:"sm",className:"flex-grow md:flex-grow-0",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:(0,Et.jsx)("path",{d:"M12 1v4M4 5l2 2M18 5l-2 2M3 13h4M17 13h4M12 23v-4M8 17l-2 2M16 17l2 2M12 18a6 6 0 100-12 6 6 0 000 12z"})}),"Loyalty"]}),(0,Et.jsxs)(Kc,{variant:"team"===g?"default":"outline",onClick:()=>v("team"),size:"sm",className:"flex-grow md:flex-grow-0",children:[(0,Et.jsx)(La,{size:16,className:"mr-2"}),"Team"]}),(0,Et.jsxs)(Kc,{variant:"management"===g?"default":"outline",onClick:()=>v("management"),size:"sm",className:"flex-grow md:flex-grow-0",children:[(0,Et.jsx)(Nu,{size:16,className:"mr-2"}),"Management"]})]})]}),(0,Et.jsx)("div",{className:"block md:hidden",children:0===P.length?(0,Et.jsx)("div",{className:"text-center py-8",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"No users match your search criteria"})}):(0,Et.jsx)("div",{className:"space-y-4",children:P.map((e=>{var t,n,r,s,i,a,o,l,c,u,d,h,m,f,p,g,v,x,y,b,w,D,N,j,C,A,k,P,O,M,L,B,z,U,q,V,H,W,G,K,Q,Y;return(0,Et.jsxs)(Rc,{className:"overflow-hidden ".concat(null!==(t=e.instructorAccess)&&void 0!==t&&t.hasAccess?"border-blue-200 bg-blue-50":""),children:[(0,Et.jsx)(Pc,{className:"pb-2",children:(0,Et.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Oc,{className:"text-lg",children:e.name||"No name"}),(0,Et.jsx)("p",{className:"text-sm text-gray-500",children:e.email||"No email"})]}),(0,Et.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[e.certificationLevel&&(0,Et.jsx)("div",{className:"bg-indigo-50 text-indigo-700 border border-indigo-200 text-xs px-2.5 py-0.5 rounded-full",children:e.certificationLevel}),(null===(n=e.instructorAccess)||void 0===n?void 0:n.hasAccess)&&(0,Et.jsx)("div",{className:"bg-blue-100 text-blue-800 border border-blue-200 text-xs px-2.5 py-0.5 rounded-full",children:"Instructor"}),(null===(r=e.loyaltyAccess)||void 0===r?void 0:r.hasAccess)&&(0,Et.jsx)("div",{className:"bg-amber-100 text-amber-800 border border-amber-200 text-xs px-2.5 py-0.5 rounded-full",children:"Loyalty Admin"}),(null===(s=e.teamAccess)||void 0===s?void 0:s.hasAccess)&&(0,Et.jsx)("div",{className:"bg-purple-100 text-purple-800 border border-purple-200 text-xs px-2.5 py-0.5 rounded-full",children:"Team Portal"}),(null===(i=e.managementRights)||void 0===i?void 0:i.hasAccess)&&(0,Et.jsx)("div",{className:"bg-green-100 text-green-800 border border-green-200 text-xs px-2.5 py-0.5 rounded-full",children:"Management"})]})]})}),(0,Et.jsx)(Mc,{children:(0,Et.jsx)("div",{className:"w-full",children:(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,Et.jsxs)("div",{className:"flex flex-col items-center mb-3",children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-center mb-1",children:"Instructor Portal"}),(0,Et.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only",checked:!(null===(a=e.instructorAccess)||void 0===a||!a.hasAccess),onChange:()=>{var t;return F(e.id,null===(t=e.instructorAccess)||void 0===t?void 0:t.hasAccess)}}),(0,Et.jsx)("div",{className:"relative w-11 h-6 rounded-full transition ".concat(null!==(o=e.instructorAccess)&&void 0!==o&&o.hasAccess?"bg-green-600":"bg-red-600"),children:(0,Et.jsx)("div",{className:"absolute top-0.5 left-0.5 bg-white w-5 h-5 rounded-full transition-all ".concat(null!==(l=e.instructorAccess)&&void 0!==l&&l.hasAccess?"transform translate-x-5":"")})})]}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(c=e.instructorAccess)&&void 0!==c&&c.hasAccess?"Enabled":"Disabled"}),(null===(u=e.instructorAccess)||void 0===u?void 0:u.hasAccess)&&(null===(d=e.instructorAccess)||void 0===d?void 0:d.grantedAt)&&(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.instructorAccess.grantedAt)})]})]}),(0,Et.jsxs)("div",{className:"flex flex-col items-center mb-3",children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-center mb-1",children:"Instructor PIN"}),(0,Et.jsx)("div",{className:"w-11 h-6 flex justify-center",children:null!==(h=e.instructorAccess)&&void 0!==h&&h.hasAccess&&(null!==(m=e.instructorSignature)&&void 0!==m&&m.code||null!==(f=e.instructorPin)&&void 0!==f&&f.pin)?(0,Et.jsx)("button",{onClick:()=>I(e.id),className:"w-6 h-6 bg-red-100 hover:bg-red-200 text-red-600 rounded-full flex items-center justify-center",children:(0,Et.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,Et.jsx)("path",{d:"M3 6h18"}),(0,Et.jsx)("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]})}):(0,Et.jsx)("span",{className:"w-6 h-6 bg-gray-100 text-gray-400 rounded-full flex items-center justify-center",children:(0,Et.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,Et.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,Et.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,Et.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})})}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(p=e.instructorAccess)&&void 0!==p&&p.hasAccess?null!==(g=e.instructorSignature)&&void 0!==g&&g.code?"Signature":null!==(v=e.instructorPin)&&void 0!==v&&v.pin?"PIN Set":"Not Set":"N/A"}),(null===(x=e.instructorAccess)||void 0===x?void 0:x.hasAccess)&&(null!==(y=e.instructorSignature)&&void 0!==y&&y.createdAt?(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.instructorSignature.createdAt)}):null!==(b=e.instructorPin)&&void 0!==b&&b.lastUpdated?(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.instructorPin.lastUpdated)}):null)]})]}),(0,Et.jsxs)("div",{className:"flex flex-col items-center mb-3",children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-center mb-1",children:"Team Portal"}),(0,Et.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only",checked:!(null===(w=e.teamAccess)||void 0===w||!w.hasAccess),onChange:()=>{var t;return _(e.id,null===(t=e.teamAccess)||void 0===t?void 0:t.hasAccess)}}),(0,Et.jsx)("div",{className:"relative w-11 h-6 rounded-full transition ".concat(null!==(D=e.teamAccess)&&void 0!==D&&D.hasAccess?"bg-green-600":"bg-red-600"),children:(0,Et.jsx)("div",{className:"absolute top-0.5 left-0.5 bg-white w-5 h-5 rounded-full transition-all ".concat(null!==(N=e.teamAccess)&&void 0!==N&&N.hasAccess?"transform translate-x-5":"")})})]}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(j=e.teamAccess)&&void 0!==j&&j.hasAccess?"Enabled":"Disabled"}),(null===(C=e.teamAccess)||void 0===C?void 0:C.hasAccess)&&(null===(A=e.teamAccess)||void 0===A?void 0:A.grantedAt)&&(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.teamAccess.grantedAt)})]})]}),(0,Et.jsxs)("div",{className:"flex flex-col items-center mb-3",children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-center mb-1",children:"Loyalty Admin"}),(0,Et.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only",checked:!(null===(k=e.loyaltyAccess)||void 0===k||!k.hasAccess),onChange:()=>{var t;return S(e.id,null===(t=e.loyaltyAccess)||void 0===t?void 0:t.hasAccess)}}),(0,Et.jsx)("div",{className:"relative w-11 h-6 rounded-full transition ".concat(null!==(P=e.loyaltyAccess)&&void 0!==P&&P.hasAccess?"bg-green-600":"bg-red-600"),children:(0,Et.jsx)("div",{className:"absolute top-0.5 left-0.5 bg-white w-5 h-5 rounded-full transition-all ".concat(null!==(O=e.loyaltyAccess)&&void 0!==O&&O.hasAccess?"transform translate-x-5":"")})})]}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(M=e.loyaltyAccess)&&void 0!==M&&M.hasAccess?"Enabled":"Disabled"}),(null===(L=e.loyaltyAccess)||void 0===L?void 0:L.hasAccess)&&(null===(B=e.loyaltyAccess)||void 0===B?void 0:B.grantedAt)&&(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.loyaltyAccess.grantedAt)})]})]}),(0,Et.jsxs)("div",{className:"flex flex-col items-center mb-3",children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-center mb-1",children:"Management Access"}),(0,Et.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only",checked:!(null===(z=e.managementRights)||void 0===z||!z.hasAccess),onChange:()=>{var t;return T(e.id,null===(t=e.managementRights)||void 0===t?void 0:t.hasAccess)}}),(0,Et.jsx)("div",{className:"relative w-11 h-6 rounded-full transition ".concat(null!==(U=e.managementRights)&&void 0!==U&&U.hasAccess?"bg-green-600":"bg-red-600"),children:(0,Et.jsx)("div",{className:"absolute top-0.5 left-0.5 bg-white w-5 h-5 rounded-full transition-all ".concat(null!==(q=e.managementRights)&&void 0!==q&&q.hasAccess?"transform translate-x-5":"")})})]}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(V=e.managementRights)&&void 0!==V&&V.hasAccess?"Enabled":"Disabled"}),(null===(H=e.managementRights)||void 0===H?void 0:H.hasAccess)&&(null===(W=e.managementRights)||void 0===W?void 0:W.grantedAt)&&(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.managementRights.grantedAt)})]})]}),(0,Et.jsxs)("div",{className:"flex flex-col items-center mb-3",children:[(0,Et.jsx)("label",{className:"text-sm font-medium text-center mb-1",children:"Reports"}),(0,Et.jsx)("div",{className:"w-11 h-6 flex justify-center",children:null!==(G=e.instructorAccess)&&void 0!==G&&G.hasAccess&&(null===(K=e.courseEndReports)||void 0===K?void 0:K.length)>0?(0,Et.jsx)("button",{onClick:()=>R(e),className:"w-6 h-6 bg-blue-100 hover:bg-blue-200 text-blue-600 rounded-full flex items-center justify-center",children:(0,Et.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,Et.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,Et.jsx)("polyline",{points:"14 2 14 8 20 8"}),(0,Et.jsx)("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),(0,Et.jsx)("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),(0,Et.jsx)("polyline",{points:"10 9 9 9 8 9"})]})}):(0,Et.jsx)("span",{className:"w-6 h-6 bg-gray-100 text-gray-400 rounded-full flex items-center justify-center",children:(0,Et.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,Et.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,Et.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,Et.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})})}),(0,Et.jsx)("div",{className:"text-xs text-center mt-1",children:null!==(Q=e.instructorAccess)&&void 0!==Q&&Q.hasAccess&&(null===(Y=e.courseEndReports)||void 0===Y?void 0:Y.length)>0?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"font-medium",children:[e.courseEndReports.filter((e=>{var t;return!(null!==(t=e.courseEndReport)&&void 0!==t&&t.finalized)})).length," Pending"]}),(0,Et.jsxs)("div",{className:"text-gray-500",children:[e.courseEndReports.length," Total"]})]}):(0,Et.jsx)("div",{className:"font-medium",children:"None"})})]})]})})})]},e.id)}))})}),(0,Et.jsx)("div",{className:"hidden md:block overflow-x-auto max-h-[70vh]",children:(0,Et.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 rounded-lg",children:[(0,Et.jsx)("thead",{className:"bg-gray-50 sticky top-0 z-10",children:(0,Et.jsxs)("tr",{children:[(0,Et.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"User"}),(0,Et.jsxs)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:["Instructor",(0,Et.jsx)("br",{}),"Portal"]}),(0,Et.jsxs)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:["Instructor",(0,Et.jsx)("br",{}),"PIN"]}),(0,Et.jsxs)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:["Team",(0,Et.jsx)("br",{}),"Portal"]}),(0,Et.jsxs)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:["Loyalty",(0,Et.jsx)("br",{}),"Admin"]}),(0,Et.jsxs)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:["Management",(0,Et.jsx)("br",{}),"Access"]}),(0,Et.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Reports"})]})}),(0,Et.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===P.length?(0,Et.jsx)("tr",{children:(0,Et.jsx)("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"No users match your search criteria"})}):P.map((e=>{var t,n,r,s,i,a,o,l,c,u,d,h,m,f,p,g,v,x,y,b,w,D,N,j,C,A,k,P,O,M;return(0,Et.jsxs)("tr",{className:null!==(t=e.instructorAccess)&&void 0!==t&&t.hasAccess?"bg-blue-50":"",children:[(0,Et.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Et.jsxs)("div",{className:"flex items-start flex-col",children:[(0,Et.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name||"No name"}),(0,Et.jsx)("div",{className:"text-sm text-gray-500",children:e.email||"No email"}),e.certificationLevel&&(0,Et.jsx)("span",{className:"bg-indigo-50 text-indigo-700 border border-indigo-200 text-xs px-2 py-0.5 rounded-full mt-1",children:e.certificationLevel})]})}),(0,Et.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Et.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Et.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only",checked:!(null===(n=e.instructorAccess)||void 0===n||!n.hasAccess),onChange:()=>{var t;return F(e.id,null===(t=e.instructorAccess)||void 0===t?void 0:t.hasAccess)}}),(0,Et.jsx)("div",{className:"relative w-11 h-6 rounded-full transition ".concat(null!==(r=e.instructorAccess)&&void 0!==r&&r.hasAccess?"bg-green-600":"bg-red-600"),children:(0,Et.jsx)("div",{className:"absolute top-0.5 left-0.5 bg-white w-5 h-5 rounded-full transition-all ".concat(null!==(s=e.instructorAccess)&&void 0!==s&&s.hasAccess?"transform translate-x-5":"")})})]}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(i=e.instructorAccess)&&void 0!==i&&i.hasAccess?"Enabled":"Disabled"}),(null===(a=e.instructorAccess)||void 0===a?void 0:a.hasAccess)&&(null===(o=e.instructorAccess)||void 0===o?void 0:o.grantedAt)&&(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.instructorAccess.grantedAt)})]})]})}),(0,Et.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Et.jsx)("div",{className:"flex flex-col items-center",children:null!==(l=e.instructorAccess)&&void 0!==l&&l.hasAccess?(0,Et.jsx)("div",{className:"space-y-2",children:null!==(c=e.instructorSignature)&&void 0!==c&&c.code?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("div",{className:"text-sm font-mono text-center",children:e.instructorSignature.code}),(0,Et.jsx)(Kc,{onClick:()=>I(e.id),variant:"destructive",size:"sm",className:"text-xs",children:"Reset Signature"})]}):null!==(u=e.instructorPin)&&void 0!==u&&u.pin?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("div",{className:"text-sm text-amber-600 text-center",children:"Legacy PIN"}),(0,Et.jsx)(Kc,{onClick:()=>I(e.id),variant:"destructive",size:"sm",className:"text-xs",children:"Reset PIN"})]}):(0,Et.jsx)("span",{className:"text-sm text-yellow-600",children:"Not set"})}):(0,Et.jsx)("span",{className:"text-sm text-gray-400",children:"N/A"})})}),(0,Et.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Et.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Et.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only",checked:!(null===(d=e.teamAccess)||void 0===d||!d.hasAccess),onChange:()=>{var t;return _(e.id,null===(t=e.teamAccess)||void 0===t?void 0:t.hasAccess)}}),(0,Et.jsx)("div",{className:"relative w-11 h-6 rounded-full transition ".concat(null!==(h=e.teamAccess)&&void 0!==h&&h.hasAccess?"bg-green-600":"bg-red-600"),children:(0,Et.jsx)("div",{className:"absolute top-0.5 left-0.5 bg-white w-5 h-5 rounded-full transition-all ".concat(null!==(m=e.teamAccess)&&void 0!==m&&m.hasAccess?"transform translate-x-5":"")})})]}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(f=e.teamAccess)&&void 0!==f&&f.hasAccess?"Enabled":"Disabled"}),(null===(p=e.teamAccess)||void 0===p?void 0:p.hasAccess)&&(null===(g=e.teamAccess)||void 0===g?void 0:g.grantedAt)&&(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.teamAccess.grantedAt)})]})]})}),(0,Et.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Et.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Et.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only",checked:!(null===(v=e.loyaltyAccess)||void 0===v||!v.hasAccess),onChange:()=>{var t;return S(e.id,null===(t=e.loyaltyAccess)||void 0===t?void 0:t.hasAccess)}}),(0,Et.jsx)("div",{className:"relative w-11 h-6 rounded-full transition ".concat(null!==(x=e.loyaltyAccess)&&void 0!==x&&x.hasAccess?"bg-green-600":"bg-red-600"),children:(0,Et.jsx)("div",{className:"absolute top-0.5 left-0.5 bg-white w-5 h-5 rounded-full transition-all ".concat(null!==(y=e.loyaltyAccess)&&void 0!==y&&y.hasAccess?"transform translate-x-5":"")})})]}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(b=e.loyaltyAccess)&&void 0!==b&&b.hasAccess?"Enabled":"Disabled"}),(null===(w=e.loyaltyAccess)||void 0===w?void 0:w.hasAccess)&&(null===(D=e.loyaltyAccess)||void 0===D?void 0:D.grantedAt)&&(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.loyaltyAccess.grantedAt)})]})]})}),(0,Et.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Et.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Et.jsxs)("label",{className:"inline-flex items-center cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",className:"sr-only",checked:!(null===(N=e.managementRights)||void 0===N||!N.hasAccess),onChange:()=>{var t;return T(e.id,null===(t=e.managementRights)||void 0===t?void 0:t.hasAccess)}}),(0,Et.jsx)("div",{className:"relative w-11 h-6 rounded-full transition ".concat(null!==(j=e.managementRights)&&void 0!==j&&j.hasAccess?"bg-green-600":"bg-red-600"),children:(0,Et.jsx)("div",{className:"absolute top-0.5 left-0.5 bg-white w-5 h-5 rounded-full transition-all ".concat(null!==(C=e.managementRights)&&void 0!==C&&C.hasAccess?"transform translate-x-5":"")})})]}),(0,Et.jsxs)("div",{className:"text-xs text-center mt-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:null!==(A=e.managementRights)&&void 0!==A&&A.hasAccess?"Enabled":"Disabled"}),(null===(k=e.managementRights)||void 0===k?void 0:k.hasAccess)&&(null===(P=e.managementRights)||void 0===P?void 0:P.grantedAt)&&(0,Et.jsx)("div",{className:"text-gray-500",children:E(e.managementRights.grantedAt)})]})]})}),(0,Et.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,Et.jsx)("div",{className:"flex flex-col items-center",children:(null===(O=e.instructorAccess)||void 0===O?void 0:O.hasAccess)&&(0,Et.jsx)("div",{className:"flex items-center",children:(null===(M=e.courseEndReports)||void 0===M?void 0:M.length)>0?(0,Et.jsxs)(Kc,{onClick:()=>R(e),variant:"outline",className:"flex items-center space-x-2",size:"sm",children:[(0,Et.jsx)("span",{children:"View Reports"}),(0,Et.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full text-xs",children:e.courseEndReports.filter((e=>{var t;return!(null!==(t=e.courseEndReport)&&void 0!==t&&t.finalized)})).length})]}):(0,Et.jsx)("span",{className:"text-sm text-gray-500",children:"No reports"})})})})]},e.id)}))})]})})]}),(0,Et.jsx)(os,{value:"knowledge",children:(0,Et.jsx)(Tu,{quizCategories:x,setQuizCategories:y,quizzes:b,setQuizzes:w,learningResources:D,setLearningResources:N,db:wt.db,storage:wt.IG,user:j})}),(0,Et.jsx)(os,{value:"loyalty",className:"p-4",children:(0,Et.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,Et.jsxs)("div",{className:"text-center",children:[(0,Et.jsx)(rn,{size:40,className:"mx-auto text-blue-500 mb-4"}),(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loyalty Program Management"}),(0,Et.jsx)("p",{className:"text-gray-600 mb-6",children:"Manage loyalty points, rewards, and member programs."}),(0,Et.jsxs)(Kc,{onClick:()=>C("/loyalty"),className:"flex items-center mx-auto",children:[(0,Et.jsx)(rn,{size:16,className:"mr-2"}),"Go to Loyalty Dashboard"]})]})})})]})})]}),(0,Et.jsx)(oc,{open:u,onOpenChange:d,children:(0,Et.jsxs)(hc,{className:"max-w-4xl bg-white p-0 rounded-lg max-h-[90vh] overflow-hidden flex flex-col sm:max-w-3xl",children:[(0,Et.jsxs)("div",{className:"border-b p-4 bg-white rounded-t-lg flex justify-between items-center sticky top-0 z-10",children:[(0,Et.jsxs)(pc,{className:"text-xl font-semibold",children:["Course End Reports - ",null===l||void 0===l?void 0:l.name]}),(0,Et.jsx)(uc,{className:"h-6 w-6 rounded-full flex items-center justify-center text-gray-500 hover:text-gray-800",children:"\xd7"})]}),(0,Et.jsx)("div",{className:"p-4 overflow-y-auto flex-grow",children:(0,Et.jsx)("div",{className:"space-y-6",children:0===(null===l||void 0===l?void 0:l.courseEndReports.length)?(0,Et.jsx)("div",{className:"text-center py-8",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"No reports available"})}):null===l||void 0===l?void 0:l.courseEndReports.map((n=>{var r,s,i,c,u,d,h,m,f,p,g,v,x;return(0,Et.jsxs)(Rc,{className:"overflow-hidden border ".concat(null!==(r=n.courseEndReport)&&void 0!==r&&r.finalized?"border-green-200":"border-amber-200"),children:[(0,Et.jsx)(Pc,{className:"pb-2 ".concat(null!==(s=n.courseEndReport)&&void 0!==s&&s.finalized?"bg-green-50":"bg-amber-50"),children:(0,Et.jsxs)("div",{className:"flex justify-between items-start flex-wrap gap-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Oc,{className:"text-xl",children:n.name}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:[new Date(n.startDate).toLocaleDateString()," - ",new Date(n.endDate).toLocaleDateString()]})]}),(0,Et.jsx)("div",{children:null!==(i=n.courseEndReport)&&void 0!==i&&i.finalized?(0,Et.jsxs)("div",{className:"text-sm text-right",children:[(0,Et.jsx)("span",{className:"bg-green-100 text-green-800 border border-green-200 px-2.5 py-0.5 rounded-full text-xs",children:"Finalized"}),(0,Et.jsxs)("p",{className:"mt-1 text-gray-600 text-xs",children:[null!==(c=n.courseEndReport)&&void 0!==c&&c.finalizedAt?E(n.courseEndReport.finalizedAt):"N/A",(0,Et.jsx)("br",{}),"By: ",(null===(u=n.courseEndReport)||void 0===u?void 0:u.finalizedBy)||"Unknown"]})]}):(0,Et.jsx)(Kc,{onClick:()=>(async(n,r)=>{if(window.confirm("Are you sure you want to mark this report as paid and finalized?"))try{const s=(0,Dt.H9)(wt.db,"courses",n);await(0,Dt.mZ)(s,{"courseEndReport.finalized":!0,"courseEndReport.finalizedAt":Dt.Dc.now(),"courseEndReport.finalizedBy":j.email}),t(e.map((e=>{if(e.id===r){const t=e.courseEndReports.map((e=>e.courseId===n?(0,o.A)((0,o.A)({},e),{},{courseEndReport:(0,o.A)((0,o.A)({},e.courseEndReport),{},{finalized:!0,finalizedAt:Dt.Dc.now(),finalizedBy:j.email})}):e));return(0,o.A)((0,o.A)({},e),{},{courseEndReports:t})}return e})))}catch(gb){a("Error finalizing report"),console.error("Error:",gb)}})(n.courseId,l.id),className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",children:"Mark as Paid & Finalize"})})]})}),(0,Et.jsx)(Mc,{className:"p-4",children:(0,Et.jsxs)("div",{className:"w-full",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Course Details"}),(0,Et.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md text-sm space-y-1",children:[(0,Et.jsxs)("p",{children:["Location: ",n.location]}),(0,Et.jsxs)("p",{children:["Completed: ",n.completedAt?E(n.completedAt):"Not completed"]})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("h4",{className:"font-medium text-sm mb-2",children:["Students (",(null===(d=n.students)||void 0===d?void 0:d.length)||0,")"]}),(0,Et.jsx)("div",{className:"bg-gray-50 p-3 rounded-md text-sm max-h-32 overflow-y-auto",children:null===(h=n.students)||void 0===h?void 0:h.map(((e,t)=>(0,Et.jsxs)("div",{className:"flex justify-between mb-1 last:mb-0",children:[(0,Et.jsx)("span",{children:e.displayName}),(0,Et.jsxs)("span",{className:"text-xs px-2.5 py-0.5 rounded-full\n                                    ".concat(k(e,n)>=100?"bg-green-50 text-green-700 border border-green-200":k(e,n)>=50?"bg-blue-50 text-blue-700 border border-blue-200":"bg-amber-50 text-amber-700 border border-amber-200","\n                                  "),children:[k(e,n),"%"]})]},t)))})]})]}),((null===(m=n.courseEndReport)||void 0===m||null===(f=m.creditAllocations)||void 0===f?void 0:f.length)>0||(null===(p=n.courseEndReport)||void 0===p?void 0:p.additionalNotes))&&(0,Et.jsxs)("div",{className:"pt-4 space-y-4 border-t mt-4",children:[(null===(g=n.courseEndReport)||void 0===g||null===(v=g.creditAllocations)||void 0===v?void 0:v.length)>0&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Credit Allocations:"}),(0,Et.jsx)("div",{className:"bg-gray-50 p-3 rounded-md space-y-1",children:n.courseEndReport.creditAllocations.map(((e,t)=>(0,Et.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Et.jsx)("span",{children:e.name}),(0,Et.jsxs)("span",{children:[e.percentage,"%"]})]},t)))})]}),(null===(x=n.courseEndReport)||void 0===x?void 0:x.additionalNotes)&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h4",{className:"font-medium text-sm mb-2",children:"Additional Notes:"}),(0,Et.jsx)("div",{className:"bg-gray-50 p-3 rounded-md text-sm whitespace-pre-wrap",children:n.courseEndReport.additionalNotes})]})]})]})})]},n.courseId)}))})})]})})]})},Pu=Mt("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]),Ou=e=>{let{count:t}=e;return!t||t<=0?null:(0,Et.jsx)("span",{className:"inline-flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-red-500 rounded-full",children:t>99?"99+":t})},Mu=e=>{let{selectedChatId:t,onChatSelect:n,onNewChat:s,isSmallScreen:i}=e;const{user:a}=kt(),[l,c]=(0,r.useState)([]),[u,d]=(0,r.useState)(!0),[h,m]=(0,r.useState)(null),[f,p]=(0,r.useState)({});(0,r.useEffect)((()=>{if(null===a||void 0===a||!a.uid)return;const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"chats"),(0,Dt._M)("activeParticipants","array-contains",a.uid),(0,Dt.My)("lastMessageAt","desc")),t=(0,Dt.aQ)(e,(e=>{const t=e.docs.map((e=>(0,o.A)({id:e.id},e.data())));c(t),d(!1)}),(e=>{console.error("Error fetching chats:",e),m("Failed to load chats"),d(!1)}));return()=>t()}),[a]),(0,r.useEffect)((()=>{if(null===a||void 0===a||!a.uid||0===l.length)return;const e=[];return l.forEach((t=>{const n=Xc.default.subscribeToItemNotifications(a.uid,"chat",t.id,(e=>{p((n=>(0,o.A)((0,o.A)({},n),{},{[t.id]:e.totalCount||0})))}));e.push(n)})),()=>{e.forEach((e=>{"function"===typeof e&&e()}))}}),[a,l]);const g=e=>{if(!e.lastMessage)return"No messages yet";const t=e.lastMessage.senderId===(null===a||void 0===a?void 0:a.uid);return"".concat(t?"You":e.lastMessage.senderName,": ").concat(e.lastMessage.text)},v=e=>{if(!e)return"";const t=e.toDate(),n=new Date-t,r=864e5;return n<r?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):n<7*r?t.toLocaleDateString([],{weekday:"short"}):t.toLocaleDateString([],{month:"short",day:"numeric"})},x=e=>{var t;if("group"===e.type)return e.name;const n=e.activeParticipants.find((e=>e!==(null===a||void 0===a?void 0:a.uid)));if(e.names&&n)return e.names[n]||"Unknown User";const r=null===(t=Object.entries(e.participants).find((e=>{let[t]=e;return t!==(null===a||void 0===a?void 0:a.uid)})))||void 0===t?void 0:t[1];return(null===r||void 0===r?void 0:r.displayName)||"Unknown User"};return(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("div",{className:"p-3 md:p-4 border-b",children:(0,Et.jsxs)("button",{onClick:s,className:"w-full flex items-center justify-center gap-2 px-4 py-2 md:py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:[(0,Et.jsx)(Pu,{size:20}),(0,Et.jsx)("span",{children:"New Chat"})]})}),(0,Et.jsx)("div",{className:"flex-1 overflow-y-auto",children:u?(0,Et.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,Et.jsx)("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}):h?(0,Et.jsx)("div",{className:"p-4 text-center text-red-500",children:h}):0===l.length?(0,Et.jsx)("div",{className:"p-4 text-center text-gray-500",children:"No chats yet"}):l.map((e=>{const r=f[e.id]||0;return(0,Et.jsxs)("button",{onClick:()=>{return t=e.id,void n(t);var t},className:"w-full text-left p-3 md:p-4 hover:bg-gray-100 transition-colors\n                  ".concat(t===e.id?"bg-gray-100":"","\n                  ").concat(i?"py-4":"","\n                  border-b border-gray-100\n                "),children:[(0,Et.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,Et.jsx)("h3",{className:"font-medium truncate text-gray-800 ".concat(i?"max-w-[70%]":"max-w-[60%]"),children:x(e)}),(0,Et.jsxs)("div",{className:"flex items-center space-x-2 shrink-0",children:[r>0&&(0,Et.jsx)(Ou,{count:r}),e.lastMessageAt&&(0,Et.jsx)("span",{className:"text-xs text-gray-500",children:v(e.lastMessageAt)})]})]}),(0,Et.jsx)("p",{className:"text-sm text-gray-600 truncate",children:g(e)})]},e.id)}))})]})},Lu=Mt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Bu=Mt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);function zu(e){"function"==typeof queueMicrotask?queueMicrotask(e):Promise.resolve().then(e).catch((e=>setTimeout((()=>{throw e}))))}function Uu(){let e=[],t={addEventListener:(e,n,r,s)=>(e.addEventListener(n,r,s),t.add((()=>e.removeEventListener(n,r,s)))),requestAnimationFrame(){let e=requestAnimationFrame(...arguments);return t.add((()=>cancelAnimationFrame(e)))},nextFrame(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.requestAnimationFrame((()=>t.requestAnimationFrame(...n)))},setTimeout(){let e=setTimeout(...arguments);return t.add((()=>clearTimeout(e)))},microTask(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];let s={current:!0};return zu((()=>{s.current&&n[0]()})),t.add((()=>{s.current=!1}))},style(e,t,n){let r=e.style.getPropertyValue(t);return Object.assign(e.style,{[t]:n}),this.add((()=>{Object.assign(e.style,{[t]:r})}))},group(e){let t=Uu();return e(t),this.add((()=>t.dispose()))},add:t=>(e.includes(t)||e.push(t),()=>{let n=e.indexOf(t);if(n>=0)for(let t of e.splice(n,1))t()}),dispose(){for(let t of e.splice(0))t()}};return t}function qu(){let[e]=(0,r.useState)(Uu);return(0,r.useEffect)((()=>()=>e.dispose()),[e]),e}var Vu=Object.defineProperty,Hu=(e,t,n)=>(((e,t,n)=>{t in e?Vu(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n);let Wu=new class{constructor(){Hu(this,"current",this.detect()),Hu(this,"handoffState","pending"),Hu(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return"server"===this.current}get isClient(){return"client"===this.current}detect(){return"undefined"==typeof window||"undefined"==typeof document?"server":"client"}handoff(){"pending"===this.handoffState&&(this.handoffState="complete")}get isHandoffComplete(){return"complete"===this.handoffState}},Gu=(e,t)=>{Wu.isServer?(0,r.useEffect)(e,t):(0,r.useLayoutEffect)(e,t)};function Ku(e){let t=(0,r.useRef)(e);return Gu((()=>{t.current=e}),[e]),t}let Qu=function(e){let t=Ku(e);return r.useCallback((function(){return t.current(...arguments)}),[t])};function Yu(){let e=(0,r.useRef)(!1);return Gu((()=>(e.current=!0,()=>{e.current=!1})),[]),e}function Ju(){let e=function(){let e="undefined"==typeof document;return(e=>e.useSyncExternalStore)(s)((()=>()=>{}),(()=>!1),(()=>!e))}(),[t,n]=r.useState(Wu.isHandoffComplete);return t&&!1===Wu.isHandoffComplete&&n(!1),r.useEffect((()=>{!0!==t&&n(!0)}),[t]),r.useEffect((()=>Wu.handoff()),[]),!e&&t}let Xu=Symbol();function $u(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let s=(0,r.useRef)(t);(0,r.useEffect)((()=>{s.current=t}),[t]);let i=Qu((e=>{for(let t of s.current)null!=t&&("function"==typeof t?t(e):t.current=e)}));return t.every((e=>null==e||(null==e?void 0:e[Xu])))?void 0:i}var Zu,ed;"undefined"!=typeof process&&"undefined"!=typeof globalThis&&"undefined"!=typeof Element&&"test"===(null==(Zu=null==process?void 0:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})?void 0:Zu.NODE_ENV)&&"undefined"==typeof(null==(ed=null==Element?void 0:Element.prototype)?void 0:ed.getAnimations)&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join("\n")),[]});var td=(e=>(e[e.None=0]="None",e[e.Closed=1]="Closed",e[e.Enter=2]="Enter",e[e.Leave=4]="Leave",e))(td||{});function nd(e,t,n,s){let[i,a]=(0,r.useState)(n),{hasFlag:o,addFlag:l,removeFlag:c}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,[t,n]=(0,r.useState)(e),s=(0,r.useCallback)((e=>n(e)),[t]),i=(0,r.useCallback)((e=>n((t=>t|e))),[t]),a=(0,r.useCallback)((e=>(t&e)===e),[t]),o=(0,r.useCallback)((e=>n((t=>t&~e))),[n]),l=(0,r.useCallback)((e=>n((t=>t^e))),[n]);return{flags:t,setFlag:s,addFlag:i,hasFlag:a,removeFlag:o,toggleFlag:l}}(e&&i?3:0),u=(0,r.useRef)(!1),d=(0,r.useRef)(!1),h=qu();return Gu((()=>{var r;if(e)return n&&a(!0),t?(null==(r=null==s?void 0:s.start)||r.call(s,n),function(e,t){let{prepare:n,run:r,done:s,inFlight:i}=t,a=Uu();return function(e,t){let{inFlight:n,prepare:r}=t;if(null!=n&&n.current)return void r();let s=e.style.transition;e.style.transition="none",r(),e.offsetHeight,e.style.transition=s}(e,{prepare:n,inFlight:i}),a.nextFrame((()=>{r(),a.requestAnimationFrame((()=>{a.add(function(e,t){var n,r;let s=Uu();if(!e)return s.dispose;let i=!1;s.add((()=>{i=!0}));let a=null!=(r=null==(n=e.getAnimations)?void 0:n.call(e).filter((e=>e instanceof CSSTransition)))?r:[];return 0===a.length?(t(),s.dispose):(Promise.allSettled(a.map((e=>e.finished))).then((()=>{i||t()})),s.dispose)}(e,s))}))})),a.dispose}(t,{inFlight:u,prepare(){d.current?d.current=!1:d.current=u.current,u.current=!0,!d.current&&(n?(l(3),c(4)):(l(4),c(2)))},run(){d.current?n?(c(3),l(4)):(c(4),l(3)):n?c(1):l(1)},done(){var e;d.current&&"function"==typeof t.getAnimations&&t.getAnimations().length>0||(u.current=!1,c(7),n||a(!1),null==(e=null==s?void 0:s.end)||e.call(s,n))}})):void(n&&l(3))}),[e,n,t,h]),e?[i,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[n,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}let rd=(0,r.createContext)(null);rd.displayName="OpenClosedContext";var sd=(e=>(e[e.Open=1]="Open",e[e.Closed=2]="Closed",e[e.Closing=4]="Closing",e[e.Opening=8]="Opening",e))(sd||{});function id(){return(0,r.useContext)(rd)}function ad(e){let{value:t,children:n}=e;return r.createElement(rd.Provider,{value:t},n)}function od(e){let{children:t}=e;return r.createElement(rd.Provider,{value:null},t)}function ld(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Array.from(new Set(t.flatMap((e=>"string"==typeof e?e.split(" "):[])))).filter(Boolean).join(" ")}function cd(e,t){if(e in t){let i=t[e];for(var n=arguments.length,r=new Array(n>2?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];return"function"==typeof i?i(...r):i}let i=new Error('Tried to handle "'.concat(e,'" but there is no handler defined. Only defined handlers are: ').concat(Object.keys(t).map((e=>'"'.concat(e,'"'))).join(", "),"."));throw Error.captureStackTrace&&Error.captureStackTrace(i,cd),i}const ud=["static"],dd=["unmount"],hd=["as","children","refName"];var md=(e=>(e[e.None=0]="None",e[e.RenderStrategy=1]="RenderStrategy",e[e.Static=2]="Static",e))(md||{}),fd=(e=>(e[e.Unmount=0]="Unmount",e[e.Hidden=1]="Hidden",e))(fd||{});function pd(){let e=function(){let e=(0,r.useRef)([]),t=(0,r.useCallback)((t=>{for(let n of e.current)null!=n&&("function"==typeof n?n(t):n.current=t)}),[]);return function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];if(!r.every((e=>null==e)))return e.current=r,t}}();return(0,r.useCallback)((t=>function(e){let{ourProps:t,theirProps:n,slot:r,defaultTag:s,features:i,visible:l=!0,name:c,mergeRefs:u}=e;u=null!=u?u:vd;let d=xd(n,t);if(l)return gd(d,r,s,c,u);let h=null!=i?i:0;if(2&h){let{static:e=!1}=d,t=(0,a.A)(d,ud);if(e)return gd(t,r,s,c,u)}if(1&h){let{unmount:e=!0}=d,t=(0,a.A)(d,dd);return cd(e?0:1,{0:()=>null,1:()=>gd((0,o.A)((0,o.A)({},t),{},{hidden:!0,style:{display:"none"}}),r,s,c,u)})}return gd(d,r,s,c,u)}((0,o.A)({mergeRefs:e},t))),[e])}function gd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=wd(e,["unmount","static"]),{as:l=n,children:c,refName:u="ref"}=o,d=(0,a.A)(o,hd),h=void 0!==e.ref?{[u]:e.ref}:{},m="function"==typeof c?c(t):c;"className"in d&&d.className&&"function"==typeof d.className&&(d.className=d.className(t)),d["aria-labelledby"]&&d["aria-labelledby"]===d.id&&(d["aria-labelledby"]=void 0);let f={};if(t){let e=!1,n=[];for(let[r,s]of Object.entries(t))"boolean"==typeof s&&(e=!0),!0===s&&n.push(r.replace(/([A-Z])/g,(e=>"-".concat(e.toLowerCase()))));if(e){f["data-headlessui-state"]=n.join(" ");for(let e of n)f["data-".concat(e)]=""}}if(l===r.Fragment&&(Object.keys(bd(d)).length>0||Object.keys(bd(f)).length>0)){if((0,r.isValidElement)(m)&&!(Array.isArray(m)&&m.length>1)){let e=m.props,t=null==e?void 0:e.className,n="function"==typeof t?function(){return ld(t(...arguments),d.className)}:ld(t,d.className),s=n?{className:n}:{},a=xd(m.props,bd(wd(d,["ref"])));for(let r in f)r in a&&delete f[r];return(0,r.cloneElement)(m,Object.assign({},a,f,h,{ref:i(Dd(m),h.ref)},s))}if(Object.keys(bd(d)).length>0)throw new Error(['Passing props on "Fragment"!',"","The current component <".concat(s,' /> is rendering a "Fragment".'),"However we need to passthrough the following props:",Object.keys(bd(d)).concat(Object.keys(bd(f))).map((e=>"  - ".concat(e))).join("\n"),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map((e=>"  - ".concat(e))).join("\n")].join("\n"))}return(0,r.createElement)(l,Object.assign({},wd(d,["ref"]),l!==r.Fragment&&h,l!==r.Fragment&&f),m)}function vd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((e=>null==e))?void 0:e=>{for(let n of t)null!=n&&("function"==typeof n?n(e):n.current=e)}}function xd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0===t.length)return{};if(1===t.length)return t[0];let r={},s={};for(let i of t)for(let e in i)e.startsWith("on")&&"function"==typeof i[e]?(null!=s[e]||(s[e]=[]),s[e].push(i[e])):r[e]=i[e];if(r.disabled||r["aria-disabled"])for(let i in s)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(i)&&(s[i]=[e=>{var t;return null==(t=null==e?void 0:e.preventDefault)?void 0:t.call(e)}]);for(let i in s)Object.assign(r,{[i](e){let t=s[i];for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(let s of t){if((e instanceof Event||(null==e?void 0:e.nativeEvent)instanceof Event)&&e.defaultPrevented)return;s(e,...r)}}});return r}function yd(e){var t;return Object.assign((0,r.forwardRef)(e),{displayName:null!=(t=e.displayName)?t:e.name})}function bd(e){let t=Object.assign({},e);for(let n in t)void 0===t[n]&&delete t[n];return t}function wd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object.assign({},e);for(let r of t)r in n&&delete n[r];return n}function Dd(e){return r.version.split(".")[0]>="19"?e.props.ref:e.ref}const Nd=["transition","beforeEnter","afterEnter","beforeLeave","afterLeave","enter","enterFrom","enterTo","entered","leave","leaveFrom","leaveTo"],jd=["show","appear","unmount"];function Cd(e){var t;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||(null!=(t=e.as)?t:_d)!==r.Fragment||1===r.Children.count(e.children)}let Ed=(0,r.createContext)(null);Ed.displayName="TransitionContext";var Ad=(e=>(e.Visible="visible",e.Hidden="hidden",e))(Ad||{});let kd=(0,r.createContext)(null);function Sd(e){return"children"in e?Sd(e.children):e.current.filter((e=>{let{el:t}=e;return null!==t.current})).filter((e=>{let{state:t}=e;return"visible"===t})).length>0}function Fd(e,t){let n=Ku(e),s=(0,r.useRef)([]),i=Yu(),a=qu(),o=Qu((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fd.Hidden,r=s.current.findIndex((t=>{let{el:n}=t;return n===e}));-1!==r&&(cd(t,{[fd.Unmount](){s.current.splice(r,1)},[fd.Hidden](){s.current[r].state="hidden"}}),a.microTask((()=>{var e;!Sd(s)&&i.current&&(null==(e=n.current)||e.call(n))})))})),l=Qu((e=>{let t=s.current.find((t=>{let{el:n}=t;return n===e}));return t?"visible"!==t.state&&(t.state="visible"):s.current.push({el:e,state:"visible"}),()=>o(e,fd.Unmount)})),c=(0,r.useRef)([]),u=(0,r.useRef)(Promise.resolve()),d=(0,r.useRef)({enter:[],leave:[]}),h=Qu(((e,n,r)=>{c.current.splice(0),t&&(t.chains.current[n]=t.chains.current[n].filter((t=>{let[n]=t;return n!==e}))),null==t||t.chains.current[n].push([e,new Promise((e=>{c.current.push(e)}))]),null==t||t.chains.current[n].push([e,new Promise((e=>{Promise.all(d.current[n].map((e=>{let[t,n]=e;return n}))).then((()=>e()))}))]),"enter"===n?u.current=u.current.then((()=>null==t?void 0:t.wait.current)).then((()=>r(n))):r(n)})),m=Qu(((e,t,n)=>{Promise.all(d.current[t].splice(0).map((e=>{let[t,n]=e;return n}))).then((()=>{var e;null==(e=c.current.shift())||e()})).then((()=>n(t)))}));return(0,r.useMemo)((()=>({children:s,register:l,unregister:o,onStart:h,onStop:m,wait:u,chains:d})),[l,o,s,h,m,d,u])}kd.displayName="NestingContext";let _d=r.Fragment,Td=md.RenderStrategy;let Id=yd((function(e,t){let{show:n,appear:s=!1,unmount:i=!0}=e,l=(0,a.A)(e,jd),c=(0,r.useRef)(null),u=$u(...Cd(e)?[c,t]:null===t?[]:[t]);Ju();let d=id();if(void 0===n&&null!==d&&(n=(d&sd.Open)===sd.Open),void 0===n)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[h,m]=(0,r.useState)(n?"visible":"hidden"),f=Fd((()=>{n||m("hidden")})),[p,g]=(0,r.useState)(!0),v=(0,r.useRef)([n]);Gu((()=>{!1!==p&&v.current[v.current.length-1]!==n&&(v.current.push(n),g(!1))}),[v,n]);let x=(0,r.useMemo)((()=>({show:n,appear:s,initial:p})),[n,s,p]);Gu((()=>{n?m("visible"):!Sd(f)&&null!==c.current&&m("hidden")}),[n,f]);let y={unmount:i},b=Qu((()=>{var t;p&&g(!1),null==(t=e.beforeEnter)||t.call(e)})),w=Qu((()=>{var t;p&&g(!1),null==(t=e.beforeLeave)||t.call(e)})),D=pd();return r.createElement(kd.Provider,{value:f},r.createElement(Ed.Provider,{value:x},D({ourProps:(0,o.A)((0,o.A)({},y),{},{as:r.Fragment,children:r.createElement(Rd,(0,o.A)((0,o.A)((0,o.A)({ref:u},y),l),{},{beforeEnter:b,beforeLeave:w}))}),theirProps:{},defaultTag:r.Fragment,features:Td,visible:"visible"===h,name:"Transition"})))})),Rd=yd((function(e,t){var n,s;let{transition:i=!0,beforeEnter:l,afterEnter:c,beforeLeave:u,afterLeave:d,enter:h,enterFrom:m,enterTo:f,entered:p,leave:g,leaveFrom:v,leaveTo:x}=e,y=(0,a.A)(e,Nd),[b,w]=(0,r.useState)(null),D=(0,r.useRef)(null),N=Cd(e),j=$u(...N?[D,t,w]:null===t?[]:[t]),C=null==(n=y.unmount)||n?fd.Unmount:fd.Hidden,{show:E,appear:A,initial:k}=function(){let e=(0,r.useContext)(Ed);if(null===e)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),[S,F]=(0,r.useState)(E?"visible":"hidden"),_=function(){let e=(0,r.useContext)(kd);if(null===e)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}(),{register:T,unregister:I}=_;Gu((()=>T(D)),[T,D]),Gu((()=>{if(C===fd.Hidden&&D.current)return E&&"visible"!==S?void F("visible"):cd(S,{hidden:()=>I(D),visible:()=>T(D)})}),[S,D,T,I,E,C]);let R=Ju();Gu((()=>{if(N&&R&&"visible"===S&&null===D.current)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")}),[D,S,R,N]);let P=k&&!A,O=A&&E&&k,M=(0,r.useRef)(!1),L=Fd((()=>{M.current||(F("hidden"),I(D))}),_),B=Qu((e=>{M.current=!0;let t=e?"enter":"leave";L.onStart(D,t,(e=>{"enter"===e?null==l||l():"leave"===e&&(null==u||u())}))})),z=Qu((e=>{let t=e?"enter":"leave";M.current=!1,L.onStop(D,t,(e=>{"enter"===e?null==c||c():"leave"===e&&(null==d||d())})),"leave"===t&&!Sd(L)&&(F("hidden"),I(D))}));(0,r.useEffect)((()=>{N&&i||(B(E),z(E))}),[E,N,i]);let U=!(!i||!N||!R||P),[,q]=nd(U,b,E,{start:B,end:z}),V=bd((0,o.A)({ref:j,className:(null==(s=ld(y.className,O&&h,O&&m,q.enter&&h,q.enter&&q.closed&&m,q.enter&&!q.closed&&f,q.leave&&g,q.leave&&!q.closed&&v,q.leave&&q.closed&&x,!q.transition&&E&&p))?void 0:s.trim())||void 0},function(e){let t={};for(let n in e)!0===e[n]&&(t["data-".concat(n)]="");return t}(q))),H=0;"visible"===S&&(H|=sd.Open),"hidden"===S&&(H|=sd.Closed),E&&"hidden"===S&&(H|=sd.Opening),!E&&"visible"===S&&(H|=sd.Closing);let W=pd();return r.createElement(kd.Provider,{value:L},r.createElement(ad,{value:H},W({ourProps:V,theirProps:y,defaultTag:_d,features:Td,visible:"visible"===S,name:"Transition.Child"})))})),Pd=yd((function(e,t){let n=null!==(0,r.useContext)(Ed),s=null!==id();return r.createElement(r.Fragment,null,!n&&s?r.createElement(Id,(0,o.A)({ref:t},e)):r.createElement(Rd,(0,o.A)({ref:t},e)))})),Od=Object.assign(Id,{Child:Pd,Root:Id});var Md=(e=>(e.Space=" ",e.Enter="Enter",e.Escape="Escape",e.Backspace="Backspace",e.Delete="Delete",e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e.Home="Home",e.End="End",e.PageUp="PageUp",e.PageDown="PageDown",e.Tab="Tab",e))(Md||{});function Ld(e,t,n,s){let i=Ku(n);(0,r.useEffect)((()=>{function n(e){i.current(e)}return(e=null!=e?e:window).addEventListener(t,n,s),()=>e.removeEventListener(t,n,s)}),[e,t,s])}class Bd extends Map{constructor(e){super(),this.factory=e}get(e){let t=super.get(e);return void 0===t&&(t=this.factory(e),this.set(e,t)),t}}var zd,Ud,qd,Vd=Object.defineProperty,Hd=(e,t,n)=>(((e,t,n)=>{t in e?Vd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),Wd=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},Gd=(e,t,n)=>(Wd(e,t,"read from private field"),n?n.call(e):t.get(e)),Kd=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Qd=(e,t,n,r)=>(Wd(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);class Yd{constructor(e){Kd(this,zd,{}),Kd(this,Ud,new Bd((()=>new Set))),Kd(this,qd,new Set),Hd(this,"disposables",Uu()),Qd(this,zd,e)}dispose(){this.disposables.dispose()}get state(){return Gd(this,zd)}subscribe(e,t){let n={selector:e,callback:t,current:e(Gd(this,zd))};return Gd(this,qd).add(n),this.disposables.add((()=>{Gd(this,qd).delete(n)}))}on(e,t){return Gd(this,Ud).get(e).add(t),this.disposables.add((()=>{Gd(this,Ud).get(e).delete(t)}))}send(e){let t=this.reduce(Gd(this,zd),e);if(t!==Gd(this,zd)){Qd(this,zd,t);for(let e of Gd(this,qd)){let t=e.selector(Gd(this,zd));Jd(e.current,t)||(e.current=t,e.callback(t))}for(let t of Gd(this,Ud).get(e.type))t(Gd(this,zd),e)}}}function Jd(e,t){return!!Object.is(e,t)||"object"==typeof e&&null!==e&&"object"==typeof t&&null!==t&&(Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&Xd(e[Symbol.iterator](),t[Symbol.iterator]()):e instanceof Map&&t instanceof Map||e instanceof Set&&t instanceof Set?e.size===t.size&&Xd(e.entries(),t.entries()):!(!$d(e)||!$d(t))&&Xd(Object.entries(e)[Symbol.iterator](),Object.entries(t)[Symbol.iterator]()))}function Xd(e,t){for(;;){let n=e.next(),r=t.next();if(n.done&&r.done)return!0;if(n.done||r.done||!Object.is(n.value,r.value))return!1}}function $d(e){if("[object Object]"!==Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);return null===t||null===Object.getPrototypeOf(t)}zd=new WeakMap,Ud=new WeakMap,qd=new WeakMap;var Zd=Object.defineProperty,eh=(e,t,n)=>(((e,t,n)=>{t in e?Zd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n})(e,"symbol"!=typeof t?t+"":t,n),n),th=(e=>(e[e.Push=0]="Push",e[e.Pop=1]="Pop",e))(th||{});let nh={0(e,t){let n=t.id,r=e.stack,s=e.stack.indexOf(n);if(-1!==s){let t=e.stack.slice();return t.splice(s,1),t.push(n),r=t,(0,o.A)((0,o.A)({},e),{},{stack:r})}return(0,o.A)((0,o.A)({},e),{},{stack:[...e.stack,n]})},1(e,t){let n=t.id,r=e.stack.indexOf(n);if(-1===r)return e;let s=e.stack.slice();return s.splice(r,1),(0,o.A)((0,o.A)({},e),{},{stack:s})}};class rh extends Yd{constructor(){super(...arguments),eh(this,"actions",{push:e=>this.send({type:0,id:e}),pop:e=>this.send({type:1,id:e})}),eh(this,"selectors",{isTop:(e,t)=>e.stack[e.stack.length-1]===t,inStack:(e,t)=>e.stack.includes(t)})}static new(){return new rh({stack:[]})}reduce(e,t){return cd(t.type,nh,e,t)}}const sh=new Bd((()=>rh.new()));var ih=n(7237);function ah(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jd;return(0,ih.useSyncExternalStoreWithSelector)(Qu((t=>e.subscribe(oh,t))),Qu((()=>e.state)),Qu((()=>e.state)),Qu(t),n)}function oh(e){return e}function lh(e,t){let n=(0,r.useId)(),s=sh.get(t),[i,a]=ah(s,(0,r.useCallback)((e=>[s.selectors.isTop(e,n),s.selectors.inStack(e,n)]),[s,n]));return Gu((()=>{if(e)return s.actions.push(n),()=>s.actions.pop(n)}),[s,e,n]),!!e&&(!a||i)}function ch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"undefined"!=typeof document?document.defaultView:null,n=arguments.length>2?arguments[2]:void 0,r=lh(e,"escape");Ld(t,"keydown",(e=>{r&&(e.defaultPrevented||e.key===Md.Escape&&n(e))}))}function uh(e){var t,n;return Wu.isServer?null:e?"ownerDocument"in e?e.ownerDocument:"current"in e?null!=(n=null==(t=e.current)?void 0:t.ownerDocument)?n:document:null:document}let dh=new Map,hh=new Map;function mh(e){var t;let n=null!=(t=hh.get(e))?t:0;return hh.set(e,n+1),0!==n||(dh.set(e,{"aria-hidden":e.getAttribute("aria-hidden"),inert:e.inert}),e.setAttribute("aria-hidden","true"),e.inert=!0),()=>fh(e)}function fh(e){var t;let n=null!=(t=hh.get(e))?t:1;if(1===n?hh.delete(e):hh.set(e,n-1),1!==n)return;let r=dh.get(e);r&&(null===r["aria-hidden"]?e.removeAttribute("aria-hidden"):e.setAttribute("aria-hidden",r["aria-hidden"]),e.inert=r.inert,dh.delete(e))}function ph(e){let{allowed:t,disallowed:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=lh(e,"inert-others");Gu((()=>{var e,s;if(!r)return;let i=Uu();for(let t of null!=(e=null==n?void 0:n())?e:[])t&&i.add(mh(t));let a=null!=(s=null==t?void 0:t())?s:[];for(let t of a){if(!t)continue;let e=uh(t);if(!e)continue;let n=t.parentElement;for(;n&&n!==e.body;){for(let e of n.children)a.some((t=>e.contains(t)))||i.add(mh(e));n=n.parentElement}}return i.dispose}),[r,t,n])}function gh(e){return"object"==typeof e&&null!==e&&"nodeType"in e}function vh(e){return gh(e)&&"tagName"in e}function xh(e){return vh(e)&&"accessKey"in e}function yh(e){return vh(e)&&"tabIndex"in e}let bh=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map((e=>"".concat(e,":not([tabindex='-1'])"))).join(","),wh=["[data-autofocus]"].map((e=>"".concat(e,":not([tabindex='-1'])"))).join(",");var Dh=(e=>(e[e.First=1]="First",e[e.Previous=2]="Previous",e[e.Next=4]="Next",e[e.Last=8]="Last",e[e.WrapAround=16]="WrapAround",e[e.NoScroll=32]="NoScroll",e[e.AutoFocus=64]="AutoFocus",e))(Dh||{}),Nh=(e=>(e[e.Error=0]="Error",e[e.Overflow=1]="Overflow",e[e.Success=2]="Success",e[e.Underflow=3]="Underflow",e))(Nh||{}),jh=(e=>(e[e.Previous=-1]="Previous",e[e.Next=1]="Next",e))(jh||{});function Ch(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return null==e?[]:Array.from(e.querySelectorAll(bh)).sort(((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER))))}var Eh=(e=>(e[e.Strict=0]="Strict",e[e.Loose=1]="Loose",e))(Eh||{});function Ah(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;var n;return e!==(null==(n=uh(e))?void 0:n.body)&&cd(t,{0:()=>e.matches(bh),1(){let t=e;for(;null!==t;){if(t.matches(bh))return!0;t=t.parentElement}return!1}})}var kh=(e=>(e[e.Keyboard=0]="Keyboard",e[e.Mouse=1]="Mouse",e))(kh||{});function Sh(e){null==e||e.focus({preventScroll:!0})}"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("keydown",(e=>{e.metaKey||e.altKey||e.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")}),!0),document.addEventListener("click",(e=>{1===e.detail?delete document.documentElement.dataset.headlessuiFocusVisible:0===e.detail&&(document.documentElement.dataset.headlessuiFocusVisible="")}),!0));let Fh=["textarea","input"].join(",");function _h(e,t){let{sorted:n=!0,relativeTo:r=null,skipElements:s=[]}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Array.isArray(e)?e.length>0?e[0].ownerDocument:document:e.ownerDocument,a=Array.isArray(e)?n?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;return e.slice().sort(((e,n)=>{let r=t(e),s=t(n);if(null===r||null===s)return 0;let i=r.compareDocumentPosition(s);return i&Node.DOCUMENT_POSITION_FOLLOWING?-1:i&Node.DOCUMENT_POSITION_PRECEDING?1:0}))}(e):e:64&t?function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return null==e?[]:Array.from(e.querySelectorAll(wh)).sort(((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER))))}(e):Ch(e);s.length>0&&a.length>1&&(a=a.filter((e=>!s.some((t=>null!=t&&"current"in t?(null==t?void 0:t.current)===e:t===e))))),r=null!=r?r:i.activeElement;let o,l=(()=>{if(5&t)return 1;if(10&t)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),c=(()=>{if(1&t)return 0;if(2&t)return Math.max(0,a.indexOf(r))-1;if(4&t)return Math.max(0,a.indexOf(r))+1;if(8&t)return a.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),u=32&t?{preventScroll:!0}:{},d=0,h=a.length;do{if(d>=h||d+h<=0)return 0;let e=c+d;if(16&t)e=(e+h)%h;else{if(e<0)return 3;if(e>=h)return 1}o=a[e],null==o||o.focus(u),d+=l}while(o!==i.activeElement);return 6&t&&function(e){var t,n;return null!=(n=null==(t=null==e?void 0:e.matches)?void 0:t.call(e,Fh))&&n}(o)&&o.select(),2}function Th(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Ih(){return Th()||/Android/gi.test(window.navigator.userAgent)}function Rh(e,t,n,s){let i=Ku(n);(0,r.useEffect)((()=>{if(e)return document.addEventListener(t,n,s),()=>document.removeEventListener(t,n,s);function n(e){i.current(e)}}),[e,t,s])}function Ph(e,t,n,s){let i=Ku(n);(0,r.useEffect)((()=>{if(e)return window.addEventListener(t,n,s),()=>window.removeEventListener(t,n,s);function n(e){i.current(e)}}),[e,t,s])}function Oh(e,t,n){let s=Ku(n),i=(0,r.useCallback)((function(e,n){if(e.defaultPrevented)return;let r=n(e);if(null===r||!r.getRootNode().contains(r)||!r.isConnected)return;let i=function e(t){return"function"==typeof t?e(t()):Array.isArray(t)||t instanceof Set?t:[t]}(t);for(let t of i)if(null!==t&&(t.contains(r)||e.composed&&e.composedPath().includes(t)))return;return!Ah(r,Eh.Loose)&&-1!==r.tabIndex&&e.preventDefault(),s.current(e,r)}),[s,t]),a=(0,r.useRef)(null);Rh(e,"pointerdown",(e=>{var t,n;Ih()||(a.current=(null==(n=null==(t=e.composedPath)?void 0:t.call(e))?void 0:n[0])||e.target)}),!0),Rh(e,"pointerup",(e=>{if(Ih()||!a.current)return;let t=a.current;return a.current=null,i(e,(()=>t))}),!0);let o=(0,r.useRef)({x:0,y:0});Rh(e,"touchstart",(e=>{o.current.x=e.touches[0].clientX,o.current.y=e.touches[0].clientY}),!0),Rh(e,"touchend",(e=>{let t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;if(!(Math.abs(t-o.current.x)>=30||Math.abs(n-o.current.y)>=30))return i(e,(()=>yh(e.target)?e.target:null))}),!0),Ph(e,"blur",(e=>i(e,(()=>function(e){return xh(e)&&"IFRAME"===e.nodeName}(window.document.activeElement)?window.document.activeElement:null))),!0)}function Mh(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.useMemo)((()=>uh(...t)),[...t])}const Lh=["features"];var Bh=(e=>(e[e.None=1]="None",e[e.Focusable=2]="Focusable",e[e.Hidden=4]="Hidden",e))(Bh||{});let zh=yd((function(e,t){var n;let{features:r=1}=e,s=(0,a.A)(e,Lh),i={ref:t,"aria-hidden":2===(2&r)||(null!=(n=s["aria-hidden"])?n:void 0),hidden:4===(4&r)||void 0,style:(0,o.A)({position:"fixed",top:1,left:1,width:1,height:0,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},4===(4&r)&&2!==(2&r)&&{display:"none"})};return pd()({ourProps:i,theirProps:s,slot:{},defaultTag:"span",name:"Hidden"})}));let Uh=(0,r.createContext)(null);function qh(e){let{children:t,node:n}=e,[s,i]=(0,r.useState)(null),a=Vh(null!=n?n:s);return r.createElement(Uh.Provider,{value:a},t,null===a&&r.createElement(zh,{features:Bh.Hidden,ref:e=>{var t,n;if(e)for(let r of null!=(n=null==(t=uh(e))?void 0:t.querySelectorAll("html > *, body > *"))?n:[])if(r!==document.body&&r!==document.head&&vh(r)&&null!=r&&r.contains(e)){i(r);break}}}))}function Vh(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var t;return null!=(t=(0,r.useContext)(Uh))?t:e}function Hh(){let e;return{before(t){let{doc:n}=t;var r;let s=n.documentElement,i=null!=(r=n.defaultView)?r:window;e=Math.max(0,i.innerWidth-s.clientWidth)},after(t){let{doc:n,d:r}=t,s=n.documentElement,i=Math.max(0,s.clientWidth-s.offsetWidth),a=Math.max(0,e-i);r.style(s,"paddingRight","".concat(a,"px"))}}}function Wh(){return Th()?{before(e){let{doc:t,d:n,meta:r}=e;function s(e){return r.containers.flatMap((e=>e())).some((t=>t.contains(e)))}n.microTask((()=>{var e;if("auto"!==window.getComputedStyle(t.documentElement).scrollBehavior){let e=Uu();e.style(t.documentElement,"scrollBehavior","auto"),n.add((()=>n.microTask((()=>e.dispose()))))}let r=null!=(e=window.scrollY)?e:window.pageYOffset,i=null;n.addEventListener(t,"click",(e=>{if(yh(e.target))try{let n=e.target.closest("a");if(!n)return;let{hash:r}=new URL(n.href),a=t.querySelector(r);yh(a)&&!s(a)&&(i=a)}catch(n){}}),!0),n.addEventListener(t,"touchstart",(e=>{if(yh(e.target)&&function(e){return vh(e)&&"style"in e}(e.target))if(s(e.target)){let t=e.target;for(;t.parentElement&&s(t.parentElement);)t=t.parentElement;n.style(t,"overscrollBehavior","contain")}else n.style(e.target,"touchAction","none")})),n.addEventListener(t,"touchmove",(e=>{if(yh(e.target)){if(function(e){return xh(e)&&"INPUT"===e.nodeName}(e.target))return;if(s(e.target)){let t=e.target;for(;t.parentElement&&""!==t.dataset.headlessuiPortal&&!(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth);)t=t.parentElement;""===t.dataset.headlessuiPortal&&e.preventDefault()}else e.preventDefault()}}),{passive:!1}),n.add((()=>{var e;let t=null!=(e=window.scrollY)?e:window.pageYOffset;r!==t&&window.scrollTo(0,r),i&&i.isConnected&&(i.scrollIntoView({block:"nearest"}),i=null)}))}))}}:{}}function Gh(e){let t={};for(let n of e)Object.assign(t,n(t));return t}let Kh=function(e,t){let n=e(),r=new Set;return{getSnapshot:()=>n,subscribe:e=>(r.add(e),()=>r.delete(e)),dispatch(e){for(var s=arguments.length,i=new Array(s>1?s-1:0),a=1;a<s;a++)i[a-1]=arguments[a];let o=t[e].call(n,...i);o&&(n=o,r.forEach((e=>e())))}}}((()=>new Map),{PUSH(e,t){var n;let r=null!=(n=this.get(e))?n:{doc:e,count:0,d:Uu(),meta:new Set};return r.count++,r.meta.add(t),this.set(e,r),this},POP(e,t){let n=this.get(e);return n&&(n.count--,n.meta.delete(t)),this},SCROLL_PREVENT(e){let{doc:t,d:n,meta:r}=e,s={doc:t,d:n,meta:Gh(r)},i=[Wh(),Hh(),{before(e){let{doc:t,d:n}=e;n.style(t.documentElement,"overflow","hidden")}}];i.forEach((e=>{let{before:t}=e;return null==t?void 0:t(s)})),i.forEach((e=>{let{after:t}=e;return null==t?void 0:t(s)}))},SCROLL_ALLOW(e){let{d:t}=e;t.dispose()},TEARDOWN(e){let{doc:t}=e;this.delete(t)}});function Qh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>({containers:[]}),s=function(e){return(0,r.useSyncExternalStore)(e.subscribe,e.getSnapshot,e.getSnapshot)}(Kh),i=t?s.get(t):void 0,a=!!i&&i.count>0;return Gu((()=>{if(t&&e)return Kh.dispatch("PUSH",t,n),()=>Kh.dispatch("POP",t,n)}),[e,t]),a}function Yh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[document.body];Qh(lh(e,"scroll-lock"),t,(e=>{var t;return{containers:[...null!=(t=e.containers)?t:[],n]}}))}Kh.subscribe((()=>{let e=Kh.getSnapshot(),t=new Map;for(let[n]of e)t.set(n,n.documentElement.style.overflow);for(let n of e.values()){let e="hidden"===t.get(n.doc),r=0!==n.count;(r&&!e||!r&&e)&&Kh.dispatch(n.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",n),0===n.count&&Kh.dispatch("TEARDOWN",n)}}));let Jh=(0,r.createContext)((()=>{}));function Xh(e){let{value:t,children:n}=e;return r.createElement(Jh.Provider,{value:t},n)}let $h=(0,r.createContext)(!1);function Zh(e){return r.createElement($h.Provider,{value:e.force},e.children)}let em=(0,r.createContext)(void 0);const tm=["id"];let nm=(0,r.createContext)(null);function rm(){let e=(0,r.useContext)(nm);if(null===e){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,rm),e}return e}nm.displayName="DescriptionContext";let sm=yd((function(e,t){let n=(0,r.useId)(),s=(0,r.useContext)(em),{id:i="headlessui-description-".concat(n)}=e,l=(0,a.A)(e,tm),c=rm(),u=$u(t);Gu((()=>c.register(i)),[i,c.register]);let d=s||!1,h=(0,r.useMemo)((()=>(0,o.A)((0,o.A)({},c.slot),{},{disabled:d})),[c.slot,d]),m=(0,o.A)((0,o.A)({ref:u},c.props),{},{id:i});return pd()({ourProps:m,theirProps:l,slot:h,defaultTag:"p",name:c.name||"Description"})})),im=Object.assign(sm,{});function am(e){let t=Qu(e),n=(0,r.useRef)(!1);(0,r.useEffect)((()=>(n.current=!1,()=>{n.current=!0,zu((()=>{n.current&&t()}))})),[t])}var om=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(om||{});function lm(e,t){let n=(0,r.useRef)([]),s=Qu(e);(0,r.useEffect)((()=>{let e=[...n.current];for(let[r,i]of t.entries())if(n.current[r]!==i){let r=s(t,e);return n.current=t,r}}),[s,...t])}let cm=[];!function(e){function t(){"loading"!==document.readyState&&(e(),document.removeEventListener("DOMContentLoaded",t))}"undefined"!=typeof window&&"undefined"!=typeof document&&(document.addEventListener("DOMContentLoaded",t),t())}((()=>{function e(e){if(!yh(e.target)||e.target===document.body||cm[0]===e.target)return;let t=e.target;t=t.closest(bh),cm.unshift(null!=t?t:e.target),cm=cm.filter((e=>null!=e&&e.isConnected)),cm.splice(10)}window.addEventListener("click",e,{capture:!0}),window.addEventListener("mousedown",e,{capture:!0}),window.addEventListener("focus",e,{capture:!0}),document.body.addEventListener("click",e,{capture:!0}),document.body.addEventListener("mousedown",e,{capture:!0}),document.body.addEventListener("focus",e,{capture:!0})}));const um=["initialFocus","initialFocusFallback","containers","features"];function dm(e){if(!e)return new Set;if("function"==typeof e)return new Set(e());let t=new Set;for(let n of e.current)vh(n.current)&&t.add(n.current);return t}var hm=(e=>(e[e.None=0]="None",e[e.InitialFocus=1]="InitialFocus",e[e.TabLock=2]="TabLock",e[e.FocusLock=4]="FocusLock",e[e.RestoreFocus=8]="RestoreFocus",e[e.AutoFocus=16]="AutoFocus",e))(hm||{});let mm=yd((function(e,t){let n=(0,r.useRef)(null),s=$u(n,t),{initialFocus:i,initialFocusFallback:o,containers:l,features:c=15}=e,u=(0,a.A)(e,um);Ju()||(c=0);let d=Mh(n);!function(e,t){let{ownerDocument:n}=t,s=!!(8&e),i=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=(0,r.useRef)(cm.slice());return lm(((e,n)=>{let[r]=e,[s]=n;!0===s&&!1===r&&zu((()=>{t.current.splice(0)})),!1===s&&!0===r&&(t.current=cm.slice())}),[e,cm,t]),Qu((()=>{var e;return null!=(e=t.current.find((e=>null!=e&&e.isConnected)))?e:null}))}(s);lm((()=>{s||(null==n?void 0:n.activeElement)===(null==n?void 0:n.body)&&Sh(i())}),[s]),am((()=>{s&&Sh(i())}))}(c,{ownerDocument:d});let h=pm(c,{ownerDocument:d,container:n,initialFocus:i,initialFocusFallback:o});gm(c,{ownerDocument:d,container:n,containers:l,previousActiveElement:h});let m=function(){let e=(0,r.useRef)(0);return Ph(!0,"keydown",(t=>{"Tab"===t.key&&(e.current=t.shiftKey?1:0)}),!0),e}(),f=Qu((e=>{if(!xh(n.current))return;let t=n.current;cd(m.current,{[om.Forwards]:()=>{_h(t,Dh.First,{skipElements:[e.relatedTarget,o]})},[om.Backwards]:()=>{_h(t,Dh.Last,{skipElements:[e.relatedTarget,o]})}})})),p=lh(!!(2&c),"focus-trap#tab-lock"),g=qu(),v=(0,r.useRef)(!1),x={ref:s,onKeyDown(e){"Tab"==e.key&&(v.current=!0,g.requestAnimationFrame((()=>{v.current=!1})))},onBlur(e){if(!(4&c))return;let t=dm(l);xh(n.current)&&t.add(n.current);let r=e.relatedTarget;yh(r)&&"true"!==r.dataset.headlessuiFocusGuard&&(vm(t,r)||(v.current?_h(n.current,cd(m.current,{[om.Forwards]:()=>Dh.Next,[om.Backwards]:()=>Dh.Previous})|Dh.WrapAround,{relativeTo:e.target}):yh(e.target)&&Sh(e.target)))}},y=pd();return r.createElement(r.Fragment,null,p&&r.createElement(zh,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:f,features:Bh.Focusable}),y({ourProps:x,theirProps:u,defaultTag:"div",name:"FocusTrap"}),p&&r.createElement(zh,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:f,features:Bh.Focusable}))})),fm=Object.assign(mm,{features:hm});function pm(e,t){let{ownerDocument:n,container:s,initialFocus:i,initialFocusFallback:a}=t,o=(0,r.useRef)(null),l=lh(!!(1&e),"focus-trap#initial-focus"),c=Yu();return lm((()=>{if(0===e)return;if(!l)return void(null!=a&&a.current&&Sh(a.current));let t=s.current;t&&zu((()=>{if(!c.current)return;let r=null==n?void 0:n.activeElement;if(null!=i&&i.current){if((null==i?void 0:i.current)===r)return void(o.current=r)}else if(t.contains(r))return void(o.current=r);if(null!=i&&i.current)Sh(i.current);else{if(16&e){if(_h(t,Dh.First|Dh.AutoFocus)!==Nh.Error)return}else if(_h(t,Dh.First)!==Nh.Error)return;if(null!=a&&a.current&&(Sh(a.current),(null==n?void 0:n.activeElement)===a.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}o.current=null==n?void 0:n.activeElement}))}),[a,l,e]),o}function gm(e,t){let{ownerDocument:n,container:r,containers:s,previousActiveElement:i}=t,a=Yu(),o=!!(4&e);Ld(null==n?void 0:n.defaultView,"focus",(e=>{if(!o||!a.current)return;let t=dm(s);xh(r.current)&&t.add(r.current);let n=i.current;if(!n)return;let l=e.target;xh(l)?vm(t,l)?(i.current=l,Sh(l)):(e.preventDefault(),e.stopPropagation(),Sh(n)):Sh(i.current)}),!0)}function vm(e,t){for(let n of e)if(n.contains(t))return!0;return!1}const xm=["ownerDocument"],ym=["enabled","ownerDocument"],bm=["target"];function wm(e){let t=(0,r.useContext)($h),n=(0,r.useContext)(Cm),[s,i]=(0,r.useState)((()=>{var r;if(!t&&null!==n)return null!=(r=n.current)?r:null;if(Wu.isServer)return null;let s=null==e?void 0:e.getElementById("headlessui-portal-root");if(s)return s;if(null===e)return null;let i=e.createElement("div");return i.setAttribute("id","headlessui-portal-root"),e.body.appendChild(i)}));return(0,r.useEffect)((()=>{null!==s&&(null!=e&&e.body.contains(s)||null==e||e.body.appendChild(s))}),[s,e]),(0,r.useEffect)((()=>{t||null!==n&&i(n.current)}),[n,i,t]),s}let Dm=r.Fragment,Nm=yd((function(e,t){let{ownerDocument:n=null}=e,s=(0,a.A)(e,xm),i=(0,r.useRef)(null),o=$u(function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object.assign(e,{[Xu]:t})}((e=>{i.current=e})),t),l=Mh(i),c=null!=n?n:l,u=wm(c),[d]=(0,r.useState)((()=>{var e;return Wu.isServer?null:null!=(e=null==c?void 0:c.createElement("div"))?e:null})),h=(0,r.useContext)(Em),m=Ju();Gu((()=>{!u||!d||u.contains(d)||(d.setAttribute("data-headlessui-portal",""),u.appendChild(d))}),[u,d]),Gu((()=>{if(d&&h)return h.register(d)}),[h,d]),am((()=>{var e;!u||!d||(gh(d)&&u.contains(d)&&u.removeChild(d),u.childNodes.length<=0&&(null==(e=u.parentElement)||e.removeChild(u)))}));let f=pd();return m&&u&&d?(0,rr.createPortal)(f({ourProps:{ref:o},theirProps:s,slot:{},defaultTag:Dm,name:"Portal"}),d):null}));let jm=r.Fragment,Cm=(0,r.createContext)(null);let Em=(0,r.createContext)(null);function Am(){let e=(0,r.useContext)(Em),t=(0,r.useRef)([]),n=Qu((n=>(t.current.push(n),e&&e.register(n),()=>s(n)))),s=Qu((n=>{let r=t.current.indexOf(n);-1!==r&&t.current.splice(r,1),e&&e.unregister(n)})),i=(0,r.useMemo)((()=>({register:n,unregister:s,portals:t})),[n,s,t]);return[t,(0,r.useMemo)((()=>function(e){let{children:t}=e;return r.createElement(Em.Provider,{value:i},t)}),[i])]}let km=yd((function(e,t){let n=$u(t),{enabled:s=!0,ownerDocument:i}=e,l=(0,a.A)(e,ym),c=pd();return s?r.createElement(Nm,(0,o.A)((0,o.A)({},l),{},{ownerDocument:i,ref:n})):c({ourProps:{ref:n},theirProps:l,slot:{},defaultTag:Dm,name:"Portal"})})),Sm=yd((function(e,t){let{target:n}=e,s=(0,a.A)(e,bm),i={ref:$u(t)},o=pd();return r.createElement(Cm.Provider,{value:n},o({ourProps:i,theirProps:s,defaultTag:jm,name:"Popover.Group"}))})),Fm=Object.assign(km,{Group:Sm});const _m=["id","open","onClose","initialFocus","role","autoFocus","__demoMode","unmount"],Tm=["transition","open"],Im=["id","transition"],Rm=["transition"],Pm=["id"];var Om=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Om||{}),Mm=(e=>(e[e.SetTitleId=0]="SetTitleId",e))(Mm||{});let Lm={0:(e,t)=>e.titleId===t.id?e:(0,o.A)((0,o.A)({},e),{},{titleId:t.id})},Bm=(0,r.createContext)(null);function zm(e){let t=(0,r.useContext)(Bm);if(null===t){let t=new Error("<".concat(e," /> is missing a parent <Dialog /> component."));throw Error.captureStackTrace&&Error.captureStackTrace(t,zm),t}return t}function Um(e,t){return cd(t.type,Lm,e,t)}Bm.displayName="DialogContext";let qm=yd((function(e,t){let n=(0,r.useId)(),{id:s="headlessui-dialog-".concat(n),open:i,onClose:o,initialFocus:l,role:c="dialog",autoFocus:u=!0,__demoMode:d=!1,unmount:h=!1}=e,m=(0,a.A)(e,_m),f=(0,r.useRef)(!1);c="dialog"===c||"alertdialog"===c?c:(f.current||(f.current=!0,console.warn("Invalid role [".concat(c,"] passed to <Dialog />. Only `dialog` and and `alertdialog` are supported. Using `dialog` instead."))),"dialog");let p=id();void 0===i&&null!==p&&(i=(p&sd.Open)===sd.Open);let g=(0,r.useRef)(null),v=$u(g,t),x=Mh(g),y=i?0:1,[b,w]=(0,r.useReducer)(Um,{titleId:null,descriptionId:null,panelRef:(0,r.createRef)()}),D=Qu((()=>o(!1))),N=Qu((e=>w({type:0,id:e}))),j=!!Ju()&&0===y,[C,E]=Am(),A={get current(){var e;return null!=(e=b.panelRef.current)?e:g.current}},k=Vh(),{resolveContainers:S}=function(){let{defaultContainers:e=[],portals:t,mainTreeNode:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=Mh(n),s=Qu((()=>{var s,i;let a=[];for(let t of e)null!==t&&(vh(t)?a.push(t):"current"in t&&vh(t.current)&&a.push(t.current));if(null!=t&&t.current)for(let e of t.current)a.push(e);for(let e of null!=(s=null==r?void 0:r.querySelectorAll("html > *, body > *"))?s:[])e!==document.body&&e!==document.head&&vh(e)&&"headlessui-portal-root"!==e.id&&(n&&(e.contains(n)||e.contains(null==(i=null==n?void 0:n.getRootNode())?void 0:i.host))||a.some((t=>e.contains(t)))||a.push(e));return a}));return{resolveContainers:s,contains:Qu((e=>s().some((t=>t.contains(e)))))}}({mainTreeNode:k,portals:C,defaultContainers:[A]}),F=null!==p&&(p&sd.Closing)===sd.Closing;ph(!d&&!F&&j,{allowed:Qu((()=>{var e,t;return[null!=(t=null==(e=g.current)?void 0:e.closest("[data-headlessui-portal]"))?t:null]})),disallowed:Qu((()=>{var e;return[null!=(e=null==k?void 0:k.closest("body > *:not(#headlessui-portal-root)"))?e:null]}))});let _=sh.get(null);Gu((()=>{if(j)return _.actions.push(s),()=>_.actions.pop(s)}),[_,s,j]);let T=ah(_,(0,r.useCallback)((e=>_.selectors.isTop(e,s)),[_,s]));Oh(T,S,(e=>{e.preventDefault(),D()})),ch(T,null==x?void 0:x.defaultView,(e=>{e.preventDefault(),e.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur(),D()})),Yh(!d&&!F&&j,x,S),function(e,t,n){let s=Ku((e=>{let t=e.getBoundingClientRect();0===t.x&&0===t.y&&0===t.width&&0===t.height&&n()}));(0,r.useEffect)((()=>{if(!e)return;let n=null===t?null:xh(t)?t:t.current;if(!n)return;let r=Uu();if("undefined"!=typeof ResizeObserver){let e=new ResizeObserver((()=>s.current(n)));e.observe(n),r.add((()=>e.disconnect()))}if("undefined"!=typeof IntersectionObserver){let e=new IntersectionObserver((()=>s.current(n)));e.observe(n),r.add((()=>e.disconnect()))}return()=>r.dispose()}),[t,s,e])}(j,g,D);let[I,R]=function(){let[e,t]=(0,r.useState)([]);return[e.length>0?e.join(" "):void 0,(0,r.useMemo)((()=>function(e){let n=Qu((e=>(t((t=>[...t,e])),()=>t((t=>{let n=t.slice(),r=n.indexOf(e);return-1!==r&&n.splice(r,1),n}))))),s=(0,r.useMemo)((()=>({register:n,slot:e.slot,name:e.name,props:e.props,value:e.value})),[n,e.slot,e.name,e.props,e.value]);return r.createElement(nm.Provider,{value:s},e.children)}),[t])]}(),P=(0,r.useMemo)((()=>[{dialogState:y,close:D,setTitleId:N,unmount:h},b]),[y,b,D,N,h]),O=(0,r.useMemo)((()=>({open:0===y})),[y]),M={ref:v,id:s,role:c,tabIndex:-1,"aria-modal":d?void 0:0===y||void 0,"aria-labelledby":b.titleId,"aria-describedby":I,unmount:h},L=!function(){var e;let[t]=(0,r.useState)((()=>"undefined"!=typeof window&&"function"==typeof window.matchMedia?window.matchMedia("(pointer: coarse)"):null)),[n,s]=(0,r.useState)(null!=(e=null==t?void 0:t.matches)&&e);return Gu((()=>{if(t)return t.addEventListener("change",e),()=>t.removeEventListener("change",e);function e(e){s(e.matches)}}),[t]),n}(),B=hm.None;j&&!d&&(B|=hm.RestoreFocus,B|=hm.TabLock,u&&(B|=hm.AutoFocus),L&&(B|=hm.InitialFocus));let z=pd();return r.createElement(od,null,r.createElement(Zh,{force:!0},r.createElement(Fm,null,r.createElement(Bm.Provider,{value:P},r.createElement(Sm,{target:g},r.createElement(Zh,{force:!1},r.createElement(R,{slot:O},r.createElement(E,null,r.createElement(fm,{initialFocus:l,initialFocusFallback:g,containers:S,features:B},r.createElement(Xh,{value:D},z({ourProps:M,theirProps:m,slot:O,defaultTag:Vm,features:Hm,visible:0===y,name:"Dialog"})))))))))))})),Vm="div",Hm=md.RenderStrategy|md.Static;let Wm=yd((function(e,t){let{transition:n=!1,open:s}=e,i=(0,a.A)(e,Tm),l=id(),c=e.hasOwnProperty("open")||null!==l,u=e.hasOwnProperty("onClose");if(!c&&!u)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!c)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!u)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!l&&"boolean"!=typeof e.open)throw new Error("You provided an `open` prop to the `Dialog`, but the value is not a boolean. Received: ".concat(e.open));if("function"!=typeof e.onClose)throw new Error("You provided an `onClose` prop to the `Dialog`, but the value is not a function. Received: ".concat(e.onClose));return void 0===s&&!n||i.static?r.createElement(qh,null,r.createElement(qm,(0,o.A)({ref:t,open:s},i))):r.createElement(qh,null,r.createElement(Od,{show:s,transition:n,unmount:i.unmount},r.createElement(qm,(0,o.A)({ref:t},i))))})),Gm=yd((function(e,t){let n=(0,r.useId)(),{id:s="headlessui-dialog-panel-".concat(n),transition:i=!1}=e,l=(0,a.A)(e,Im),[{dialogState:c,unmount:u},d]=zm("Dialog.Panel"),h=$u(t,d.panelRef),m=(0,r.useMemo)((()=>({open:0===c})),[c]),f=Qu((e=>{e.stopPropagation()})),p={ref:h,id:s,onClick:f},g=i?Pd:r.Fragment,v=i?{unmount:u}:{},x=pd();return r.createElement(g,(0,o.A)({},v),x({ourProps:p,theirProps:l,slot:m,defaultTag:"div",name:"Dialog.Panel"}))})),Km=(yd((function(e,t){let{transition:n=!1}=e,s=(0,a.A)(e,Rm),[{dialogState:i,unmount:l}]=zm("Dialog.Backdrop"),c=(0,r.useMemo)((()=>({open:0===i})),[i]),u={ref:t,"aria-hidden":!0},d=n?Pd:r.Fragment,h=n?{unmount:l}:{},m=pd();return r.createElement(d,(0,o.A)({},h),m({ourProps:u,theirProps:s,slot:c,defaultTag:"div",name:"Dialog.Backdrop"}))})),yd((function(e,t){let n=(0,r.useId)(),{id:s="headlessui-dialog-title-".concat(n)}=e,i=(0,a.A)(e,Pm),[{dialogState:o,setTitleId:l}]=zm("Dialog.Title"),c=$u(t);(0,r.useEffect)((()=>(l(s),()=>l(null))),[s,l]);let u=(0,r.useMemo)((()=>({open:0===o})),[o]),d={ref:c,id:s};return pd()({ourProps:d,theirProps:i,slot:u,defaultTag:"h2",name:"Dialog.Title"})}))),Qm=Object.assign(Wm,{Panel:Gm,Title:Km,Description:im});const Ym=e=>{let{isOpen:t,onClose:n,onLeaveChat:s,onDeleteChat:i,onViewProfile:a,participantId:o,participantName:l,isGroup:c}=e;const[u,d]=(0,r.useState)(!1);return(0,Et.jsx)(Od,{appear:!0,show:t,as:r.Fragment,children:(0,Et.jsxs)(Qm,{as:"div",className:"relative z-50",onClose:n,children:[(0,Et.jsx)(Od.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,Et.jsx)("div",{className:"fixed inset-0 bg-black/25"})}),(0,Et.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,Et.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,Et.jsx)(Od.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,Et.jsxs)(Qm.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-lg bg-white p-6 text-left align-middle shadow-xl transition-all",children:[(0,Et.jsx)(Qm.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 mb-4",children:"Chat Options"}),(0,Et.jsxs)("div",{className:"space-y-3",children:[!c&&o&&(0,Et.jsxs)("button",{onClick:()=>{"function"===typeof a&&a(),n()},className:"w-full flex items-center px-4 py-2 text-gray-700 hover:bg-gray-50 rounded transition-colors duration-150",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"View ",l||"Participant","'s Profile"]}),(0,Et.jsxs)("button",{onClick:async()=>{if(window.confirm("Are you sure you want to delete this chat? This action cannot be undone.")){d(!0);try{"function"===typeof i&&await i()}catch(e){console.error("Error deleting chat:",e),alert("Failed to delete chat. Please try again.")}finally{d(!1),n()}}},disabled:u,className:"w-full flex items-center px-4 py-2 text-red-600 hover:bg-red-50 rounded transition-colors duration-150",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),u?"Deleting...":"Delete Chat"]}),c&&(0,Et.jsxs)("button",{onClick:()=>{window.confirm("Are you sure you want to leave this group chat?")&&("function"===typeof s&&s(),n())},className:"w-full flex items-center px-4 py-2 text-red-600 hover:bg-red-50 rounded transition-colors duration-150",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"})}),"Leave Group"]}),(0,Et.jsxs)("button",{onClick:n,className:"w-full flex items-center px-4 py-2 text-gray-600 hover:bg-gray-50 rounded transition-colors duration-150",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}),"Cancel"]})]})]})})})})]})})},Jm=e=>{let{chatId:t,onDeleteChat:n,showBackButton:s=!1,onBack:i}=e;const a=de(),{user:l}=kt(),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(!1),[m,f]=(0,r.useState)(!0),[p,g]=(0,r.useState)(null);(0,r.useEffect)((()=>{(async()=>{if(t)try{f(!0);const e=await(0,Dt.x7)((0,Dt.H9)(wt.db,"chats",t));e.exists()?u((0,o.A)({id:e.id},e.data())):g("Chat not found")}catch(gb){console.error("Error fetching chat:",gb),g("Failed to load chat details")}finally{f(!1)}})()}),[t]);const v=()=>{"function"===typeof n&&n(),h(!1)},x=(()=>{if(!c||"group"===c.type||!c.participants)return null;const e=Object.entries(c.participants).find((e=>{let[t]=e;return t!==(null===l||void 0===l?void 0:l.uid)}));return e?(0,o.A)({id:e[0]},e[1]):null})();return(0,Et.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-white",children:[(0,Et.jsxs)("div",{className:"flex items-center flex-1 min-w-0",children:[s&&(0,Et.jsx)("button",{onClick:()=>{"function"===typeof i&&i()},className:"mr-2 p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Back to chat list",children:(0,Et.jsx)(Lu,{size:20})}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h2",{className:"text-lg font-medium text-gray-900 truncate",children:(()=>{var e;if(m)return"Loading...";if(p)return"Error loading chat";if(!c)return"";if("group"===c.type)return c.name;const t=null===(e=Object.entries(c.participants||{}).find((e=>{let[t]=e;return t!==(null===l||void 0===l?void 0:l.uid)})))||void 0===e?void 0:e[1];return(null===t||void 0===t?void 0:t.displayName)||"Unknown User"})()}),"group"===(null===c||void 0===c?void 0:c.type)&&(0,Et.jsxs)("p",{className:"text-sm text-gray-500",children:[null!==c&&void 0!==c&&c.participants?Object.values(c.participants).filter((e=>e.active)).length:0," participants"]})]})]}),(0,Et.jsx)("button",{onClick:()=>h(!0),className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",children:(0,Et.jsx)(Bu,{size:20})}),(0,Et.jsx)(Ym,{isOpen:d,onClose:()=>h(!1),onDeleteChat:v,onLeaveChat:v,onViewProfile:x?()=>{return e=x.id,a("/buddy/".concat(e)),void h(!1);var e}:void 0,participantId:null===x||void 0===x?void 0:x.id,participantName:null===x||void 0===x?void 0:x.displayName,isGroup:"group"===(null===c||void 0===c?void 0:c.type)})]})},Xm=e=>{let{isOpen:t,onClose:n,onChatCreated:s}=e;const{user:i}=kt(),[a,l]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)(""),[m,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)("");(0,r.useEffect)((()=>{(async()=>{if(i&&t)try{f(!0),g("");const e=(0,Dt.H9)(wt.db,"profiles",i.uid),t=await(0,Dt.x7)(e),n=t.exists()&&t.data().buddyList||{},r=Object.entries(n).filter((e=>{let[t,n]=e;return"accepted"===n.status})).map((e=>{let[t]=e;return t})),s=r.map((async e=>{try{const t=await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",e));return t.exists()?(0,o.A)({id:e},t.data()):null}catch(gb){return console.error("Error fetching buddy ".concat(e,":"),gb),null}})),a=(await Promise.all(s)).filter(Boolean).sort(((e,t)=>(e.name||"").localeCompare(t.name||"")));u(a)}catch(gb){console.error("Error fetching buddies:",gb),g("Failed to load buddies")}finally{f(!1)}})(),l([]),h("")}),[i,t]);const v=c.filter((e=>(e.name||"").toLowerCase().includes(d.toLowerCase())||(e.email||"").toLowerCase().includes(d.toLowerCase())));return(0,Et.jsx)(Od,{appear:!0,show:t,as:r.Fragment,children:(0,Et.jsxs)(Qm,{as:"div",className:"relative z-50",onClose:n,children:[(0,Et.jsx)(Od.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,Et.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,Et.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,Et.jsx)(Od.Child,{as:r.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,Et.jsxs)(Qm.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-lg bg-white p-6 shadow-xl transition-all",children:[(0,Et.jsx)(Qm.Title,{as:"h3",className:"text-lg font-medium text-gray-900",children:"New Chat"}),p&&(0,Et.jsx)("div",{className:"mt-2 p-2 text-sm text-red-600 bg-red-50 rounded",children:p}),(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 border rounded-lg bg-white",children:[(0,Et.jsx)(Hc,{className:"text-gray-400",size:20}),(0,Et.jsx)("input",{type:"text",value:d,onChange:e=>h(e.target.value),placeholder:"Search buddies...",className:"flex-1 outline-none"})]}),a.length>0&&(0,Et.jsxs)("div",{className:"mt-2 flex items-center gap-2",children:[(0,Et.jsx)(La,{size:16,className:"text-gray-500"}),(0,Et.jsxs)("span",{className:"text-sm text-gray-600",children:[a.length," selected"]})]}),(0,Et.jsx)("div",{className:"mt-4 max-h-60 overflow-y-auto",children:m?(0,Et.jsx)("div",{className:"flex justify-center py-4",children:(0,Et.jsx)("div",{className:"animate-spin h-6 w-6 border-2 border-blue-500 border-t-transparent rounded-full"})}):0===c.length?(0,Et.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No buddies found. Add some buddies first!"}):0===v.length?(0,Et.jsx)("p",{className:"text-center text-gray-500 py-4",children:"No buddies match your search"}):v.map((e=>(0,Et.jsxs)("label",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[(0,Et.jsx)("input",{type:"checkbox",checked:a.includes(e.id),onChange:()=>{return t=e.id,void l((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]));var t},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,Et.jsxs)("div",{className:"flex-1",children:[(0,Et.jsx)("p",{className:"font-medium text-gray-900",children:e.name||"Unknown User"}),e.email&&!e.hideEmail&&(0,Et.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]},e.id)))})]}),(0,Et.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,Et.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded-md",children:"Cancel"}),(0,Et.jsx)("button",{type:"button",onClick:async()=>{if(0!==a.length)try{if(f(!0),g(""),1===a.length){const e=a[0],t=(0,Dt.rJ)(wt.db,"chats"),n=(0,Dt.P)(t,(0,Dt._M)("activeParticipants","array-contains",i.uid)),r=(await(0,Dt.GG)(n)).docs.find((t=>{const n=t.data();return"direct"===n.type&&2===n.activeParticipants.length&&n.activeParticipants.includes(e)}));if(r)return console.log("Found existing chat:",r.id),void s(r.id)}const e=await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",i.uid)),t=e.exists()&&e.data().name||"Unknown User",n=a.length>1,r={[i.uid]:{joined:(0,Dt.O5)(),active:!0,displayName:t}};a.forEach((e=>{const t=c.find((t=>t.id===e));r[e]={joined:(0,Dt.O5)(),active:!0,displayName:(null===t||void 0===t?void 0:t.name)||"Unknown User"}}));const l={type:n?"group":"direct",createdBy:i.uid,createdAt:(0,Dt.O5)(),lastMessageAt:(0,Dt.O5)(),participants:r,activeParticipants:[i.uid,...a],names:(0,o.A)({[i.uid]:t},a.reduce(((e,t)=>{const n=c.find((e=>e.id===t));return e[t]=(null===n||void 0===n?void 0:n.name)||"Unknown User",e}),{}))};if(n){const e=a.map((e=>{var t;return(null===(t=c.find((t=>t.id===e)))||void 0===t?void 0:t.name)||"Unknown User"})).join(", ");l.name="Group: ".concat(e)}const u=await(0,Dt.gS)((0,Dt.rJ)(wt.db,"chats"),l);s(u.id)}catch(gb){console.error("Error creating chat:",gb),g("Failed to create chat")}finally{f(!1)}},disabled:0===a.length||m,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 rounded-md disabled:bg-blue-300",children:m?"Creating...":"Start Chat"})]})]})})})})]})})},$m=e=>{let{chatNotifications:t,isSmallScreen:n}=e;const{user:s}=kt(),i=le(),[a,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(null),[h,m]=(0,r.useState)(!0);(0,r.useEffect)((()=>{var e;null!==(e=i.state)&&void 0!==e&&e.chatId&&(o(i.state.chatId),n&&m(!1))}),[i.state,n]),(0,r.useEffect)((()=>{n&&a?m(!1):n||m(!0)}),[n,a]),(0,r.useEffect)((()=>{a?(null!==s&&void 0!==s&&s.uid&&Xc.default.markTabNotificationsAsRead(s.uid,"chat",a,"chat"),d({id:a,chatId:a})):d(null)}),[a,s]);const f="\n    ".concat(n?"w-full":"w-1/3 md:w-2/5 lg:w-1/3"," \n    border-r flex flex-col bg-gray-50\n    ").concat(n&&!h?"hidden":"block","\n  "),p="\n    flex-1 flex flex-col overflow-hidden\n    ".concat(n&&h?"hidden":"flex","\n  ");return(0,Et.jsxs)("div",{className:"h-full w-full flex bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Et.jsx)("div",{className:f,children:(0,Et.jsx)(Mu,{selectedChatId:a,onChatSelect:e=>{o(e),n&&m(!1)},onNewChat:()=>c(!0),isSmallScreen:n})}),(0,Et.jsx)("div",{className:p,children:a?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Jm,{chatId:a,onDeleteChat:async()=>{try{if(!a||null===s||void 0===s||!s.uid)return void console.error("Cannot delete chat: Missing chat ID or user ID");await Ps.default.deleteChat(a,s.uid),o(null),d(null),m(!0)}catch(e){console.error("Error deleting chat:",e),alert("Failed to delete chat. Please try again.")}},showBackButton:n,onBack:()=>{m(!0)}}),u&&(0,Et.jsx)("div",{className:"flex-1 flex flex-col",children:(0,Et.jsx)($c,{context:u,contextType:"personal",isOpen:!0,onClose:()=>{}})})]}):(0,Et.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,Et.jsxs)("div",{className:"text-center",children:[(0,Et.jsx)("p",{className:"mb-2",children:"Select a chat or start a new conversation"}),(0,Et.jsx)("button",{onClick:()=>c(!0),className:"text-blue-500 hover:underline",children:"Start New Chat"})]})})}),l&&(0,Et.jsx)(Xm,{isOpen:l,onClose:()=>c(!1),onChatCreated:e=>{o(e),c(!1),n&&m(!1)}})]})},Zm=()=>{const{user:e}=kt(),[t,n]=(0,r.useState)({}),[s,i]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{const e=()=>{i(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,r.useEffect)((()=>{if(!e)return;const t=(0,Dt.P)((0,Dt.rJ)(wt.db,"chats"),(0,Dt._M)("activeParticipants","array-contains",e.uid));(0,Dt.GG)(t).then((t=>{const r=t.docs.map((e=>e.id)).map((t=>Xc.default.subscribeToItemNotifications(e.uid,"chat",t,(e=>{n((n=>(0,o.A)((0,o.A)({},n),{},{[t]:e.totalCount})))}))));return()=>{r.forEach((e=>e&&e()))}})).catch((e=>{console.error("Error fetching chats:",e),n({})}))}),[e]),(0,Et.jsx)(ui,{children:(0,Et.jsx)("div",{className:"h-full w-full chat-container smooth-scroll no-overscroll",children:(0,Et.jsx)($m,{chatNotifications:t,isSmallScreen:s})})})},ef=()=>{const{user:e}=kt(),t=de(),[s,i]=(0,r.useState)([]),[a,l]=(0,r.useState)([]),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)(""),[m,f]=(0,r.useState)([]),[p,g]=(0,r.useState)(""),[v,x]=(0,r.useState)(!1),[y,b]=(0,r.useState)("buddies"),[w,D]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=()=>{D(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>{(async()=>{if(e)try{const t=(0,Dt.P)((0,Dt.rJ)(wt.db,"notifications"),(0,Dt._M)("toUser","==",e.uid),(0,Dt._M)("read","==",!1),(0,Dt._M)("type","==","buddy_request")),n=await(0,Dt.GG)(t);console.log("Found ".concat(n.size," buddy request notifications to mark as read"));for(const r of n.docs)await Xc.default.markNotificationAsRead(r.id,e.uid)}catch(gb){console.error("Error marking buddy notifications as read:",gb)}})()}),[e]);const N=(0,r.useCallback)((async()=>{if(d&&!(d.length<2))try{var t;x(!0),g("");const i=(null===(t=(await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",e.uid))).data())||void 0===t?void 0:t.buddyList)||{},a=(0,Dt.rJ)(wt.db,"profiles"),l=await(0,Dt.GG)(a),c=[];for(const t of l.docs)if(t.id!==e.uid){var n,r;const e=t.data(),a=d.toLowerCase(),l=null===(n=e.name)||void 0===n?void 0:n.toLowerCase().includes(a),u=null===(r=e.email)||void 0===r?void 0:r.toLowerCase().includes(a);if(l||u){var s;const n=(null===(s=i[t.id])||void 0===s?void 0:s.status)||"none";c.push((0,o.A)((0,o.A)({id:t.id},e),{},{buddyStatus:n}))}}f(c)}catch(gb){console.error("Error searching users:",gb),g("Failed to search users")}finally{x(!1)}}),[d,null===e||void 0===e?void 0:e.uid]);(0,r.useEffect)((()=>{e&&j(e.uid)}),[e]),(0,r.useEffect)((()=>{const e=setTimeout((()=>{d.length>=2?N():f([])}),300);return()=>clearTimeout(e)}),[d,N]);const j=async e=>{try{var t;x(!0);const n=(0,Dt.H9)(wt.db,"profiles",e),r=await(0,Dt.x7)(n);if(!r.exists())return void console.error("User profile document not found");const s=(null===(t=r.data())||void 0===t?void 0:t.buddyList)||{},a=[],c=[],d=[],h=Object.entries(s).map((async e=>{let[t,n]=e;try{const e=await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",t));if(e.exists()){const r=(0,o.A)((0,o.A)({id:t},e.data()),{},{requestStatus:n.status,initiator:n.initiator});"accepted"===n.status?a.push(r):"pending"===n.status&&(n.initiator?c.push(r):d.push(r))}return null}catch(gb){return console.error("Error fetching buddy ".concat(t,":"),gb),null}}));await Promise.all(h);const m=(e,t)=>(e.name||"").localeCompare(t.name||"");i(a.sort(m)),l(c.sort(m)),u(d.sort(m))}catch(gb){console.error("Error fetching buddies:",gb),g("Failed to load buddy list")}finally{x(!1)}},C=async(t,n)=>{if(e)try{x(!0),g("");const r=(0,Dt.wP)(wt.db);if(n){const n=(0,Dt.H9)(wt.db,"profiles",e.uid),s=(0,Dt.H9)(wt.db,"profiles",t);r.update(n,{["buddyList.".concat(t,".status")]:"accepted"}),r.update(s,{["buddyList.".concat(e.uid,".status")]:"accepted"})}else{const n=(0,Dt.H9)(wt.db,"profiles",e.uid),s=(0,Dt.H9)(wt.db,"profiles",t);r.update(n,{["buddyList.".concat(t)]:(0,Dt.CL)()}),r.update(s,{["buddyList.".concat(e.uid)]:(0,Dt.CL)()})}await r.commit(),j(e.uid)}catch(gb){console.error("Error handling buddy request:",gb),g("Failed to process buddy request")}finally{x(!1)}},E=async t=>{if(e)try{x(!0),g("");const r=(await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",e.uid))).data();if(((null===r||void 0===r?void 0:r.buddyList)||{})[t])return void g("Buddy request already sent or exists");const s=(0,Dt.wP)(wt.db),i=(0,Dt.H9)(wt.db,"profiles",e.uid);s.update(i,{["buddyList.".concat(t)]:{status:"pending",timestamp:(0,Dt.O5)(),initiator:!0}});const a=(0,Dt.H9)(wt.db,"profiles",t);s.update(a,{["buddyList.".concat(e.uid)]:{status:"pending",timestamp:(0,Dt.O5)(),initiator:!1}}),await s.commit(),Promise.resolve().then(n.bind(n,4733)).then((n=>{n.default.createBuddyRequestNotification({fromUser:e.uid,fromUserName:(null===r||void 0===r?void 0:r.name)||e.displayName||e.email,toUser:t,requestId:e.uid})})),j(e.uid)}catch(gb){console.error("Error sending buddy request:",gb),g("Failed to send buddy request")}finally{x(!1)}},A=(e,n)=>(0,Et.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between p-3 border-b hover:bg-gray-50 transition-colors",children:[(0,Et.jsxs)("div",{className:"flex-grow cursor-pointer mb-2 md:mb-0 w-full md:w-auto",onClick:()=>t("/buddy/".concat(e.id)),children:[(0,Et.jsxs)("div",{className:"flex items-center",children:[e.photoURL&&""!==e.photoURL.trim()?(0,Et.jsx)("img",{src:e.photoURL,alt:e.name||"User",className:"w-10 h-10 rounded-full mr-3 object-cover",onError:e=>{e.target.onerror=null,e.target.style.display="none",e.target.parentNode.querySelector(".fallback-avatar").style.display="flex"}}):null,(0,Et.jsx)("div",{className:"w-10 h-10 rounded-full mr-3 bg-blue-100 flex items-center justify-center fallback-avatar ".concat(e.photoURL&&""!==e.photoURL.trim()?"hidden":""),children:(0,Et.jsx)("span",{className:"text-sm font-medium text-blue-600",children:e.name&&""!==e.name.trim()?e.name.trim()[0].toUpperCase():"?"})}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"font-medium text-gray-800",children:e.name||"Unknown User"}),!e.hideEmail&&e.email&&(0,Et.jsx)("p",{className:"text-xs text-gray-500",children:e.email})]})]}),(0,Et.jsxs)("div",{className:"mt-2 pl-12",children:[(0,Et.jsx)(gn,{certificationLevel:e.certificationLevel,specialties:e.specialties,numberOfDives:e.numberOfDives,size:"small",showSections:!1}),(0,Et.jsxs)("div",{className:"flex flex-wrap gap-2 mt-1",children:[e.certificationLevel&&(0,Et.jsx)("span",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-0.5 rounded",children:e.certificationLevel}),e.numberOfDives>0&&(0,Et.jsxs)("span",{className:"text-xs text-gray-600 bg-gray-100 px-2 py-0.5 rounded",children:[e.numberOfDives," dives"]})]})]})]}),(0,Et.jsxs)("div",{className:"flex ".concat(w?"flex-col w-full space-y-2":"space-x-2"),children:[(0,Et.jsx)("button",{onClick:()=>t("/buddy/".concat(e.id)),className:"text-xs py-1.5 px-3 bg-gray-100 text-gray-700 rounded border border-gray-200 hover:bg-gray-200 transition-colors ".concat(w?"w-full":""),children:"View Profile"}),n]})]},e.id);return(0,Et.jsxs)("div",{className:"max-w-4xl mx-auto p-3 md:p-4 bg-white md:shadow-sm md:rounded-lg",children:[p&&(0,Et.jsx)("div",{className:"mb-4 p-3 bg-red-50 text-red-700 rounded-md text-sm border border-red-100",children:p}),w&&(0,Et.jsx)("div",{className:"mb-4 border-b",children:(0,Et.jsxs)("div",{className:"flex",children:[(0,Et.jsxs)("button",{onClick:()=>b("buddies"),className:"py-2 px-4 text-sm font-medium ".concat("buddies"===y?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:["My Buddies ",s.length>0&&"(".concat(s.length,")")]}),(0,Et.jsxs)("button",{onClick:()=>b("requests"),className:"py-2 px-4 text-sm font-medium ".concat("requests"===y?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:["Requests ",c.length+a.length>0&&"(".concat(c.length+a.length,")")]}),(0,Et.jsx)("button",{onClick:()=>b("search"),className:"py-2 px-4 text-sm font-medium ".concat("search"===y?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:"Find Buddies"})]})}),(!w||"search"===y)&&(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:d,onChange:e=>h(e.target.value),className:"w-full p-2 pl-9 border border-gray-300 rounded focus:border-blue-500 focus:ring-1 focus:ring-blue-500 text-sm",disabled:v}),(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 absolute left-3 top-3 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),1===d.length&&(0,Et.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Type at least 2 characters to search"})]}),v&&(0,Et.jsx)("div",{className:"text-center py-4",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"})}),!v&&m.length>0&&(!w||"search"===y)&&(0,Et.jsxs)("div",{className:"mb-6",children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-2 tracking-wider",children:"Search Results"}),(0,Et.jsx)("div",{className:"bg-white rounded-lg overflow-hidden border border-gray-200",children:m.map((e=>A(e,"none"===e.buddyStatus?(0,Et.jsx)("button",{onClick:()=>E(e.id),className:"text-xs py-1.5 px-3 bg-blue-50 text-blue-700 rounded border border-blue-200 hover:bg-blue-100 transition-colors ".concat(w?"w-full":""),disabled:v,children:"Add Buddy"}):"pending"===e.buddyStatus?(0,Et.jsx)("div",{className:"text-xs py-1.5 px-3 bg-gray-50 text-gray-500 rounded border border-gray-200",children:"Request Pending"}):(0,Et.jsx)("div",{className:"text-xs py-1.5 px-3 bg-green-50 text-green-700 rounded border border-green-200",children:"Already Buddies"}))))})]}),!v&&d.length>=2&&0===m.length&&(!w||"search"===y)&&(0,Et.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm bg-gray-50 rounded-lg border border-gray-200",children:"No users found matching your search"}),c.length>0&&(!w||"requests"===y)&&(0,Et.jsxs)("div",{className:"mb-6",children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-2 tracking-wider",children:"Incoming Buddy Requests"}),(0,Et.jsx)("div",{className:"bg-white rounded-lg overflow-hidden border border-gray-200",children:c.map((e=>A(e,(0,Et.jsxs)("div",{className:"flex ".concat(w?"flex-col space-y-2 w-full":"space-x-2"),children:[(0,Et.jsx)("button",{onClick:()=>C(e.id,!0),className:"text-xs py-1.5 px-3 bg-green-50 text-green-700 rounded border border-green-200 hover:bg-green-100 transition-colors ".concat(w?"w-full":""),disabled:v,children:"Accept"}),(0,Et.jsx)("button",{onClick:()=>C(e.id,!1),className:"text-xs py-1.5 px-3 bg-red-50 text-red-700 rounded border border-red-200 hover:bg-red-100 transition-colors ".concat(w?"w-full":""),disabled:v,children:"Decline"})]}))))})]}),a.length>0&&(!w||"requests"===y)&&(0,Et.jsxs)("div",{className:"mb-6",children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-2 tracking-wider",children:"Pending Requests"}),(0,Et.jsx)("div",{className:"bg-white rounded-lg overflow-hidden border border-gray-200",children:a.map((e=>A(e,(0,Et.jsx)("div",{className:"text-xs py-1.5 px-3 bg-gray-50 text-gray-500 rounded border border-gray-200",children:"Awaiting Response"}))))})]}),(!w||"buddies"===y)&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-2 tracking-wider",children:"My Buddies"}),v&&0===s.length?(0,Et.jsx)("p",{className:"text-gray-500 text-sm text-center py-4",children:"Loading buddies..."}):0===s.length?(0,Et.jsxs)("div",{className:"text-center py-6 bg-gray-50 rounded-lg border border-gray-200",children:[(0,Et.jsx)("p",{className:"text-gray-500 text-sm mb-2",children:"No buddies yet"}),(0,Et.jsx)("button",{onClick:()=>w?b("search"):null,className:"text-xs py-1.5 px-4 bg-blue-50 text-blue-700 rounded border border-blue-200 hover:bg-blue-100 transition-colors",children:"Find Buddies"})]}):(0,Et.jsx)("div",{className:"bg-white rounded-lg overflow-hidden border border-gray-200",children:s.map((n=>A(n,(0,Et.jsxs)("div",{className:"flex ".concat(w?"flex-col space-y-2 w-full":"space-x-2"),children:[(0,Et.jsx)("button",{onClick:()=>(async n=>{try{var r;x(!0);const i=await(0,Dt.gS)((0,Dt.rJ)(wt.db,"chats"),{type:"direct",participants:{[e.uid]:{joined:(0,Dt.O5)(),active:!0,displayName:e.displayName||"Unknown User"},[n]:{joined:(0,Dt.O5)(),active:!0,displayName:(null===(r=s.find((e=>e.id===n)))||void 0===r?void 0:r.name)||"Unknown User"}},activeParticipants:[e.uid,n],createdAt:(0,Dt.O5)(),createdBy:e.uid,lastMessageAt:(0,Dt.O5)()});t("/messages",{state:{chatId:i.id}})}catch(gb){console.error("Error starting chat:",gb),g("Failed to start chat")}finally{x(!1)}})(n.id),className:"text-xs py-1.5 px-3 bg-blue-50 text-blue-700 rounded border border-blue-200 hover:bg-blue-100 transition-colors ".concat(w?"w-full":""),disabled:v,children:"Message"}),(0,Et.jsx)("button",{onClick:()=>(async t=>{if(e&&window.confirm("Are you sure you want to remove this buddy? This action cannot be undone."))try{x(!0),g("");const n=(0,Dt.wP)(wt.db),r=(0,Dt.H9)(wt.db,"profiles",e.uid);n.update(r,{["buddyList.".concat(t)]:(0,Dt.CL)()});const s=(0,Dt.H9)(wt.db,"profiles",t);n.update(s,{["buddyList.".concat(e.uid)]:(0,Dt.CL)()}),await n.commit(),j(e.uid)}catch(gb){console.error("Error removing buddy:",gb),g("Failed to remove buddy")}finally{x(!1)}})(n.id),className:"text-xs py-1.5 px-3 bg-red-50 text-red-700 rounded border border-red-200 hover:bg-red-100 transition-colors ".concat(w?"w-full":""),disabled:v,children:"Remove"})]}))))})]})]})},tf=()=>{var e,t,n,s;const{userId:i}=he(),a=de(),{user:o}=kt(),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(!0),[h,m]=(0,r.useState)(""),[f,p]=(0,r.useState)(null),[g,v]=(0,r.useState)("about"),[x,y]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=()=>{y(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>{(async()=>{if(i&&o)try{var e,t;d(!0),m("");const n=await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",i));if(!n.exists())return void m("User not found");const r=n.data(),s=await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",o.uid)),a=(null===(t=((null===(e=s.data())||void 0===e?void 0:e.buddyList)||{})[i])||void 0===t?void 0:t.status)||"none";c(r),p(a)}catch(gb){console.error("Error fetching profile:",gb),m("Failed to load profile")}finally{d(!1)}})()}),[i,o]);return u?(0,Et.jsx)("div",{className:"max-w-2xl mx-auto p-3 md:p-4",children:(0,Et.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-4 md:p-5 border border-gray-100",children:(0,Et.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,Et.jsx)("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full bg-gray-200 mx-auto"}),(0,Et.jsx)("div",{className:"h-5 bg-gray-200 rounded w-1/2 mx-auto"}),(0,Et.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/3 mx-auto"})]})})}):h?(0,Et.jsx)("div",{className:"max-w-2xl mx-auto p-3 md:p-4",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 md:p-5 border border-gray-100",children:[(0,Et.jsx)("div",{className:"text-red-500 text-center text-sm",children:h}),(0,Et.jsxs)("button",{onClick:()=>a(-1),className:"mt-4 text-blue-600 text-sm hover:underline flex items-center justify-center mx-auto",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Go Back"]})]})}):(0,Et.jsxs)("div",{className:"max-w-2xl mx-auto p-3 md:p-4",children:[(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden",children:[(0,Et.jsxs)("div",{className:"text-center p-4 border-b border-gray-100",children:[(0,Et.jsxs)("div",{className:"flex flex-col items-center",children:[null!==l&&void 0!==l&&l.photoURL&&""!==l.photoURL.trim()?(0,Et.jsx)("img",{src:l.photoURL,alt:l.name||"User",className:"w-20 h-20 md:w-24 md:h-24 rounded-full mb-3 object-cover ring-2 ring-gray-100",onError:e=>{e.target.onerror=null,e.target.style.display="none",e.target.parentNode.querySelector(".fallback-avatar").style.display="flex"}}):null,(0,Et.jsx)("div",{className:"w-20 h-20 md:w-24 md:h-24 rounded-full mb-3 bg-blue-50 flex items-center justify-center fallback-avatar ring-2 ring-gray-100 ".concat(null!==l&&void 0!==l&&l.photoURL&&""!==l.photoURL.trim()?"hidden":""),children:(0,Et.jsx)("span",{className:"text-2xl font-medium text-blue-600",children:null!==l&&void 0!==l&&l.name&&""!==l.name.trim()?l.name.trim()[0].toUpperCase():"?"})}),(0,Et.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-1",children:null===l||void 0===l?void 0:l.name}),(null===l||void 0===l?void 0:l.certificationLevel)&&(0,Et.jsx)("p",{className:"text-sm text-blue-600 mb-2",children:l.certificationLevel}),(0,Et.jsx)("div",{className:"mt-1",children:(0,Et.jsx)(gn,{certificationLevel:null===l||void 0===l?void 0:l.certificationLevel,specialties:null===l||void 0===l?void 0:l.specialties,numberOfDives:null===l||void 0===l?void 0:l.numberOfDives,size:"small",showSections:!1})})]}),(0,Et.jsx)("div",{className:"mt-4 flex ".concat(x?"flex-col space-y-2":"justify-center space-x-3"),children:"accepted"===f?(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)("button",{onClick:async()=>{try{a("/messages",{state:{userId:i}})}catch(gb){console.error("Error starting chat:",gb),m("Failed to start chat")}},className:"py-1.5 px-4 bg-blue-50 text-blue-700 rounded text-sm font-medium border border-blue-200 hover:bg-blue-100 transition-colors ".concat(x?"w-full":""),children:"Message"}),(0,Et.jsx)("button",{onClick:async()=>{if(o&&i&&window.confirm("Are you sure you want to remove this buddy? This action cannot be undone."))try{d(!0),m("");const e=(0,Dt.wP)(wt.db),t=(0,Dt.H9)(wt.db,"profiles",o.uid);e.update(t,{["buddyList.".concat(i)]:(0,Dt.CL)()});const n=(0,Dt.H9)(wt.db,"profiles",i);e.update(n,{["buddyList.".concat(o.uid)]:(0,Dt.CL)()}),await e.commit(),p("none")}catch(gb){console.error("Error removing buddy:",gb),m("Failed to remove buddy")}finally{d(!1)}},className:"py-1.5 px-4 bg-red-50 text-red-700 rounded text-sm font-medium border border-red-200 hover:bg-red-100 transition-colors ".concat(x?"w-full":""),disabled:u,children:"Remove Buddy"})]}):"pending"===f?(0,Et.jsx)("div",{className:"py-1.5 px-4 bg-gray-50 text-gray-600 rounded text-sm border border-gray-200",children:"Buddy Request Pending"}):(0,Et.jsx)("button",{onClick:async()=>{if(o&&l)try{d(!0);const e=(0,Dt.H9)(wt.db,"profiles",o.uid);await(0,Dt.mZ)(e,{["buddyList.".concat(i)]:{status:"pending",timestamp:(0,Dt.O5)(),initiator:!0}});const t=(0,Dt.H9)(wt.db,"profiles",i);await(0,Dt.mZ)(t,{["buddyList.".concat(o.uid)]:{status:"pending",timestamp:(0,Dt.O5)(),initiator:!1}}),await Xc.default.createBuddyRequestNotification({fromUser:o.uid,fromUserName:o.displayName,toUser:i,requestId:o.uid}),p("pending")}catch(gb){console.error("Error sending buddy request:",gb),m("Failed to send buddy request")}finally{d(!1)}},disabled:u,className:"py-1.5 px-4 bg-blue-50 text-blue-700 rounded text-sm font-medium border border-blue-200 hover:bg-blue-100 transition-colors disabled:bg-gray-50 disabled:text-gray-400 ".concat(x?"w-full":""),children:"Add Buddy"})})]}),x&&(0,Et.jsx)("div",{className:"mb-3 border-b",children:(0,Et.jsxs)("div",{className:"flex overflow-x-auto",children:[(0,Et.jsx)("button",{onClick:()=>v("about"),className:"py-2 px-3 text-xs font-medium whitespace-nowrap ".concat("about"===g?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:"About"}),(0,Et.jsx)("button",{onClick:()=>v("stats"),className:"py-2 px-3 text-xs font-medium whitespace-nowrap ".concat("stats"===g?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:"Diving Stats"}),(0,Et.jsx)("button",{onClick:()=>v("specialties"),className:"py-2 px-3 text-xs font-medium whitespace-nowrap ".concat("specialties"===g?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:"Specialties"}),(0,Et.jsx)("button",{onClick:()=>v("trips"),className:"py-2 px-3 text-xs font-medium whitespace-nowrap ".concat("trips"===g?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:"Dive Trips"}),(0,Et.jsx)("button",{onClick:()=>v("contact"),className:"py-2 px-3 text-xs font-medium whitespace-nowrap ".concat("contact"===g?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),children:"Contact"})]})}),null!==l&&void 0!==l&&l.hideProfile?(0,Et.jsx)("div",{className:"p-4 text-center text-gray-500 text-sm",children:"This profile is private"}):(0,Et.jsxs)("div",{className:"p-4 space-y-5",children:[(!x||"about"===g)&&(null===l||void 0===l?void 0:l.bio)&&(0,Et.jsxs)("div",{className:"".concat(x?"":"border-b border-gray-100 pb-4"),children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-2 tracking-wider",children:"About Me"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:l.bio}),"Instructor"===(null===l||void 0===l?void 0:l.certificationLevel)&&(null===l||void 0===l||null===(e=l.instructorCertifications)||void 0===e?void 0:e.length)>0&&(0,Et.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[(0,Et.jsx)("h4",{className:"text-xs text-gray-500 mb-2",children:"Instructor Certifications"}),(0,Et.jsx)("div",{className:"space-y-1",children:l.instructorCertifications.map(((e,t)=>(0,Et.jsxs)("div",{className:"text-xs text-gray-600 bg-gray-50 px-2 py-1 rounded inline-block mr-2 mb-2",children:[e.agency," #",e.number]},t)))})]})]}),(!x||"stats"===g)&&!(null!==l&&void 0!==l&&l.hideStats)&&(null===l||void 0===l?void 0:l.divingStats)&&(0,Et.jsxs)("div",{className:"".concat(x?"":"border-b border-gray-100 pb-4"),children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-3 tracking-wider",children:"Diving Statistics"}),(0,Et.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,Et.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 text-center border border-blue-100",children:[(0,Et.jsx)("div",{className:"text-lg font-bold text-blue-700",children:l.divingStats.totalDives||0}),(0,Et.jsx)("div",{className:"text-xs text-gray-600",children:"Total Dives"})]}),(0,Et.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 text-center border border-blue-100",children:[(0,Et.jsxs)("div",{className:"text-lg font-bold text-blue-700",children:[l.divingStats.maxDepth||0,"ft"]}),(0,Et.jsx)("div",{className:"text-xs text-gray-600",children:"Max Depth"})]}),(0,Et.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 text-center border border-blue-100",children:[(0,Et.jsxs)("div",{className:"text-lg font-bold text-blue-700",children:[l.divingStats.totalTime||0,"h"]}),(0,Et.jsx)("div",{className:"text-xs text-gray-600",children:"Bottom Time"})]})]})]}),(!x||"specialties"===g)&&(null===l||void 0===l||null===(t=l.specialties)||void 0===t?void 0:t.length)>0&&(0,Et.jsxs)("div",{className:"".concat(x?"":"border-b border-gray-100 pb-4"),children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-2 tracking-wider",children:"Specialties"}),(0,Et.jsx)("div",{className:"flex flex-wrap gap-2",children:l.specialties.map((e=>(0,Et.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-50 text-blue-700 border border-blue-100",children:e},e)))})]}),(!x||"trips"===g)&&(0,Et.jsxs)("div",{className:"".concat(x?"":"border-b border-gray-100 pb-4"),children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-2 tracking-wider",children:"Dive Trips"}),(0,Et.jsxs)("div",{className:"space-y-3 text-sm text-gray-600",children:[(null===l||void 0===l?void 0:l.favoritePlace)&&(0,Et.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[(0,Et.jsx)("p",{className:"font-medium text-gray-700 mb-1",children:"Favorite Dive Location"}),(0,Et.jsxs)("p",{children:[l.favoritePlace,l.favoriteDivesite&&(0,Et.jsxs)("span",{className:"text-blue-600",children:[" - ",l.favoriteDivesite]})]})]}),(null===l||void 0===l||null===(n=l.diveTrips)||void 0===n?void 0:n.length)>0&&(0,Et.jsxs)("div",{className:"mt-3",children:[(0,Et.jsx)("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Trip History"}),(0,Et.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:l.diveTrips.sort(((e,t)=>t.year-e.year)).map(((e,t)=>(0,Et.jsxs)("div",{className:"flex justify-between text-xs py-1 border-b border-gray-100 last:border-0",children:[(0,Et.jsx)("span",{className:"font-medium",children:e.year}),(0,Et.jsx)("span",{children:e.location})]},t)))})]})]})]}),(!x||"contact"===g)&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-sm uppercase font-semibold text-gray-500 mb-2 tracking-wider",children:"Contact Information"}),"accepted"===f?(0,Et.jsxs)("div",{className:"space-y-2",children:[!(null!==l&&void 0!==l&&l.hideEmail)&&(null===l||void 0===l?void 0:l.email)&&(0,Et.jsxs)("p",{className:"text-sm text-gray-600 flex items-center",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),l.email]}),!(null!==l&&void 0!==l&&l.hidePhone)&&(null===l||void 0===l?void 0:l.phone)&&(0,Et.jsxs)("p",{className:"text-sm text-gray-600 flex items-center",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),l.phone]})]}):(0,Et.jsxs)("p",{className:"text-sm text-gray-500 italic flex items-center",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"Contact details visible after connecting as buddies"]}),!(null!==l&&void 0!==l&&l.hideLocation)&&((null===l||void 0===l?void 0:l.city)||(null===l||void 0===l?void 0:l.state))&&(0,Et.jsxs)("p",{className:"text-sm text-gray-600 flex items-center mt-2",children:[(0,Et.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),[l.city,l.state].filter(Boolean).join(", ")]}),!(null!==l&&void 0!==l&&null!==(s=l.privacySettings)&&void 0!==s&&s.hideSocial)&&(null===l||void 0===l?void 0:l.socialLinks)&&Object.values(l.socialLinks).some(Boolean)&&(0,Et.jsxs)("div",{className:"mt-4 pt-3 border-t border-gray-100",children:[(0,Et.jsx)("h4",{className:"text-xs text-gray-500 mb-2",children:"Connect On"}),(0,Et.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(l.socialLinks).map((e=>{let[t,n]=e;return n&&(0,Et.jsx)("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-3 py-1 bg-gray-50 text-gray-700 rounded-full border border-gray-200 hover:bg-gray-100 transition-colors",children:t.charAt(0).toUpperCase()+t.slice(1)},t)}))})]})]})]}),(0,Et.jsx)("div",{className:"".concat(x?"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-3 z-10":"mt-2 text-center p-4 border-t border-gray-100"),children:(0,Et.jsx)("button",{onClick:()=>a(-1),className:"text-blue-600 hover:bg-blue-50 ".concat(x?"w-full py-1.5 rounded text-sm font-medium border border-blue-200":"text-sm hover:underline"),children:(0,Et.jsxs)("div",{className:"flex items-center justify-center",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Go Back"]})})})]}),x&&(0,Et.jsx)("div",{className:"h-16"})]})},nf={OCEANIC_SILVER:{min:0,max:9999,multiplier:1,name:"Oceanic Silver"},MARINER_GOLD:{min:1e4,max:19999,multiplier:1.2,name:"Mariner Gold"},NAUTILUS_PLATINUM:{min:2e4,max:49999,multiplier:1.5,name:"Nautilus Platinum"},TRIDENT_ELITE:{min:5e4,max:99999,multiplier:2,name:"Trident Elite"},LIFETIME_ELITE:{min:1e5,max:1/0,multiplier:2,name:"Lifetime Elite"}},rf={equipment:5,service:10,courses:10,trips:1,rentals:5},sf="success",af="error",of=()=>{var e;const[t,n]=(0,r.useState)(null),[s,i]=(0,r.useState)(""),[a,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(""),[m,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)([]),[v,x]=(0,r.useState)(null),[y,b]=(0,r.useState)(""),[w,D]=(0,r.useState)(!1),[N,j]=(0,r.useState)(null),[C,E]=(0,r.useState)(""),[A,k]=(0,r.useState)(!1),[S,F]=(0,r.useState)({amount:"",reason:"",type:"add",affectLifetime:!1}),[_,T]=(0,r.useState)({equipment:0,service:0,courses:0,trips:0,rentals:0}),{user:I}=kt(),R=(0,r.useCallback)((async()=>{try{const e=(0,Dt.rJ)(wt.db,"giftCardRequests"),t=(0,Dt.P)(e,(0,Dt._M)("status","==","pending")),n=await(0,Dt.GG)(t),r=[];n.forEach((e=>{r.push((0,o.A)({id:e.id},e.data()))})),g(r)}catch(e){console.error("Error fetching gift card requests:",e),P("Error fetching gift card requests")}}),[]);(0,r.useEffect)((()=>{R()}),[R]);const P=function(e){u({text:e,type:arguments.length>1&&void 0!==arguments[1]?arguments[1]:af}),setTimeout((()=>u(null)),5e3)},O=e=>Object.entries(nf).reduce(((t,n)=>{let[r,s]=n;return e>=s.min&&e<=s.max?(0,o.A)({tier:r},s):t}),nf.OCEANIC_SILVER),M=(e,t)=>Object.entries(e).reduce(((e,n)=>{let[r,s]=n;return e+s*rf[r]*t}),0),L=e=>e instanceof Date?e.toLocaleDateString():null!==e&&void 0!==e&&e.seconds?new Date(1e3*e.seconds).toLocaleDateString():"Invalid Date",B=e=>{var t;let{customerData:n}=e;const r=(new Date).getFullYear(),s=O(n.lifetimePoints),i=.1*nf[s.tier].min,a=(null===(t=n.yearlyPointsEarned)||void 0===t?void 0:t[r])||0,o=a/i*100;return(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsx)("h4",{className:"font-semibold mb-2 text-gray-900",children:"Yearly Progress"}),(0,Et.jsx)("div",{className:"bg-gray-200 rounded-full h-2.5",children:(0,Et.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(Math.min(o,100),"%")}})}),(0,Et.jsxs)("p",{className:"text-sm mt-1 text-gray-600",children:[a," / ",i," points required this year"]})]})},z=async()=>{if(!s)return void P("Please enter a customer ID or loyalty code");const e=s.trim();console.log("Looking up customer:",e),l(!0),u(null);try{const t=(0,Dt.rJ)(wt.db,"profiles"),r=e.toUpperCase(),s=e.toLowerCase(),i=await(0,Dt.GG)((0,Dt.P)(t,(0,Dt._M)("loyaltyCode","in",[e,r,s])));if(!i.empty){const e=i.docs[0],t=e.data();return n((0,o.A)((0,o.A)({id:e.id},t),{},{currentTier:O(t.lifetimePoints||0)})),void P("Customer found by loyalty code",sf)}let a=await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",e));if(!a.exists())return console.log("Not found by direct ID, trying case-insensitive query"),console.log("Failed lookup for ID:",e),P("Customer not found"),void n(null);const l=a.data();n((0,o.A)((0,o.A)({id:a.id},l),{},{currentTier:O(l.lifetimePoints||0)})),P("Customer found successfully",sf)}catch(gb){P("Error looking up customer"),console.error("Error:",gb)}finally{l(!1)}};return(0,Et.jsxs)("div",{className:"max-w-4xl mx-auto p-4 bg-gray-100",children:[(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,Et.jsx)("div",{className:"border-b p-6",children:(0,Et.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Loyalty Program Management"})}),(0,Et.jsx)("div",{className:"p-6",children:(0,Et.jsxs)("div",{className:"space-y-6",children:[c&&(0,Et.jsx)("div",{className:"p-4 rounded-lg ".concat(c.type===sf?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:c.text}),(0,Et.jsxs)("div",{className:"flex space-x-4",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Enter customer UID",value:s,onChange:e=>i(e.target.value),onKeyPress:e=>"Enter"===e.key&&z(),className:"flex-1 p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,Et.jsx)("button",{onClick:z,disabled:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Look Up Customer"})]}),(0,Et.jsxs)("div",{className:"border-t pt-6",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"Pending Gift Card Requests"}),(0,Et.jsxs)("div",{className:"space-y-4",children:[p.map((e=>(0,Et.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:(0,Et.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"font-medium text-gray-900",children:e.userName}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Requested: $",e.amount]}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Points: ",e.pointsRequested]}),(0,Et.jsxs)("p",{className:"text-sm text-gray-500",children:["Requested on: ",L(e.requestDate)]})]}),(0,Et.jsx)("div",{children:(null===v||void 0===v?void 0:v.id)===e.id?(0,Et.jsxs)("div",{className:"space-y-2",children:[(0,Et.jsx)("input",{type:"text",placeholder:"Enter gift card number",value:y,onChange:e=>b(e.target.value),className:"w-full p-2 border border-gray-200 rounded-lg text-sm"}),(0,Et.jsxs)("div",{className:"flex space-x-2",children:[(0,Et.jsx)("button",{onClick:()=>(async e=>{if(y){D(!0);try{const t=(0,Dt.H9)(wt.db,"profiles",e.userId),n=(await(0,Dt.x7)(t)).data();if(!n)return void P("User profile not found");if(n.redeemablePoints<e.pointsRequested)return void P("User has insufficient points");const r={number:y,amount:e.amount,issueDate:Dt.Dc.now(),status:"active"},s=n.giftCards||[];await(0,Dt.mZ)(t,{redeemablePoints:(0,Dt.GV)(-e.pointsRequested),giftCards:[...s,r],transactions:[{type:"gift_card",date:Dt.Dc.now(),points:-e.pointsRequested,giftCardAmount:e.amount,giftCardNumber:y,processedBy:I.email},...n.transactions||[]]});const i=(0,Dt.H9)(wt.db,"giftCardRequests",e.id);await(0,Dt.mZ)(i,{status:"completed",processedDate:Dt.Dc.now(),processedBy:I.email,giftCardNumber:y}),P("Gift card processed successfully",sf),b(""),x(null),R()}catch(t){console.error("Error processing gift card:",t),P("Error processing gift card")}finally{D(!1)}}else P("Please enter a gift card number")})(e),disabled:!y||w,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 disabled:opacity-50",children:w?"Processing...":"Process"}),(0,Et.jsx)("button",{onClick:()=>{x(null),b("")},className:"px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded hover:bg-gray-200",children:"Cancel"})]})]}):(0,Et.jsx)("button",{onClick:()=>x(e),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Process Request"})})]})},e.id))),0===p.length&&(0,Et.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No pending gift card requests"})]})]}),t&&(0,Et.jsxs)("div",{className:"space-y-6",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-900",children:t.name}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Current Tier"}),(0,Et.jsx)("p",{className:"font-medium text-gray-900",children:t.currentTier.name})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Point Multiplier"}),(0,Et.jsxs)("p",{className:"font-medium text-gray-900",children:[t.currentTier.multiplier,"x"]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Lifetime Points"}),(0,Et.jsx)("p",{className:"font-medium text-gray-900",children:t.lifetimePoints||0})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Redeemable Points"}),(0,Et.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Et.jsx)("p",{className:"font-medium text-gray-900",children:t.redeemablePoints||0}),(0,Et.jsx)("button",{onClick:()=>f(!0),className:"px-2 py-1 text-sm bg-white border border-gray-200 rounded hover:bg-gray-50",children:"Edit"})]})]})]}),(0,Et.jsx)(B,{customerData:t})]}),(null===t||void 0===t?void 0:t.giftCards)&&t.giftCards.length>0&&(0,Et.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"Gift Cards"}),(0,Et.jsx)("div",{className:"grid grid-cols-1 gap-4",children:t.giftCards.map(((e,t)=>(0,Et.jsx)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("p",{className:"font-medium text-gray-900",children:["Card: ",e.number]}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Balance: $",e.amount]}),e.lastUsed&&(0,Et.jsxs)("p",{className:"text-xs text-gray-500",children:["Last used: ",L(e.lastUsed)]})]}),(0,Et.jsx)("button",{onClick:()=>{j(e),k(!0)},className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Adjust Balance"})]})},t)))})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"Earn Points"}),(0,Et.jsx)("div",{className:"grid grid-cols-2 gap-4",children:Object.entries(rf).map((e=>{let[t,n]=e;return(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.charAt(0).toUpperCase()+t.slice(1)," (",n," points/$)"]}),(0,Et.jsx)("input",{type:"number",min:"0",value:_[t],onChange:e=>T((0,o.A)((0,o.A)({},_),{},{[t]:parseFloat(e.target.value)||0})),className:"w-full p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]},t)}))}),(0,Et.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mt-4 border border-blue-100",children:[(0,Et.jsx)("h4",{className:"font-semibold mb-2 text-gray-900",children:"Points Preview"}),(0,Et.jsxs)("div",{className:"space-y-1",children:[(0,Et.jsxs)("p",{className:"text-gray-700",children:["Base Points: ",M(_,1)]}),(0,Et.jsxs)("p",{className:"text-gray-700",children:["Tier Multiplier: ",t.currentTier.multiplier,"x"]}),(0,Et.jsxs)("p",{className:"font-medium text-gray-900",children:["Total Points to be earned: ",M(_,t.currentTier.multiplier)]})]})]}),(0,Et.jsx)("button",{onClick:async()=>{if(t)try{const e=M(_,t.currentTier.multiplier),r=(0,Dt.H9)(wt.db,"profiles",t.id),s=(new Date).getFullYear(),i="yearlyPointsEarned.".concat(s),a={type:"earn",date:Dt.Dc.now(),points:e,basePoints:M(_,1),multiplier:t.currentTier.multiplier,amounts:_,processedBy:I.email},l={lifetimePoints:(t.lifetimePoints||0)+e,redeemablePoints:(t.redeemablePoints||0)+e,[i]:(0,Dt.GV)(e),transactions:[a,...t.transactions||[]]};await(0,Dt.mZ)(r,l),n((0,o.A)((0,o.A)((0,o.A)({},t),l),{},{currentTier:O(l.lifetimePoints)})),T({equipment:0,service:0,courses:0,trips:0,rentals:0}),P("Successfully added ".concat(e," points"),sf)}catch(gb){P("Error updating points"),console.error("Error:",gb)}},disabled:Object.values(_).every((e=>0===e)),className:"w-full mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Process Transaction"})]}),(0,Et.jsxs)("div",{className:"border-t pt-6",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"Redeem Points"}),(0,Et.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Et.jsx)("input",{type:"number",min:"0",max:t.redeemablePoints,placeholder:"Points to redeem",className:"flex-1 p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:d,onChange:e=>h(e.target.value)}),(0,Et.jsxs)("div",{className:"text-sm text-gray-600 whitespace-nowrap",children:["Value: $",((d||0)/100).toFixed(2)]}),(0,Et.jsx)("button",{onClick:async()=>{if(t&&d)try{const e=parseFloat(d);if(e>t.redeemablePoints)return void P("Not enough points available");const r=(0,Dt.H9)(wt.db,"profiles",t.id),s={type:"redeem",date:Dt.Dc.now(),points:e,processedBy:I.email,value:(e/100).toFixed(2)},i={redeemablePoints:t.redeemablePoints-e,transactions:[s,...t.transactions||[]]};await(0,Dt.mZ)(r,i),n((0,o.A)((0,o.A)({},t),i)),h(""),P("Successfully redeemed ".concat(e," points"),sf)}catch(gb){P("Error processing redemption"),console.error("Error:",gb)}},disabled:!d||d>t.redeemablePoints,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Redeem Points"})]}),(0,Et.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Available points for redemption: ",t.redeemablePoints]})]}),(0,Et.jsxs)("div",{className:"border-t pt-6",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-900",children:"Transaction History"}),(0,Et.jsx)("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:null===(e=t.transactions)||void 0===e?void 0:e.map(((e,t)=>(0,Et.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"font-medium text-gray-900",children:"adjustment"===e.type?"Points ".concat("add"===e.adjustmentType?"Added":"Subtracted"):"earn"===e.type?"Points Earned":"gift_card_use"===e.type?"Gift Card Used":"Points Redeemed"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:L(e.date)})]}),(0,Et.jsxs)("div",{className:"text-right",children:[(0,Et.jsxs)("p",{className:"font-medium ".concat("earn"===e.type||"adjustment"===e.type&&"add"===e.adjustmentType?"text-green-600":"text-red-600"),children:["earn"===e.type||"adjustment"===e.type&&"add"===e.adjustmentType?"+":"-",e.points," points"]}),"earn"===e.type&&(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Base Points: ",e.basePoints," \xd7 ",e.multiplier]}),"redeem"===e.type&&(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Value: $",e.value]}),"gift_card_use"===e.type&&(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Card: ",e.giftCardNumber,(0,Et.jsx)("br",{}),"Amount Used: $",e.amountUsed,(0,Et.jsx)("br",{}),"Remaining: $",e.remainingBalance]})]})]}),"earn"===e.type&&e.amounts&&(0,Et.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:Object.entries(e.amounts).filter((e=>{let[t,n]=e;return n>0})).map((e=>{let[t,n]=e;return(0,Et.jsxs)("div",{className:"flex justify-between",children:[(0,Et.jsxs)("span",{children:[t.charAt(0).toUpperCase()+t.slice(1),":"]}),(0,Et.jsxs)("span",{children:["$",n]})]},t)}))}),"adjustment"===e.type&&(0,Et.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:(0,Et.jsxs)("p",{children:["Reason: ",e.reason]})}),(0,Et.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Processed by: ",e.processedBy]})]},t)))})]})]})]})})]}),m&&(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-md",children:[(0,Et.jsx)("div",{className:"border-b p-6",children:(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Adjust Points"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Modify customer points and lifetime tier status"})]}),(0,Et.jsx)("button",{onClick:()=>f(!1),className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,Et.jsxs)("div",{className:"p-6 space-y-4",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,Et.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,Et.jsx)("input",{type:"radio",checked:"add"===S.type,onChange:()=>F((e=>(0,o.A)((0,o.A)({},e),{},{type:"add"}))),className:"text-blue-600"}),(0,Et.jsx)("span",{className:"text-gray-900",children:"Add Points"})]}),(0,Et.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,Et.jsx)("input",{type:"radio",checked:"subtract"===S.type,onChange:()=>F((e=>(0,o.A)((0,o.A)({},e),{},{type:"subtract"}))),className:"text-blue-600"}),(0,Et.jsx)("span",{className:"text-gray-900",children:"Subtract Points"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Points Amount"}),(0,Et.jsx)("input",{type:"number",min:"0",value:S.amount,onChange:e=>F((t=>(0,o.A)((0,o.A)({},t),{},{amount:e.target.value}))),className:"w-full p-2 border border-gray-200 rounded-lg"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Adjustment"}),(0,Et.jsx)("input",{type:"text",value:S.reason,onChange:e=>F((t=>(0,o.A)((0,o.A)({},t),{},{reason:e.target.value}))),placeholder:"Enter reason for adjustment",className:"w-full p-2 border border-gray-200 rounded-lg"})]}),(0,Et.jsx)("div",{className:"flex items-center",children:(0,Et.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,Et.jsx)("input",{type:"checkbox",checked:S.affectLifetime,onChange:e=>F((t=>(0,o.A)((0,o.A)({},t),{},{affectLifetime:e.target.checked}))),className:"text-blue-600 rounded"}),(0,Et.jsx)("span",{className:"text-gray-900",children:"Adjust Lifetime Points (affects tier status)"})]})}),(0,Et.jsx)("button",{onClick:async()=>{if(t&&S.amount&&S.reason)try{var e;const r=parseInt(S.amount),s=(0,Dt.H9)(wt.db,"profiles",t.id),i=(await(0,Dt.x7)(s)).data(),a=(null===i||void 0===i?void 0:i.redeemablePoints)||0,l=(null===i||void 0===i?void 0:i.lifetimePoints)||0,c=(null===i||void 0===i||null===(e=i.yearlyPointsEarned)||void 0===e?void 0:e[(new Date).getFullYear()])||0;let u=a,d=l,h=c;if("add"===S.type)u+=r,S.affectLifetime&&(d+=r);else{if(S.affectLifetime){if(r>l)return void P("Cannot subtract more points than available lifetime points");const e=r/l,t=Math.ceil(c*e);d-=r,h-=t}if(r>a){if(!S.affectLifetime)return void P("Cannot subtract more points than available redeemable points");u=0}else u-=r}const m={type:"adjustment",date:Dt.Dc.now(),points:r,adjustmentType:S.type,affectedLifetime:S.affectLifetime,reason:S.reason,processedBy:I.email},p=(new Date).getFullYear(),g={redeemablePoints:u,lifetimePoints:d,["yearlyPointsEarned.".concat(p)]:h,transactions:[m,...(null===i||void 0===i?void 0:i.transactions)||[]]};await(0,Dt.mZ)(s,g),n((0,o.A)((0,o.A)((0,o.A)({},t),g),{},{currentTier:O(d)})),f(!1),F({amount:"",reason:"",type:"add",affectLifetime:!1}),P("Successfully ".concat("add"===S.type?"added":"subtracted"," ").concat(r," points")+(S.affectLifetime?" (including lifetime points)":""),sf)}catch(gb){P("Error adjusting points"),console.error("Error:",gb)}},disabled:!S.amount||!S.reason,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Confirm Adjustment"})]})]})}),A&&N&&(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-md p-6",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Adjust Gift Card Balance"}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:["Card: ",N.number]})]}),(0,Et.jsx)("button",{onClick:()=>{k(!1),j(null),E("")},className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Current Balance: $",N.amount]}),(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Amount Used"}),(0,Et.jsx)("input",{type:"number",min:"0.01",step:"0.01",max:N.amount,value:C,onChange:e=>E(e.target.value),className:"w-full p-2 border border-gray-200 rounded-lg",placeholder:"Enter amount used"}),C&&!isNaN(C)&&(0,Et.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["New balance will be: $",(N.amount-parseFloat(C)).toFixed(2)]})]}),(0,Et.jsx)("button",{onClick:async()=>{if(N&&C)try{const e=parseFloat(C);if(isNaN(e)||e<=0)return void P("Please enter a valid amount");if(e>N.amount)return void P("Adjustment amount cannot be greater than current balance");const r=(0,Dt.H9)(wt.db,"profiles",t.id),s=(await(0,Dt.x7)(r)).data(),i=s.giftCards.map((t=>t.number===N.number?(0,o.A)((0,o.A)({},t),{},{amount:t.amount-e,lastUsed:Dt.Dc.now()}):t)).filter((e=>e.amount>0)),a={type:"gift_card_use",date:Dt.Dc.now(),giftCardNumber:N.number,amountUsed:e,remainingBalance:N.amount-e,processedBy:I.email};await(0,Dt.mZ)(r,{giftCards:i,transactions:[a,...s.transactions||[]]}),n((0,o.A)((0,o.A)({},t),{},{giftCards:i,transactions:[a,...t.transactions||[]]})),k(!1),j(null),E(""),P("Gift card balance updated successfully",sf)}catch(e){console.error("Error adjusting gift card balance:",e),P("Error adjusting gift card balance")}},disabled:!C||isNaN(C)||parseFloat(C)<=0||parseFloat(C)>N.amount,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Update Balance"})]})]})})]})},lf=e=>{var t;let{children:n}=e;const{user:r}=kt();return null!==r&&void 0!==r&&null!==(t=r.loyaltyAccess)&&void 0!==t&&t.hasAccess?n:(0,Et.jsx)(Ae,{to:"/"})},cf=Mt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),uf=e=>{let{size:t="default",message:n="Loading...",fullScreen:r=!1}=e;const s={small:"h-4 w-4",default:"h-8 w-8",large:"h-12 w-12"},i=s[t]||s.default;return r?(0,Et.jsx)("div",{className:"fixed inset-0 flex justify-center items-center bg-white/80 z-50",children:(0,Et.jsxs)("div",{className:"text-gray-600 flex flex-col items-center",children:[(0,Et.jsx)(cf,{className:"".concat(i," animate-spin mb-4")}),(0,Et.jsx)("p",{children:n})]})}):(0,Et.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,Et.jsxs)("div",{className:"text-gray-600 flex flex-col items-center",children:[(0,Et.jsx)(cf,{className:"".concat(i," animate-spin mb-2")}),(0,Et.jsx)("p",{className:"text-sm",children:n})]})})},df=e=>{let{children:t}=e;const{user:n}=kt(),[s,i]=(0,r.useState)(!0),[a,o]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{(async()=>{if(n)try{const e=(0,Dt.H9)(wt.db,"profiles",n.uid),t=await(0,Dt.x7)(e);if(t.exists()){const e=t.data();e.teamAccess&&e.teamAccess.hasAccess&&o(!0)}}catch(e){console.error("Error checking team access:",e)}finally{i(!1)}else i(!1)})()}),[n]),s?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):a?t:(0,Et.jsx)(Ae,{to:"/"})},hf=Mt("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),mf=Mt("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),ff=e=>"".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString().padStart(2,"0"),"-").concat(e.getDate().toString().padStart(2,"0")),pf=e=>{if(!e)return"";if(e instanceof Date)return e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"});try{const[t,n,r]=e.split("-").map((e=>parseInt(e,10)));return new Date(t,n-1,r).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}catch(t){console.error("Error formatting date:",t,e);try{const t=new Date(e);if(!isNaN(t.getTime()))return t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}catch(Jh){console.error("Failed to format date",Jh)}return String(e)}},gf=()=>{const{user:e}=kt(),[t,n]=(0,r.useState)(null),[s,i]=(0,r.useState)(!1),[a,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{(async()=>{if(!e)return l(!1),void h(!0);try{const t=(0,Dt.P)((0,Dt.rJ)(wt.db,"profiles"),(0,Dt._M)("uid","==",e.uid)),r=await(0,Dt.GG)(t);if(r.empty)try{const t=(0,Dt.H9)(wt.db,"profiles",e.uid),r=await(0,Dt.x7)(t);if(r.exists()){const t=(0,o.A)({id:r.id},r.data());n(t),i("jeff@diveuww.com"===e.email)}else if(e.email){const t=(0,Dt.P)((0,Dt.rJ)(wt.db,"profiles"),(0,Dt._M)("email","==",e.email)),r=await(0,Dt.GG)(t);if(r.empty)u("User profile not found");else{const t=(0,o.A)({id:r.docs[0].id},r.docs[0].data());n(t),i("jeff@diveuww.com"===e.email)}}else u("User profile not found")}catch(gb){console.error("Error fetching profile directly:",gb),u("Failed to load user profile")}else{const t=(0,o.A)({id:r.docs[0].id},r.docs[0].data());n(t),i("jeff@diveuww.com"===e.email)}}catch(gb){console.error("Error fetching user profile:",gb),u("Failed to load user profile")}finally{l(!1),h(!0)}})()}),[e]),{userProfile:t,isAdmin:s,loading:a,error:c,profileLoaded:d}},vf=e=>{let{userId:t}=e;const[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{t&&(async()=>{try{a(!0);const e=new Date,n=[];for(let t=0;t<14;t++){const r=new Date(e);r.setDate(e.getDate()+t),n.push(ff(r))}const r=n.slice(0,10),i=n.slice(10),l=[],c=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","in",r),(0,Dt._M)("staffId","==",t));if((await(0,Dt.GG)(c)).docs.forEach((e=>{l.push((0,o.A)({id:e.id},e.data()))})),i.length>0){const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","in",i),(0,Dt._M)("staffId","==",t));(await(0,Dt.GG)(e)).docs.forEach((e=>{l.push((0,o.A)({id:e.id},e.data()))}))}l.sort(((e,t)=>e.date.localeCompare(t.date)));const u=l.map((e=>{const[t,n,r]=e.date.split("-").map((e=>parseInt(e,10))),s=new Date(t,n-1,r);return(0,o.A)((0,o.A)({},e),{},{dayName:s.toLocaleDateString("en-US",{weekday:"short"}),formattedDate:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})})}));s(u)}catch(gb){console.error("Error fetching my schedule:",gb)}finally{a(!1)}})()}),[t]),i?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):0===n.length?(0,Et.jsx)("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"You have no upcoming shifts scheduled"})}):(0,Et.jsx)("div",{className:"space-y-2",children:n.map((e=>(0,Et.jsx)("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-3",children:(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("span",{className:"font-medium",children:[e.dayName,", ",e.formattedDate]}),(0,Et.jsx)("div",{className:"text-blue-700",children:e.shift})]}),e.notes&&(0,Et.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.notes})]})},e.id)))})},xf=e=>{let{userId:t,currentUserProfile:n}=e;const[s,i]=(0,r.useState)(null),[a,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)([]),m=ff(new Date);(0,r.useEffect)((()=>{t&&(async()=>{try{l(!0);const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeTracking"),(0,Dt._M)("date","==",m),(0,Dt._M)("staffId","==",t)),n=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));n.sort(((e,t)=>{var n,r;return((null===(n=t.timestamp)||void 0===n?void 0:n.seconds)||0)-((null===(r=e.timestamp)||void 0===r?void 0:r.seconds)||0)})),n.length>0?(u(n[0]),i(n[0].action)):i("clock-out");const r=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","==",m),(0,Dt._M)("staffId","==",t)),s=(await(0,Dt.GG)(r)).docs.map((e=>(0,o.A)({id:e.id},e.data())));h(s)}catch(gb){console.error("Error fetching time tracking data:",gb)}finally{l(!1)}})()}),[t,m]);const f=async e=>{try{l(!0),await(0,Dt.gS)((0,Dt.rJ)(wt.db,"timeTracking"),{staffId:t,date:m,action:e,timestamp:(0,Dt.O5)()}),i(e);const n=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeTracking"),(0,Dt._M)("date","==",m),(0,Dt._M)("staffId","==",t)),r=(await(0,Dt.GG)(n)).docs.map((e=>(0,o.A)({id:e.id},e.data())));r.sort(((e,t)=>{var n,r;return((null===(n=t.timestamp)||void 0===n?void 0:n.seconds)||0)-((null===(r=e.timestamp)||void 0===r?void 0:r.seconds)||0)})),r.length>0&&u(r[0])}catch(gb){console.error("Error recording time:",gb)}finally{l(!1)}},p=d.length>0;return a?(0,Et.jsx)(uf,{message:"Loading time clock data..."}):(0,Et.jsx)("div",{className:"mt-4",children:(0,Et.jsxs)(Rc,{className:"p-4",children:[(0,Et.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[(0,Et.jsxs)("div",{className:"mb-3 md:mb-0",children:[(0,Et.jsx)("div",{className:"text-sm font-medium",children:"Current Status:"}),(0,Et.jsx)("div",{className:"text-lg font-bold ".concat("clock-in"===s?"text-green-600":"text-gray-600"),children:"clock-in"===s?"Clocked In":"Clocked Out"}),c&&c.timestamp&&(0,Et.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Last action: ",new Date(1e3*c.timestamp.seconds).toLocaleTimeString()]})]}),(0,Et.jsx)("div",{className:"flex gap-2 w-full md:w-auto",children:"clock-in"!==s?(0,Et.jsxs)(Kc,{className:"bg-green-600 hover:bg-green-700 text-white flex items-center w-full md:w-auto h-12 md:h-auto",onClick:()=>f("clock-in"),children:[(0,Et.jsx)(Qt,{className:"h-4 w-4 mr-1"}),"Clock In"]}):(0,Et.jsxs)(Kc,{className:"bg-red-600 hover:bg-red-700 text-white flex items-center w-full md:w-auto h-12 md:h-auto",onClick:()=>f("clock-out"),children:[(0,Et.jsx)(Qt,{className:"h-4 w-4 mr-1"}),"Clock Out"]})})]}),p?(0,Et.jsxs)("div",{className:"bg-blue-50 mt-3 p-2 rounded text-sm",children:[(0,Et.jsx)("div",{className:"font-medium",children:"Today's scheduled shift:"}),d.map((e=>(0,Et.jsxs)("div",{className:"mt-1",children:[e.shift," ",e.notes&&"(".concat(e.notes,")")]},e.id)))]}):(0,Et.jsxs)("div",{className:"bg-blue-50 mt-3 p-2 rounded text-sm",children:[(0,Et.jsx)("div",{className:"font-medium",children:"No scheduled shift today"}),(0,Et.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"You can still clock in and out as needed for unscheduled work."})]})]})})},yf=()=>{const{user:e}=kt(),{userProfile:t}=gf(),[n,s]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{t&&s(!1)}),[t]),n&&!t?(0,Et.jsx)(uf,{message:"Loading profile data..."}):(0,Et.jsxs)("div",{className:"space-y-6",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsx)("h2",{className:"text-lg font-medium",children:"My Schedule & Time Clock"}),(0,Et.jsxs)("div",{className:"text-xs text-gray-500",children:["Logged in as: ",(null===t||void 0===t?void 0:t.name)||(null===e||void 0===e?void 0:e.email)]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"font-medium mb-3",children:"My Upcoming Shifts"}),(0,Et.jsx)(vf,{userId:null===e||void 0===e?void 0:e.uid})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"font-medium mb-3",children:"My Time Clock"}),(0,Et.jsx)(xf,{userId:null===e||void 0===e?void 0:e.uid,currentUserProfile:t})]})]})},bf=["className","type"],wf=r.forwardRef(((e,t)=>{let{className:n,type:r}=e,s=(0,a.A)(e,bf);return(0,Et.jsx)("input",(0,o.A)({type:r,className:(0,Dn.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t},s))}));wf.displayName="Input";const Df=["className"],Nf=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,Df);return(0,Et.jsx)("label",(0,o.A)({ref:t,className:(0,Dn.cn)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",n)},r))}));Nf.displayName="Label";const jf=["className"],Cf=r.forwardRef(((e,t)=>{let{className:n}=e,r=(0,a.A)(e,jf);return(0,Et.jsx)("textarea",(0,o.A)({className:(0,Dn.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t},r))}));Cf.displayName="Textarea";const Ef=Mt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Af=Mt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),kf=e=>{let{open:t,onClose:n,title:r,description:s,children:i,footer:a}=e;return t?(0,Et.jsx)(oc,{open:t,onOpenChange:n,children:(0,Et.jsxs)(hc,{className:"sm:max-w-md max-h-[90vh] flex flex-col w-[95vw] sm:w-auto",children:[(0,Et.jsxs)(mc,{children:[(0,Et.jsx)(pc,{children:r}),s&&(0,Et.jsx)(gc,{children:s})]}),(0,Et.jsx)("div",{className:"py-4 overflow-y-auto flex-grow",children:i}),(0,Et.jsx)(fc,{className:"flex-shrink-0 flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:a})]})}):null},Sf=e=>{let{error:t,className:n=""}=e;return t?(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md border border-red-200 ".concat(n),children:(0,Et.jsxs)("div",{className:"flex items-start",children:[(0,Et.jsx)(nn,{className:"h-5 w-5 text-red-500 mr-2 mt-0.5"}),(0,Et.jsx)("p",{className:"text-red-600",children:"string"===typeof t?t:"An error occurred. Please try again."})]})}):null},Ff=()=>{const{user:e}=kt(),{userProfile:t,isAdmin:n}=gf(),[s,i]=(0,r.useState)(!0),[a,l]=(0,r.useState)(null),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)([]),[m,f]=(0,r.useState)("all"),[p,g]=(0,r.useState)(!1),[v,x]=(0,r.useState)({startDate:ff(new Date),endDate:ff(new Date((new Date).setDate((new Date).getDate()+1))),reason:"",notes:""}),[y,b]=(0,r.useState)(!1),[w,D]=(0,r.useState)(null),[N,j]=(0,r.useState)("");(0,r.useEffect)((()=>{(async()=>{if(t)try{let e;i(!0),e=n?(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt.My)("requestedAt","desc")):(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt._M)("staffId","==",t.id),(0,Dt.My)("requestedAt","desc"));const r=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));u(r),C(r,m)}catch(gb){l("Error loading time-off requests"),console.error("Error:",gb)}finally{i(!1)}})()}),[t,n,m]);const C=(e,t)=>{h("all"===t?e:e.filter((e=>e.status===t)))},E=e=>{f(e),C(c,e)},A=async t=>{if(n&&w)try{i(!0);const n=(0,Dt.H9)(wt.db,"timeOffRequests",w.id);await(0,Dt.mZ)(n,{status:t,reviewedBy:e.email,reviewedAt:(0,Dt.O5)(),reviewNotes:N}),b(!1);const r=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt.My)("requestedAt","desc")),s=(await(0,Dt.GG)(r)).docs.map((e=>(0,o.A)({id:e.id},e.data())));u(s),C(s,m)}catch(gb){l("Error updating time-off request"),console.error("Error:",gb)}finally{i(!1)}},k=async e=>{if(!t)return;const r=c.find((t=>t.id===e));if(r)if(n||r.staffId===t.id&&"pending"===r.status){if(window.confirm("Are you sure you want to delete this time-off request?"))try{let r;i(!0),await(0,Dt.kd)((0,Dt.H9)(wt.db,"timeOffRequests",e)),r=n?(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt.My)("requestedAt","desc")):(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt._M)("staffId","==",t.id),(0,Dt.My)("requestedAt","desc"));const s=(await(0,Dt.GG)(r)).docs.map((e=>(0,o.A)({id:e.id},e.data())));u(s),C(s,m)}catch(gb){l("Error deleting time-off request"),console.error("Error:",gb)}finally{i(!1)}}else alert("You can only delete your own pending requests")};return s?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h2",{className:"text-lg font-medium",children:"Time-Off Requests"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:n?"Review and manage team time-off requests":"Submit and track your time-off requests"})]}),(0,Et.jsx)("div",{className:"flex items-center space-x-2",children:(0,Et.jsxs)(Kc,{onClick:()=>g(!0),className:"flex items-center",children:[(0,Et.jsx)(gu,{className:"h-4 w-4 mr-1"}),"New Request"]})})]}),(0,Et.jsxs)("div",{className:"flex overflow-x-auto no-scrollbar border-b",children:[(0,Et.jsx)(Kc,{variant:"ghost",size:"sm",className:"py-3 min-w-[80px] ".concat("all"===m?"border-b-2 border-blue-500 rounded-none":"rounded-none"," no-tap-highlight"),onClick:()=>E("all"),children:"All Requests"}),(0,Et.jsxs)(Kc,{variant:"ghost",size:"sm",className:"py-3 min-w-[80px] ".concat("pending"===m?"border-b-2 border-blue-500 rounded-none":"rounded-none"," no-tap-highlight"),onClick:()=>E("pending"),children:[(0,Et.jsx)(Qt,{className:"h-4 w-4 mr-1 text-amber-500"}),"Pending"]}),(0,Et.jsxs)(Kc,{variant:"ghost",size:"sm",className:"py-3 min-w-[80px] ".concat("approved"===m?"border-b-2 border-blue-500 rounded-none":"rounded-none"," no-tap-highlight"),onClick:()=>E("approved"),children:[(0,Et.jsx)(Ef,{className:"h-4 w-4 mr-1 text-green-500"}),"Approved"]}),(0,Et.jsxs)(Kc,{variant:"ghost",size:"sm",className:"py-3 min-w-[80px] ".concat("denied"===m?"border-b-2 border-blue-500 rounded-none":"rounded-none"," no-tap-highlight"),onClick:()=>E("denied"),children:[(0,Et.jsx)(Af,{className:"h-4 w-4 mr-1 text-red-500"}),"Denied"]})]}),a&&(0,Et.jsx)(Sf,{error:a,className:"mb-4"}),(0,Et.jsx)("div",{className:"space-y-4 mt-4",children:0===d.length?(0,Et.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,Et.jsx)("p",{className:"text-gray-500",children:"No time-off requests found"}),(0,Et.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"all"===m?'Click "New Request" to submit a time-off request':"No ".concat(m," requests found")})]}):d.map((e=>(0,Et.jsx)(Rc,{className:"overflow-hidden",children:(0,Et.jsxs)("div",{className:"p-4",children:[(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-3",children:[n&&(0,Et.jsx)("h3",{className:"font-medium text-gray-900",children:e.staffName||"Unknown Staff"}),(0,Et.jsxs)("div",{className:"\n                    rounded-full px-3 py-1 text-xs font-medium mt-2 sm:mt-0\n                    ".concat("pending"===e.status?"bg-amber-100 text-amber-700":"","\n                    ").concat("approved"===e.status?"bg-green-100 text-green-700":"","\n                    ").concat("denied"===e.status?"bg-red-100 text-red-700":"","\n                  "),children:["pending"===e.status&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Qt,{className:"h-3 w-3 inline mr-1"}),"Pending"]}),"approved"===e.status&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Ef,{className:"h-3 w-3 inline mr-1"}),"Approved"]}),"denied"===e.status&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Af,{className:"h-3 w-3 inline mr-1"}),"Denied"]})]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-3",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Date Range"}),(0,Et.jsxs)("div",{className:"text-sm font-medium flex items-center",children:[(0,Et.jsx)(an,{className:"h-3 w-3 mr-1"}),pf(e.startDate)," \u2013 ",pf(e.endDate)]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Reason"}),(0,Et.jsx)("div",{className:"text-sm",children:e.reason})]})]}),e.notes&&(0,Et.jsxs)("div",{className:"mt-2 text-xs text-gray-600 bg-gray-50 p-2 rounded",children:[(0,Et.jsx)(wc,{className:"h-3 w-3 inline mr-1"}),e.notes]}),e.reviewNotes&&("approved"===e.status||"denied"===e.status)&&(0,Et.jsxs)("div",{className:"mt-2 text-xs p-2 rounded ".concat("approved"===e.status?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:[(0,Et.jsx)(nn,{className:"h-3 w-3 inline mr-1"}),(0,Et.jsx)("span",{className:"font-medium",children:"Admin response:"})," ",e.reviewNotes]}),(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-end mt-3 space-y-2 sm:space-y-0 sm:space-x-2",children:[!n&&"pending"===e.status&&(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>k(e.id),className:"text-red-600 hover:bg-red-50 py-3 sm:py-2 w-full sm:w-auto",children:[(0,Et.jsx)(Af,{className:"h-4 w-4 mr-1"}),"Cancel"]}),n&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>k(e.id),className:"text-red-600 hover:bg-red-50 py-3 sm:py-2 w-full sm:w-auto",children:[(0,Et.jsx)(Af,{className:"h-4 w-4 mr-1"}),"Delete"]}),"pending"===e.status&&(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>(e=>{n&&(D(e),j(e.reviewNotes||""),b(!0))})(e),className:"text-blue-600 hover:bg-blue-50 py-3 sm:py-2 w-full sm:w-auto",children:[(0,Et.jsx)(wc,{className:"h-4 w-4 mr-1"}),"Review"]})]})]})]})},e.id)))}),(0,Et.jsx)(kf,{open:p,onClose:()=>g(!1),title:"Request Time Off",description:"Submit a new time-off request",footer:(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:async()=>{if(!t)return;if(!v.startDate||!v.endDate||!v.reason)return void alert("Please fill in all required fields");const e=new Date(v.startDate);if(new Date(v.endDate)<e)alert("End date cannot be before start date");else try{i(!0),await(0,Dt.gS)((0,Dt.rJ)(wt.db,"timeOffRequests"),{staffId:t.id,staffName:t.name||"Unknown",startDate:v.startDate,endDate:v.endDate,reason:v.reason,notes:v.notes,status:"pending",requestedAt:(0,Dt.O5)(),reviewedBy:null,reviewedAt:null,reviewNotes:null}),x({startDate:ff(new Date),endDate:ff(new Date((new Date).setDate((new Date).getDate()+1))),reason:"",notes:""}),g(!1);const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt._M)("staffId","==",t.id),(0,Dt.My)("requestedAt","desc")),n=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));u(n),C(n,m)}catch(gb){l("Error submitting time-off request"),console.error("Error:",gb)}finally{i(!1)}},children:"Submit Request"})]}),children:(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"start-date",children:"Start Date"}),(0,Et.jsx)(wf,{id:"start-date",type:"date",value:v.startDate,onChange:e=>x((0,o.A)((0,o.A)({},v),{},{startDate:e.target.value})),className:"mt-1"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"end-date",children:"End Date"}),(0,Et.jsx)(wf,{id:"end-date",type:"date",value:v.endDate,onChange:e=>x((0,o.A)((0,o.A)({},v),{},{endDate:e.target.value})),className:"mt-1"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"reason",children:"Reason"}),(0,Et.jsxs)("select",{id:"reason",value:v.reason,onChange:e=>x((0,o.A)((0,o.A)({},v),{},{reason:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-md mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,Et.jsx)("option",{value:"",children:"Select reason..."}),(0,Et.jsx)("option",{value:"Vacation",children:"Vacation"}),(0,Et.jsx)("option",{value:"Sick Leave",children:"Sick Leave"}),(0,Et.jsx)("option",{value:"Personal",children:"Personal"}),(0,Et.jsx)("option",{value:"Family",children:"Family"}),(0,Et.jsx)("option",{value:"Other",children:"Other"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"notes",children:"Additional Notes (Optional)"}),(0,Et.jsx)(Cf,{id:"notes",value:v.notes,onChange:e=>x((0,o.A)((0,o.A)({},v),{},{notes:e.target.value})),placeholder:"Add any additional details about your request",className:"mt-1 resize-none h-20"})]})]})}),(0,Et.jsx)(kf,{open:y,onClose:()=>b(!1),title:"Review Time-Off Request",description:w?"Request from ".concat(w.staffName||"Unknown Staff"):"",footer:(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),(0,Et.jsxs)(Kc,{variant:"outline",className:"bg-red-50 text-red-600 hover:bg-red-100",onClick:()=>A("denied"),children:[(0,Et.jsx)(Af,{className:"h-4 w-4 mr-1"}),"Deny"]}),(0,Et.jsxs)(Kc,{className:"bg-green-600 hover:bg-green-700",onClick:()=>A("approved"),children:[(0,Et.jsx)(Ef,{className:"h-4 w-4 mr-1"}),"Approve"]})]}),children:w&&(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Start Date"}),(0,Et.jsx)("div",{className:"font-medium",children:pf(w.startDate)})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"End Date"}),(0,Et.jsx)("div",{className:"font-medium",children:pf(w.endDate)})]})]}),(0,Et.jsxs)("div",{className:"mb-2",children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Reason"}),(0,Et.jsx)("div",{children:w.reason})]}),w.notes&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Additional Notes"}),(0,Et.jsx)("div",{className:"text-sm",children:w.notes})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"review-notes",children:"Review Notes (Optional)"}),(0,Et.jsx)(Cf,{id:"review-notes",value:N,onChange:e=>j(e.target.value),placeholder:"Add any notes for the team member",className:"mt-1 resize-none h-20"})]})]})})]})},_f=Mt("AlarmClock",[["circle",{cx:"12",cy:"13",r:"8",key:"3y4lt7"}],["path",{d:"M12 9v4l2 2",key:"1c63tq"}],["path",{d:"M5 3 2 6",key:"18tl5t"}],["path",{d:"m22 6-3-3",key:"1opdir"}],["path",{d:"M6.38 18.7 4 21",key:"17xu3x"}],["path",{d:"M17.64 18.67 20 21",key:"kv2oe2"}]]),Tf=async function(e,t,n,r){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=(e=>"".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString().padStart(2,"0"),"-").concat(e.getDate().toString().padStart(2,"0")))(t),l=i[a]||[],c=e=>{const[t,n]=e.split(":").map((e=>parseInt(e,10)));return 60*t+n},u=c(n),d=c(r),h=[];l.forEach((t=>{if(s&&t.id===s)return;if(t.staffId!==e)return;const[n,r]=t.shift.split(" - "),i=e=>{const t=e.toLowerCase().includes("pm"),n=e.toLowerCase().startsWith("12");let[r,s]=e.replace(" AM","").replace(" PM","").replace("am","").replace("pm","").split(":");r=parseInt(r,10),t&&!n&&(r+=12),!t&&n&&(r=0);let i=0;return s&&(i=parseInt(s,10)),60*r+i},a=i(n),o=i(r);u<o&&d>a&&h.push({shift:t,type:"overlap",message:"Overlaps with existing shift: ".concat(t.shift)})}));try{const t=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt._M)("staffId","==",e),(0,Dt._M)("status","==","approved")),n=await(0,Dt.GG)(t);n.docs.map((e=>(0,o.A)({id:e.id},e.data()))).forEach((e=>{const t=new Date(e.startDate),n=new Date(e.endDate),r=new Date(a);t.setHours(0,0,0,0),n.setHours(23,59,59,999),r.setHours(12,0,0,0),r>=t&&r<=n&&h.push({request:e,type:"timeOff",message:"Conflicts with approved time-off request (".concat(e.startDate," to ").concat(e.endDate,"): ").concat(e.reason)})}))}catch(gb){console.error("Error checking time-off conflicts:",gb)}return h},If=async(e,t)=>{const n=(e=>"".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString().padStart(2,"0"),"-").concat(e.getDate().toString().padStart(2,"0")))(t);try{const t=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt._M)("staffId","==",e),(0,Dt._M)("status","==","approved")),r=(await(0,Dt.GG)(t)).docs.map((e=>(0,o.A)({id:e.id},e.data())));for(const e of r){const t=new Date(e.startDate),r=new Date(e.endDate),s=new Date(n);if(t.setHours(0,0,0,0),r.setHours(23,59,59,999),s.setHours(12,0,0,0),s>=t&&s<=r)return e}return null}catch(gb){return console.error("Error checking time-off:",gb),null}},Rf=()=>{const{user:e}=kt(),[t,n]=(0,r.useState)(!0),{userProfile:s,error:i,profileLoaded:a}=gf(),[l,c]=(0,r.useState)(null);(0,r.useEffect)((()=>{i&&c(i)}),[i]);const[u,d]=(0,r.useState)([]),[h,m]=(0,r.useState)([]),[f,p]=(0,r.useState)(!1),[g,v]=(0,r.useState)(null),[x,y]=(0,r.useState)(""),b=(0,r.useCallback)((async()=>{if(!e||!s||!s.id)return[];try{const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"shiftSwapRequests"),(0,Dt._M)("requestorId","==",s.id),(0,Dt.My)("requestedAt","desc")),t=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));return m(t),t}catch(gb){return console.error("Error fetching swap requests:",gb),[]}}),[e,s]);(0,r.useEffect)((()=>{(async()=>{if(a)if(e&&s)try{n(!0);const e=new Date,t=[];for(let n=0;n<14;n++){const r=new Date(e);r.setDate(e.getDate()+n),t.push(ff(r))}const r=t.slice(0,10),i=t.slice(10),a=[],l=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","in",r),(0,Dt._M)("staffId","==",s.id));if((await(0,Dt.GG)(l)).docs.forEach((e=>{a.push((0,o.A)({id:e.id},e.data()))})),i.length>0){const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","in",i),(0,Dt._M)("staffId","==",s.id));(await(0,Dt.GG)(e)).docs.forEach((e=>{a.push((0,o.A)({id:e.id},e.data()))}))}a.sort(((e,t)=>e.date.localeCompare(t.date))),d(a),await b()}catch(gb){console.error("Error fetching upcoming shifts:",gb),c("Failed to load upcoming shifts")}finally{n(!1)}else n(!1)})()}),[s,b,a,e]);return t?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):e?a&&!s?(0,Et.jsx)("div",{className:"text-center p-4 text-red-600",children:"Your user profile could not be found. Please contact an administrator."}):(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsx)("h2",{className:"text-lg font-medium",children:"Request Shift Swaps"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Need someone to cover a shift? Create a swap request for your upcoming shifts."}),l&&(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md border border-red-200",children:(0,Et.jsx)("p",{className:"text-red-600",children:l})}),(0,Et.jsxs)(Rc,{className:"p-4",children:[(0,Et.jsxs)("h3",{className:"font-medium mb-4 flex items-center",children:[(0,Et.jsx)(an,{className:"h-4 w-4 mr-1"}),"My Upcoming Shifts"]}),0===u.length?(0,Et.jsx)("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"You have no upcoming shifts scheduled"})}):(0,Et.jsx)("div",{className:"space-y-3",children:u.map((e=>{const t=(n=e.id,h.some((e=>e.originalShiftId===n&&("pending"===e.status||"accepted"===e.status))));var n;return(0,Et.jsx)("div",{className:"border rounded-lg p-3",children:(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:pf(e.date)}),(0,Et.jsx)("div",{className:"text-blue-600",children:e.shift})]}),(0,Et.jsx)("div",{children:t?(0,Et.jsx)("div",{className:"text-xs bg-amber-100 text-amber-700 px-2 py-1 rounded",children:"Swap Requested"}):(0,Et.jsxs)(Kc,{size:"sm",onClick:()=>(e=>{v(e),y(""),p(!0)})(e),className:"text-xs",children:[(0,Et.jsx)(_f,{className:"h-3 w-3 mr-1"}),"Request Swap"]})})]})},e.id)}))})]}),h.length>0&&(0,Et.jsxs)(Rc,{className:"p-4",children:[(0,Et.jsxs)("h3",{className:"font-medium mb-4 flex items-center",children:[(0,Et.jsx)(Qt,{className:"h-4 w-4 mr-1"}),"My Swap Requests"]}),(0,Et.jsx)("div",{className:"space-y-3",children:h.map((e=>(0,Et.jsxs)("div",{className:"border rounded-lg p-3 ".concat("accepted"===e.status?"bg-green-50 border-green-200":"completed"===e.status?"bg-blue-50 border-blue-200":"cancelled"===e.status?"bg-gray-50 border-gray-200":""),children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:pf(e.date)}),(0,Et.jsx)("div",{className:"text-blue-600",children:e.shift})]}),(0,Et.jsx)("div",{className:"text-xs px-2 py-1 rounded ".concat("pending"===e.status?"bg-amber-100 text-amber-700":"accepted"===e.status?"bg-green-100 text-green-700":"completed"===e.status?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"pending"===e.status?"Pending":"accepted"===e.status?"Accepted":"completed"===e.status?"Completed":"cancelled"===e.status?"Cancelled":e.status})]}),e.requestNote&&(0,Et.jsxs)("div",{className:"text-xs text-gray-600 bg-gray-50 p-2 rounded mb-2",children:[(0,Et.jsx)(wc,{className:"h-3 w-3 inline mr-1"}),e.requestNote]}),"accepted"===e.status&&(0,Et.jsxs)("div",{className:"text-xs text-green-600",children:[(0,Et.jsx)("span",{className:"font-medium",children:"Accepted by:"})," ",e.acceptorName]}),"pending"===e.status&&(0,Et.jsx)("div",{className:"flex justify-end mt-2",children:(0,Et.jsx)(Kc,{variant:"outline",size:"sm",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to cancel this swap request?"))try{n(!0),await(0,Dt.kd)((0,Dt.H9)(wt.db,"shiftSwapRequests",e)),await b(),alert("Swap request cancelled successfully!")}catch(gb){console.error("Error cancelling swap request:",gb),c("Failed to cancel swap request")}finally{n(!1)}})(e.id),className:"text-xs text-red-600 hover:bg-red-50",children:"Cancel Request"})})]},e.id)))})]}),(0,Et.jsx)(kf,{open:f,onClose:()=>p(!1),title:"Request Shift Swap",description:"Ask a team member to cover your shift",footer:(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>p(!1),children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:async()=>{if(g&&e&&s)try{n(!0);const e=await If(s.id,new Date(g.date));if(e&&(alert("Warning: You have approved time-off on this date (".concat(e.reason,"). ")+"You may want to cancel your time-off request instead of requesting a shift swap."),!window.confirm("Do you want to proceed with the shift swap request anyway?")))return void n(!1);await(0,Dt.gS)((0,Dt.rJ)(wt.db,"shiftSwapRequests"),{originalShiftId:g.id,requestorId:s.id,requestorName:s.name||"Unknown",date:g.date,shift:g.shift,requestNote:x,status:"pending",requestedAt:(0,Dt.O5)(),acceptorId:"",acceptorName:"",acceptedAt:null,completedAt:null}),p(!1),await b(),alert("Shift swap request created successfully!")}catch(gb){console.error("Error creating swap request:",gb),c("Failed to create swap request")}finally{n(!1)}else c("You must be logged in to create a swap request")},children:"Submit Request"})]}),children:g&&(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Shift Details"}),(0,Et.jsx)("div",{className:"font-medium",children:pf(g.date)}),(0,Et.jsx)("div",{className:"text-blue-600",children:g.shift})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{htmlFor:"request-note",className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),(0,Et.jsx)(Cf,{id:"request-note",value:x,onChange:e=>y(e.target.value),placeholder:"Add a note explaining why you need someone to cover this shift",className:"resize-none h-20"})]}),(0,Et.jsx)("div",{className:"text-xs text-gray-600 bg-gray-50 p-3 rounded",children:(0,Et.jsx)("p",{children:"Your request will be visible to all team members. Once someone accepts it, the schedule will be updated automatically."})})]})})]}):(0,Et.jsx)("div",{className:"text-center p-4 text-amber-600",children:"Please log in to view your shift swap requests"})},Pf=()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)(!0),[i,a]=(0,r.useState)(null),[l,c]=(0,r.useState)(null),{user:u}=kt(),d=(0,r.useCallback)((async()=>{if(!u)return null;try{const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"profiles"),(0,Dt._M)("uid","==",u.uid)),t=await(0,Dt.GG)(e);if(!t.empty)return(0,o.A)({id:t.docs[0].id},t.docs[0].data());const n=(0,Dt.H9)(wt.db,"profiles",u.uid),r=await(0,Dt.x7)(n);if(r.exists())return(0,o.A)({id:r.id},r.data());if(u.email){const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"profiles"),(0,Dt._M)("email","==",u.email)),t=await(0,Dt.GG)(e);if(!t.empty)return(0,o.A)({id:t.docs[0].id},t.docs[0].data())}return console.error("No profile found for user:",u.uid),null}catch(gb){return console.error("Error finding user profile:",gb),null}}),[u]),h=(0,r.useCallback)((async e=>{if(u&&e){s(!0);try{const n=(0,Dt.P)((0,Dt.rJ)(wt.db,"shiftSwapRequests"),(0,Dt._M)("status","==","pending"),(0,Dt._M)("requestorId","!=",e)),r=await(0,Dt.GG)(n),s=[];for(const e of r.docs){const t=e.data(),n=await(0,Dt.x7)((0,Dt.H9)(wt.db,"profiles",t.requestorId)),r=n.exists()&&(n.data().displayName||n.data().name)||"Unknown User";s.push((0,o.A)((0,o.A)({id:e.id},t),{},{requestorName:r}))}t(s)}catch(gb){console.error("Error fetching available requests:",gb),a("Failed to load available swap requests. Please try again later.")}finally{s(!1)}}else s(!1)}),[u]);(0,r.useEffect)((()=>{(async()=>{const e=await d();c(e),e?h(e.id):s(!1)})()}),[d,h]);const m=async t=>{if(!u||!l)return void a("You must be logged in with a valid profile to accept shift swap requests");const n=e.find((e=>e.id===t));if(n)try{const e=n.date.seconds?new Date(1e3*n.date.seconds):new Date(n.date),[r,s]=n.shift.split(" - "),a=e=>{const t=e.toLowerCase().includes("pm"),n=e.toLowerCase().startsWith("12");let[r,s]=e.replace(" AM","").replace(" PM","").replace("am","").replace("pm","").split(":");r=parseInt(r,10),t&&!n&&(r+=12),!t&&n&&(r=0);let i=0;return s&&(i=parseInt(s,10)),"".concat(r.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"))},o=a(r),c=a(s),u=await Tf(l.id,e,o,c),d=await If(l.id,e);if(u.length>0||d){let e="Warning: Taking this shift may create conflicts:\n\n";if(u.length>0&&(e+="- You already have a shift scheduled during this time\n"),d&&(e+="- You have approved time-off on this date (".concat(d.reason,")\n")),e+="\nDo you still want to accept this shift swap?",!window.confirm(e))return}if(!window.confirm("Are you sure you want to accept this shift swap request?"))return;const m=(0,Dt.H9)(wt.db,"shiftSwapRequests",t);await(0,Dt.mZ)(m,{status:"accepted",acceptorId:l.id,acceptorName:l.name||l.displayName||"Unknown User",acceptedAt:new Date}),await(async(e,t)=>{try{const n=(0,Dt.H9)(wt.db,"shiftSwapRequests",e),r=await(0,Dt.x7)(n);if(!r.exists())return console.error("Swap request not found"),!1;const s=r.data();if("accepted"!==s.status)return console.error("Cannot update schedule for a swap request that is not accepted"),!1;const i=(0,Dt.H9)(wt.db,"schedules",s.originalShiftId);return(await(0,Dt.x7)(i)).exists()?(await(0,Dt.mZ)(i,{staffId:t,updatedAt:(0,Dt.O5)(),swappedFrom:s.requestorId,swapRequestId:e}),await(0,Dt.mZ)(n,{status:"completed",completedAt:(0,Dt.O5)()}),await(0,Dt.gS)((0,Dt.rJ)(wt.db,"shiftSwapHistory"),{requestId:e,originalShiftId:s.originalShiftId,requestorId:s.requestorId,requestorName:s.requestorName||"",acceptorId:t,acceptorName:"",date:s.date,shift:s.shift,completedAt:(0,Dt.O5)()}),!0):(console.error("Original shift not found in schedule"),!1)}catch(i){return console.error("Error updating schedule after swap:",i),!1}})(t,l.id),h(l.id),alert("Shift swap request accepted successfully!")}catch(gb){console.error("Error accepting request:",gb),alert("Failed to accept the shift swap request. Please try again.")}else a("Could not find the requested shift")};return n?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):i?(0,Et.jsx)("div",{className:"text-center p-4 text-red-500",children:i}):u?l?(0,Et.jsxs)("div",{className:"p-4",children:[(0,Et.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Available Shift Swaps"}),0===e.length?(0,Et.jsx)("p",{className:"text-gray-500",children:"No pending shift swap requests available."}):(0,Et.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map((e=>(0,Et.jsxs)("div",{className:"border rounded-lg p-4 bg-white shadow-sm hover:shadow-md transition-shadow",children:[(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start mb-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"font-semibold",children:e.requestorName}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:new Date(1e3*e.date.seconds).toLocaleDateString()})]}),(0,Et.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs inline-block mt-2 sm:mt-0 w-fit",children:"Pending"})]}),(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsxs)("p",{className:"text-sm",children:[(0,Et.jsx)("span",{className:"font-medium",children:"Shift: "}),e.shift]}),(0,Et.jsxs)("p",{className:"text-sm",children:[(0,Et.jsx)("span",{className:"font-medium",children:"Reason: "}),e.reason||"No reason provided"]}),e.notes&&(0,Et.jsxs)("p",{className:"text-sm",children:[(0,Et.jsx)("span",{className:"font-medium",children:"Notes: "}),e.notes]})]}),(0,Et.jsx)("button",{onClick:()=>m(e.id),className:"w-full py-3 bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors touch-target",children:"Accept Shift"})]},e.id)))})]}):(0,Et.jsx)("div",{className:"text-center p-4 text-amber-600",children:"Your user profile could not be found. Please contact an administrator."}):(0,Et.jsx)("div",{className:"text-center p-4 text-amber-600",children:"Please log in to view available shift swaps"})},Of=()=>{const[e,t]=(0,r.useState)("my-requests");return(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("h2",{className:"text-lg font-medium flex items-center",children:[(0,Et.jsx)(mf,{className:"h-5 w-5 mr-2"}),"Shift Swap System"]}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Request coverage for your shifts or accept shifts from other team members"})]})}),(0,Et.jsxs)(ss,{defaultValue:"my-requests",value:e,onValueChange:t,className:"w-full",children:[(0,Et.jsxs)(is,{className:"w-full flex justify-start mb-6 border-b",children:[(0,Et.jsxs)(as,{value:"my-requests",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(an,{className:"h-4 w-4 mr-2"}),"My Swap Requests"]}),(0,Et.jsxs)(as,{value:"available-shifts",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(cf,{className:"h-4 w-4 mr-2"}),"Available Shifts"]})]}),(0,Et.jsx)(os,{value:"my-requests",children:(0,Et.jsx)(Rf,{})}),(0,Et.jsx)(os,{value:"available-shifts",children:(0,Et.jsx)(Pf,{})})]})]})},Mf=e=>{let{currentUserProfile:t}=e;const[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[u,d]=(0,r.useState)(null),[h,m]=(0,r.useState)(new Date),f=(0,r.useCallback)((()=>{const e=h.getFullYear(),t=h.getMonth(),n=new Date(e,t,1).getDay(),r=new Date(e,t,1-(0===n?6:n-1)),s=[];for(let i=0;i<42;i++){const e=new Date(r);e.setDate(r.getDate()+i),s.push(e)}return s}),[h]),p=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)};(0,r.useEffect)((()=>{(async()=>{try{c(!0);const e=f(),t=e[0],n=e[e.length-1],r=p(t),i=p(n),l=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date",">=",r),(0,Dt._M)("date","<=",i),(0,Dt.My)("date","asc")),u=(await(0,Dt.GG)(l)).docs.map((e=>(0,o.A)({id:e.id},e.data()))),d=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"profiles"))).docs.map((e=>(0,o.A)({id:e.id},e.data())));a(d),s(u)}catch(gb){console.error("Error loading schedule or profiles:",gb),d("Failed to load schedule data")}finally{c(!1)}})()}),[h,f]);if(l)return(0,Et.jsx)(uf,{message:"Loading calendar data..."});if(u)return(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md border border-red-200",children:(0,Et.jsx)("p",{className:"text-red-600",children:u})});const g=f();return(0,Et.jsxs)(Rc,{className:"p-4",children:[(0,Et.jsx)("div",{className:"mb-4",children:t&&(0,Et.jsx)("div",{className:"text-sm text-blue-600 bg-blue-50 p-3 rounded-lg mb-4",children:(0,Et.jsxs)("p",{children:[(0,Et.jsx)("span",{className:"font-medium",children:"Your shifts"})," are highlighted with a blue border"]})})}),(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)(Kc,{variant:"outline",size:"sm",onClick:()=>{const e=new Date(h);e.setMonth(h.getMonth()-1),m(e)},children:(0,Et.jsx)(Lu,{className:"h-4 w-4"})}),(0,Et.jsx)("h2",{className:"text-lg font-medium",children:h.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,Et.jsx)(Kc,{variant:"outline",size:"sm",onClick:()=>{const e=new Date(h);e.setMonth(h.getMonth()+1),m(e)},children:(0,Et.jsx)(hs,{className:"h-4 w-4"})})]}),(0,Et.jsx)("div",{className:"grid grid-cols-7 text-center mb-2",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map((e=>(0,Et.jsx)("div",{className:"font-medium py-2",children:e},e)))}),(0,Et.jsx)("div",{className:"grid grid-cols-7 gap-1",children:g.map(((e,r)=>{const s=(e=>{const t=p(e);return n.filter((e=>e.date===t))})(e),a=(e=>e.getMonth()===h.getMonth())(e),o=(e=>{const t=new Date;return e.getDate()===t.getDate()&&e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()})(e);return(0,Et.jsxs)("div",{className:"min-h-24 border rounded-md p-1 ".concat(a?o?"border-blue-500":"bg-white":"bg-gray-50 text-gray-400"),children:[(0,Et.jsx)("div",{className:"text-right text-sm font-medium mb-1",children:e.getDate()}),(0,Et.jsx)("div",{className:"space-y-1 overflow-y-auto max-h-20",children:s.map((e=>{const n=(e=>{const t=i.find((t=>t.id===e));return(null===t||void 0===t?void 0:t.name)||"Unknown Staff"})(e.staffId),r=(e=>{const t=e.split("").reduce(((e,t)=>t.charCodeAt(0)+((e<<5)-e)),0),n=Math.abs(t%360);return"hsl(".concat(n,", 70%, 80%)")})(e.staffId),s=t&&t.id===e.staffId;return(0,Et.jsxs)("div",{className:"text-xs p-1 rounded truncate ".concat(s?"border-2 border-blue-500":""),style:{backgroundColor:r},children:[(0,Et.jsx)("div",{className:"font-medium",children:n}),e.shift&&(0,Et.jsx)("div",{children:e.shift})]},e.id)}))})]},r)}))})]})},Lf=Mt("CalendarRange",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]]),Bf=Mt("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),zf=Mt("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]),Uf=()=>{var e;const[t,n]=(0,r.useState)([]),[s,i]=(0,r.useState)({}),[a,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(new Date),[m,f]=(0,r.useState)("week"),[p,g]=(0,r.useState)({}),[v,x]=(0,r.useState)(!1),[y,b]=(0,r.useState)("create"),[w,D]=(0,r.useState)(null),[N,j]=(0,r.useState)({staffId:"",startTime:"",endTime:"",notes:""}),[C,E]=(0,r.useState)(null),[A,k]=(0,r.useState)(!1),[S,F]=(0,r.useState)([]),[_,T]=(0,r.useState)({start:new Date((new Date).setDate((new Date).getDate()-14)),end:new Date}),[I,R]=(0,r.useState)(!1),[P,O]=(0,r.useState)({start:new Date((new Date).setDate(1)),end:new Date((new Date).setMonth((new Date).getMonth()+1,0))}),[M,L]=(0,r.useState)(!1),[B,z]=(0,r.useState)({startDate:new Date,endDate:new Date((new Date).setDate((new Date).getDate()+7)),daysOfWeek:[1,2,3,4,5,6],staffIds:[]});(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"profiles"),(0,Dt._M)("teamAccess.hasAccess","==",!0)),t=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));n(t)}catch(gb){console.error("Error fetching staff members:",gb),u("Failed to load staff members")}})()}),[]);const U=(0,r.useCallback)((()=>{const e=[],t=new Date(d);if("day"===m)e.push(new Date(t));else if("week"===m){const n=d.getDay(),r=0===n?6:n-1;t.setDate(d.getDate()-r);for(let s=0;s<7;s++){const n=new Date(t);n.setDate(t.getDate()+s),e.push(n)}}else if("month"===m){t.setDate(1);const n=new Date(t).getDay(),r=0===n?6:n-1;t.setDate(t.getDate()-r);for(let s=0;s<42;s++){const n=new Date(t);n.setDate(t.getDate()+s),e.push(n)}}return e}),[d,m]),q=e=>{if(!e)return"";const[t,n]=e.split(":").map((e=>parseInt(e,10))),r=t>=12?"pm":"am";return"".concat(t%12||12).concat(n>0?":".concat(n.toString().padStart(2,"0")):"").concat(r)},V=e=>{const t=ff(e);return s[t]||[]},H=(0,r.useCallback)((async e=>{try{const n=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt._M)("status","==","approved")),r=(await(0,Dt.GG)(n)).docs.map((e=>(0,o.A)({id:e.id},e.data()))),s={};for(const i of e){s[i]=[];const e=new Date(i);for(const n of r){const r=new Date(n.startDate),a=new Date(n.endDate);if(r.setHours(0,0,0,0),a.setHours(23,59,59,999),e.setHours(12,0,0,0),e>=r&&e<=a){const e=t.find((e=>e.id===n.staffId));s[i].push({staffId:n.staffId,name:e?e.name:n.staffName||"Unknown",reason:n.reason,requestId:n.id})}}}g(s)}catch(gb){console.error("Error fetching time-off data:",gb)}}),[t]);(0,r.useEffect)((()=>{(async()=>{try{l(!0);const e=U().map((e=>ff(e))),t=10;let n={};for(let r=0;r<e.length;r+=t){const s=e.slice(r,r+t),i=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","in",s)),a=await(0,Dt.GG)(i);a.docs.map((e=>(0,o.A)({id:e.id},e.data()))).forEach((e=>{n[e.date]||(n[e.date]=[]),n[e.date].push(e)}))}i(n),await H(e)}catch(gb){console.error("Error fetching schedule data:",gb),u("Failed to load schedule data")}finally{l(!1)}})()}),[d,m,U,H]);const W=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(D(e),n){b("edit"),E(n.id);const[e,t]=n.shift.split(" - "),r=e=>{const t=e.toLowerCase().includes("pm"),n=e.toLowerCase().startsWith("12");let[r,s]=e.replace(" AM","").replace(" PM","").replace("am","").replace("pm","").split(":");return r=parseInt(r,10),t&&!n&&(r+=12),!t&&n&&(r=0),s=s||"00","".concat(r.toString().padStart(2,"0"),":").concat(s.padStart(2,"0"))};j({staffId:n.staffId,startTime:r(e),endTime:r(t),notes:n.notes||""})}else{b("create"),E(null);const n=(e=>{const t=e.getDay();return 0===t?{startTime:"",endTime:""}:6===t?{startTime:"10:00",endTime:"18:00"}:{startTime:"11:00",endTime:"19:00"}})(e);j({staffId:t||"",startTime:n.startTime,endTime:n.endTime,notes:""})}x(!0)},G=async()=>{if(C&&window.confirm("Are you sure you want to delete this shift?"))try{await(0,Dt.kd)((0,Dt.H9)(wt.db,"schedules",C));const e=ff(w),t=(0,o.A)({},s);t[e]&&(t[e]=t[e].filter((e=>e.id!==C))),i(t),x(!1)}catch(gb){console.error("Error deleting shift:",gb),u("Failed to delete shift")}},K=e=>{const n=ff(e),r=s[n]||[],i=e.getMonth()===d.getMonth(),a=ff(e)===ff(new Date),o=0===e.getDay(),l=p[n]||[];return(0,Et.jsxs)("div",{className:"border min-h-[100px] ".concat(i?"bg-white":"bg-gray-50"," ").concat(a?"border-blue-400":"border-gray-200"," ").concat(o?"bg-gray-100":""),children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center p-1 border-b",children:[(0,Et.jsx)("span",{className:"text-sm font-medium ".concat(i?"":"text-gray-400"," ").concat(a?"text-blue-600":""),children:e.getDate()}),i&&(0,Et.jsx)("button",{onClick:()=>W(e),className:"text-blue-600 hover:text-blue-800 p-1 rounded-full hover:bg-blue-50",children:(0,Et.jsx)(gu,{size:14})})]}),(0,Et.jsxs)("div",{className:"p-1 space-y-1",children:[l.length>0&&(0,Et.jsxs)("div",{className:"p-1 text-xs text-red-600 bg-red-50 rounded mb-1",children:[(0,Et.jsx)("div",{className:"font-medium",children:"Time Off:"}),l.map((e=>(0,Et.jsxs)("div",{className:"truncate",children:[e.name," (",e.reason,")"]},e.staffId)))]}),r.map((n=>{const r=t.find((e=>e.id===n.staffId)),s=l.some((e=>e.staffId===n.staffId));return(0,Et.jsxs)("div",{className:"".concat(s?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"," p-1 rounded text-xs cursor-pointer hover:bg-blue-200"),onClick:()=>W(e,null,n),children:[(0,Et.jsx)("div",{className:"font-medium",children:n.shift}),(0,Et.jsxs)("div",{className:"flex items-center",children:[(null===r||void 0===r?void 0:r.name)||"Unknown",s&&(0,Et.jsx)("span",{className:"ml-1 text-red-600 text-xs",children:"\u26a0\ufe0f"})]}),n.notes&&(0,Et.jsx)("div",{className:"text-blue-600 text-xs truncate",children:n.notes})]},n.id)}))]})]})},Q=e=>{const n=ff(e),r=s[n]||[],i=e.getMonth()===d.getMonth(),a=ff(e)===ff(new Date),o=0===e.getDay(),l=p[n]||[];return(0,Et.jsxs)("div",{className:"".concat(i?"bg-white":"bg-gray-50"," \n                    ").concat(a?"border-blue-400 border-2":"border border-gray-200"," \n                    ").concat(o?"bg-gray-100":""," \n                    rounded-lg overflow-hidden mb-3 shadow-sm"),children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50",children:[(0,Et.jsxs)("span",{className:"font-medium ".concat(i?"":"text-gray-400"," ").concat(a?"text-blue-600":""),children:[e.toLocaleDateString("en-US",{weekday:"short"}),", ",e.getDate()]}),i&&(0,Et.jsx)("button",{onClick:()=>W(e),className:"bg-blue-100 text-blue-600 hover:bg-blue-200 p-2 rounded-full","aria-label":"Add shift",children:(0,Et.jsx)(gu,{size:18})})]}),(0,Et.jsxs)("div",{className:"p-2 space-y-2 max-h-36 overflow-y-auto",children:[l.length>0&&(0,Et.jsxs)("div",{className:"p-2 text-xs text-red-600 bg-red-50 rounded mb-1",children:[(0,Et.jsxs)("div",{className:"font-medium flex items-center",children:[(0,Et.jsx)(nn,{className:"h-3 w-3 mr-1"}),"Time Off:"]}),l.map((e=>(0,Et.jsx)("div",{className:"truncate pl-1 pt-1",children:e.name},e.staffId)))]}),r.map((n=>{const r=t.find((e=>e.id===n.staffId)),s=l.some((e=>e.staffId===n.staffId));return(0,Et.jsxs)("div",{className:"".concat(s?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"," \n                            p-3 rounded text-sm cursor-pointer active:opacity-80 \n                            flex justify-between items-start shadow-sm"),onClick:()=>W(e,null,n),children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:n.shift}),(0,Et.jsxs)("div",{className:"flex items-center",children:[(null===r||void 0===r?void 0:r.name)||"Unknown",s&&(0,Et.jsx)("span",{className:"ml-1 text-red-600 text-xs",children:"\u26a0\ufe0f"})]})]}),n.notes&&(0,Et.jsx)("div",{className:"text-xs italic truncate max-w-[100px]",children:n.notes})]},n.id)})),0===r.length&&i&&(0,Et.jsx)("div",{className:"text-xs text-gray-500 text-center py-4",children:"No shifts scheduled"})]})]})},Y=e=>{let{scheduleData:t,staffMembers:n,startDate:s,endDate:i}=e;const[a,o]=(0,r.useState)({totalShifts:0,hoursPerStaff:[],shiftsPerDay:[],coverage:[]}),l=(0,r.useCallback)((()=>{const e=[],r=new Date(s),a=new Date(i);for(let t=new Date(r);t<=a;t.setDate(t.getDate()+1))e.push(ff(t));let l=0;const c={},u={},d={};n.forEach((e=>{c[e.id]=0})),e.forEach((e=>{u[e]=0,d[e]=[]})),e.forEach((e=>{const n=t[e]||[];l+=n.length,u[e]=n.length,n.forEach((t=>{const[n,r]=t.shift.split(" - "),s=e=>{const t=e.toLowerCase().includes("pm"),n=e.toLowerCase().startsWith("12");let[r,s]=e.replace(" AM","").replace(" PM","").replace("am","").replace("pm","").split(":");r=parseInt(r,10),t&&!n&&(r+=12),!t&&n&&(r=0);let i=0;return s&&(i=parseInt(s,10)),60*r+i},i=s(n),a=s(r),o=(a-i)/60;if(void 0!==c[t.staffId]&&(c[t.staffId]+=o),d[e])for(let l=i;l<a;l+=30){const t=30*Math.floor(l/30);d[e].includes(t)||d[e].push(t)}}))}));const h=Object.keys(c).map((e=>{const t=n.find((t=>t.id===e));return{staffId:e,name:(null===t||void 0===t?void 0:t.name)||"Unknown",hours:parseFloat(c[e].toFixed(2))}})).sort(((e,t)=>t.hours-e.hours)),m=Object.keys(u).map((e=>{const[t,n,r]=e.split("-").map((e=>parseInt(e,10))),s=new Date(t,n-1,r);return{date:e,dayName:s.toLocaleDateString("en-US",{weekday:"short"}),formattedDate:s.toLocaleDateString("en-US",{month:"short",day:"numeric"}),shifts:u[e]}})),f=Object.keys(d).map((e=>{const[t,n,r]=e.split("-").map((e=>parseInt(e,10))),s=new Date(t,n-1,r),i=0===s.getDay(),a=i?100:d[e].length/24*100;return{date:e,dayName:s.toLocaleDateString("en-US",{weekday:"short"}),formattedDate:s.toLocaleDateString("en-US",{month:"short",day:"numeric"}),coverage:parseFloat(a.toFixed(2)),isClosed:i}}));o({totalShifts:l,hoursPerStaff:h,shiftsPerDay:m,coverage:f})}),[t,s,i,n]);return(0,r.useEffect)((()=>{l()}),[l]),(0,Et.jsxs)("div",{className:"space-y-6",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Et.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,Et.jsx)("h3",{className:"font-medium mb-2",children:"Total Shifts"}),(0,Et.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:a.totalShifts})]}),(0,Et.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,Et.jsx)("h3",{className:"font-medium mb-2",children:"Date Range"}),(0,Et.jsxs)("p",{className:"text-lg font-bold text-green-700",children:[new Date(s).toLocaleDateString()," - ",new Date(i).toLocaleDateString()]})]}),(0,Et.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,Et.jsx)("h3",{className:"font-medium mb-2",children:"Avg. Hours per Staff"}),(0,Et.jsx)("p",{className:"text-2xl font-bold text-purple-700",children:a.hoursPerStaff.length>0?(a.hoursPerStaff.reduce(((e,t)=>e+t.hours),0)/a.hoursPerStaff.filter((e=>e.hours>0)).length).toFixed(1):0})]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"font-medium mb-3",children:"Hours by Staff Member"}),(0,Et.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-3 border-b grid grid-cols-2",children:[(0,Et.jsx)("div",{className:"font-medium",children:"Staff"}),(0,Et.jsx)("div",{className:"font-medium text-right",children:"Hours"})]}),(0,Et.jsxs)("div",{className:"max-h-48 overflow-y-auto",children:[a.hoursPerStaff.map((e=>(0,Et.jsxs)("div",{className:"p-3 border-b grid grid-cols-2 hover:bg-gray-50",children:[(0,Et.jsx)("div",{children:e.name}),(0,Et.jsx)("div",{className:"text-right font-mono",children:e.hours})]},e.staffId))),0===a.hoursPerStaff.length&&(0,Et.jsx)("div",{className:"p-4 text-center text-gray-500",children:"No staff hours to display"})]})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"font-medium mb-3",children:"Coverage by Day"}),(0,Et.jsxs)("div",{className:"border rounded-lg overflow-hidden",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-3 border-b grid grid-cols-2",children:[(0,Et.jsx)("div",{className:"font-medium",children:"Date"}),(0,Et.jsx)("div",{className:"font-medium text-right",children:"Coverage"})]}),(0,Et.jsxs)("div",{className:"max-h-48 overflow-y-auto",children:[a.coverage.map((e=>(0,Et.jsxs)("div",{className:"p-3 border-b grid grid-cols-2 hover:bg-gray-50",children:[(0,Et.jsxs)("div",{children:[e.dayName,", ",e.formattedDate]}),(0,Et.jsx)("div",{className:"text-right",children:e.isClosed?(0,Et.jsx)("span",{className:"text-gray-500",children:"Closed"}):(0,Et.jsxs)("div",{className:"flex items-center justify-end",children:[(0,Et.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2.5 mr-2",children:(0,Et.jsx)("div",{className:"h-2.5 rounded-full ".concat(e.coverage<60?"bg-red-500":e.coverage<80?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(e.coverage,"%")}})}),(0,Et.jsxs)("span",{className:"font-mono",children:[e.coverage,"%"]})]})})]},e.date))),0===a.coverage.length&&(0,Et.jsx)("div",{className:"p-4 text-center text-gray-500",children:"No coverage data to display"})]})]})]})]})]})},J=async()=>{try{l(!0);const e=ff(_.start),n=ff(_.end),r=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeTracking"),(0,Dt._M)("date",">=",e),(0,Dt._M)("date","<=",n),(0,Dt.My)("date")),s=(await(0,Dt.GG)(r)).docs.map((e=>(0,o.A)({id:e.id},e.data()))),i={};s.forEach((e=>{i[e.staffId]||(i[e.staffId]=[]),i[e.staffId].push(e)}));const a=[];for(const o in i){const e=t.find((e=>e.id===o));if(!e)continue;const n={};i[o].forEach((e=>{n[e.date]||(n[e.date]=[]),n[e.date].push({action:e.action,timestamp:e.timestamp})}));const r=[];for(const t in n){const e=n[t].sort(((e,t)=>{var n,r;return((null===(n=e.timestamp)||void 0===n?void 0:n.seconds)||0)-((null===(r=t.timestamp)||void 0===r?void 0:r.seconds)||0)}));let s=0,i=null;e.forEach((e=>{if("clock-in"===e.action)i=e.timestamp;else if("clock-out"===e.action&&i){const t=1e3*i.seconds,n=1e3*e.timestamp.seconds,r=Math.round((n-t)/6e4);s+=r,i=null}}));const a=Math.floor(s/60),o=s%60,l=null!==i;r.push({date:t,displayDate:new Date(t.split("-")[0],t.split("-")[1]-1,t.split("-")[2]).toLocaleDateString(),totalTime:"".concat(a,"h ").concat(o,"m"),totalMinutes:s,isStillClockedIn:l})}r.sort(((e,t)=>e.date.localeCompare(t.date)));const s=r.reduce(((e,t)=>e+t.totalMinutes),0),l=Math.floor(s/60),c=s%60;a.push({staffId:o,staffName:e.name||"Unknown Staff",totalHours:"".concat(l,"h ").concat(c,"m"),totalMinutes:s,dailyBreakdown:r})}a.sort(((e,t)=>e.staffName.localeCompare(t.staffName))),F(a),k(!0)}catch(gb){console.error("Error generating time card report:",gb),u("Failed to generate time card report")}finally{l(!1)}};return a?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):c?(0,Et.jsx)(Sf,{error:c}):(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 mb-6",children:[(0,Et.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4",children:[(0,Et.jsxs)("h1",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,Et.jsx)(La,{className:"mr-2 h-5 w-5"}),"Team Schedule"]}),(0,Et.jsx)("div",{className:"text-sm bg-blue-100 text-blue-700 px-2 py-1 rounded-full mt-2 md:mt-0",children:"Admin Mode"})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[(0,Et.jsxs)(Kc,{size:"sm",onClick:J,className:"flex items-center justify-center",children:[(0,Et.jsx)(Qt,{className:"h-4 w-4 mr-1"}),"Time Cards"]}),(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>{z({startDate:new Date,endDate:new Date((new Date).setDate((new Date).getDate()+7)),daysOfWeek:[1,2,3,4,5,6],staffIds:[]}),L(!0)},className:"flex items-center justify-center",children:[(0,Et.jsx)(an,{className:"h-4 w-4 mr-1"}),(0,Et.jsx)("span",{className:"hidden sm:inline",children:"Create Bulk Schedule"}),(0,Et.jsx)("span",{className:"sm:hidden",children:"Bulk Create"})]}),(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>R(!0),className:"flex items-center justify-center",children:[(0,Et.jsx)(zf,{className:"h-4 w-4 mr-1"}),(0,Et.jsx)("span",{className:"hidden sm:inline",children:"Schedule Statistics"}),(0,Et.jsx)("span",{className:"sm:hidden",children:"Stats"})]})]})]}),(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:[(0,Et.jsxs)("div",{className:"flex space-x-2",children:[(0,Et.jsx)(Kc,{variant:"outline",size:"sm",onClick:()=>f("day"),className:"day"===m?"bg-blue-50 border-blue-200":"",children:"Day"}),(0,Et.jsx)(Kc,{variant:"outline",size:"sm",onClick:()=>f("week"),className:"week"===m?"bg-blue-50 border-blue-200":"",children:"Week"}),(0,Et.jsx)(Kc,{variant:"outline",size:"sm",onClick:()=>f("month"),className:"month"===m?"bg-blue-50 border-blue-200":"",children:"Month"})]}),(0,Et.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Et.jsx)(Kc,{variant:"outline",size:"icon",onClick:()=>{const e=new Date(d);"day"===m?e.setDate(d.getDate()-1):"week"===m?e.setDate(d.getDate()-7):"month"===m&&e.setMonth(d.getMonth()-1),h(e)},children:(0,Et.jsx)(Lu,{className:"h-4 w-4"})}),(0,Et.jsxs)("span",{className:"text-sm font-medium",children:["day"===m&&pf(d),"week"===m&&"Week of ".concat(pf(U()[0])),"month"===m&&d.toLocaleDateString("en-US",{month:"long",year:"numeric"})]}),(0,Et.jsx)(Kc,{variant:"outline",size:"icon",onClick:()=>{const e=new Date(d);"day"===m?e.setDate(d.getDate()+1):"week"===m?e.setDate(d.getDate()+7):"month"===m&&e.setMonth(d.getMonth()+1),h(e)},children:(0,Et.jsx)(hs,{className:"h-4 w-4"})})]})]}),(0,Et.jsxs)(Rc,{className:"overflow-hidden",children:[(0,Et.jsxs)("div",{className:"hidden md:block",children:["month"===m&&(0,Et.jsx)("div",{className:"grid grid-cols-7 bg-white border-b",children:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map((e=>(0,Et.jsx)("div",{className:"py-2 font-medium text-center border-r last:border-r-0",children:e},e)))}),"month"===m&&(0,Et.jsx)("div",{className:"grid grid-cols-7",children:U().map(((e,t)=>(0,Et.jsx)("div",{children:K(e)},t)))}),"week"===m&&(0,Et.jsx)("div",{className:"grid grid-cols-7",children:U().map(((e,t)=>(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("div",{className:"p-2 font-medium text-center border-b border-r",children:[["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t],(0,Et.jsx)("div",{className:"text-sm font-normal",children:e.getDate()})]}),K(e)]},t)))}),"day"===m&&(0,Et.jsxs)("div",{className:"p-4",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h2",{className:"text-lg font-medium",children:pf(d)}),(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>W(d),className:"flex items-center",children:[(0,Et.jsx)(gu,{className:"h-4 w-4 mr-1"}),"Add Shift"]})]}),(null===(e=p[ff(d)])||void 0===e?void 0:e.length)>0&&(0,Et.jsxs)("div",{className:"p-3 mb-4 text-sm text-red-600 bg-red-50 rounded",children:[(0,Et.jsxs)("div",{className:"font-medium flex items-center",children:[(0,Et.jsx)(nn,{className:"h-4 w-4 mr-1"}),"Staff on Time Off:"]}),p[ff(d)].map((e=>(0,Et.jsxs)("div",{className:"ml-5 mt-1 flex items-center",children:[(0,Et.jsxs)("span",{children:["\u2022 ",e.name]}),(0,Et.jsx)("span",{className:"ml-2 text-xs bg-red-100 px-2 py-0.5 rounded",children:e.reason})]},e.staffId)))]}),(0,Et.jsx)("div",{className:"space-y-4",children:0===V(d).length?(0,Et.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,Et.jsx)("p",{className:"text-gray-500",children:"No shifts scheduled for this day"}),(0,Et.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Click the 'Add Shift' button to schedule staff"})]}):V(d).map((e=>{var n;const r=t.find((t=>t.id===e.staffId)),s=null===(n=p[ff(d)])||void 0===n?void 0:n.some((t=>t.staffId===e.staffId));return(0,Et.jsxs)("div",{className:"flex justify-between items-center p-4 border rounded-lg hover:bg-blue-50 cursor-pointer ".concat(s?"bg-red-50 border-red-200":""),onClick:()=>W(d,null,e),children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("div",{className:"font-medium flex items-center",children:[(null===r||void 0===r?void 0:r.name)||"Unknown",s&&(0,Et.jsx)("span",{className:"ml-2 text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded",children:"Time Off"})]}),(0,Et.jsx)("div",{className:"text-sm text-blue-600",children:e.shift}),e.notes&&(0,Et.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:e.notes})]}),(0,Et.jsxs)("div",{className:"flex space-x-2",children:[(0,Et.jsx)(Kc,{variant:"ghost",size:"sm",className:"text-blue-600 hover:bg-blue-100",onClick:t=>{t.stopPropagation(),W(d,null,e)},children:(0,Et.jsx)(Nu,{className:"h-4 w-4"})}),(0,Et.jsx)(Kc,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-100",onClick:t=>{t.stopPropagation(),D(d),E(e.id),G()},children:(0,Et.jsx)(Bf,{className:"h-4 w-4"})})]})]},e.id)}))})]})]}),"day"===m&&(()=>{const e=ff(d),n=p[e]||[];return(0,Et.jsxs)("div",{className:"md:hidden",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h2",{className:"text-lg font-medium",children:pf(d)}),(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>W(d),className:"flex items-center",children:[(0,Et.jsx)(gu,{className:"h-4 w-4 mr-1"}),"Add"]})]}),n.length>0&&(0,Et.jsxs)("div",{className:"p-2 text-sm text-red-600 bg-red-50 rounded mb-4",children:[(0,Et.jsx)("div",{className:"font-medium",children:"Staff on Time Off:"}),n.map((e=>(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsxs)("span",{children:["\u2022 ",e.name]}),(0,Et.jsx)("span",{className:"ml-2 text-xs bg-red-100 px-2 py-0.5 rounded",children:e.reason})]},e.staffId)))]}),(0,Et.jsx)("div",{className:"space-y-2",children:0===V(d).length?(0,Et.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"No shifts scheduled"})}):V(d).map((e=>{const r=t.find((t=>t.id===e.staffId)),s=n.some((t=>t.staffId===e.staffId));return(0,Et.jsxs)("div",{className:"flex justify-between items-center p-3 border rounded-lg hover:bg-blue-50 cursor-pointer ".concat(s?"bg-red-50 border-red-200":""),onClick:()=>W(d,null,e),children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("div",{className:"font-medium",children:[(null===r||void 0===r?void 0:r.name)||"Unknown",s&&(0,Et.jsx)("span",{className:"ml-2 text-xs bg-red-100 text-red-700 px-2 py-0.5 rounded",children:"Time Off"})]}),(0,Et.jsx)("div",{className:"text-sm text-blue-600",children:e.shift}),e.notes&&(0,Et.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.notes})]}),(0,Et.jsxs)("div",{className:"flex space-x-1",children:[(0,Et.jsx)(Kc,{variant:"ghost",size:"sm",className:"text-blue-600 hover:bg-blue-100 p-1 h-8 w-8",onClick:t=>{t.stopPropagation(),W(d,null,e)},children:(0,Et.jsx)(Nu,{className:"h-4 w-4"})}),(0,Et.jsx)(Kc,{variant:"ghost",size:"sm",className:"text-red-600 hover:bg-red-100 p-1 h-8 w-8",onClick:t=>{t.stopPropagation(),D(d),E(e.id),G()},children:(0,Et.jsx)(Bf,{className:"h-4 w-4"})})]})]},e.id)}))})]})})(),"week"===m&&(()=>{const e=U();return(0,Et.jsx)("div",{className:"space-y-2 md:hidden",children:e.map(((e,t)=>(0,Et.jsx)("div",{children:Q(e)},t)))})})(),"month"===m&&(()=>{const e=U(),t=[];for(let n=0;n<e.length;n+=7)t.push(e.slice(n,n+7));return(0,Et.jsx)("div",{className:"space-y-4 md:hidden",children:t.map(((e,t)=>(0,Et.jsxs)("div",{className:"space-y-2",children:[(0,Et.jsxs)("h3",{className:"text-sm font-medium text-gray-500",children:["Week of ",e[0].toLocaleDateString("en-US",{month:"short",day:"numeric"})]}),e.map(((e,t)=>(0,Et.jsx)("div",{children:Q(e)},t)))]},t)))})})()]}),(0,Et.jsx)(kf,{open:v,onClose:()=>x(!1),title:"create"===y?"Add New Shift":"Edit Shift",description:w?pf(w):"",footer:(0,Et.jsxs)(Et.Fragment,{children:["edit"===y&&(0,Et.jsxs)(Kc,{variant:"outline",onClick:G,className:"mr-auto text-red-600 hover:bg-red-50 hover:text-red-700",children:[(0,Et.jsx)(Bf,{className:"h-4 w-4 mr-1"}),"Delete"]}),(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>x(!1),children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:async()=>{if(!w||!N.staffId||!N.startTime||!N.endTime)return void alert("Please fill in all required fields");const e=await Tf(N.staffId,w,N.startTime,N.endTime,"edit"===y?C:null,s);if(e.length>0){const t=e.filter((e=>"timeOff"===e.type)),n=e.filter((e=>"overlap"===e.type));let r="The following conflicts were detected:\n\n";if(t.length>0&&(r+="TIME-OFF CONFLICTS:\n",r+=t.map((e=>"- ".concat(e.message))).join("\n"),r+="\n\n"),n.length>0&&(r+="SHIFT CONFLICTS:\n",r+=n.map((e=>"- ".concat(e.message))).join("\n")),r+="\n\nDo you want to save this shift anyway?",!window.confirm(r))return}try{const e=ff(w),t="".concat(q(N.startTime)," - ").concat(q(N.endTime));if("edit"===y&&C){const e=(0,Dt.H9)(wt.db,"schedules",C);await(0,Dt.mZ)(e,{staffId:N.staffId,shift:t,notes:N.notes,updatedAt:(0,Dt.O5)()})}else await(0,Dt.gS)((0,Dt.rJ)(wt.db,"schedules"),{staffId:N.staffId,date:e,shift:t,notes:N.notes,createdAt:(0,Dt.O5)(),updatedAt:(0,Dt.O5)()});const n=(0,o.A)({},s),r=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","==",e)),a=await(0,Dt.GG)(r);n[e]=a.docs.map((e=>(0,o.A)({id:e.id},e.data()))),i(n),x(!1)}catch(gb){console.error("Error saving shift:",gb),u("Failed to save shift")}},children:"create"===y?"Create":"Update"})]}),children:(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"staff-select",children:"Staff Member"}),(0,Et.jsxs)("select",{id:"staff-select",value:N.staffId,onChange:e=>j((0,o.A)((0,o.A)({},N),{},{staffId:e.target.value})),className:"w-full p-2 border border-gray-300 rounded-md mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,Et.jsx)("option",{value:"",children:"Select staff member"}),t.map((e=>(0,Et.jsxs)("option",{value:e.id,children:[e.name||"No name"," ",e.certificationLevel?"(".concat(e.certificationLevel,")"):""]},e.id)))]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"start-time",children:"Start Time"}),(0,Et.jsx)(wf,{id:"start-time",type:"time",value:N.startTime,onChange:e=>j((0,o.A)((0,o.A)({},N),{},{startTime:e.target.value})),className:"mt-1"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"end-time",children:"End Time"}),(0,Et.jsx)(wf,{id:"end-time",type:"time",value:N.endTime,onChange:e=>j((0,o.A)((0,o.A)({},N),{},{endTime:e.target.value})),className:"mt-1"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"shift-notes",children:"Notes (optional)"}),(0,Et.jsx)(Cf,{id:"shift-notes",value:N.notes,onChange:e=>j((0,o.A)((0,o.A)({},N),{},{notes:e.target.value})),placeholder:"E.g., Training session, On-call, etc.",className:"mt-1 resize-none h-20"})]}),N.staffId&&w&&(0,Et.jsx)("div",{className:"relative",children:(0,Et.jsx)(Kc,{type:"button",variant:"outline",size:"sm",className:"absolute right-0 top-0 text-amber-600 border-amber-200 hover:bg-amber-50",onClick:async()=>{const e=(await Tf(N.staffId,w,N.startTime||"09:00",N.endTime||"17:00","edit"===y?C:null)).filter((e=>"timeOff"===e.type));e.length>0?alert("This staff member has approved time-off for this date:\n\n".concat(e.map((e=>e.message)).join("\n"))):alert("No time-off conflicts found for this date.")},children:"Check Time-Off"})}),(0,Et.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,Et.jsx)("p",{className:"text-sm text-blue-800",children:"Shift Preview:"}),(0,Et.jsx)("p",{className:"text-sm font-medium mt-1",children:N.startTime&&N.endTime?"".concat(q(N.startTime)," - ").concat(q(N.endTime)):"Please select both start and end times"})]})]})}),(0,Et.jsx)(kf,{open:A,onClose:()=>k(!1),title:"Time Card Report",description:"".concat(_.start.toLocaleDateString()," - ").concat(_.end.toLocaleDateString()),footer:(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>k(!1),children:"Close"}),(0,Et.jsxs)(Kc,{className:"flex items-center",onClick:()=>{if(0===S.length)return;let e="Staff Member,Total Hours,Daily Breakdown\n";S.forEach((t=>{let n=t.dailyBreakdown.map((e=>"".concat(e.displayDate,": ").concat(e.totalTime).concat(e.isStillClockedIn?" (Still clocked in)":""))).join("; ");e+='"'.concat(t.staffName,'","').concat(t.totalHours,'","').concat(n,'"\n')}));let t="Staff Member,Date,Hours Worked,Status\n";S.forEach((e=>{e.dailyBreakdown.forEach((n=>{t+='"'.concat(e.staffName,'","').concat(n.displayDate,'","').concat(n.totalTime,'","').concat(n.isStillClockedIn?"Still clocked in":"Completed",'"\n')}))}));const n=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(n),s=document.createElement("a");s.setAttribute("href",r),s.setAttribute("download","time-card-summary-".concat(ff(_.start),"-to-").concat(ff(_.end),".csv")),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s);const i=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(i),o=document.createElement("a");o.setAttribute("href",a),o.setAttribute("download","time-card-detailed-".concat(ff(_.start),"-to-").concat(ff(_.end),".csv")),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},disabled:0===S.length,children:[(0,Et.jsx)(Nc,{className:"h-4 w-4 mr-1"}),"Export CSV"]})]}),children:(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[(0,Et.jsxs)("div",{className:"w-full sm:w-1/2",children:[(0,Et.jsx)(Nf,{htmlFor:"report-start-date",children:"Start Date"}),(0,Et.jsx)(wf,{id:"report-start-date",type:"date",value:_.start.toISOString().substring(0,10),onChange:e=>T((0,o.A)((0,o.A)({},_),{},{start:new Date(e.target.value)})),className:"mt-1"})]}),(0,Et.jsxs)("div",{className:"w-full sm:w-1/2",children:[(0,Et.jsx)(Nf,{htmlFor:"report-end-date",children:"End Date"}),(0,Et.jsx)(wf,{id:"report-end-date",type:"date",value:_.end.toISOString().substring(0,10),onChange:e=>T((0,o.A)((0,o.A)({},_),{},{end:new Date(e.target.value)})),className:"mt-1"})]})]}),(0,Et.jsxs)(Kc,{onClick:J,className:"w-full",children:[(0,Et.jsx)(cf,{className:"h-4 w-4 mr-1"}),"Refresh Report"]})]}),0===S.length?(0,Et.jsx)("div",{className:"text-center py-8",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"No time card data available for the selected period"})}):(0,Et.jsx)("div",{className:"space-y-6",children:S.map((e=>(0,Et.jsxs)("div",{className:"border rounded-md overflow-hidden",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-3 flex justify-between items-center border-b",children:[(0,Et.jsx)("h3",{className:"font-medium",children:e.staffName}),(0,Et.jsx)("div",{className:"font-mono text-sm bg-blue-50 text-blue-800 px-2 py-1 rounded",children:e.totalHours})]}),(0,Et.jsxs)("div",{className:"p-3",children:[(0,Et.jsx)("div",{className:"text-sm font-medium mb-2",children:"Daily Breakdown:"}),(0,Et.jsx)("div",{className:"space-y-1 max-h-40 overflow-y-auto",children:e.dailyBreakdown.map(((e,t)=>(0,Et.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,Et.jsx)("span",{children:e.displayDate}),(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("span",{className:"font-mono",children:e.totalTime}),e.isStillClockedIn&&(0,Et.jsx)("span",{className:"ml-2 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full",children:"Still clocked in"})]})]},t)))})]})]},e.staffId)))})]})}),(0,Et.jsx)(kf,{open:I,onClose:()=>R(!1),title:"Schedule Statistics",description:"".concat(P.start.toLocaleDateString()," - ").concat(P.end.toLocaleDateString()),footer:(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>R(!1),children:"Close"}),children:(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsx)("div",{className:"mb-4",children:(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 mb-4",children:[(0,Et.jsxs)("div",{className:"w-full sm:w-1/2",children:[(0,Et.jsx)(Nf,{htmlFor:"stats-start-date",children:"Start Date"}),(0,Et.jsx)(wf,{id:"stats-start-date",type:"date",value:P.start.toISOString().substring(0,10),onChange:e=>O((0,o.A)((0,o.A)({},P),{},{start:new Date(e.target.value)})),className:"mt-1"})]}),(0,Et.jsxs)("div",{className:"w-full sm:w-1/2",children:[(0,Et.jsx)(Nf,{htmlFor:"stats-end-date",children:"End Date"}),(0,Et.jsx)(wf,{id:"stats-end-date",type:"date",value:P.end.toISOString().substring(0,10),onChange:e=>O((0,o.A)((0,o.A)({},P),{},{end:new Date(e.target.value)})),className:"mt-1"})]})]})}),(0,Et.jsx)(Y,{scheduleData:s,staffMembers:t,startDate:P.start,endDate:P.end})]})}),(0,Et.jsx)(kf,{open:M,onClose:()=>L(!1),title:"Create Bulk Schedule",description:"Quickly create schedules for multiple staff members across a date range",footer:(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:async()=>{if(0!==B.staffIds.length)if(0!==B.daysOfWeek.length){if(window.confirm("This will create schedules for the selected staff members on the specified days. Continue?"))try{l(!0);const a=[],c=new Date(B.startDate),u=new Date(B.endDate);for(;c<=u;){const e=c.getDay();B.daysOfWeek.includes(e)&&a.push(new Date(c)),c.setDate(c.getDate()+1)}const d=[],h=[];for(const i of B.staffIds)for(const o of a){var e;const a=ff(o),l=o.getDay(),c=p[a]||[];if(c.some((e=>e.staffId===i))){var n,r;const e=(null===(n=t.find((e=>e.id===i)))||void 0===n?void 0:n.name)||"Unknown",s=(null===(r=c.find((e=>e.staffId===i)))||void 0===r?void 0:r.reason)||"Unknown reason";h.push({staffId:i,staffName:e,date:pf(o),reason:s});continue}let u;u=6===l?{startTime:"10:00",endTime:"18:00"}:{startTime:"11:00",endTime:"19:00"};const m="".concat(q(u.startTime)," - ").concat(q(u.endTime)),f=null===(e=s[a])||void 0===e?void 0:e.find((e=>e.staffId===i));if(f){const e=(0,Dt.H9)(wt.db,"schedules",f.id);d.push((0,Dt.mZ)(e,{shift:m,updatedAt:(0,Dt.O5)()}))}else d.push((0,Dt.gS)((0,Dt.rJ)(wt.db,"schedules"),{staffId:i,date:a,shift:m,createdAt:(0,Dt.O5)(),updatedAt:(0,Dt.O5)()}))}if(h.length>0){const e="The following staff have approved time-off during the selected period:\n\n".concat(h.map((e=>"- ".concat(e.staffName," on ").concat(e.date,": ").concat(e.reason))).join("\n"),"\n\nShifts for these dates will be skipped. Continue with creating the other shifts?");if(!window.confirm(e))return void l(!1)}await Promise.all(d);const m=(0,o.A)({},s);for(const e of a){const t=ff(e),n=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","==",t)),r=await(0,Dt.GG)(n);m[t]=r.docs.map((e=>(0,o.A)({id:e.id},e.data())))}i(m),L(!1),alert("Successfully created ".concat(d.length," schedule entries."))}catch(gb){console.error("Error creating bulk schedules:",gb),u("Failed to create bulk schedules")}finally{l(!1)}}else alert("Please select at least one day of the week");else alert("Please select at least one staff member")},disabled:0===B.staffIds.length||0===B.daysOfWeek.length,children:"Create Schedules"})]}),children:(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"bulk-start-date",children:"Start Date"}),(0,Et.jsx)(wf,{id:"bulk-start-date",type:"date",value:B.startDate.toISOString().substring(0,10),onChange:e=>z((0,o.A)((0,o.A)({},B),{},{startDate:new Date(e.target.value)})),className:"mt-1"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"bulk-end-date",children:"End Date"}),(0,Et.jsx)(wf,{id:"bulk-end-date",type:"date",value:B.endDate.toISOString().substring(0,10),onChange:e=>z((0,o.A)((0,o.A)({},B),{},{endDate:new Date(e.target.value)})),className:"mt-1"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{children:"Days of Week"}),(0,Et.jsx)("div",{className:"flex flex-wrap gap-2 mt-1",children:[{day:1,label:"Mon"},{day:2,label:"Tue"},{day:3,label:"Wed"},{day:4,label:"Thu"},{day:5,label:"Fri"},{day:6,label:"Sat"},{day:0,label:"Sun"}].map((e=>{let{day:t,label:n}=e;return(0,Et.jsx)(Kc,{type:"button",variant:B.daysOfWeek.includes(t)?"default":"outline",size:"sm",onClick:()=>(e=>{const t=[...B.daysOfWeek],n=t.indexOf(e);n>=0?t.splice(n,1):t.push(e),z((0,o.A)((0,o.A)({},B),{},{daysOfWeek:t}))})(t),children:n},t)}))}),(0,Et.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Default hours: Mon-Fri 11am-7pm, Sat 10am-6pm, Sun closed"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{children:"Select Staff Members"}),(0,Et.jsx)("div",{className:"mt-1 border rounded-lg max-h-40 overflow-y-auto",children:t.map((e=>(0,Et.jsxs)("div",{className:"flex items-center p-2 cursor-pointer hover:bg-gray-50 ".concat(B.staffIds.includes(e.id)?"bg-blue-50":""),onClick:()=>(e=>{const t=[...B.staffIds],n=t.indexOf(e);n>=0?t.splice(n,1):t.push(e),z((0,o.A)((0,o.A)({},B),{},{staffIds:t}))})(e.id),children:[(0,Et.jsx)("input",{type:"checkbox",checked:B.staffIds.includes(e.id),onChange:()=>{},className:"mr-2"}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"font-medium",children:e.name||"No name"}),e.certificationLevel&&(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:e.certificationLevel})]})]},e.id)))})]}),(0,Et.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,Et.jsx)("div",{className:"text-sm font-medium text-blue-800 mb-2",children:"Summary:"}),(0,Et.jsxs)("p",{className:"text-sm",children:["Creating shifts from ",(0,Et.jsx)("span",{className:"font-medium",children:B.startDate.toLocaleDateString()})," to ",(0,Et.jsx)("span",{className:"font-medium",children:B.endDate.toLocaleDateString()})]}),(0,Et.jsxs)("p",{className:"text-sm",children:["Days: ",(0,Et.jsx)("span",{className:"font-medium",children:B.daysOfWeek.map((e=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e])).join(", ")})]}),(0,Et.jsxs)("p",{className:"text-sm",children:["Staff: ",(0,Et.jsxs)("span",{className:"font-medium",children:[B.staffIds.length," selected"]})]}),(0,Et.jsx)("p",{className:"text-sm text-blue-600 mt-2",children:"Each day will use its default hours: Mon-Fri 11am-7pm, Sat 10am-6pm"})]}),(0,Et.jsxs)("div",{className:"bg-amber-50 p-3 rounded-lg",children:[(0,Et.jsxs)("div",{className:"text-sm font-medium text-amber-800 flex items-center mb-2",children:[(0,Et.jsx)(nn,{className:"h-4 w-4 mr-1"}),"Time-Off Handling:"]}),(0,Et.jsx)("p",{className:"text-sm text-amber-700",children:"Staff with approved time-off during the selected period will not be scheduled for those dates."})]})]})})]})},qf=Mt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Vf=e=>{if(!e)return"";const[t,n,r]=e.split("-").map((e=>parseInt(e,10)));return new Date(t,n-1,r).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})},Hf=(e,t)=>{if(!e||!t)return 0;const n=new Date(e),r=new Date(t);return n.setHours(0,0,0,0),r.setHours(0,0,0,0),Math.floor((r-n)/864e5)+1},Wf=()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)([]),[l,c]=(0,r.useState)(!0),[u,d]=(0,r.useState)(null),[h,m]=(0,r.useState)("all"),[f,p]=(0,r.useState)("all"),[g,v]=(0,r.useState)({start:"",end:""}),[x,y]=(0,r.useState)(!1),[b,w]=(0,r.useState)(null),[D,N]=(0,r.useState)(""),[j,C]=(0,r.useState)(!1);(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"profiles"),(0,Dt._M)("teamAccess.hasAccess","==",!0)),t=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));a(t)}catch(gb){console.error("Error fetching staff members:",gb),d("Failed to load staff members")}})()}),[]),(0,r.useEffect)((()=>{(async()=>{try{c(!0);const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeOffRequests"),(0,Dt.My)("requestedAt","desc")),n=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));t(n),E(n,h,f,g)}catch(gb){console.error("Error fetching time-off requests:",gb),d("Failed to load time-off requests")}finally{c(!1)}})()}),[g,f,h]);const E=(e,t,n,r)=>{let i=[...e];if("all"!==t&&(i=i.filter((e=>e.status===t))),"all"!==n&&(i=i.filter((e=>e.staffId===n))),r.start&&r.end){const e=new Date(r.start),t=new Date(r.end);i=i.filter((n=>{const r=new Date(n.startDate),s=new Date(n.endDate);return r<=t&&s>=e}))}s(i)},A=(t,n)=>{let r=h,s=f,i=(0,o.A)({},g);"status"===t?(r=n,m(n)):"staff"===t?(s=n,p(n)):"dateStart"===t?(i.start=n,v((e=>(0,o.A)((0,o.A)({},e),{},{start:n})))):"dateEnd"===t&&(i.end=n,v((e=>(0,o.A)((0,o.A)({},e),{},{end:n})))),E(e,r,s,i)},k=async n=>{if(b)try{if(c(!0),"approved"===n){const e=new Date(b.startDate),t=new Date(b.endDate),n=[],r=new Date(e);for(;r<=t;)n.push(new Date(r)),r.setDate(r.getDate()+1);const s=[];for(const i of n){const e=await Tf(b.staffId,i,"09:00","17:00");e.length>0&&s.push({date:i,conflicts:e})}if(s.length>0){if(!window.confirm("This time-off request conflicts with ".concat(s.length," scheduled shifts. ")+"Do you want to approve it anyway? If approved, the system will prevent new shifts from being scheduled during this time period."))return void c(!1)}}const r=(0,Dt.H9)(wt.db,"timeOffRequests",b.id);await(0,Dt.mZ)(r,{status:n,reviewedBy:"admin",reviewedAt:(0,Dt.O5)(),reviewNotes:D}),y(!1);const s=e.map((e=>e.id===b.id?(0,o.A)((0,o.A)({},e),{},{status:n,reviewedBy:"admin",reviewNotes:D}):e));t(s),E(s,h,f,g)}catch(gb){console.error("Error updating time-off request:",gb),d("Failed to update time-off request")}finally{c(!1)}},S={pending:e.filter((e=>"pending"===e.status)).length,approved:e.filter((e=>"approved"===e.status)).length,denied:e.filter((e=>"denied"===e.status)).length};return l?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 mb-6",children:[(0,Et.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4",children:[(0,Et.jsxs)("h1",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,Et.jsx)(an,{className:"mr-2 h-5 w-5"}),"Time-Off Request Management"]}),(0,Et.jsx)("div",{className:"text-sm bg-blue-100 text-blue-700 px-2 py-1 rounded-full mt-2 md:mt-0",children:"Admin Mode"})]}),(0,Et.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Review and manage time-off requests from your team members"}),(0,Et.jsx)("div",{className:"flex flex-wrap gap-2",children:(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>C(!0),className:"flex items-center",children:[(0,Et.jsx)(qf,{className:"h-4 w-4 mr-1"}),"Filters",("all"!==h||"all"!==f||g.start||g.end)&&(0,Et.jsx)("span",{className:"ml-1 bg-blue-100 text-blue-700 rounded-full px-2 text-xs",children:"Active"})]})})]}),(0,Et.jsxs)("div",{className:"flex flex-wrap gap-2 border-b",children:[(0,Et.jsxs)(Kc,{variant:"ghost",size:"sm",className:"all"===h?"border-b-2 border-blue-500 rounded-none":"rounded-none",onClick:()=>A("status","all"),children:["All Requests",(0,Et.jsx)("span",{className:"ml-1 bg-gray-100 text-gray-700 rounded-full px-2 text-xs",children:e.length})]}),(0,Et.jsxs)(Kc,{variant:"ghost",size:"sm",className:"pending"===h?"border-b-2 border-blue-500 rounded-none":"rounded-none",onClick:()=>A("status","pending"),children:[(0,Et.jsx)(Qt,{className:"h-4 w-4 mr-1 text-amber-500"}),"Pending",(0,Et.jsx)("span",{className:"ml-1 bg-amber-100 text-amber-700 rounded-full px-2 text-xs",children:S.pending})]}),(0,Et.jsxs)(Kc,{variant:"ghost",size:"sm",className:"approved"===h?"border-b-2 border-blue-500 rounded-none":"rounded-none",onClick:()=>A("status","approved"),children:[(0,Et.jsx)(Ef,{className:"h-4 w-4 mr-1 text-green-500"}),"Approved",(0,Et.jsx)("span",{className:"ml-1 bg-green-100 text-green-700 rounded-full px-2 text-xs",children:S.approved})]}),(0,Et.jsxs)(Kc,{variant:"ghost",size:"sm",className:"denied"===h?"border-b-2 border-blue-500 rounded-none":"rounded-none",onClick:()=>A("status","denied"),children:[(0,Et.jsx)(Af,{className:"h-4 w-4 mr-1 text-red-500"}),"Denied",(0,Et.jsx)("span",{className:"ml-1 bg-red-100 text-red-700 rounded-full px-2 text-xs",children:S.denied})]})]}),u&&(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md border border-red-200",children:(0,Et.jsx)("p",{className:"text-red-600",children:u})}),(0,Et.jsx)("div",{className:"space-y-4 mt-4",children:0===n.length?(0,Et.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,Et.jsx)("p",{className:"text-gray-500",children:"No time-off requests found"}),(0,Et.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"all"!==h||"all"!==f||g.start||g.end?"Try adjusting your filters to see more results":"Time-off requests will appear here once team members submit them"})]}):n.map((n=>{var r;return(0,Et.jsx)(Rc,{className:"overflow-hidden",children:(0,Et.jsxs)("div",{className:"p-4",children:[(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-3",children:[(0,Et.jsxs)("h3",{className:"font-medium text-gray-900 flex items-center",children:[(0,Et.jsx)(_i,{className:"h-4 w-4 mr-1"}),n.staffName||"Unknown Staff"]}),(0,Et.jsxs)("div",{className:"\n                    rounded-full px-3 py-1 text-xs font-medium mt-2 sm:mt-0\n                    ".concat("pending"===n.status?"bg-amber-100 text-amber-700":"","\n                    ").concat("approved"===n.status?"bg-green-100 text-green-700":"","\n                    ").concat("denied"===n.status?"bg-red-100 text-red-700":"","\n                  "),children:["pending"===n.status&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Qt,{className:"h-3 w-3 inline mr-1"}),"Pending Review"]}),"approved"===n.status&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Ef,{className:"h-3 w-3 inline mr-1"}),"Approved"]}),"denied"===n.status&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Af,{className:"h-3 w-3 inline mr-1"}),"Denied"]})]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 mb-3",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Date Range"}),(0,Et.jsxs)("div",{className:"text-sm font-medium flex items-center",children:[(0,Et.jsx)(an,{className:"h-3 w-3 mr-1"}),Vf(n.startDate)," \u2013 ",Vf(n.endDate)]}),(0,Et.jsxs)("div",{className:"text-xs text-blue-600",children:[Hf(n.startDate,n.endDate)," day(s)"]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Reason"}),(0,Et.jsx)("div",{className:"text-sm",children:n.reason})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Requested"}),(0,Et.jsx)("div",{className:"text-sm",children:null!==(r=n.requestedAt)&&void 0!==r&&r.seconds?new Date(1e3*n.requestedAt.seconds).toLocaleDateString():"Unknown date"})]})]}),n.notes&&(0,Et.jsxs)("div",{className:"mt-2 text-xs text-gray-600 bg-gray-50 p-2 rounded",children:[(0,Et.jsx)(wc,{className:"h-3 w-3 inline mr-1"}),n.notes]}),n.reviewNotes&&("approved"===n.status||"denied"===n.status)&&(0,Et.jsxs)("div",{className:"mt-2 text-xs p-2 rounded ".concat("approved"===n.status?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),children:[(0,Et.jsx)(nn,{className:"h-3 w-3 inline mr-1"}),(0,Et.jsx)("span",{className:"font-medium",children:"Admin response:"})," ",n.reviewNotes]}),(0,Et.jsxs)("div",{className:"flex justify-end mt-3 space-x-2",children:[(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>(async n=>{if(window.confirm("Are you sure you want to delete this time-off request?"))try{c(!0),await(0,Dt.kd)((0,Dt.H9)(wt.db,"timeOffRequests",n));const r=e.filter((e=>e.id!==n));t(r),E(r,h,f,g)}catch(gb){console.error("Error deleting time-off request:",gb),d("Failed to delete time-off request")}finally{c(!1)}})(n.id),className:"text-red-600 hover:bg-red-50",children:[(0,Et.jsx)(Af,{className:"h-4 w-4 mr-1"}),"Delete"]}),"pending"===n.status&&(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>(e=>{w(e),N(e.reviewNotes||""),y(!0)})(n),className:"text-blue-600 hover:bg-blue-50",children:[(0,Et.jsx)(wc,{className:"h-4 w-4 mr-1"}),"Review"]})]})]})},n.id)}))}),(0,Et.jsx)(kf,{open:x,onClose:()=>y(!1),title:"Review Time-Off Request",description:b?"Request from ".concat(b.staffName||"Unknown Staff"):"",footer:(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),(0,Et.jsxs)(Kc,{variant:"outline",className:"bg-red-50 text-red-600 hover:bg-red-100",onClick:()=>k("denied"),children:[(0,Et.jsx)(Af,{className:"h-4 w-4 mr-1"}),"Deny"]}),(0,Et.jsxs)(Kc,{className:"bg-green-600 hover:bg-green-700",onClick:()=>k("approved"),children:[(0,Et.jsx)(Ef,{className:"h-4 w-4 mr-1"}),"Approve"]})]}),children:b&&(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Start Date"}),(0,Et.jsx)("div",{className:"font-medium",children:Vf(b.startDate)})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"End Date"}),(0,Et.jsx)("div",{className:"font-medium",children:Vf(b.endDate)})]}),(0,Et.jsxs)("div",{className:"col-span-2",children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Duration"}),(0,Et.jsxs)("div",{className:"font-medium",children:[Hf(b.startDate,b.endDate)," day(s)"]})]})]}),(0,Et.jsxs)("div",{className:"mb-2",children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Reason"}),(0,Et.jsx)("div",{className:"font-medium",children:b.reason})]}),b.notes&&(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"text-xs text-gray-500",children:"Additional Notes"}),(0,Et.jsx)("div",{className:"text-sm",children:b.notes})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"review-notes",children:"Review Notes"}),(0,Et.jsx)(Cf,{id:"review-notes",value:D,onChange:e=>N(e.target.value),placeholder:"Add notes to explain your decision (optional)",className:"mt-1 resize-none h-20"})]}),(0,Et.jsxs)("div",{className:"bg-amber-50 p-3 rounded-lg text-sm text-amber-700",children:[(0,Et.jsx)(nn,{className:"h-4 w-4 inline mr-1"}),(0,Et.jsx)("span",{className:"font-medium",children:"Note:"})," Approving this request will prevent scheduling conflicts. The system will warn about conflicts when creating schedules during this time period."]})]})}),(0,Et.jsx)(kf,{open:j,onClose:()=>C(!1),title:"Filter Time-Off Requests",footer:(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>{m("all"),p("all"),v({start:"",end:""}),s(e),C(!1)},className:"mr-auto",children:"Clear Filters"}),(0,Et.jsx)(Kc,{variant:"outline",onClick:()=>C(!1),children:"Cancel"}),(0,Et.jsx)(Kc,{onClick:()=>{E(e,h,f,g),C(!1)},children:"Apply Filters"})]}),children:(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"status-filter",children:"Status"}),(0,Et.jsxs)("select",{id:"status-filter",value:h,onChange:e=>A("status",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,Et.jsx)("option",{value:"all",children:"All Statuses"}),(0,Et.jsx)("option",{value:"pending",children:"Pending"}),(0,Et.jsx)("option",{value:"approved",children:"Approved"}),(0,Et.jsx)("option",{value:"denied",children:"Denied"})]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"staff-filter",children:"Staff Member"}),(0,Et.jsxs)("select",{id:"staff-filter",value:f,onChange:e=>A("staff",e.target.value),className:"w-full p-2 border border-gray-300 rounded-md mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,Et.jsx)("option",{value:"all",children:"All Staff Members"}),i.map((e=>(0,Et.jsx)("option",{value:e.id,children:e.name||"Unnamed Staff"},e.id)))]})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"date-start",children:"Date Range Start"}),(0,Et.jsx)(wf,{id:"date-start",type:"date",value:g.start,onChange:e=>A("dateStart",e.target.value),className:"mt-1"})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)(Nf,{htmlFor:"date-end",children:"Date Range End"}),(0,Et.jsx)(wf,{id:"date-end",type:"date",value:g.end,onChange:e=>A("dateEnd",e.target.value),className:"mt-1"})]})]}),(0,Et.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg text-sm",children:[(0,Et.jsx)(an,{className:"h-4 w-4 inline mr-1 text-blue-600"}),(0,Et.jsx)("span",{className:"text-blue-700",children:"Note:"})," Date range filter will show all time-off requests that overlap with this period, even partially."]})]})})]})},Gf=e=>{let{userId:t}=e;const[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)(!0);return(0,r.useEffect)((()=>{t&&(async()=>{try{a(!0);const e=new Date,n=[];for(let t=0;t<14;t++){const r=new Date(e);r.setDate(e.getDate()+t),n.push(ff(r))}const r=n.slice(0,10),i=n.slice(10),l=[],c=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","in",r),(0,Dt._M)("staffId","==",t));if((await(0,Dt.GG)(c)).docs.forEach((e=>{l.push((0,o.A)({id:e.id},e.data()))})),i.length>0){const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","in",i),(0,Dt._M)("staffId","==",t));(await(0,Dt.GG)(e)).docs.forEach((e=>{l.push((0,o.A)({id:e.id},e.data()))}))}l.sort(((e,t)=>e.date.localeCompare(t.date)));const u=l.map((e=>{const[t,n,r]=e.date.split("-").map((e=>parseInt(e,10))),s=new Date(t,n-1,r);return(0,o.A)((0,o.A)({},e),{},{dayName:s.toLocaleDateString("en-US",{weekday:"short"}),formattedDate:s.toLocaleDateString("en-US",{month:"short",day:"numeric"})})}));s(u)}catch(gb){console.error("Error fetching my schedule:",gb)}finally{a(!1)}})()}),[t]),i?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):0===n.length?(0,Et.jsx)("div",{className:"text-center py-6 bg-gray-50 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"You have no upcoming shifts scheduled"})}):(0,Et.jsx)("div",{className:"space-y-2",children:n.map((e=>(0,Et.jsx)("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-3",children:(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("span",{className:"font-medium",children:[e.dayName,", ",e.formattedDate]}),(0,Et.jsx)("div",{className:"text-blue-700",children:e.shift})]}),e.notes&&(0,Et.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:e.notes})]})},e.id)))})},Kf=e=>{let{userId:t,currentUserProfile:n}=e;const[s,i]=(0,r.useState)(null),[a,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)([]),m=ff(new Date);(0,r.useEffect)((()=>{t&&(async()=>{try{l(!0);const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeTracking"),(0,Dt._M)("date","==",m),(0,Dt._M)("staffId","==",t)),n=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));n.sort(((e,t)=>{var n,r;return((null===(n=t.timestamp)||void 0===n?void 0:n.seconds)||0)-((null===(r=e.timestamp)||void 0===r?void 0:r.seconds)||0)})),n.length>0?(u(n[0]),i(n[0].action)):i("clock-out");const r=(0,Dt.P)((0,Dt.rJ)(wt.db,"schedules"),(0,Dt._M)("date","==",m),(0,Dt._M)("staffId","==",t)),s=(await(0,Dt.GG)(r)).docs.map((e=>(0,o.A)({id:e.id},e.data())));h(s)}catch(gb){console.error("Error fetching time tracking data:",gb)}finally{l(!1)}})()}),[t,m]);const f=async e=>{try{l(!0),await(0,Dt.gS)((0,Dt.rJ)(wt.db,"timeTracking"),{staffId:t,date:m,action:e,timestamp:(0,Dt.O5)()}),i(e);const n=(0,Dt.P)((0,Dt.rJ)(wt.db,"timeTracking"),(0,Dt._M)("date","==",m),(0,Dt._M)("staffId","==",t)),r=(await(0,Dt.GG)(n)).docs.map((e=>(0,o.A)({id:e.id},e.data())));r.sort(((e,t)=>{var n,r;return((null===(n=t.timestamp)||void 0===n?void 0:n.seconds)||0)-((null===(r=e.timestamp)||void 0===r?void 0:r.seconds)||0)})),r.length>0&&u(r[0])}catch(gb){console.error("Error recording time:",gb)}finally{l(!1)}},p=d.length>0;return a?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):(0,Et.jsx)("div",{className:"mt-4",children:(0,Et.jsxs)(Rc,{className:"p-4",children:[(0,Et.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[(0,Et.jsxs)("div",{className:"mb-3 md:mb-0",children:[(0,Et.jsx)("div",{className:"text-sm font-medium",children:"Current Status:"}),(0,Et.jsx)("div",{className:"text-lg font-bold ".concat("clock-in"===s?"text-green-600":"text-gray-600"),children:"clock-in"===s?"Clocked In":"Clocked Out"}),c&&c.timestamp&&(0,Et.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Last action: ",new Date(1e3*c.timestamp.seconds).toLocaleTimeString()]})]}),(0,Et.jsx)("div",{className:"flex gap-2",children:"clock-in"!==s?(0,Et.jsxs)(Kc,{className:"bg-green-600 hover:bg-green-700 text-white flex items-center",onClick:()=>f("clock-in"),children:[(0,Et.jsx)(Qt,{className:"h-4 w-4 mr-1"}),"Clock In"]}):(0,Et.jsxs)(Kc,{className:"bg-red-600 hover:bg-red-700 text-white flex items-center",onClick:()=>f("clock-out"),children:[(0,Et.jsx)(Qt,{className:"h-4 w-4 mr-1"}),"Clock Out"]})})]}),p?(0,Et.jsxs)("div",{className:"bg-blue-50 mt-3 p-2 rounded text-sm",children:[(0,Et.jsx)("div",{className:"font-medium",children:"Today's scheduled shift:"}),d.map((e=>(0,Et.jsxs)("div",{className:"mt-1",children:[e.shift," ",e.notes&&"(".concat(e.notes,")")]},e.id)))]}):(0,Et.jsxs)("div",{className:"bg-blue-50 mt-3 p-2 rounded text-sm",children:[(0,Et.jsx)("div",{className:"font-medium",children:"No scheduled shift today"}),(0,Et.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"You can still clock in and out as needed for unscheduled work."})]})]})})},Qf=()=>{var e,t;const{user:n}=kt(),[s,i]=(0,r.useState)("personal"),[a,o]=(0,r.useState)(!0),{userProfile:l,loading:c}=gf(),u=(null===l||void 0===l||null===(e=l.managementRights)||void 0===e?void 0:e.hasAccess)||"jeff@diveuww.com"===(null===l||void 0===l?void 0:l.email)||"kevin@ferrero.bz"===(null===l||void 0===l?void 0:l.email);return(0,r.useEffect)((()=>{o(c)}),[c]),a?(0,Et.jsx)(uf,{message:"Loading schedule data..."}):null!==l&&void 0!==l&&null!==(t=l.teamAccess)&&void 0!==t&&t.hasAccess?(0,Et.jsxs)("div",{children:[(0,Et.jsx)("div",{className:"flex justify-between items-center mb-4",children:u&&(0,Et.jsx)("div",{className:"text-xs text-blue-700 px-2 py-1 rounded-full bg-blue-100 ml-auto",children:"Management Access"})}),(0,Et.jsxs)(ss,{defaultValue:s,onValueChange:i,className:"w-full",children:[(0,Et.jsxs)(is,{className:"w-full flex justify-start border-b overflow-x-auto",children:[(0,Et.jsxs)(as,{value:"personal",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(_i,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"My Schedule"})]}),(0,Et.jsxs)(as,{value:"calendar",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(hf,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"Team Calendar"})]}),(0,Et.jsxs)(as,{value:"shift-swap",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(Lf,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"Shift Swaps"})]}),u&&(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)(as,{value:"admin-schedule",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(Lf,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"Schedule Manager"})]}),(0,Et.jsxs)(as,{value:"time-off",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(Lf,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"Time-Off Requests"})]})]})]}),(0,Et.jsxs)(os,{value:"personal",className:"pt-4",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h2",{className:"text-lg font-medium",children:"My Schedule & Time Clock"}),(0,Et.jsxs)("div",{className:"text-xs text-gray-500",children:["Logged in as: ",(null===l||void 0===l?void 0:l.name)||(null===n||void 0===n?void 0:n.email)]})]}),(0,Et.jsx)("h3",{className:"font-medium mb-2",children:"My Upcoming Shifts"}),(0,Et.jsx)(Gf,{userId:null===n||void 0===n?void 0:n.uid}),(0,Et.jsx)("h3",{className:"font-medium mb-2 mt-6",children:"My Time Clock"}),(0,Et.jsx)(Kf,{userId:null===n||void 0===n?void 0:n.uid,currentUserProfile:l})]}),(0,Et.jsxs)(os,{value:"calendar",className:"pt-4",children:[(0,Et.jsxs)("div",{className:"mb-4",children:[(0,Et.jsx)("h2",{className:"text-lg font-medium",children:"Team Calendar View"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"View the entire team's schedule in calendar format to see who you're working with"})]}),(0,Et.jsx)(Mf,{currentUserProfile:l})]}),(0,Et.jsx)(os,{value:"shift-swap",className:"pt-4",children:(0,Et.jsx)(Of,{})}),u&&(0,Et.jsx)(os,{value:"admin-schedule",className:"pt-4",children:(0,Et.jsx)(Uf,{})}),u&&(0,Et.jsx)(os,{value:"time-off",className:"pt-4",children:(0,Et.jsx)(Wf,{})})]})]}):(0,Et.jsx)("div",{className:"w-full mt-6",children:(0,Et.jsxs)(Rc,{className:"p-8 text-center",children:[(0,Et.jsx)(nn,{className:"h-12 w-12 text-amber-600 mx-auto mb-4"}),(0,Et.jsx)("h2",{className:"text-xl font-bold mb-2",children:"Access Required"}),(0,Et.jsx)("p",{className:"text-gray-600 mb-4",children:"You need Team Portal access to view schedule information."}),(0,Et.jsx)("p",{className:"text-sm text-gray-500",children:"Please contact an administrator to request access."})]})})},Yf=()=>{const{user:e}=kt(),[t,n]=(0,r.useState)(!1),[s,i]=(0,r.useState)([]),[a,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)(null);return(0,r.useEffect)((()=>{(async()=>{e&&n("jeff@diveuww.com"===e.email)})()}),[e]),(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.P)((0,Dt.rJ)(wt.db,"profiles"),(0,Dt._M)("teamAccess.hasAccess","==",!0)),t=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));i(t)}catch(gb){u("Error loading staff members"),console.error("Error:",gb)}finally{l(!1)}})()}),[]),a?(0,Et.jsx)(uf,{message:"Loading team data..."}):c?(0,Et.jsx)("div",{className:"max-w-2xl mx-auto p-4",children:(0,Et.jsx)(Rc,{className:"border-red-200",children:(0,Et.jsx)("div",{className:"p-6",children:(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,Et.jsx)("p",{className:"text-red-600",children:c})})})})}):(0,Et.jsx)("div",{className:"w-full px-4 pb-6 sm:px-6 lg:px-8",children:(0,Et.jsxs)(Rc,{className:"border-0 shadow-md bg-white",children:[(0,Et.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-t-lg p-4",children:[(0,Et.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Team Portal"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage staff, schedules, and time-off requests"})]}),(0,Et.jsx)("div",{className:"p-0",children:(0,Et.jsxs)(ss,{defaultValue:"directory",className:"w-full",children:[(0,Et.jsxs)(is,{className:"w-full flex border-b justify-start overflow-x-auto no-scrollbar mt-2 p-0",children:[(0,Et.jsxs)(as,{value:"directory",className:"flex items-center py-3 px-2 sm:px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500 no-tap-highlight",children:[(0,Et.jsx)(La,{size:18,className:"mr-1 sm:mr-2"}),(0,Et.jsx)("span",{className:"text-sm sm:text-base",children:"Staff Directory"})]}),(0,Et.jsxs)(as,{value:"schedule",className:"flex items-center py-3 px-2 sm:px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500 no-tap-highlight",children:[(0,Et.jsx)(an,{size:18,className:"mr-1 sm:mr-2"}),(0,Et.jsx)("span",{className:"text-sm sm:text-base",children:"Schedule"})]}),(0,Et.jsxs)(as,{value:"calendar",className:"flex items-center py-3 px-2 sm:px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500 no-tap-highlight",children:[(0,Et.jsx)(hf,{size:18,className:"mr-1 sm:mr-2"}),(0,Et.jsx)("span",{className:"text-sm sm:text-base",children:"Team Calendar"})]}),(0,Et.jsxs)(as,{value:"timeoff",className:"flex items-center py-3 px-2 sm:px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500 no-tap-highlight",children:[(0,Et.jsx)(Qt,{size:18,className:"mr-1 sm:mr-2"}),(0,Et.jsx)("span",{className:"text-sm sm:text-base",children:"Time Off"})]}),(0,Et.jsxs)(as,{value:"shiftswap",className:"flex items-center py-3 px-2 sm:px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500 no-tap-highlight",children:[(0,Et.jsx)(mf,{size:18,className:"mr-1 sm:mr-2"}),(0,Et.jsx)("span",{className:"text-sm sm:text-base",children:"Shift Swaps"})]})]}),(0,Et.jsx)(os,{value:"directory",className:"p-4",children:(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:[s.map((e=>(0,Et.jsx)(Rc,{className:"overflow-hidden",children:(0,Et.jsxs)("div",{className:"p-4",children:[(0,Et.jsx)("h3",{className:"font-medium",children:e.name||"No name"}),(0,Et.jsx)("p",{className:"text-sm text-gray-500",children:e.email||"No email"}),e.phone&&(0,Et.jsxs)("p",{className:"text-sm",children:["Phone: ",e.phone]}),e.certificationLevel&&(0,Et.jsx)("div",{className:"mt-2",children:(0,Et.jsx)("span",{className:"bg-indigo-50 text-indigo-700 border border-indigo-200 text-xs px-2.5 py-0.5 rounded-full",children:e.certificationLevel})})]})},e.id))),0===s.length&&(0,Et.jsxs)("div",{className:"col-span-full text-center py-8 bg-gray-50 rounded-lg",children:[(0,Et.jsx)("p",{className:"text-gray-500",children:"No staff members found"}),(0,Et.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:"Staff members will appear here once they have been granted Team Portal access"})]})]})}),(0,Et.jsx)(os,{value:"schedule",className:"p-4",children:t?(0,Et.jsx)(Qf,{}):(0,Et.jsx)(yf,{})}),(0,Et.jsx)(os,{value:"calendar",className:"p-4",children:(0,Et.jsx)(Mf,{currentUserProfile:e})}),(0,Et.jsx)(os,{value:"timeoff",className:"p-4",children:t?(0,Et.jsxs)(ss,{defaultValue:"my-requests",className:"w-full",children:[(0,Et.jsxs)(is,{className:"w-full flex border-b justify-start overflow-x-auto no-scrollbar mt-2 p-0",children:[(0,Et.jsxs)(as,{value:"my-requests",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(Qt,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"My Time-Off Requests"})]}),(0,Et.jsxs)(as,{value:"manage-requests",className:"flex items-center py-3 px-4 data-[state=active]:border-b-2 data-[state=active]:border-blue-500",children:[(0,Et.jsx)(La,{size:18,className:"mr-2"}),(0,Et.jsx)("span",{children:"Manage Team Requests"})]})]}),(0,Et.jsx)(os,{value:"my-requests",className:"p-4",children:(0,Et.jsx)(Ff,{})}),(0,Et.jsx)(os,{value:"manage-requests",className:"p-4",children:(0,Et.jsx)(Wf,{})})]}):(0,Et.jsx)(Ff,{})}),(0,Et.jsx)(os,{value:"shiftswap",className:"p-4",children:(0,Et.jsx)(Of,{})})]})})]})})},Jf=()=>(0,Et.jsx)(Yf,{}),Xf={OCEANIC_SILVER:{min:0,max:9999,multiplier:1,name:"Oceanic Silver"},MARINER_GOLD:{min:1e4,max:19999,multiplier:1.2,name:"Mariner Gold"},NAUTILUS_PLATINUM:{min:2e4,max:49999,multiplier:1.5,name:"Nautilus Platinum"},TRIDENT_ELITE:{min:5e4,max:99999,multiplier:2,name:"Trident Elite"},LIFETIME_ELITE:{min:1e5,max:1/0,multiplier:2,name:"Lifetime Elite"}},$f=()=>{var e,t;const{user:n}=kt(),[s,i]=(0,r.useState)(null),[a,l]=(0,r.useState)(null),c=de();(0,r.useEffect)((()=>{(async()=>{if(null!==n&&void 0!==n&&n.uid)try{const t=(0,Dt.H9)(wt.db,"profiles",n.uid),r=await(0,Dt.x7)(t);if(!r.exists()||!r.data().name)return void c("/profile");if(r.exists()){const t=r.data();i(t),l((e=t.lifetimePoints||0,Object.entries(Xf).reduce(((t,n)=>{let[r,s]=n;return e>=s.min&&e<=s.max?(0,o.A)({tier:r},s):t}),Xf.OCEANIC_SILVER)))}}catch(t){console.error("Error fetching profile data:",t)}var e})()}),[n,c]);return(0,Et.jsxs)("div",{className:"flex-1",children:[(0,Et.jsxs)("div",{className:"relative h-64",children:[(0,Et.jsx)("img",{src:"/images/badges/backgroundHome.jpg",alt:"Diving background",className:"w-full h-full object-cover"}),(0,Et.jsxs)("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex flex-col justify-center px-4",children:[(0,Et.jsx)("h1",{className:"text-white text-2xl font-bold mb-2",children:"EXPLORE THE UNDERWATER WORLD"}),(0,Et.jsx)("a",{href:"https://shop.diveunderwaterworld.com/iishop?dynamicFilters=%7B%22class_category%22:%7B%22788902742%22:true%7D%7D",target:"_blank",rel:"noopener noreferrer",className:"bg-white text-blue-600 px-6 py-2 rounded-lg w-40 font-semibold text-center",children:"Book a trip"})]})]}),(0,Et.jsxs)("div",{className:"m-4 p-4 bg-white rounded-lg shadow-md",children:[(0,Et.jsxs)("h2",{className:"text-xl font-bold mb-2",children:["Hello, ",(u=null===s||void 0===s?void 0:s.name,u?u.split(" ")[0]:"Diver")]}),(0,Et.jsx)("div",{className:"".concat((e=>{switch(e){case"OCEANIC_SILVER":default:return"bg-gray-200";case"MARINER_GOLD":return"bg-yellow-100";case"NAUTILUS_PLATINUM":return"bg-purple-100";case"TRIDENT_ELITE":case"LIFETIME_ELITE":return"bg-blue-100"}})(null===a||void 0===a?void 0:a.tier)," px-3 py-1 rounded-full inline-block mb-2"),children:(0,Et.jsx)("span",{className:"text-sm font-medium",children:(null===a||void 0===a?void 0:a.name)||"Oceanic Silver"})}),(0,Et.jsxs)("div",{onClick:()=>c("/rewards"),className:"mt-4 p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition-colors",children:[(0,Et.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,Et.jsx)("h3",{className:"font-semibold text-gray-800",children:"Your Rewards"}),(0,Et.jsx)(hs,{className:"text-gray-400",size:20})]}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Lifetime Points"}),(0,Et.jsx)("p",{className:"text-lg font-semibold",children:(null===s||void 0===s||null===(e=s.lifetimePoints)||void 0===e?void 0:e.toLocaleString())||0})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:"Available Points"}),(0,Et.jsx)("p",{className:"text-lg font-semibold",children:(null===s||void 0===s||null===(t=s.redeemablePoints)||void 0===t?void 0:t.toLocaleString())||0})]})]})]})]})]});var u},Zf=Mt("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]),ep=Mt("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),tp=Mt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),np=Mt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),rp=Mt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),sp=Mt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ip=e=>{let{className:t="",color:n="text-white"}=e;const{logout:r}=kt(),s=de();return(0,Et.jsxs)("button",{onClick:async()=>{try{await r(),s("/")}catch(e){console.error("Failed to log out:",e)}},className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium hover:bg-gray-100 transition-colors duration-150 ".concat(n," ").concat(t),children:[(0,Et.jsx)(sp,{size:18}),(0,Et.jsx)("span",{children:"Logout"})]})},ap=e=>{let{children:t}=e;const n=de(),s=le(),{user:i}=kt(),[a,o]=(0,r.useState)(!1),[l,c]=(0,r.useState)({messages:0,training:0,travel:0,buddies:0,total:0});(0,r.useEffect)((()=>{i||n("/")}),[i,n]),(0,r.useEffect)((()=>{if(!i)return;console.log("Setting up notification counter subscription for user:",i.uid),Xc.default.resetNegativeCounters(i.uid);const e=Xc.default.subscribeToUnreadCounters(i.uid,(e=>{console.log("Received updated counters:",e),console.log("Buddies count:",e.buddies),c(e)}));return()=>e()}),[i]);const u=e=>{n(e),o(!1)};return(0,Et.jsxs)("div",{className:"flex flex-col min-h-screen min-h-screen-safe bg-gray-100",children:[(0,Et.jsxs)("header",{className:"fixed top-0 left-0 right-0 z-40 flex items-center justify-between p-4 bg-blue-600 safe-top",children:[(0,Et.jsxs)("button",{className:"p-2 text-white relative",onClick:()=>o(!0),children:[(0,Et.jsx)(np,{size:24}),l.total>0&&(0,Et.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l.total>9?"9+":l.total})]}),(0,Et.jsx)("div",{className:"flex items-center justify-center flex-1",children:(0,Et.jsx)("img",{src:"/logo.png",alt:"UWW Buddies Logo",className:"h-8"})}),(0,Et.jsx)("button",{className:"p-2 text-white",onClick:()=>u("/profile"),children:(0,Et.jsx)(_i,{size:24})})]}),(()=>{var e,t;if(!a)return null;const n="jeff@diveuww.com"===(null===i||void 0===i?void 0:i.email);return(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",children:(0,Et.jsxs)("div",{className:"fixed left-0 top-0 bottom-0 w-64 bg-white shadow-lg z-50 overflow-y-auto",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center p-4 border-b",children:[(0,Et.jsx)("h2",{className:"text-lg font-bold",children:"Menu"}),(0,Et.jsx)("button",{onClick:()=>o(!1),className:"p-2",children:(0,Et.jsx)(cn,{size:24})})]}),(0,Et.jsxs)("div",{className:"py-4",children:[(0,Et.jsxs)("div",{className:"px-4 space-y-2",children:[(0,Et.jsxs)("button",{onClick:()=>u("/profile"),className:"flex items-center space-x-2 w-full px-2 py-2 text-left hover:bg-gray-100 rounded-lg",children:[(0,Et.jsx)(_i,{size:20}),(0,Et.jsx)("span",{children:"Profile"})]}),(0,Et.jsxs)("button",{onClick:()=>u("/knowledge"),className:"flex items-center space-x-2 w-full px-2 py-2 text-left hover:bg-gray-100 rounded-lg",children:[(0,Et.jsx)(Zf,{size:20}),(0,Et.jsx)("span",{children:"Knowledge Hub"})]}),(0,Et.jsxs)("button",{onClick:()=>u("/buddies"),className:"flex items-center justify-between w-full px-2 py-2 text-left hover:bg-gray-100 rounded-lg",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Et.jsx)(La,{size:20}),(0,Et.jsx)("span",{children:"Buddies"})]}),l.buddies>0&&(0,Et.jsx)("span",{className:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l.buddies>9?"9+":l.buddies})]})]}),(0,Et.jsxs)("div",{className:"px-4 mt-4 pt-4 border-t",children:[(0,Et.jsxs)("button",{onClick:()=>u("/instructor"),className:"flex items-center justify-between w-full px-2 py-2 text-left hover:bg-gray-100 rounded-lg",children:[(0,Et.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Et.jsx)(ep,{size:20,className:"text-blue-600"}),(0,Et.jsx)("span",{children:"Instructor Portal"})]}),l.instructor>0&&(0,Et.jsx)("span",{className:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l.instructor>9?"9+":l.instructor})]}),(null===i||void 0===i||null===(e=i.loyaltyAccess)||void 0===e?void 0:e.hasAccess)&&(0,Et.jsxs)("button",{onClick:()=>u("/loyalty"),className:"flex items-center space-x-2 w-full px-2 py-2 text-left hover:bg-gray-100 rounded-lg",children:[(0,Et.jsx)(rn,{size:20,className:"text-blue-600"}),(0,Et.jsx)("span",{children:"Loyalty Program"})]}),(null===i||void 0===i||null===(t=i.teamAccess)||void 0===t?void 0:t.hasAccess)&&(0,Et.jsxs)("button",{onClick:()=>u("/team"),className:"flex items-center space-x-2 w-full px-2 py-2 text-left hover:bg-gray-100 rounded-lg",children:[(0,Et.jsx)(La,{size:20,className:"text-blue-600"}),(0,Et.jsx)("span",{children:"Team Portal"})]}),n&&(0,Et.jsxs)("button",{onClick:()=>u("/admin"),className:"flex items-center space-x-2 w-full px-2 py-2 text-left hover:bg-gray-100 rounded-lg",children:[(0,Et.jsx)(tp,{size:20,className:"text-blue-600"}),(0,Et.jsx)("span",{children:"Admin Dashboard"})]})]}),(0,Et.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t",children:(0,Et.jsx)(ip,{className:"w-full justify-start",color:"text-gray-700"})})]})]})})})(),(0,Et.jsx)("main",{className:"flex-1 pt-[72px] pb-[88px] overflow-y-auto w-full smooth-scroll no-overscroll",children:t}),(0,Et.jsxs)("nav",{className:"fixed bottom-0 left-0 right-0 z-40 grid grid-cols-5 border-t bg-white safe-bottom",children:[(0,Et.jsxs)("button",{className:"flex flex-col items-center p-2 ".concat("/"===s.pathname?"text-blue-600":"text-gray-600"),onClick:()=>u("/"),children:[(0,Et.jsx)(rp,{size:20}),(0,Et.jsx)("span",{className:"text-xs mt-1",children:"Home"})]}),(0,Et.jsxs)("button",{className:"flex flex-col items-center p-2 ".concat("/training"===s.pathname?"text-blue-600":"text-gray-600"),onClick:()=>u("/training"),children:[(0,Et.jsxs)("div",{className:"relative inline-flex",children:[(0,Et.jsx)(Iu,{size:20}),l.training>0&&(0,Et.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l.training>9?"9+":l.training})]}),(0,Et.jsx)("span",{className:"text-xs mt-1",children:"Training"})]}),(0,Et.jsxs)("button",{className:"flex flex-col items-center p-2 ".concat("/messages"===s.pathname?"text-blue-600":"text-gray-600"),onClick:()=>u("/messages"),children:[(0,Et.jsxs)("div",{className:"relative inline-flex",children:[(0,Et.jsx)(Fi,{size:20}),l.messages>0&&(0,Et.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l.messages>9?"9+":l.messages})]}),(0,Et.jsx)("span",{className:"text-xs mt-1",children:"Messages"})]}),(0,Et.jsxs)("button",{className:"flex flex-col items-center p-2 ".concat("/travel"===s.pathname?"text-blue-600":"text-gray-600"),onClick:()=>u("/travel"),children:[(0,Et.jsxs)("div",{className:"relative inline-flex",children:[(0,Et.jsx)(yu,{size:20}),l.travel>0&&(0,Et.jsx)("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:l.travel>9?"9+":l.travel})]}),(0,Et.jsx)("span",{className:"text-xs mt-1",children:"Travel"})]}),(0,Et.jsxs)("button",{className:"flex flex-col items-center p-2 ".concat("/logbook"===s.pathname?"text-blue-600":"text-gray-600"),onClick:()=>u("/logbook"),children:[(0,Et.jsx)(vu,{size:20}),(0,Et.jsx)("span",{className:"text-xs mt-1",children:"Logbook"})]})]})]})},op=Mt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),lp={OCEANIC_SILVER:{min:0,max:9999,multiplier:1,name:"Oceanic Silver"},MARINER_GOLD:{min:1e4,max:19999,multiplier:1.2,name:"Mariner Gold"},NAUTILUS_PLATINUM:{min:2e4,max:49999,multiplier:1.5,name:"Nautilus Platinum"},TRIDENT_ELITE:{min:5e4,max:99999,multiplier:2,name:"Trident Elite"},LIFETIME_ELITE:{min:1e5,max:1/0,multiplier:2,name:"Lifetime Elite"}},cp=()=>{var e,t,n,s,i,a,l,c,u,d,h,m,f;const{user:p}=kt(),g=de(),[v,x]=(0,r.useState)(null),[y,b]=(0,r.useState)(null),[w,D]=(0,r.useState)(!1),[N,j]=(0,r.useState)(!1),[C,E]=(0,r.useState)(""),[A,k]=(0,r.useState)({type:"",message:""});(0,r.useEffect)((()=>{(async()=>{if(null!==p&&void 0!==p&&p.uid)try{const t=(0,Dt.H9)(wt.db,"profiles",p.uid),n=await(0,Dt.x7)(t);if(n.exists()){const t=n.data();x(t),b((e=t.lifetimePoints||0,Object.entries(lp).reduce(((t,n)=>{let[r,s]=n;return e>=s.min&&e<=s.max?(0,o.A)({tier:r},s):t}),lp.OCEANIC_SILVER)))}}catch(t){console.error("Error fetching profile data:",t)}var e})()}),[p]);const S=(e,t)=>Math.min(e/t*100,100);return(0,Et.jsxs)("div",{className:"flex flex-col h-full bg-gray-50",children:[(0,Et.jsxs)("div",{className:"bg-black text-white p-4 flex items-center",children:[(0,Et.jsx)("button",{onClick:()=>g(-1),className:"mr-4",children:(0,Et.jsx)(op,{size:24})}),(0,Et.jsx)("h1",{className:"text-xl font-semibold",children:"DiveRewards"})]}),(0,Et.jsxs)("div",{className:"flex-1 p-4",children:[(0,Et.jsxs)("div",{className:"bg-white p-6 mb-6",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("h2",{className:"text-3xl font-bold mb-1",children:["Hello, ",null===v||void 0===v||null===(e=v.name)||void 0===e?void 0:e.split(" ")[0]]}),(0,Et.jsx)("p",{className:"text-gray-700 mb-1",children:null===v||void 0===v?void 0:v.certificationLevel}),(0,Et.jsxs)("p",{className:"text-sm text-gray-500",children:["Member since ",new Date((null===v||void 0===v?void 0:v.joinDate)||Date.now()).toLocaleDateString("en-US",{month:"long",year:"numeric"})]})]}),(0,Et.jsx)("div",{className:"px-4 py-1.5 rounded-lg ".concat("OCEANIC_SILVER"===(null===y||void 0===y?void 0:y.tier)?"bg-gray-100 text-gray-800":"MARINER_GOLD"===(null===y||void 0===y?void 0:y.tier)?"bg-yellow-100 text-yellow-800":"NAUTILUS_PLATINUM"===(null===y||void 0===y?void 0:y.tier)?"bg-slate-200 text-slate-800":"bg-blue-100 text-blue-800"),children:(0,Et.jsx)("span",{className:"text-sm font-medium",children:null===y||void 0===y?void 0:y.name})})]}),(0,Et.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,Et.jsx)("h3",{className:"text-lg mb-4",children:"Points"}),(0,Et.jsxs)("div",{className:"space-y-3",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Lifetime Points"}),(0,Et.jsx)("span",{className:"text-xl font-bold",children:(null===v||void 0===v||null===(t=v.lifetimePoints)||void 0===t?void 0:t.toLocaleString())||0})]}),(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsx)("span",{className:"text-gray-600",children:"Redeemable Points"}),(0,Et.jsx)("span",{className:"text-xl font-bold",children:(null===v||void 0===v||null===(n=v.redeemablePoints)||void 0===n?void 0:n.toLocaleString())||0})]})]}),(0,Et.jsxs)("button",{onClick:()=>D(!0),className:"w-full mt-4 py-3 flex justify-between items-center border-t border-gray-200 hover:bg-gray-50 transition-colors",children:[(0,Et.jsx)("span",{className:"text-gray-700",children:"Learn More"}),(0,Et.jsx)(hs,{className:"h-5 w-5 text-gray-400"})]}),(0,Et.jsxs)("div",{className:"w-full py-4 border-t border-gray-200",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-gray-700",children:"Passes and subscriptions"}),(0,Et.jsxs)("button",{onClick:()=>j(!0),className:"flex items-center text-sm text-blue-600 hover:text-blue-700",children:[(0,Et.jsx)(gu,{size:16,className:"mr-1"}),"Request Gift Card"]})]}),A.message&&(0,Et.jsx)(An,{variant:"error"===A.type?"destructive":"default",className:"mb-4",children:(0,Et.jsx)(kn,{children:A.message})}),(0,Et.jsx)("div",{className:"relative",children:(0,Et.jsxs)("div",{className:"flex space-x-4 overflow-x-auto pb-4 scrollbar-hide",children:[(0,Et.jsx)("div",{className:"flex-none w-64",children:(0,Et.jsx)(vs,{tier:null===y||void 0===y?void 0:y.tier,memberName:null===v||void 0===v?void 0:v.name,memberId:(F=null===p||void 0===p?void 0:p.uid,_=v,null!==_&&void 0!==_&&_.loyaltyCode?_.loyaltyCode:F?F.toUpperCase():"MEMBER-ID"),joinDate:(null===v||void 0===v?void 0:v.joinDate)||Date.now(),certificationLevel:null===v||void 0===v?void 0:v.certificationLevel,redeemablePoints:null===v||void 0===v?void 0:v.redeemablePoints})}),null===v||void 0===v||null===(s=v.giftCards)||void 0===s?void 0:s.map(((e,t)=>(0,Et.jsx)("div",{className:"flex-none w-64 h-40 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-sm p-4 text-white",children:(0,Et.jsxs)("div",{className:"h-full flex flex-col justify-between",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm opacity-80",children:"Gift Card"}),(0,Et.jsxs)("p",{className:"text-2xl font-bold",children:["$",e.amount]})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("p",{className:"text-sm opacity-80",children:"Card Number"}),(0,Et.jsx)("p",{className:"font-mono",children:e.number.slice(-4).padStart(16,"*")})]})]})},t)))]})})]}),N&&(0,Et.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg w-full max-w-md p-6",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h3",{className:"text-lg font-semibold",children:"Request Gift Card"}),(0,Et.jsx)("button",{onClick:()=>{j(!1),E(""),k({type:"",message:""})},className:"text-gray-500 hover:text-gray-700",children:(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Et.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Amount ($)"}),(0,Et.jsx)("div",{className:"mt-1",children:(0,Et.jsx)("input",{type:"number",min:"1",step:"1",value:C,onChange:e=>{E(e.target.value);const t=parseFloat(e.target.value);if(!isNaN(t)&&t>0){k({type:"info",message:"This will require ".concat(100*t," points")})}else k({type:"error",message:"Please enter a valid amount"})},className:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Enter amount"})}),(0,Et.jsxs)("p",{className:"mt-1 text-sm text-gray-500",children:["Available points: ",(null===v||void 0===v||null===(i=v.redeemablePoints)||void 0===i?void 0:i.toLocaleString())||0]})]}),(0,Et.jsx)("button",{onClick:async()=>{if(null!==p&&void 0!==p&&p.uid&&C)try{const e=100*parseFloat(C);if(e>v.redeemablePoints)return void k({type:"error",message:"Insufficient points available"});const t={userId:p.uid,userName:v.name,amount:parseFloat(C),pointsRequested:e,status:"pending",requestDate:new Date,userEmail:p.email};await(0,Dt.gS)((0,Dt.rJ)(wt.db,"giftCardRequests"),t),k({type:"success",message:"Gift card request submitted successfully"}),j(!1),E(""),setTimeout((()=>k({type:"",message:""})),3e3)}catch(e){console.error("Error submitting gift card request:",e),k({type:"error",message:"Error submitting request. Please try again."})}},disabled:!C||100*parseFloat(C)>((null===v||void 0===v?void 0:v.redeemablePoints)||0),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Submit Request"})]})]})})]})]}),(0,Et.jsxs)("div",{className:"bg-white p-6 rounded-lg",children:[(0,Et.jsx)("h3",{className:"text-2xl font-bold mb-2",children:"Your Progress"}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600 mb-6",children:["Earned in ",(new Date).getFullYear()]}),(0,Et.jsxs)("div",{className:"flex justify-around items-center",children:[(0,Et.jsxs)("div",{className:"text-center",children:[(0,Et.jsxs)("div",{className:"relative inline-block w-32 h-32",children:[(0,Et.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 36 36",children:[(0,Et.jsx)("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",transform:"rotate(-90 18 18)",fill:"none",stroke:"#eee",strokeWidth:"2"}),(0,Et.jsx)("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#4263eb",strokeWidth:"2",strokeDasharray:"".concat(S((null===v||void 0===v?void 0:v.lifetimePoints)||0,(null===(a=Object.entries(lp).find((e=>{let[t,n]=e;return n.min>((null===v||void 0===v?void 0:v.lifetimePoints)||0)})))||void 0===a||null===(l=a[1])||void 0===l?void 0:l.min)||(null===y||void 0===y?void 0:y.max)),", 100")})]}),(0,Et.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,Et.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:((null===v||void 0===v?void 0:v.lifetimePoints)||0).toLocaleString()}),(0,Et.jsxs)("span",{className:"text-sm text-gray-500",children:["/",(null===(c=Object.entries(lp).find((e=>{let[t,n]=e;return n.min>((null===v||void 0===v?void 0:v.lifetimePoints)||0)})))||void 0===c||null===(u=c[1])||void 0===u?void 0:u.min.toLocaleString())||(null===y||void 0===y?void 0:y.max.toLocaleString())]})]})]}),(0,Et.jsxs)("p",{className:"mt-3 text-sm",children:["To ","LIFETIME_ELITE"===(null===y||void 0===y?void 0:y.tier)?"Lifetime Elite":(null===(d=Object.entries(lp).find((e=>{let[t,n]=e;return n.min>((null===v||void 0===v?void 0:v.lifetimePoints)||0)})))||void 0===d||null===(h=d[1])||void 0===h?void 0:h.name)||""]})]}),(0,Et.jsxs)("div",{className:"text-center",children:[(0,Et.jsxs)("div",{className:"relative inline-block w-32 h-32",children:[(0,Et.jsxs)("svg",{className:"w-full h-full -rotate-90",viewBox:"0 0 36 36",children:[(0,Et.jsx)("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#eee",strokeWidth:"2"}),(0,Et.jsx)("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#4263eb",strokeWidth:"2",strokeDasharray:"".concat(S((null===v||void 0===v||null===(m=v.yearlyPointsEarned)||void 0===m?void 0:m[(new Date).getFullYear()])||0,Math.ceil(.1*(null===y||void 0===y?void 0:y.min))),", 100")})]}),(0,Et.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,Et.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:null!==v&&void 0!==v&&v.yearlyPointsEarned?null===(f=v.yearlyPointsEarned[(new Date).getFullYear()])||void 0===f?void 0:f.toLocaleString():"0"}),(0,Et.jsxs)("span",{className:"text-sm text-gray-500",children:["/",Math.ceil(.1*(null===y||void 0===y?void 0:y.min)).toLocaleString()]})]})]}),(0,Et.jsx)("p",{className:"mt-3 text-sm",children:"Lock Points"})]})]})]})]}),(0,Et.jsx)(xs,{isOpen:w,onClose:()=>D(!1)})]});var F,_},up=e=>{let{trip:t,isOpen:n,onClose:r,defaultView:s="discussion"}=e;return(0,Et.jsx)($c,{context:t,contextType:"trip",isOpen:n,onClose:r,defaultTab:s})},dp=()=>{const{user:e}=kt(),[t,n]=(0,r.useState)(!0),[s,i]=(0,r.useState)(""),[a,l]=(0,r.useState)([]),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(null),[m,f]=(0,r.useState)(!1),[p,g]=(0,r.useState)(""),[,v]=(0,r.useState)({});(0,r.useEffect)((()=>{if(!e||!a.length)return;const t=a.map((t=>Xc.default.subscribeToItemNotifications(e.uid,"trip",t.tripId,(e=>{v((n=>(0,o.A)((0,o.A)({},n),{},{[t.tripId]:e.totalCount})))}))));return()=>{t.forEach((e=>e&&e()))}}),[e,a]);const x=(0,r.useCallback)((async t=>{if(!t||0===t.length)return[];const n=[],r=[];for(const e of t)try{var s;const t=(0,Dt.H9)(wt.db,"trips",e.tripId),i=await(0,Dt.x7)(t);if(!i.exists()){r.push(e.tripId);continue}const a=i.data();n.push((0,o.A)((0,o.A)((0,o.A)({},e),a),{},{tripId:e.tripId,currentParticipants:(null===(s=a.participants)||void 0===s?void 0:s.length)||0,instructor:a.instructor,requirements:a.requirements,description:a.description,status:a.status||e.status,maxParticipants:a.maxParticipants||e.maxParticipants}))}catch(gb){console.error("Error checking trip:",gb),n.push(e)}if(r.length>0)try{const t=(0,Dt.H9)(wt.db,"profiles",e.uid);await(0,Dt.mZ)(t,{trips:n})}catch(gb){console.error("Error updating profile:",gb)}return n}),[null===e||void 0===e?void 0:e.uid]);(0,r.useEffect)((()=>{(async()=>{if(null!==e&&void 0!==e&&e.uid)try{const t=(0,Dt.H9)(wt.db,"profiles",e.uid),n=await(0,Dt.x7)(t);if(n.exists()){const e=n.data().trips||[],t=await x(e);l(t)}}catch(gb){console.error("Error fetching trips:",gb),i("Error loading trip data")}finally{n(!1)}})()}),[e,x]);const y=async e=>{c===e?(u(null),h(null)):(u(e),await(async e=>{if(!e)return g("Invalid trip ID"),void f(!1);try{f(!0),g("");const t=(0,Dt.H9)(wt.db,"trips",e),n=await(0,Dt.x7)(t);if(n.exists()){const e=n.data();h(e)}else g("Trip not found")}catch(gb){console.error("Error fetching trip details:",gb),g("Failed to load trip details")}finally{f(!1)}})(e))},b=e=>{var t,n,s;let{trip:i,isExpanded:a,onToggle:l,isLoading:c,error:u,currentUserId:d}=e;const[h,m]=(0,r.useState)(!1),[f,p]=(0,r.useState)({broadcasts:0,discussion:0,direct:0}),{user:g}=kt();(0,r.useEffect)((()=>{if(!i.tripId||!g)return;const e=Xc.default.subscribeToItemNotifications(g.uid,"trip",i.tripId,(e=>{p({broadcasts:e.tabCounts.broadcast,discussion:e.tabCounts.discussion,direct:e.tabCounts.direct})}));return()=>e()}),[i.tripId,g]);const{divers:v,nonDivers:x}=(e=>{let t=0,n=0;return null===e||void 0===e||e.forEach((e=>{var r;e.isDiver?t++:n++,null===(r=e.companions)||void 0===r||r.forEach((e=>{e.isDiver?t++:n++}))})),{divers:t,nonDivers:n}})(i.participants),y=e=>{let{isSubmitted:t}=e;return(0,Et.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat(t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t?"Waiver Accepted":"Waiver Required"})};return(0,Et.jsxs)("div",{className:"bg-white border rounded-lg shadow-sm overflow-hidden",children:[(0,Et.jsxs)("div",{className:"p-4",children:[(0,Et.jsxs)("div",{className:"mb-2",children:[(0,Et.jsx)("div",{className:"flex items-start gap-2",children:(0,Et.jsx)("h4",{className:"text-lg font-semibold",children:i.location})}),(0,Et.jsxs)("p",{className:"text-sm text-gray-600",children:[i.resort," \u2022 ",new Date(i.startDate).toLocaleDateString()," - ",new Date(i.endDate).toLocaleDateString()]}),(0,Et.jsxs)("div",{className:"mt-3 mb-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:[(0,Et.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Important Document Required:"}),(0,Et.jsxs)("a",{href:i.waiverLink||"https://app.waiverforever.com/pending/dC3UBXG7ZZ1684272159",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 text-blue-600 hover:text-blue-800 font-medium p-2 bg-white rounded-md border border-blue-200",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),"Travel Waiver"]})]}),(0,Et.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,Et.jsxs)("span",{className:"text-sm text-gray-600",children:["Total Participants: ",i.currentParticipants]}),(0,Et.jsxs)("span",{className:"text-sm text-blue-600",children:["Divers: ",v]}),(0,Et.jsxs)("span",{className:"text-sm text-green-600",children:["Non-Divers: ",x]}),(0,Et.jsx)("span",{className:"px-2 py-0.5 text-xs rounded-full ".concat("upcoming"===i.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:i.status})]})]}),(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsx)("button",{onClick:l,className:"text-sm text-gray-600 hover:text-blue-600 flex items-center gap-1",children:a?"Hide Details":"View Details"}),(0,Et.jsxs)("button",{onClick:()=>m(!0),className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-2 relative",children:[(0,Et.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Et.jsx)("path",{fillRule:"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z",clipRule:"evenodd"})}),"Trip Messages",(f.broadcasts>0||f.discussion>0||f.direct>0)&&(0,Et.jsx)("div",{className:"absolute -top-2 -right-2",children:(0,Et.jsx)(tu,{count:f.broadcasts+f.discussion+f.direct,size:"sm"})})]})]})]}),a&&(0,Et.jsx)("div",{className:"border-t bg-gray-50",children:c?(0,Et.jsx)("div",{className:"p-4 text-center text-gray-600",children:"Loading..."}):u?(0,Et.jsx)("div",{className:"p-4 text-center text-red-600",children:u}):i?(0,Et.jsx)("div",{className:"p-4",children:(0,Et.jsxs)("div",{className:"space-y-4",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Description"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:i.description})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Requirements"}),(0,Et.jsx)("p",{className:"text-sm text-gray-600",children:i.requirements})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Trip Leader"}),(0,Et.jsx)("div",{className:"flex items-center gap-3",children:(0,Et.jsxs)("div",{className:"flex flex-col",children:[(0,Et.jsx)("span",{className:"text-sm font-medium",children:null===(t=i.instructor)||void 0===t?void 0:t.displayName}),(0,Et.jsx)("span",{className:"text-sm text-gray-600",children:null===(n=i.instructor)||void 0===n?void 0:n.email})]})})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h5",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Participants"}),(0,Et.jsx)("div",{className:"space-y-3",children:null===(s=i.participants)||void 0===s?void 0:s.map((e=>{var t;const n=e.uid===d;return(0,Et.jsxs)("div",{className:"border-b pb-3 last:border-b-0",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("span",{className:"font-medium",children:e.displayName}),n&&(0,Et.jsx)("span",{className:"ml-2 text-sm text-gray-500",children:"(You)"})]}),(0,Et.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Et.jsx)("span",{className:"text-sm ".concat(e.isDiver?"text-blue-600":"text-green-600"),children:e.isDiver?"Diver":"Non-Diver"}),n&&(0,Et.jsx)(y,{isSubmitted:e.waiverSubmitted})]})]}),(null===(t=e.companions)||void 0===t?void 0:t.length)>0&&(0,Et.jsxs)("div",{className:"mt-2 ml-4",children:[(0,Et.jsx)("div",{className:"text-sm text-gray-600",children:"Traveling With:"}),(0,Et.jsx)("div",{className:"ml-2 space-y-1",children:e.companions.map((e=>(0,Et.jsxs)("div",{className:"text-sm flex justify-between items-center",children:[(0,Et.jsxs)("span",{children:[e.name,n&&e.relationship&&(0,Et.jsx)("span",{className:"text-gray-500",children:" \u2022 ".concat(e.relationship)})]}),(0,Et.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Et.jsx)("span",{className:e.isDiver?"text-blue-600":"text-green-600",children:e.isDiver?"Diver":"Non-Diver"}),n&&(0,Et.jsx)(y,{isSubmitted:e.waiverSubmitted})]})]},e.id)))})]})]},e.uid)}))})]})]})}):(0,Et.jsx)("div",{className:"p-4 text-center text-gray-600",children:"No details available"})}),h&&(0,Et.jsx)(up,{trip:(0,o.A)((0,o.A)({},i),{},{id:i.tripId}),isOpen:h,onClose:()=>{m(!1),g&&i.tripId&&(Xc.default.markTabNotificationsAsRead(g.uid,"trip",i.tripId,"broadcast"),Xc.default.markTabNotificationsAsRead(g.uid,"trip",i.tripId,"discussion"),Xc.default.markTabNotificationsAsRead(g.uid,"trip",i.tripId,"direct"))},defaultView:"discussion"})]})};return t?(0,Et.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,Et.jsx)("div",{className:"text-gray-600",children:"Loading..."})}):s?(0,Et.jsx)("div",{className:"max-w-2xl mx-auto p-4",children:(0,Et.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,Et.jsx)("p",{className:"text-red-600",children:s})})}):(0,Et.jsx)("div",{className:"max-w-6xl mx-auto p-4",children:(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,Et.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Travel"}),(0,Et.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Upcoming Trips"}),(0,Et.jsx)("div",{className:"space-y-4",children:0===a.filter((e=>"upcoming"===e.status)).length?(0,Et.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-600",children:"No upcoming trips."})}):a.filter((e=>"upcoming"===e.status)).map((t=>(0,Et.jsx)(b,{trip:t,isExpanded:c===t.tripId,onToggle:()=>y(t.tripId),details:c===t.tripId?d:null,isLoading:m,error:p,currentUserId:e.uid},t.tripId)))})]}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Past Trips"}),(0,Et.jsx)("div",{className:"space-y-4",children:0===a.filter((e=>"completed"===e.status)).length?(0,Et.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-600",children:"No past trips."})}):a.filter((e=>"completed"===e.status)).map((t=>(0,Et.jsx)(b,{trip:t,isExpanded:c===t.tripId,onToggle:()=>y(t.tripId),details:c===t.tripId?d:null,isLoading:m,error:p,currentUserId:e.uid},t.tripId)))})]})]})]})})},hp=Mt("Fish",[["path",{d:"M6.5 12c.94-3.46 4.94-6 8.5-6 3.56 0 6.06 2.54 7 6-.94 3.47-3.44 6-7 6s-7.56-2.53-8.5-6Z",key:"15baut"}],["path",{d:"M18 12v.5",key:"18hhni"}],["path",{d:"M16 17.93a9.77 9.77 0 0 1 0-11.86",key:"16dt7o"}],["path",{d:"M7 10.67C7 8 5.58 5.97 2.73 5.5c-1 1.5-1 5 .23 6.5-1.24 1.5-1.24 5-.23 6.5C5.58 18.03 7 16 7 13.33",key:"l9di03"}],["path",{d:"M10.46 7.26C10.2 5.88 9.17 4.24 8 3h5.8a2 2 0 0 1 1.98 1.67l.23 1.4",key:"1kjonw"}],["path",{d:"m16.01 17.93-.23 1.4A2 2 0 0 1 13.8 21H9.5a5.96 5.96 0 0 0 1.49-3.98",key:"1zlm23"}]]),mp=Mt("CloudLightning",[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]]),fp=Mt("Mountain",[["path",{d:"m8 3 4 8 5-5 5 15H2L8 3z",key:"otkl63"}]]),pp=Mt("Shell",[["path",{d:"M14 11a2 2 0 1 1-4 0 4 4 0 0 1 8 0 6 6 0 0 1-12 0 8 8 0 0 1 16 0 10 10 0 1 1-20 0 11.93 11.93 0 0 1 2.42-7.22 2 2 0 1 1 3.16 2.44",key:"1cn552"}]]),gp=e=>{let{title:t,description:n,iconName:r,count:s,onClick:i}=e;return(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 cursor-pointer hover:shadow-lg transition-shadow",onClick:i,children:[(0,Et.jsxs)("div",{className:"flex items-start mb-2",children:[(0,Et.jsx)("div",{className:"p-2 bg-blue-50 rounded-full mr-3",children:(e=>{const t={compass:yu,book:vu,anchor:xu,thermometer:xi,fish:hp,weather:mp,topography:fp,marine:pp,navigation:sn,certification:rn}[null===e||void 0===e?void 0:e.toLowerCase()]||vu;return(0,Et.jsx)(t,{size:24,className:"text-blue-500"})})(r)}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"font-bold text-lg",children:t}),(0,Et.jsxs)("p",{className:"text-sm text-gray-500",children:[s," quizzes"]})]})]}),(0,Et.jsx)("p",{className:"text-gray-600 text-sm",children:n})]})},vp=Mt("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]),xp=Mt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),yp=Mt("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),bp=Mt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),wp=Mt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Dp=Mt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Np=Mt("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),jp={FIRST_QUIZ:{id:"first_quiz",name:"First Dive",description:"Completed your first knowledge quiz",icon:(0,Et.jsx)(Ef,{size:24,className:"text-green-500"}),color:"bg-green-100"},PERFECT_SCORE:{id:"perfect_score",name:"Perfect Dive",description:"Achieved a perfect score on a quiz",icon:(0,Et.jsx)(wp,{size:24,className:"text-yellow-500"}),color:"bg-yellow-100"},CATEGORY_MASTER:{id:"category_master",name:"Category Master",description:"Completed all quizzes in a category",icon:(0,Et.jsx)(bp,{size:24,className:"text-purple-500"}),color:"bg-purple-100"},QUICK_LEARNER:{id:"quick_learner",name:"Quick Learner",description:"Completed 5 quizzes in a single day",icon:(0,Et.jsx)(Dp,{size:24,className:"text-blue-500"}),color:"bg-blue-100"},FIVE_DAY_STREAK:{id:"five_day_streak",name:"5-Day Streak",description:"Completed quizzes for 5 consecutive days",icon:(0,Et.jsx)(Np,{size:24,className:"text-orange-500"}),color:"bg-orange-100"},MARINE_EXPERT:{id:"marine_expert",name:"Marine Expert",description:"Achieved high scores on all Marine Life quizzes",icon:(0,Et.jsx)(pp,{size:24,className:"text-indigo-500"}),color:"bg-indigo-100"},DIVE_PHYSICS_PRO:{id:"dive_physics_pro",name:"Physics Pro",description:"Mastered all Dive Physics quizzes",icon:(0,Et.jsx)(Iu,{size:24,className:"text-red-500"}),color:"bg-red-100"}},Cp=e=>{let{showAll:t=!1}=e;const[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)(null),[l,c]=(0,r.useState)(!1),[u,d]=(0,r.useState)(!0),{user:h}=kt(),m=de();return(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.H9)(wt.db,"profiles",h.uid),t=await(0,Dt.x7)(e);if(t.exists()){const e=t.data(),n=(e.badges||[]).map((e=>{if(e.startsWith("category_master_")){const t=e.replace("category_master_","");return(0,o.A)((0,o.A)({},jp.CATEGORY_MASTER),{},{id:e,name:"".concat(t.charAt(0).toUpperCase()+t.slice(1)," Master")})}return Object.values(jp).find((t=>t.id===e))||{id:e,name:"Mystery Badge",description:"A mysterious badge",icon:(0,Et.jsx)(rn,{size:24,className:"text-gray-500"}),color:"bg-gray-100"}}));s(n)}d(!1)}catch(e){console.error("Error fetching badges:",e),d(!1)}})()}),[h.uid]),(0,r.useEffect)((()=>{(async()=>{if(localStorage.getItem("justCompletedQuiz")){localStorage.removeItem("justCompletedQuiz");try{const e=(0,Dt.H9)(wt.db,"profiles",h.uid),t=await(0,Dt.x7)(e);if(t.exists()){const n=t.data(),r=n.quizHistory||[],i=n.badges||[],l=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"quizzes"))).docs.map((e=>(0,o.A)({id:e.id},e.data()))),u=(await(0,Dt.GG)((0,Dt.rJ)(wt.db,"quizCategories"))).docs.map((e=>(0,o.A)({id:e.id},e.data()))),d=await(async(e,t,n,r)=>{const s=[];1===t.length&&s.push(jp.FIRST_QUIZ),t.some((e=>100===e.score))&&s.push(jp.PERFECT_SCORE);const i={};r.forEach((e=>{i[e.id]={total:0,completed:0}})),n.forEach((e=>{i[e.categoryId]&&(i[e.categoryId].total+=1)})),t.forEach((e=>{const t=n.find((t=>t.id===e.quizId));t&&i[t.categoryId]&&(i[t.categoryId].completed+=1)})),Object.keys(i).forEach((e=>{const t=i[e];var n;t.total>0&&t.completed===t.total&&s.push((0,o.A)((0,o.A)({},jp.CATEGORY_MASTER),{},{id:"category_master_".concat(e),name:"".concat((null===(n=r.find((t=>t.id===e)))||void 0===n?void 0:n.title)||"Category"," Master")}))}));const a={};t.forEach((e=>{const t=new Date(e.completedAt).toDateString();a[t]||(a[t]=0),a[t]+=1}));const l=Object.values(a).some((e=>e>=5));l&&s.push(jp.QUICK_LEARNER);const c=t.map((e=>new Date(e.completedAt).toDateString())),u=[...new Set(c)].sort(((e,t)=>new Date(e)-new Date(t)));let d=0,h=0;for(let o=0;o<u.length;o++){if(0===o)h=1;else{const e=new Date(u[o-1]);1===(new Date(u[o])-e)/864e5?h+=1:h=1}d=Math.max(d,h)}d>=5&&s.push(jp.FIVE_DAY_STREAK);const m=r.find((e=>"marine"===e.id));if(m){const e=n.filter((e=>"marine"===e.categoryId)),r=e.map((e=>e.id)),i=t.filter((e=>r.includes(e.quizId))),a=r.length>0&&r.every((e=>i.some((t=>t.quizId===e)))),o=i.every((e=>e.score>=85));a&&o&&s.push(jp.MARINE_EXPERT)}const f=r.find((e=>"physics"===e.id));if(f){const e=n.filter((e=>"physics"===e.categoryId)),r=e.map((e=>e.id)),i=t.filter((e=>r.includes(e.quizId))),a=r.length>0&&r.every((e=>i.some((t=>t.quizId===e)))),o=i.every((e=>e.score>=80));a&&o&&s.push(jp.DIVE_PHYSICS_PRO)}return s})(0,r,l,u),h=d.filter((e=>!i.includes(e.id)));if(h.length>0){const t=h.map((e=>e.id));await(0,Dt.mZ)(e,{badges:(0,Dt.hq)(...t)}),a(h[0]),c(!0),s((e=>[...e,...h]))}}}catch(e){console.error("Error checking for new badges:",e)}}})()}),[h,h.uid]),u?(0,Et.jsx)("div",{className:"flex justify-center py-4",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,Et.jsxs)("div",{className:"mt-4",children:[(0,Et.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,Et.jsx)(rn,{className:"mr-2 text-blue-500",size:20}),"Your Badges"]}),0===n.length?(0,Et.jsxs)("div",{className:"text-center bg-gray-50 p-6 rounded-lg",children:[(0,Et.jsx)("div",{className:"mb-2 text-gray-400",children:(0,Et.jsx)(rn,{size:48,className:"mx-auto"})}),(0,Et.jsx)("p",{className:"text-gray-500",children:"Complete quizzes to earn badges!"})]}):(0,Et.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[n.slice(0,t?n.length:4).map((e=>(0,Et.jsxs)("div",{className:"".concat(e.color," p-3 rounded-lg flex flex-col items-center shadow-sm transition-transform hover:scale-105"),children:[(0,Et.jsx)("div",{className:"mb-2",children:e.icon}),(0,Et.jsx)("p",{className:"font-medium text-sm text-center",children:e.name}),t&&(0,Et.jsx)("p",{className:"text-xs text-center mt-1 text-gray-600",children:e.description})]},e.id))),!t&&n.length>4&&(0,Et.jsx)("div",{className:"bg-gray-100 p-3 rounded-lg flex flex-col items-center justify-center cursor-pointer shadow-sm hover:bg-gray-200",onClick:()=>m("/profile"),children:(0,Et.jsxs)("p",{className:"font-medium text-sm text-center text-gray-700",children:["+",n.length-4," more"]})})]}),(0,Et.jsx)(oc,{open:l,onOpenChange:c,children:(0,Et.jsxs)(hc,{className:"bg-white p-6 rounded-lg max-w-md mx-auto text-center",children:[(0,Et.jsx)(pc,{className:"text-2xl font-bold mb-6",children:"New Badge Earned!"}),i&&(0,Et.jsxs)("div",{className:"flex flex-col items-center",children:[(0,Et.jsx)("div",{className:"".concat(i.color," p-6 rounded-full mb-4 animate-pulse"),children:r.cloneElement(i.icon,{size:48})}),(0,Et.jsx)("h3",{className:"text-xl font-bold mb-2",children:i.name}),(0,Et.jsx)("p",{className:"text-gray-600 mb-6",children:i.description}),(0,Et.jsx)("button",{onClick:()=>c(!1),className:"px-6 py-2 bg-blue-600 text-white rounded-md",children:"Awesome!"})]})]})})]})},Ep=Mt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Ap=e=>{let{quizId:t,categoryId:n}=e;const[s,i]=(0,r.useState)([]),[a,l]=(0,r.useState)(!0),[c,u]=(0,r.useState)("quiz"),{user:d}=kt();(0,r.useEffect)((()=>{(async()=>{try{let e;e="quiz"===c&&t?(0,Dt.P)((0,Dt.rJ)(wt.db,"quizResults"),(0,Dt._M)("quizId","==",t),(0,Dt.My)("score","desc"),(0,Dt.AB)(10)):(0,Dt.P)((0,Dt.rJ)(wt.db,"quizResults"),(0,Dt._M)("categoryId","==",n),(0,Dt.My)("score","desc"),(0,Dt.AB)(10));const r=await(0,Dt.GG)(e),s=[];for(const t of r.docs){const e=t.data(),n=await(0,Dt.GG)((0,Dt.P)((0,Dt.rJ)(wt.db,"profiles"),(0,Dt._M)("uid","==",e.userId)));let r={name:"Anonymous Diver"};n.empty||(r=n.docs[0].data()),s.push((0,o.A)((0,o.A)({id:t.id},e),{},{user:r}))}i(s),l(!1)}catch(e){console.error("Error fetching leaderboard:",e),l(!1)}})()}),[t,n,c]);const h=e=>{switch(e){case 0:return(0,Et.jsx)(yp,{size:20,className:"text-yellow-500"});case 1:return(0,Et.jsx)(yp,{size:20,className:"text-gray-400"});case 2:return(0,Et.jsx)(yp,{size:20,className:"text-amber-700"});default:return null}},m=(e,t,n)=>{const r="I'm ranked #".concat(e+1," on the ").concat("quiz"===c?"quiz":"category"," leaderboard with a score of ").concat(n,"%! Can you beat me? #SCUBADiving #KnowledgeHub");navigator.share?navigator.share({title:"SCUBA Knowledge Challenge",text:r,url:window.location.href}):(navigator.clipboard.writeText(r),alert("Copied to clipboard!"))};return(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-6",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsxs)("h2",{className:"text-lg font-semibold flex items-center",children:[(0,Et.jsx)(xp,{size:20,className:"text-blue-500 mr-2"}),"Leaderboard"]}),(0,Et.jsxs)("div",{className:"flex space-x-2 text-sm",children:[(0,Et.jsx)("button",{className:"px-3 py-1 rounded-full ".concat("quiz"===c?"bg-blue-100 text-blue-700 font-medium":"text-gray-600 hover:bg-gray-100"),onClick:()=>u("quiz"),children:"This Quiz"}),(0,Et.jsx)("button",{className:"px-3 py-1 rounded-full ".concat("category"===c?"bg-blue-100 text-blue-700 font-medium":"text-gray-600 hover:bg-gray-100"),onClick:()=>u("category"),children:"Category"})]})]}),a?(0,Et.jsx)("div",{className:"flex justify-center py-8",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,Et.jsxs)("div",{children:[0===s.length?(0,Et.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,Et.jsx)(La,{className:"mx-auto mb-2 text-gray-400",size:32}),(0,Et.jsx)("p",{children:"No entries yet! Be the first to complete this quiz."})]}):(0,Et.jsx)("div",{className:"space-y-3",children:s.map(((e,t)=>{var n,r;return(0,Et.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg ".concat(e.userId===d.uid?"bg-blue-50 border border-blue-200":"bg-gray-50"),children:[(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("div",{className:"w-8 text-center font-semibold text-gray-600",children:h(t)||"#".concat(t+1)}),(0,Et.jsxs)("div",{className:"ml-3",children:[(0,Et.jsx)("p",{className:"font-medium",children:(null===(n=e.user)||void 0===n?void 0:n.name)||"Anonymous Diver"}),(0,Et.jsx)("p",{className:"text-xs text-gray-500",children:new Date(null===(r=e.timestamp)||void 0===r?void 0:r.toDate()).toLocaleDateString()})]})]}),(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(e.score>=90?"bg-green-100 text-green-700":e.score>=75?"bg-blue-100 text-blue-700":e.score>=60?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[e.score,"%"]}),e.userId===d.uid&&(0,Et.jsx)("button",{onClick:()=>{var n;return m(t,null===(n=e.user)||void 0===n||n.name,e.score)},className:"ml-2 p-1 text-gray-500 hover:text-blue-500",children:(0,Et.jsx)(Ep,{size:16})})]})]},e.id)}))}),(0,Et.jsxs)("div",{className:"mt-4 flex justify-between",children:[(0,Et.jsx)("p",{className:"text-sm text-gray-500",children:"quiz"===c?"Top scores for this quiz":"Top average scores in this category"}),s.length>0&&(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>{var e;return m(s.findIndex((e=>e.userId===d.uid)),d.displayName,(null===(e=s.find((e=>e.userId===d.uid)))||void 0===e?void 0:e.score)||0)},children:[(0,Et.jsx)(Ep,{size:14,className:"mr-1"}),"Share Results"]})]})]})]})},kp=()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)(!0),[i,a]=(0,r.useState)({stats:!0,leaderboard:!1}),[l,c]=(0,r.useState)(null),[u,d]=(0,r.useState)({completedQuizzes:0,totalQuizzes:0,avgScore:0,bestCategory:"",recentActivity:[]}),h=de(),{user:m}=kt();(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.rJ)(wt.db,"quizCategories"),n=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data())));if(t(n),n.length>0){const e=n.reduce(((e,t)=>(e.quizCount||0)>(t.quizCount||0)?e:t));c(e)}const r=(0,Dt.rJ)(wt.db,"quizzes"),i=(await(0,Dt.GG)(r)).docs.map((e=>(0,o.A)({id:e.id},e.data()))),a=(0,Dt.H9)(wt.db,"profiles",m.uid),l=await(0,Dt.x7)(a);if(l.exists()){const e=l.data().quizHistory||[],t=i.length,r=new Set;e.forEach((e=>{e.quizId&&r.add(e.quizId)}));const s=r.size;let a=0;e.forEach((e=>{a+=e.score||0}));const o={};e.forEach((e=>{const t=i.find((t=>t.id===e.quizId));if(t){var r;if(!o[t.categoryId])o[t.categoryId]={count:0,totalScore:0,name:(null===(r=n.find((e=>e.id===t.categoryId)))||void 0===r?void 0:r.title)||""};o[t.categoryId].count+=1,o[t.categoryId].totalScore+=e.score||0}}));let c="",u=0;Object.keys(o).forEach((e=>{const t=o[e].totalScore/o[e].count;t>u&&o[e].count>=2&&(u=t,c=o[e].name)}));const h=[...e].sort(((e,t)=>new Date(t.completedAt)-new Date(e.completedAt))).slice(0,5).map((e=>{const t=i.find((t=>t.id===e.quizId));return{quizId:e.quizId,quizTitle:e.quizTitle||(null===t||void 0===t?void 0:t.title)||"Unknown Quiz",score:e.score,completedAt:e.completedAt}}));d({completedQuizzes:s,totalQuizzes:t,avgScore:e.length>0?Math.round(a/e.length):0,bestCategory:c,recentActivity:h})}s(!1)}catch(e){console.error("Error fetching data:",e),s(!1)}})()}),[m.uid]);const f=()=>0===u.totalQuizzes?0:Math.min(100,Math.round(u.completedQuizzes/u.totalQuizzes*100));return(0,Et.jsxs)("div",{className:"flex-1 p-4",children:[(0,Et.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,Et.jsx)("h1",{className:"text-2xl font-bold",children:"Knowledge Hub"})}),(0,Et.jsx)("p",{className:"text-gray-600 mb-6",children:"Test your knowledge and expand your diving expertise with quizzes and knowledge reviews."}),(0,Et.jsxs)(ss,{defaultValue:"dashboard",className:"mb-6",children:[(0,Et.jsxs)(is,{className:"grid grid-cols-3 mb-4",children:[(0,Et.jsxs)(as,{value:"dashboard",className:"text-sm",children:[(0,Et.jsx)(vp,{size:16,className:"mr-2"}),"Dashboard"]}),(0,Et.jsxs)(as,{value:"quizzes",className:"text-sm",children:[(0,Et.jsx)(Iu,{size:16,className:"mr-2"}),"Quizzes"]}),(0,Et.jsxs)(as,{value:"leaderboard",className:"text-sm",children:[(0,Et.jsx)(xp,{size:16,className:"mr-2"}),"Leaderboard"]})]}),(0,Et.jsxs)(os,{value:"dashboard",className:"space-y-6",children:[(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center p-4 bg-blue-50 cursor-pointer",onClick:()=>{return e="stats",void a((0,o.A)((0,o.A)({},i),{},{[e]:!i[e]}));var e},children:[(0,Et.jsxs)("h2",{className:"font-semibold flex items-center",children:[(0,Et.jsx)(vp,{className:"mr-2 text-blue-500",size:20}),"Your Knowledge Stats"]}),(0,Et.jsx)("button",{className:"text-blue-500",children:i.stats?(0,Et.jsx)(us,{size:20}):(0,Et.jsx)(ds,{size:20})})]}),i.stats&&(0,Et.jsx)("div",{className:"p-4",children:n?(0,Et.jsx)("div",{className:"flex justify-center py-4",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"})}):(0,Et.jsxs)(Et.Fragment,{children:[(0,Et.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,Et.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg flex flex-col items-center justify-center",children:[(0,Et.jsxs)("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:[f(),"%"]}),(0,Et.jsx)("div",{className:"text-sm text-blue-700",children:"Completion Rate"}),(0,Et.jsx)("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2.5",children:(0,Et.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(f(),"%")}})})]}),(0,Et.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg flex flex-col items-center justify-center",children:[(0,Et.jsx)("div",{className:"text-3xl font-bold text-green-600 mb-1",children:u.completedQuizzes}),(0,Et.jsx)("div",{className:"text-sm text-green-700",children:"Completed Quizzes"})]}),(0,Et.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg flex flex-col items-center justify-center",children:[(0,Et.jsxs)("div",{className:"text-3xl font-bold text-purple-600 mb-1",children:[u.avgScore,"%"]}),(0,Et.jsx)("div",{className:"text-sm text-purple-700",children:"Average Score"})]}),(0,Et.jsxs)("div",{className:"bg-amber-50 p-4 rounded-lg flex flex-col items-center justify-center",children:[(0,Et.jsx)("div",{className:"text-lg font-bold text-amber-600 mb-1 truncate max-w-full",children:u.bestCategory||"Keep practicing!"}),(0,Et.jsx)("div",{className:"text-sm text-amber-700",children:"Best Category"})]})]}),u.recentActivity.length>0&&(0,Et.jsxs)("div",{children:[(0,Et.jsxs)("h3",{className:"font-medium text-gray-700 mb-2 flex items-center",children:[(0,Et.jsx)(Qt,{size:16,className:"mr-1"})," Recent Activity"]}),(0,Et.jsx)("div",{className:"bg-gray-50 rounded-lg p-3",children:u.recentActivity.map(((e,t)=>(0,Et.jsxs)("div",{className:"flex justify-between items-center py-2 ".concat(t!==u.recentActivity.length-1?"border-b border-gray-200":""),children:[(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)(Ef,{size:16,className:"text-green-500 mr-2"}),(0,Et.jsx)("span",{className:"text-sm",children:e.quizTitle})]}),(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsxs)("span",{className:"text-sm font-medium px-2 py-1 rounded-full ".concat(e.score>=80?"bg-green-100 text-green-700":e.score>=60?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:[e.score,"%"]}),(0,Et.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:new Date(e.completedAt).toLocaleDateString()})]})]},t)))})]})]})})]}),(0,Et.jsx)(Cp,{showAll:!1})]}),(0,Et.jsxs)(os,{value:"quizzes",className:"space-y-6",children:[(0,Et.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n?(0,Et.jsx)("div",{className:"col-span-2 flex justify-center py-8",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.length>0?e.map((e=>(0,Et.jsx)(gp,{title:e.title,description:e.description,iconName:e.icon,count:e.quizCount||0,onClick:()=>{return t=e.id,void h("/knowledge/category/".concat(t));var t}},e.id))):(0,Et.jsx)("div",{className:"col-span-2 text-center p-6 bg-gray-50 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-500",children:"No quiz categories available yet. Check back soon!"})})}),(0,Et.jsxs)("div",{className:"mt-8 mb-6",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsx)("h2",{className:"text-xl font-bold",children:"Learning Resources"}),(0,Et.jsxs)("button",{onClick:()=>h("/knowledge/resources"),className:"text-sm text-blue-600 flex items-center",children:["View All ",(0,Et.jsx)(hs,{size:16,className:"ml-1"})]})]}),(0,Et.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg",children:(0,Et.jsxs)("div",{className:"flex items-start",children:[(0,Et.jsx)(wc,{className:"text-blue-500 mr-3 flex-shrink-0 mt-1"}),(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"font-medium text-blue-800",children:"Learning Resources Available"}),(0,Et.jsx)("p",{className:"text-blue-700 mt-1",children:"Access comprehensive guides and resources about diving techniques, equipment, physics, and more. Perfect for preparing for quizzes or expanding your knowledge."}),(0,Et.jsx)("button",{onClick:()=>h("/knowledge/resources"),className:"mt-3 bg-blue-600 text-white px-4 py-2 rounded-md text-sm hover:bg-blue-700 transition-colors",children:"Browse Resources"})]})]})})]})]}),(0,Et.jsx)(os,{value:"leaderboard",className:"space-y-6",children:(0,Et.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:(0,Et.jsxs)("div",{className:"p-4",children:[(0,Et.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,Et.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg",children:[(0,Et.jsx)("div",{className:"flex justify-center mb-2",children:(0,Et.jsx)(yp,{size:24,className:"text-blue-600"})}),(0,Et.jsx)("h3",{className:"text-center font-medium text-blue-800 mb-1",children:"Overall Top Divers"}),(0,Et.jsx)("p",{className:"text-xs text-center text-blue-600",children:"Based on average scores"})]}),(0,Et.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg",children:[(0,Et.jsx)("div",{className:"flex justify-center mb-2",children:(0,Et.jsx)(rn,{size:24,className:"text-green-600"})}),(0,Et.jsx)("h3",{className:"text-center font-medium text-green-800 mb-1",children:"Most Active Divers"}),(0,Et.jsx)("p",{className:"text-xs text-center text-green-600",children:"Based on quizzes completed"})]}),(0,Et.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg",children:[(0,Et.jsx)("div",{className:"flex justify-center mb-2",children:(0,Et.jsx)(bp,{size:24,className:"text-purple-600"})}),(0,Et.jsx)("h3",{className:"text-center font-medium text-purple-800 mb-1",children:"Category Champions"}),(0,Et.jsx)("p",{className:"text-xs text-center text-purple-600",children:"Leaders in each category"})]})]}),l&&(0,Et.jsx)(Ap,{categoryId:l.id})]})})})]})]})},Sp=()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)(""),[l,c]=(0,r.useState)(!0),[u,d]=(0,r.useState)("all"),{categoryId:h}=he(),m=de();(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.rJ)(wt.db,"quizCategories"),n=await(0,Dt.GG)((0,Dt.P)(e,(0,Dt._M)("id","==",h)));n.empty||a(n.docs[0].data().title);const r=(0,Dt.rJ)(wt.db,"quizzes"),i=(0,Dt.P)(r,(0,Dt._M)("categoryId","==",h)),l=(await(0,Dt.GG)(i)).docs.map((e=>(0,o.A)((0,o.A)({id:e.id},e.data()),{},{level:e.data().difficulty||"beginner"})));t(l),s(l),c(!1)}catch(e){console.error("Error fetching quizzes:",e),c(!1)}})()}),[h]),(0,r.useEffect)((()=>{s("all"===u?e:e.filter((e=>e.difficulty===u)))}),[u,e]);const f=e=>{switch(e){case"beginner":return"bg-green-100 text-green-700";case"intermediate":return"bg-blue-100 text-blue-700";case"advanced":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-700"}};return(0,Et.jsxs)("div",{className:"flex-1 p-4",children:[(0,Et.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Et.jsx)("button",{className:"mr-2 p-2 hover:bg-gray-100 rounded-full",onClick:()=>m("/knowledge"),children:(0,Et.jsx)(op,{size:20})}),(0,Et.jsx)("h1",{className:"text-xl font-bold",children:i||"Quizzes"})]}),(0,Et.jsxs)("div",{className:"mb-4 bg-white p-3 rounded-lg shadow",children:[(0,Et.jsxs)("div",{className:"flex items-center mb-2",children:[(0,Et.jsx)(qf,{size:16,className:"mr-2 text-gray-500"}),(0,Et.jsx)("span",{className:"text-sm font-medium",children:"Filter by Level:"})]}),(0,Et.jsx)("div",{className:"flex flex-wrap gap-2",children:[{id:"all",label:"All Levels"},{id:"beginner",label:"Beginner"},{id:"intermediate",label:"Intermediate"},{id:"advanced",label:"Advanced"}].map((e=>(0,Et.jsx)("button",{onClick:()=>(e=>{d(e)})(e.id),className:"px-3 py-1 text-sm rounded-full transition-colors ".concat(u===e.id?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e.label},e.id)))})]}),l?(0,Et.jsx)("div",{className:"flex justify-center mt-8",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,Et.jsx)("div",{className:"mt-4 space-y-3",children:n.length>0?n.map((e=>(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 flex justify-between items-center hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>{return!e.locked&&(t=e.id,void m("/knowledge/quiz/".concat(t)));var t},children:[(0,Et.jsxs)("div",{children:[(0,Et.jsx)("h3",{className:"font-medium ".concat(e.locked?"text-gray-400":""),children:e.title}),(0,Et.jsxs)("div",{className:"flex items-center mt-1",children:[(0,Et.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat(f(e.difficulty)),children:e.difficulty?e.difficulty.charAt(0).toUpperCase()+e.difficulty.slice(1):"Beginner"}),(0,Et.jsx)("span",{className:"mx-2 text-gray-300",children:"\u2022"}),(0,Et.jsxs)("p",{className:"text-sm text-gray-500",children:[e.questionCount||0," questions"]})]})]}),(0,Et.jsx)("div",{className:"flex items-center",children:e.completed?(0,Et.jsx)(Ef,{size:20,className:"text-green-500"}):e.locked?(0,Et.jsx)(zc,{size:20,className:"text-gray-400"}):(0,Et.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 text-sm rounded-full",children:"Start"})})]},e.id))):(0,Et.jsx)("div",{className:"text-center p-6 bg-gray-50 rounded-lg",children:(0,Et.jsx)("p",{className:"text-gray-500",children:e.length>0?"No quizzes available for the selected level.":"No quizzes available in this category yet."})})})]})},Fp=Mt("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),_p=()=>{const[e,t]=(0,r.useState)(null),[n,s]=(0,r.useState)(0),[i,a]=(0,r.useState)(null),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)([]),[d,h]=(0,r.useState)(!0),[m,f]=(0,r.useState)(!0),{quizId:p}=he(),{user:g}=kt(),v=de();(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.H9)(wt.db,"quizzes",p),n=await(0,Dt.x7)(e);n.exists()?t(n.data()):console.error("Quiz not found"),h(!1)}catch(e){console.error("Error fetching quiz:",e),h(!1)}})()}),[p]);const x=async(t,n,r)=>{try{const s=(0,Dt.H9)(wt.db,"profiles",g.uid);await(0,Dt.mZ)(s,{quizHistory:(0,Dt.hq)({quizId:p,quizTitle:e.title,score:t,correctAnswers:n,totalQuestions:r,completedAt:(new Date).toISOString()}),totalQuizzesCompleted:(0,Dt.GV)(1)});const i=(0,Dt.H9)(wt.db,"quizzes",p);await(0,Dt.mZ)(i,{completedBy:(0,Dt.hq)(g.uid)})}catch(s){console.error("Error saving quiz results:",s)}};if(d)return(0,Et.jsx)("div",{className:"flex-1 flex justify-center items-center p-4",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});if(!e||!e.questions||0===e.questions.length)return(0,Et.jsx)("div",{className:"flex-1 p-4",children:(0,Et.jsxs)("div",{className:"text-center p-6 bg-gray-50 rounded-lg",children:[(0,Et.jsx)("p",{className:"text-gray-500",children:"This quiz is not available or has no questions."}),(0,Et.jsx)("button",{className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg",onClick:()=>v("/knowledge"),children:"Back to Knowledge Hub"})]})});const y=e.questions[n],b=n===e.questions.length-1;return(0,Et.jsxs)("div",{className:"flex-1 p-4",children:[(0,Et.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Et.jsx)("button",{className:"mr-2 p-2 hover:bg-gray-100 rounded-full",onClick:()=>v("/knowledge"),children:(0,Et.jsx)(op,{size:20})}),(0,Et.jsx)("h1",{className:"text-xl font-bold",children:e.title})]}),(0,Et.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-6",children:(0,Et.jsx)("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:"".concat(n/e.questions.length*100,"%")}})}),(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-4",children:[(0,Et.jsxs)("p",{className:"text-gray-500 mb-2 text-sm",children:["Question ",n+1," of ",e.questions.length]}),(0,Et.jsx)("h2",{className:"text-lg font-medium mb-6",children:y.question}),y.imageUrl&&(0,Et.jsx)("div",{className:"mb-4",children:(0,Et.jsx)("img",{src:y.imageUrl,alt:"Question",className:"w-full max-h-60 object-contain rounded-lg shadow-md"})}),(0,Et.jsx)("div",{className:"space-y-3",children:y.answers.map(((t,r)=>(0,Et.jsx)("div",{className:"p-3 border rounded-lg cursor-pointer transition-colors ".concat(i===r?r===y.correctAnswer?"bg-green-50 border-green-300":"bg-red-50 border-red-300":"hover:bg-gray-50"),onClick:()=>(t=>{if(o)return;a(t),l(!0);const r=t===e.questions[n].correctAnswer;u([...c,{questionIndex:n,selectedAnswer:t,isCorrect:r}])})(r),children:t},r)))}),o&&y.explanation&&(0,Et.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg flex items-start",children:[(0,Et.jsx)(Fp,{size:20,className:"text-blue-500 mr-2 mt-0.5 flex-shrink-0"}),(0,Et.jsx)("p",{className:"text-blue-700 text-sm",children:y.explanation})]})]}),(0,Et.jsxs)("div",{className:"flex justify-between items-center",children:[b&&o?(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)("input",{type:"checkbox",id:"leaderboardOption",checked:m,onChange:e=>f(e.target.checked),className:"mr-2 h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),(0,Et.jsxs)("label",{htmlFor:"leaderboardOption",className:"text-sm text-gray-600 flex items-center",children:[(0,Et.jsx)(rn,{size:16,className:"mr-1 text-blue-500"}),"Include my score on the leaderboard"]})]}):(0,Et.jsx)("div",{}),(0,Et.jsx)("button",{className:"px-6 py-2 rounded-lg font-medium ".concat(o?"bg-blue-600 text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"),onClick:()=>{if(n<e.questions.length-1)s(n+1),a(null),l(!1);else{const t=c.filter((e=>e.isCorrect)).length,n=e.questions.length,r=Math.round(t/n*100);x(r,t,n),v("/knowledge/results",{state:{quizId:p,categoryId:e.categoryId,score:r,correctAnswers:t,totalQuestions:n,userAnswers:c,quizTitle:e.title,includeInLeaderboard:m}})}},disabled:!o,children:n<e.questions.length-1?"Next Question":"Finish Quiz"})]})]})},Tp=()=>{const e=le(),t=de(),{user:n}=kt(),[s,i]=(0,r.useState)(!1),{score:a,correctAnswers:o,totalQuestions:l,quizTitle:c,quizId:u,categoryId:d,includeInLeaderboard:h=!0}=e.state||{};(0,r.useEffect)((()=>(localStorage.setItem("justCompletedQuiz","true"),()=>{})),[]),(0,r.useEffect)((()=>{a||0===a||t("/knowledge")}),[a,t]);const m=(e=>e>=90?{icon:(0,Et.jsx)(rn,{size:40,className:"text-yellow-500"}),text:"Expert"}:e>=75?{icon:(0,Et.jsx)(rn,{size:40,className:"text-blue-500"}),text:"Advanced"}:e>=60?{icon:(0,Et.jsx)(rn,{size:40,className:"text-green-500"}),text:"Proficient"}:{icon:(0,Et.jsx)(rn,{size:40,className:"text-gray-500"}),text:"Beginner"})(a);if((0,r.useEffect)((()=>{(async()=>{if(a&&u&&d&&h)try{const e=(0,Dt.rJ)(wt.db,"quizResults");await(0,Dt.gS)(e,{userId:n.uid,quizId:u,categoryId:d,score:a,completedAt:new Date,timestamp:Dt.Dc.now()})}catch(e){console.error("Error saving to leaderboard:",e)}})()}),[a,u,d,n.uid,h]),!a&&0!==a)return(0,Et.jsx)("div",{className:"flex-1 flex justify-center items-center p-4",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})});const f=a>=75;return(0,Et.jsxs)("div",{className:"flex-1 p-4",children:[(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 text-center mb-6",children:[(0,Et.jsx)("h1",{className:"text-xl font-bold mb-1",children:c}),(0,Et.jsx)("p",{className:"text-gray-500 mb-6",children:"Quiz Completed"}),(0,Et.jsx)("div",{className:"flex justify-center mb-6",children:(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("div",{className:"w-28 h-28 rounded-full flex items-center justify-center border-8 border-blue-100",children:(0,Et.jsxs)("span",{className:"text-3xl font-bold text-blue-600",children:[a,"%"]})}),(0,Et.jsx)("div",{className:"absolute -right-2 -bottom-2 bg-white rounded-full p-1",children:m.icon})]})}),(0,Et.jsx)("p",{className:"font-medium text-lg mb-1",children:f?"Congratulations!":"Good effort!"}),(0,Et.jsx)("p",{className:"text-gray-600 mb-6",children:f?"You've mastered this topic!":"Keep learning and try again to improve your score."}),(0,Et.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[(0,Et.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,Et.jsx)("div",{className:"flex justify-center mb-2",children:(0,Et.jsx)(Ef,{size:24,className:"text-green-500"})}),(0,Et.jsx)("p",{className:"font-bold text-green-800",children:o}),(0,Et.jsx)("p",{className:"text-sm text-green-600",children:"Correct"})]}),(0,Et.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,Et.jsx)("div",{className:"flex justify-center mb-2",children:(0,Et.jsx)(Af,{size:24,className:"text-red-500"})}),(0,Et.jsx)("p",{className:"font-bold text-red-800",children:l-o}),(0,Et.jsx)("p",{className:"text-sm text-red-600",children:"Incorrect"})]})]}),(0,Et.jsx)("div",{className:"mb-8",children:(0,Et.jsxs)(Kc,{onClick:()=>{const e="I scored ".concat(a,'% on the "').concat(c,'" quiz! #SCUBADiving #KnowledgeHub');navigator.share?navigator.share({title:"SCUBA Knowledge Quiz Results",text:e,url:window.location.href}).catch((e=>{console.error("Error sharing:",e)})):navigator.clipboard.writeText(e).then((()=>{alert("Results copied to clipboard!")}))},variant:"outline",className:"flex items-center space-x-2",children:[(0,Et.jsx)(Ep,{size:16}),(0,Et.jsx)("span",{children:"Share Results"})]})}),(0,Et.jsxs)("div",{className:"space-y-3",children:[(0,Et.jsx)(Kc,{onClick:()=>t("/knowledge"),className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg font-medium",children:"Return to Knowledge Hub"}),!f&&(0,Et.jsx)(Kc,{onClick:()=>t(-2),variant:"outline",className:"w-full px-4 py-3 border border-blue-600 text-blue-600 rounded-lg font-medium",children:"Try Again"})]})]}),h&&u&&d&&(0,Et.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[(0,Et.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Et.jsxs)("h2",{className:"font-semibold flex items-center text-lg",children:[(0,Et.jsx)(xp,{size:20,className:"text-blue-500 mr-2"}),"Leaderboard"]}),(0,Et.jsx)(Kc,{variant:"ghost",onClick:()=>i(!s),size:"sm",children:s?"Hide":"Show"})]}),s&&(0,Et.jsx)(Ap,{quizId:u,categoryId:d}),!s&&(0,Et.jsx)("p",{className:"text-center text-gray-500 py-4",children:'Click "Show" to view the leaderboard and see how you compare.'})]})]})},Ip=()=>(0,Et.jsxs)(Fe,{children:[(0,Et.jsx)(ke,{path:"/",element:(0,Et.jsx)(kp,{})}),(0,Et.jsx)(ke,{path:"/category/:categoryId",element:(0,Et.jsx)(Sp,{})}),(0,Et.jsx)(ke,{path:"/quiz/:quizId",element:(0,Et.jsx)(_p,{})}),(0,Et.jsx)(ke,{path:"/results",element:(0,Et.jsx)(Tp,{})})]}),Rp=Mt("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]),Pp=e=>{let{title:t,description:n,icon:r,category:s,onClick:i}=e;const a=()=>{switch(r){case"book":default:return(0,Et.jsx)(vu,{size:24,className:"text-blue-500"});case"compass":return(0,Et.jsx)(yu,{size:24,className:"text-blue-500"});case"flask":return(0,Et.jsx)(bu,{size:24,className:"text-blue-500"});case"droplet":return(0,Et.jsx)(Kt,{size:24,className:"text-blue-500"});case"thermometer":return(0,Et.jsx)(xi,{size:24,className:"text-blue-500"});case"waves":return(0,Et.jsx)(Rp,{size:24,className:"text-blue-500"});case"shield-alert":return(0,Et.jsx)(qt,{size:24,className:"text-blue-500"});case"anchor":return(0,Et.jsx)(xu,{size:24,className:"text-blue-500"})}};return(0,Et.jsx)("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-4 cursor-pointer",onClick:i,children:(0,Et.jsxs)("div",{className:"flex items-start",children:[(0,Et.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg mr-4",children:(0,Et.jsx)(a,{})}),(0,Et.jsxs)("div",{className:"flex-1",children:[(0,Et.jsx)("h3",{className:"font-semibold text-gray-900",children:t}),(0,Et.jsx)("p",{className:"text-sm text-gray-600 mb-1 line-clamp-2",children:n}),(0,Et.jsx)("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full inline-block",children:s})]}),(0,Et.jsx)(hs,{size:20,className:"text-gray-400 self-center"})]})})},Op=()=>{const[e,t]=(0,r.useState)([]),[n,s]=(0,r.useState)([]),[i,a]=(0,r.useState)(!0),[l,c]=(0,r.useState)(""),[u,d]=(0,r.useState)("all"),h=de();(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.rJ)(wt.db,"learningResources"),n=(await(0,Dt.GG)(e)).docs.map((e=>(0,o.A)({id:e.id},e.data()))),r=[...new Set(n.map((e=>e.category)))];t(n),s(r),a(!1)}catch(e){console.error("Error fetching resources:",e),a(!1)}})()}),[]);const m=e.filter((e=>{const t=e.title.toLowerCase().includes(l.toLowerCase())||e.description.toLowerCase().includes(l.toLowerCase()),n="all"===u||e.category===u;return t&&n}));return(0,Et.jsxs)("div",{className:"flex-1 p-4",children:[(0,Et.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Et.jsx)("button",{className:"mr-2 p-2 hover:bg-gray-100 rounded-full",onClick:()=>h("/knowledge"),children:(0,Et.jsx)(op,{size:20})}),(0,Et.jsx)("h1",{className:"text-2xl font-bold",children:"Learning Resources"})]}),(0,Et.jsx)("p",{className:"text-gray-600 mb-6",children:"Expand your diving knowledge with these comprehensive guides and references."}),(0,Et.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,Et.jsxs)("div",{className:"relative flex-1",children:[(0,Et.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Et.jsx)(Hc,{size:18,className:"text-gray-400"})}),(0,Et.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Search resources..."})]}),(0,Et.jsx)("div",{className:"sm:w-64",children:(0,Et.jsxs)("div",{className:"relative",children:[(0,Et.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,Et.jsx)(qf,{size:18,className:"text-gray-400"})}),(0,Et.jsxs)("select",{value:u,onChange:e=>d(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",children:[(0,Et.jsx)("option",{value:"all",children:"All Categories"}),n.map((e=>(0,Et.jsx)("option",{value:e,children:e},e)))]})]})})]}),i?(0,Et.jsx)("div",{className:"flex justify-center py-8",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):m.length>0?(0,Et.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.map((e=>(0,Et.jsx)(Pp,{title:e.title,description:e.description,icon:e.icon,category:e.category,onClick:()=>{return t=e.id,void h("/knowledge/resources/".concat(t));var t}},e.id)))}):(0,Et.jsxs)("div",{className:"text-center p-8 bg-gray-50 rounded-lg",children:[(0,Et.jsx)(vu,{size:48,className:"mx-auto mb-4 text-gray-400"}),(0,Et.jsx)("p",{className:"text-gray-500",children:l||"all"!==u?"No resources match your search criteria. Try adjusting your filters.":"No learning resources available yet. Check back soon!"})]})]})},Mp=Mt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]),Lp=Mt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);const Bp=/^(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[\$0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088E\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC4\uDEFC-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]|\uDB40[\uDD00-\uDDEF])*$/,zp=/^(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD23\uDD4A-\uDD65\uDD6F-\uDD85\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF1C\uDF27\uDF30-\uDF45\uDF70-\uDF81\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDEB8\uDF00-\uDF1A\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCDF\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE70-\uDEBE\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDE40-\uDE7F\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB]|\uD839[\uDCD0-\uDCEB\uDDD0-\uDDED\uDDF0\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43\uDD4B]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])(?:[\$\x2D0-9A-Z_a-z\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u07FD\u0800-\u082D\u0840-\u085B\u0860-\u086A\u0870-\u0887\u0889-\u088E\u0897-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u09FE\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3C-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECE\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1715\u171F-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B4C\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CD0-\u1CD2\u1CD4-\u1CFA\u1D00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA827\uA82C\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF65-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDD00-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69-\uDD6D\uDD6F-\uDD85\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC4\uDEFC-\uDF1C\uDF27\uDF30-\uDF50\uDF70-\uDF85\uDFB0-\uDFC4\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC46\uDC66-\uDC75\uDC7F-\uDCBA\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDC9-\uDDCC\uDDCE-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3B-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC-\uDFD3\uDFE1\uDFE2]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC5E-\uDC61\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2B\uDF30-\uDF39\uDF40-\uDF46]|\uD806[\uDC00-\uDC3A\uDCA0-\uDCE9\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B-\uDD43\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDE1\uDDE3\uDDE4\uDE00-\uDE3E\uDE47\uDE50-\uDE99\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF42\uDF50-\uDF5A\uDFB0]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC40-\uDC55\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE7F\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFE4\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD833[\uDCF0-\uDCF9\uDF00-\uDF2D\uDF30-\uDF46]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD30-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAE\uDEC0-\uDEF9]|\uD839[\uDCD0-\uDCF9\uDDD0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4B\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]|\uDB40[\uDD00-\uDDEF])*$/,Up={};function qp(e,t){return((t||Up).jsx?zp:Bp).test(e)}const Vp=/[ \t\n\f\r]/g;function Hp(e){return""===e.replace(Vp,"")}class Wp{constructor(e,t,n){this.normal=t,this.property=e,n&&(this.space=n)}}function Gp(e,t){const n={},r={};for(const s of e)Object.assign(n,s.property),Object.assign(r,s.normal);return new Wp(n,r,t)}function Kp(e){return e.toLowerCase()}Wp.prototype.normal={},Wp.prototype.property={},Wp.prototype.space=void 0;class Qp{constructor(e,t){this.attribute=t,this.property=e}}Qp.prototype.attribute="",Qp.prototype.booleanish=!1,Qp.prototype.boolean=!1,Qp.prototype.commaOrSpaceSeparated=!1,Qp.prototype.commaSeparated=!1,Qp.prototype.defined=!1,Qp.prototype.mustUseProperty=!1,Qp.prototype.number=!1,Qp.prototype.overloadedBoolean=!1,Qp.prototype.property="",Qp.prototype.spaceSeparated=!1,Qp.prototype.space=void 0;let Yp=0;const Jp=rg(),Xp=rg(),$p=rg(),Zp=rg(),eg=rg(),tg=rg(),ng=rg();function rg(){return 2**++Yp}const sg=Object.keys(e);class ig extends Qp{constructor(t,n,r,s){let i=-1;if(super(t,n),ag(this,"space",s),"number"===typeof r)for(;++i<sg.length;){const t=sg[i];ag(this,sg[i],(r&e[t])===e[t])}}}function ag(e,t,n){n&&(e[t]=n)}function og(e){const t={},n={};for(const[r,s]of Object.entries(e.properties)){const i=new ig(r,e.transform(e.attributes||{},r),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),t[r]=i,n[Kp(r)]=r,n[Kp(i.attribute)]=r}return new Wp(t,n,e.space)}ig.prototype.defined=!0;const lg=og({properties:{ariaActiveDescendant:null,ariaAtomic:Xp,ariaAutoComplete:null,ariaBusy:Xp,ariaChecked:Xp,ariaColCount:Zp,ariaColIndex:Zp,ariaColSpan:Zp,ariaControls:eg,ariaCurrent:null,ariaDescribedBy:eg,ariaDetails:null,ariaDisabled:Xp,ariaDropEffect:eg,ariaErrorMessage:null,ariaExpanded:Xp,ariaFlowTo:eg,ariaGrabbed:Xp,ariaHasPopup:null,ariaHidden:Xp,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:eg,ariaLevel:Zp,ariaLive:null,ariaModal:Xp,ariaMultiLine:Xp,ariaMultiSelectable:Xp,ariaOrientation:null,ariaOwns:eg,ariaPlaceholder:null,ariaPosInSet:Zp,ariaPressed:Xp,ariaReadOnly:Xp,ariaRelevant:null,ariaRequired:Xp,ariaRoleDescription:eg,ariaRowCount:Zp,ariaRowIndex:Zp,ariaRowSpan:Zp,ariaSelected:Xp,ariaSetSize:Zp,ariaSort:null,ariaValueMax:Zp,ariaValueMin:Zp,ariaValueNow:Zp,ariaValueText:null,role:null},transform:(e,t)=>"role"===t?t:"aria-"+t.slice(4).toLowerCase()});function cg(e,t){return t in e?e[t]:t}function ug(e,t){return cg(e,t.toLowerCase())}const dg=og({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:tg,acceptCharset:eg,accessKey:eg,action:null,allow:null,allowFullScreen:Jp,allowPaymentRequest:Jp,allowUserMedia:Jp,alt:null,as:null,async:Jp,autoCapitalize:null,autoComplete:eg,autoFocus:Jp,autoPlay:Jp,blocking:eg,capture:null,charSet:null,checked:Jp,cite:null,className:eg,cols:Zp,colSpan:null,content:null,contentEditable:Xp,controls:Jp,controlsList:eg,coords:Zp|tg,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Jp,defer:Jp,dir:null,dirName:null,disabled:Jp,download:$p,draggable:Xp,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Jp,formTarget:null,headers:eg,height:Zp,hidden:$p,high:Zp,href:null,hrefLang:null,htmlFor:eg,httpEquiv:eg,id:null,imageSizes:null,imageSrcSet:null,inert:Jp,inputMode:null,integrity:null,is:null,isMap:Jp,itemId:null,itemProp:eg,itemRef:eg,itemScope:Jp,itemType:eg,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Jp,low:Zp,manifest:null,max:null,maxLength:Zp,media:null,method:null,min:null,minLength:Zp,multiple:Jp,muted:Jp,name:null,nonce:null,noModule:Jp,noValidate:Jp,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Jp,optimum:Zp,pattern:null,ping:eg,placeholder:null,playsInline:Jp,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Jp,referrerPolicy:null,rel:eg,required:Jp,reversed:Jp,rows:Zp,rowSpan:Zp,sandbox:eg,scope:null,scoped:Jp,seamless:Jp,selected:Jp,shadowRootClonable:Jp,shadowRootDelegatesFocus:Jp,shadowRootMode:null,shape:null,size:Zp,sizes:null,slot:null,span:Zp,spellCheck:Xp,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Zp,step:null,style:null,tabIndex:Zp,target:null,title:null,translate:null,type:null,typeMustMatch:Jp,useMap:null,value:Xp,width:Zp,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:eg,axis:null,background:null,bgColor:null,border:Zp,borderColor:null,bottomMargin:Zp,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Jp,declare:Jp,event:null,face:null,frame:null,frameBorder:null,hSpace:Zp,leftMargin:Zp,link:null,longDesc:null,lowSrc:null,marginHeight:Zp,marginWidth:Zp,noResize:Jp,noHref:Jp,noShade:Jp,noWrap:Jp,object:null,profile:null,prompt:null,rev:null,rightMargin:Zp,rules:null,scheme:null,scrolling:Xp,standby:null,summary:null,text:null,topMargin:Zp,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Zp,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Jp,disableRemotePlayback:Jp,prefix:null,property:null,results:Zp,security:null,unselectable:null},space:"html",transform:ug}),hg=og({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:ng,accentHeight:Zp,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Zp,amplitude:Zp,arabicForm:null,ascent:Zp,attributeName:null,attributeType:null,azimuth:Zp,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Zp,by:null,calcMode:null,capHeight:Zp,className:eg,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Zp,diffuseConstant:Zp,direction:null,display:null,dur:null,divisor:Zp,dominantBaseline:null,download:Jp,dx:null,dy:null,edgeMode:null,editable:null,elevation:Zp,enableBackground:null,end:null,event:null,exponent:Zp,externalResourcesRequired:null,fill:null,fillOpacity:Zp,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:tg,g2:tg,glyphName:tg,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Zp,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Zp,horizOriginX:Zp,horizOriginY:Zp,id:null,ideographic:Zp,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Zp,k:Zp,k1:Zp,k2:Zp,k3:Zp,k4:Zp,kernelMatrix:ng,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Zp,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Zp,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Zp,overlineThickness:Zp,paintOrder:null,panose1:null,path:null,pathLength:Zp,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:eg,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Zp,pointsAtY:Zp,pointsAtZ:Zp,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:ng,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:ng,rev:ng,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:ng,requiredFeatures:ng,requiredFonts:ng,requiredFormats:ng,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Zp,specularExponent:Zp,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Zp,strikethroughThickness:Zp,string:null,stroke:null,strokeDashArray:ng,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Zp,strokeOpacity:Zp,strokeWidth:null,style:null,surfaceScale:Zp,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:ng,tabIndex:Zp,tableValues:null,target:null,targetX:Zp,targetY:Zp,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:ng,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Zp,underlineThickness:Zp,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Zp,values:null,vAlphabetic:Zp,vMathematical:Zp,vectorEffect:null,vHanging:Zp,vIdeographic:Zp,version:null,vertAdvY:Zp,vertOriginX:Zp,vertOriginY:Zp,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Zp,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:cg}),mg=og({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform:(e,t)=>"xlink:"+t.slice(5).toLowerCase()}),fg=og({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:ug}),pg=og({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform:(e,t)=>"xml:"+t.slice(3).toLowerCase()}),gg=Gp([lg,dg,mg,fg,pg],"html"),vg=Gp([lg,hg,mg,fg,pg],"svg"),xg=/[A-Z]/g,yg=/-[a-z]/g,bg=/^data[-\w.:]+$/i;function wg(e){return"-"+e.toLowerCase()}function Dg(e){return e.charAt(1).toUpperCase()}const Ng={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"};var jg=n(7294);const Cg=Ag("end"),Eg=Ag("start");function Ag(e){return function(t){const n=t&&t.position&&t.position[e]||{};if("number"===typeof n.line&&n.line>0&&"number"===typeof n.column&&n.column>0)return{line:n.line,column:n.column,offset:"number"===typeof n.offset&&n.offset>-1?n.offset:void 0}}}function kg(e){return e&&"object"===typeof e?"position"in e||"type"in e?Fg(e.position):"start"in e||"end"in e?Fg(e):"line"in e||"column"in e?Sg(e):"":""}function Sg(e){return _g(e&&e.line)+":"+_g(e&&e.column)}function Fg(e){return Sg(e&&e.start)+"-"+Sg(e&&e.end)}function _g(e){return e&&"number"===typeof e?e:1}class Tg extends Error{constructor(e,t,n){super(),"string"===typeof t&&(n=t,t=void 0);let r="",s={},i=!1;if(t&&(s="line"in t&&"column"in t||"start"in t&&"end"in t?{place:t}:"type"in t?{ancestors:[t],place:t.position}:(0,o.A)({},t)),"string"===typeof e?r=e:!s.cause&&e&&(i=!0,r=e.message,s.cause=e),!s.ruleId&&!s.source&&"string"===typeof n){const e=n.indexOf(":");-1===e?s.ruleId=n:(s.source=n.slice(0,e),s.ruleId=n.slice(e+1))}if(!s.place&&s.ancestors&&s.ancestors){const e=s.ancestors[s.ancestors.length-1];e&&(s.place=e.position)}const a=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=a?a.column:void 0,this.fatal=void 0,this.file,this.message=r,this.line=a?a.line:void 0,this.name=kg(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=i&&s.cause&&"string"===typeof s.cause.stack?s.cause.stack:"",this.actual,this.expected,this.note,this.url}}Tg.prototype.file="",Tg.prototype.name="",Tg.prototype.reason="",Tg.prototype.message="",Tg.prototype.stack="",Tg.prototype.column=void 0,Tg.prototype.line=void 0,Tg.prototype.ancestors=void 0,Tg.prototype.cause=void 0,Tg.prototype.fatal=void 0,Tg.prototype.place=void 0,Tg.prototype.ruleId=void 0,Tg.prototype.source=void 0;const Ig={}.hasOwnProperty,Rg=new Map,Pg=/[A-Z]/g,Og=new Set(["table","tbody","thead","tfoot","tr"]),Mg=new Set(["td","th"]),Lg="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Bg(e,t){if(!t||void 0===t.Fragment)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if("function"!==typeof t.jsxDEV)throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=function(e,t){return n;function n(n,r,s,i){const a=Array.isArray(s.children),o=Eg(n);return t(r,s,i,a,{columnNumber:o?o.column-1:void 0,fileName:e,lineNumber:o?o.line:void 0},void 0)}}(n,t.jsxDEV)}else{if("function"!==typeof t.jsx)throw new TypeError("Expected `jsx` in production options");if("function"!==typeof t.jsxs)throw new TypeError("Expected `jsxs` in production options");r=function(e,t,n){return r;function r(e,r,s,i){const a=Array.isArray(s.children)?n:t;return i?a(r,s,i):a(r,s)}}(0,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:!1!==t.passKeys,passNode:t.passNode||!1,schema:"svg"===t.space?vg:gg,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:!1!==t.tableCellAlignToStyle},i=zg(s,e,void 0);return i&&"string"!==typeof i?i:s.create(e,s.Fragment,{children:i||void 0},void 0)}function zg(e,t,n){return"element"===t.type?function(e,t,n){const r=e.schema;let s=r;"svg"===t.tagName.toLowerCase()&&"html"===r.space&&(s=vg,e.schema=s);e.ancestors.push(t);const i=Wg(e,t.tagName,!1),a=function(e,t){const n={};let r,s;for(s in t.properties)if("children"!==s&&Ig.call(t.properties,s)){const i=Hg(e,s,t.properties[s]);if(i){const[s,a]=i;e.tableCellAlignToStyle&&"align"===s&&"string"===typeof a&&Mg.has(t.tagName)?r=a:n[s]=a}}if(r){(n.style||(n.style={}))["css"===e.stylePropertyNameCase?"text-align":"textAlign"]=r}return n}(e,t);let o=Vg(e,t);Og.has(t.tagName)&&(o=o.filter((function(e){return"string"!==typeof e||!("object"===typeof(t=e)?"text"===t.type&&Hp(t.value):Hp(t));var t})));return Ug(e,a,i,t),qg(a,o),e.ancestors.pop(),e.schema=r,e.create(t,i,a,n)}(e,t,n):"mdxFlowExpression"===t.type||"mdxTextExpression"===t.type?function(e,t){if(t.data&&t.data.estree&&e.evaluater){const n=t.data.estree.body[0];return n.type,e.evaluater.evaluateExpression(n.expression)}Gg(e,t.position)}(e,t):"mdxJsxFlowElement"===t.type||"mdxJsxTextElement"===t.type?function(e,t,n){const r=e.schema;let s=r;"svg"===t.name&&"html"===r.space&&(s=vg,e.schema=s);e.ancestors.push(t);const i=null===t.name?e.Fragment:Wg(e,t.name,!0),a=function(e,t){const n={};for(const r of t.attributes)if("mdxJsxExpressionAttribute"===r.type)if(r.data&&r.data.estree&&e.evaluater){const t=r.data.estree.body[0];t.type;const s=t.expression;s.type;const i=s.properties[0];i.type,Object.assign(n,e.evaluater.evaluateExpression(i.argument))}else Gg(e,t.position);else{const s=r.name;let i;if(r.value&&"object"===typeof r.value)if(r.value.data&&r.value.data.estree&&e.evaluater){const t=r.value.data.estree.body[0];t.type,i=e.evaluater.evaluateExpression(t.expression)}else Gg(e,t.position);else i=null===r.value||r.value;n[s]=i}return n}(e,t),o=Vg(e,t);return Ug(e,a,i,t),qg(a,o),e.ancestors.pop(),e.schema=r,e.create(t,i,a,n)}(e,t,n):"mdxjsEsm"===t.type?function(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Gg(e,t.position)}(e,t):"root"===t.type?function(e,t,n){const r={};return qg(r,Vg(e,t)),e.create(t,e.Fragment,r,n)}(e,t,n):"text"===t.type?function(e,t){return t.value}(0,t):void 0}function Ug(e,t,n,r){"string"!==typeof n&&n!==e.Fragment&&e.passNode&&(t.node=r)}function qg(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function Vg(e,t){const n=[];let r=-1;const s=e.passKeys?new Map:Rg;for(;++r<t.children.length;){const i=t.children[r];let a;if(e.passKeys){const e="element"===i.type?i.tagName:"mdxJsxFlowElement"===i.type||"mdxJsxTextElement"===i.type?i.name:void 0;if(e){const t=s.get(e)||0;a=e+"-"+t,s.set(e,t+1)}}const o=zg(e,i,a);void 0!==o&&n.push(o)}return n}function Hg(e,t,n){const r=function(e,t){const n=Kp(t);let r=t,s=Qp;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&"data"===n.slice(0,4)&&bg.test(t)){if("-"===t.charAt(4)){const e=t.slice(5).replace(yg,Dg);r="data"+e.charAt(0).toUpperCase()+e.slice(1)}else{const e=t.slice(4);if(!yg.test(e)){let n=e.replace(xg,wg);"-"!==n.charAt(0)&&(n="-"+n),t="data"+n}}s=ig}return new s(r,t)}(e.schema,t);if(!(null===n||void 0===n||"number"===typeof n&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?function(e,t){const n=t||{};return(""===e[e.length-1]?[...e,""]:e).join((n.padRight?" ":"")+","+(!1===n.padLeft?"":" ")).trim()}(n):n.join(" ").trim()),"style"===r.property){let t="object"===typeof n?n:function(e,t){try{return jg(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const t=n,r=new Tg("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:t,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw r.file=e.filePath||void 0,r.url=Lg+"#cannot-parse-style-attribute",r}}(e,String(n));return"css"===e.stylePropertyNameCase&&(t=function(e){const t={};let n;for(n in e)Ig.call(e,n)&&(t[Kg(n)]=e[n]);return t}(t)),["style",t]}return["react"===e.elementAttributeNameCase&&r.space?Ng[r.property]||r.property:r.attribute,n]}}function Wg(e,t,n){let r;if(n)if(t.includes(".")){const e=t.split(".");let n,s=-1;for(;++s<e.length;){const t=qp(e[s])?{type:"Identifier",name:e[s]}:{type:"Literal",value:e[s]};n=n?{type:"MemberExpression",object:n,property:t,computed:Boolean(s&&"Literal"===t.type),optional:!1}:t}r=n}else r=qp(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};else r={type:"Literal",value:t};if("Literal"===r.type){const t=r.value;return Ig.call(e.components,t)?e.components[t]:t}if(e.evaluater)return e.evaluater.evaluateExpression(r);Gg(e)}function Gg(e,t){const n=new Tg("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=Lg+"#cannot-handle-mdx-estrees-without-createevaluater",n}function Kg(e){let t=e.replace(Pg,Qg);return"ms-"===t.slice(0,3)&&(t="-"+t),t}function Qg(e){return"-"+e.toLowerCase()}const Yg={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},Jg={};function Xg(e,t,n){if(function(e){return Boolean(e&&"object"===typeof e)}(e)){if("value"in e)return"html"!==e.type||n?e.value:"";if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return $g(e.children,t,n)}return Array.isArray(e)?$g(e,t,n):""}function $g(e,t,n){const r=[];let s=-1;for(;++s<e.length;)r[s]=Xg(e[s],t,n);return r.join("")}function Zg(e,t,n,r){const s=e.length;let i,a=0;if(t=t<0?-t>s?0:s+t:t>s?s:t,n=n>0?n:0,r.length<1e4)i=Array.from(r),i.unshift(t,n),e.splice(...i);else for(n&&e.splice(t,n);a<r.length;)i=r.slice(a,a+1e4),i.unshift(t,0),e.splice(...i),a+=1e4,t+=1e4}function ev(e,t){return e.length>0?(Zg(e,e.length,0,t),e):t}class tv{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,t){const n=null===t||void 0===t?Number.POSITIVE_INFINITY:t;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,t,n){const r=t||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return n&&nv(this.left,n),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),nv(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),nv(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&0===this.right.length||e<0&&0===this.left.length))if(e<this.left.length){const t=this.left.splice(e,Number.POSITIVE_INFINITY);nv(this.right,t.reverse())}else{const t=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);nv(this.left,t.reverse())}}}function nv(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function rv(e){const t={};let n,r,s,i,a,l,c,u=-1;const d=new tv(e);for(;++u<d.length;){for(;u in t;)u=t[u];if(n=d.get(u),u&&"chunkFlow"===n[1].type&&"listItemPrefix"===d.get(u-1)[1].type&&(l=n[1]._tokenizer.events,s=0,s<l.length&&"lineEndingBlank"===l[s][1].type&&(s+=2),s<l.length&&"content"===l[s][1].type))for(;++s<l.length&&"content"!==l[s][1].type;)"chunkText"===l[s][1].type&&(l[s][1]._isInFirstContentOfListItem=!0,s++);if("enter"===n[0])n[1].contentType&&(Object.assign(t,sv(d,u)),u=t[u],c=!0);else if(n[1]._container){for(s=u,r=void 0;s--;)if(i=d.get(s),"lineEnding"===i[1].type||"lineEndingBlank"===i[1].type)"enter"===i[0]&&(r&&(d.get(r)[1].type="lineEndingBlank"),i[1].type="lineEnding",r=s);else if("linePrefix"!==i[1].type&&"listItemIndent"!==i[1].type)break;r&&(n[1].end=(0,o.A)({},d.get(r)[1].start),a=d.slice(r,u),a.unshift(n),d.splice(r,u-r+1,a))}}return Zg(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!c}function sv(e,t){const n=e.get(t)[1],r=e.get(t)[2];let s=t-1;const i=[];let a=n._tokenizer;a||(a=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(a._contentTypeTextTrailing=!0));const o=a.events,l=[],c={};let u,d,h=-1,m=n,f=0,p=0;const g=[p];for(;m;){for(;e.get(++s)[1]!==m;);i.push(s),m._tokenizer||(u=r.sliceStream(m),m.next||u.push(null),d&&a.defineSkip(m.start),m._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=!0),a.write(u),m._isInFirstContentOfListItem&&(a._gfmTasklistFirstContentOfListItem=void 0)),d=m,m=m.next}for(m=n;++h<o.length;)"exit"===o[h][0]&&"enter"===o[h-1][0]&&o[h][1].type===o[h-1][1].type&&o[h][1].start.line!==o[h][1].end.line&&(p=h+1,g.push(p),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(a.events=[],m?(m._tokenizer=void 0,m.previous=void 0):g.pop(),h=g.length;h--;){const t=o.slice(g[h],g[h+1]),n=i.pop();l.push([n,n+t.length-1]),e.splice(n,2,t)}for(l.reverse(),h=-1;++h<l.length;)c[f+l[h][0]]=f+l[h][1],f+=l[h][1]-l[h][0]-1;return c}const iv={}.hasOwnProperty;function av(e,t){let n;for(n in t){const r=(iv.call(e,n)?e[n]:void 0)||(e[n]={}),s=t[n];let i;if(s)for(i in s){iv.call(r,i)||(r[i]=[]);const e=s[i];ov(r[i],Array.isArray(e)?e:e?[e]:[])}}}function ov(e,t){let n=-1;const r=[];for(;++n<t.length;)("after"===t[n].add?e:r).push(t[n]);Zg(e,0,0,r)}const lv=bv(/[A-Za-z]/),cv=bv(/[\dA-Za-z]/),uv=bv(/[#-'*+\--9=?A-Z^-~]/);function dv(e){return null!==e&&(e<32||127===e)}const hv=bv(/\d/),mv=bv(/[\dA-Fa-f]/),fv=bv(/[!-/:-@[-`{-~]/);function pv(e){return null!==e&&e<-2}function gv(e){return null!==e&&(e<0||32===e)}function vv(e){return-2===e||-1===e||32===e}const xv=bv(/(?:[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B4E\u1B4F\u1B5A-\u1B60\u1B7D-\u1B7F\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDD6E\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9\uDFD4\uDFD5\uDFD7\uDFD8]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09\uDFE1]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDD6D-\uDD6F\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD839\uDDFF|\uD83A[\uDD5E\uDD5F])|(?:[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2429\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E5\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD803[\uDD8E\uDD8F]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDC00-\uDCEF\uDD00-\uDEB3\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0-\uDCBB\uDCC0\uDCC1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFEF])/),yv=bv(/\s/);function bv(e){return function(t){return null!==t&&t>-1&&e.test(String.fromCharCode(t))}}function wv(e,t,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return function(r){if(vv(r))return e.enter(n),a(r);return t(r)};function a(r){return vv(r)&&i++<s?(e.consume(r),a):(e.exit(n),t(r))}}const Dv={tokenize:function(e){const t=e.attempt(this.parser.constructs.contentInitial,(function(n){if(null===n)return void e.consume(n);return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),wv(e,t,"linePrefix")}),(function(t){return e.enter("paragraph"),r(t)}));let n;return t;function r(t){const r=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=r),n=r,s(t)}function s(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):pv(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),s)}}};const Nv={tokenize:function(e){const t=this,n=[];let r,s,i,a=0;return l;function l(r){if(a<n.length){const s=n[a];return t.containerState=s[1],e.attempt(s[0].continuation,c,u)(r)}return u(r)}function c(e){if(a++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,r&&y();const n=t.events.length;let s,i=n;for(;i--;)if("exit"===t.events[i][0]&&"chunkFlow"===t.events[i][1].type){s=t.events[i][1].end;break}x(a);let l=n;for(;l<t.events.length;)t.events[l][1].end=(0,o.A)({},s),l++;return Zg(t.events,i+1,0,t.events.slice(n)),t.events.length=l,u(e)}return l(e)}function u(s){if(a===n.length){if(!r)return m(s);if(r.currentConstruct&&r.currentConstruct.concrete)return p(s);t.interrupt=Boolean(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(jv,d,h)(s)}function d(e){return r&&y(),x(a),m(e)}function h(e){return t.parser.lazy[t.now().line]=a!==n.length,i=t.now().offset,p(e)}function m(n){return t.containerState={},e.attempt(jv,f,p)(n)}function f(e){return a++,n.push([t.currentConstruct,t.containerState]),m(e)}function p(n){return null===n?(r&&y(),x(0),void e.consume(n)):(r=r||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:r,contentType:"flow",previous:s}),g(n))}function g(n){return null===n?(v(e.exit("chunkFlow"),!0),x(0),void e.consume(n)):pv(n)?(e.consume(n),v(e.exit("chunkFlow")),a=0,t.interrupt=void 0,l):(e.consume(n),g)}function v(e,n){const l=t.sliceStream(e);if(n&&l.push(null),e.previous=s,s&&(s.next=e),s=e,r.defineSkip(e.start),r.write(l),t.parser.lazy[e.start.line]){let e=r.events.length;for(;e--;)if(r.events[e][1].start.offset<i&&(!r.events[e][1].end||r.events[e][1].end.offset>i))return;const n=t.events.length;let s,l,c=n;for(;c--;)if("exit"===t.events[c][0]&&"chunkFlow"===t.events[c][1].type){if(s){l=t.events[c][1].end;break}s=!0}for(x(a),e=n;e<t.events.length;)t.events[e][1].end=(0,o.A)({},l),e++;Zg(t.events,c+1,0,t.events.slice(n)),t.events.length=e}}function x(r){let s=n.length;for(;s-- >r;){const r=n[s];t.containerState=r[1],r[0].exit.call(t,e)}n.length=r}function y(){r.write([null]),s=void 0,r=void 0,t.containerState._closeFlow=void 0}}},jv={tokenize:function(e,t,n){return wv(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}};const Cv={partial:!0,tokenize:function(e,t,n){return function(t){return vv(t)?wv(e,r,"linePrefix")(t):r(t)};function r(e){return null===e||pv(e)?t(e):n(e)}}};const Ev={resolve:function(e){return rv(e),e},tokenize:function(e,t){let n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),r(t)};function r(t){return null===t?s(t):pv(t)?e.check(Av,i,s)(t):(e.consume(t),r)}function s(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function i(t){return e.consume(t),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,r}}},Av={partial:!0,tokenize:function(e,t,n){const r=this;return function(t){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),wv(e,s,"linePrefix")};function s(s){if(null===s||pv(s))return n(s);const i=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&i&&"linePrefix"===i[1].type&&i[2].sliceSerialize(i[1],!0).length>=4?t(s):e.interrupt(r.parser.constructs.flow,n,t)(s)}}};const kv={tokenize:function(e){const t=this,n=e.attempt(Cv,(function(r){if(null===r)return void e.consume(r);return e.enter("lineEndingBlank"),e.consume(r),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}),e.attempt(this.parser.constructs.flowInitial,r,wv(e,e.attempt(this.parser.constructs.flow,r,e.attempt(Ev,r)),"linePrefix")));return n;function r(r){if(null!==r)return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(r)}}};const Sv={resolveAll:Iv()},Fv=Tv("string"),_v=Tv("text");function Tv(e){return{resolveAll:Iv("text"===e?Rv:void 0),tokenize:function(t){const n=this,r=this.parser.constructs[e],s=t.attempt(r,i,a);return i;function i(e){return l(e)?s(e):a(e)}function a(e){if(null!==e)return t.enter("data"),t.consume(e),o;t.consume(e)}function o(e){return l(e)?(t.exit("data"),s(e)):(t.consume(e),o)}function l(e){if(null===e)return!0;const t=r[e];let s=-1;if(t)for(;++s<t.length;){const e=t[s];if(!e.previous||e.previous.call(n,n.previous))return!0}return!1}}}}function Iv(e){return function(t,n){let r,s=-1;for(;++s<=t.length;)void 0===r?t[s]&&"data"===t[s][1].type&&(r=s,s++):t[s]&&"data"===t[s][1].type||(s!==r+2&&(t[r][1].end=t[s-1][1].end,t.splice(r+2,s-r-2),s=r+2),r=void 0);return e?e(t,n):t}}function Rv(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||"lineEnding"===e[n][1].type)&&"data"===e[n-1][1].type){const r=e[n-1][1],s=t.sliceStream(r);let i,a=s.length,l=-1,c=0;for(;a--;){const e=s[a];if("string"===typeof e){for(l=e.length;32===e.charCodeAt(l-1);)c++,l--;if(l)break;l=-1}else if(-2===e)i=!0,c++;else if(-1!==e){a++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(c=0),c){const s={type:n===e.length||i||c<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:a?l:r.start._bufferIndex+l,_index:r.start._index+a,line:r.end.line,column:r.end.column-c,offset:r.end.offset-c},end:(0,o.A)({},r.end)};r.end=(0,o.A)({},s.start),r.start.offset===r.end.offset?Object.assign(r,s):(e.splice(n,0,["enter",s,t],["exit",s,t]),n+=2)}n++}return e}const Pv={name:"thematicBreak",tokenize:function(e,t,n){let r,s=0;return function(t){return e.enter("thematicBreak"),function(e){return r=e,i(e)}(t)};function i(i){return i===r?(e.enter("thematicBreakSequence"),a(i)):s>=3&&(null===i||pv(i))?(e.exit("thematicBreak"),t(i)):n(i)}function a(t){return t===r?(e.consume(t),s++,a):(e.exit("thematicBreakSequence"),vv(t)?wv(e,i,"whitespace")(t):i(t))}}};const Ov={continuation:{tokenize:function(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(Cv,s,i);function s(n){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,wv(e,t,"listItemIndent",r.containerState.size+1)(n)}function i(n){return r.containerState.furtherBlankLines||!vv(n)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,a(n)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(Lv,t,a)(n))}function a(s){return r.containerState._closeFlow=!0,r.interrupt=void 0,wv(e,e.attempt(Ov,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}},exit:function(e){e.exit(this.containerState.type)},name:"list",tokenize:function(e,t,n){const r=this,s=r.events[r.events.length-1];let i=s&&"linePrefix"===s[1].type?s[2].sliceSerialize(s[1],!0).length:0,a=0;return function(t){const s=r.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===s?!r.containerState.marker||t===r.containerState.marker:hv(t)){if(r.containerState.type||(r.containerState.type=s,e.enter(s,{_container:!0})),"listUnordered"===s)return e.enter("listItemPrefix"),42===t||45===t?e.check(Pv,n,l)(t):l(t);if(!r.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),o(t)}return n(t)};function o(t){return hv(t)&&++a<10?(e.consume(t),o):(!r.interrupt||a<2)&&(r.containerState.marker?t===r.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),l(t)):n(t)}function l(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||t,e.check(Cv,r.interrupt?n:c,e.attempt(Mv,d,u))}function c(e){return r.containerState.initialBlankLine=!0,i++,d(e)}function u(t){return vv(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),d):n(t)}function d(n){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(n)}}},Mv={partial:!0,tokenize:function(e,t,n){const r=this;return wv(e,(function(e){const s=r.events[r.events.length-1];return!vv(e)&&s&&"listItemPrefixWhitespace"===s[1].type?t(e):n(e)}),"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5)}},Lv={partial:!0,tokenize:function(e,t,n){const r=this;return wv(e,(function(e){const s=r.events[r.events.length-1];return s&&"listItemIndent"===s[1].type&&s[2].sliceSerialize(s[1],!0).length===r.containerState.size?t(e):n(e)}),"listItemIndent",r.containerState.size+1)}};const Bv={continuation:{tokenize:function(e,t,n){const r=this;return function(t){if(vv(t))return wv(e,s,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t);return s(t)};function s(r){return e.attempt(Bv,t,n)(r)}}},exit:function(e){e.exit("blockQuote")},name:"blockQuote",tokenize:function(e,t,n){const r=this;return function(t){if(62===t){const n=r.containerState;return n.open||(e.enter("blockQuote",{_container:!0}),n.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),s}return n(t)};function s(n){return vv(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}}};function zv(e,t,n,r,s,i,a,o,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return function(t){if(60===t)return e.enter(r),e.enter(s),e.enter(i),e.consume(t),e.exit(i),d;if(null===t||32===t||41===t||dv(t))return n(t);return e.enter(r),e.enter(a),e.enter(o),e.enter("chunkString",{contentType:"string"}),f(t)};function d(n){return 62===n?(e.enter(i),e.consume(n),e.exit(i),e.exit(s),e.exit(r),t):(e.enter(o),e.enter("chunkString",{contentType:"string"}),h(n))}function h(t){return 62===t?(e.exit("chunkString"),e.exit(o),d(t)):null===t||60===t||pv(t)?n(t):(e.consume(t),92===t?m:h)}function m(t){return 60===t||62===t||92===t?(e.consume(t),h):h(t)}function f(s){return u||null!==s&&41!==s&&!gv(s)?u<c&&40===s?(e.consume(s),u++,f):41===s?(e.consume(s),u--,f):null===s||32===s||40===s||dv(s)?n(s):(e.consume(s),92===s?p:f):(e.exit("chunkString"),e.exit(o),e.exit(a),e.exit(r),t(s))}function p(t){return 40===t||41===t||92===t?(e.consume(t),f):f(t)}}function Uv(e,t,n,r,s,i){const a=this;let o,l=0;return function(t){return e.enter(r),e.enter(s),e.consume(t),e.exit(s),e.enter(i),c};function c(d){return l>999||null===d||91===d||93===d&&!o||94===d&&!l&&"_hiddenFootnoteSupport"in a.parser.constructs?n(d):93===d?(e.exit(i),e.enter(s),e.consume(d),e.exit(s),e.exit(r),t):pv(d)?(e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),c):(e.enter("chunkString",{contentType:"string"}),u(d))}function u(t){return null===t||91===t||93===t||pv(t)||l++>999?(e.exit("chunkString"),c(t)):(e.consume(t),o||(o=!vv(t)),92===t?d:u)}function d(t){return 91===t||92===t||93===t?(e.consume(t),l++,u):u(t)}}function qv(e,t,n,r,s,i){let a;return function(t){if(34===t||39===t||40===t)return e.enter(r),e.enter(s),e.consume(t),e.exit(s),a=40===t?41:t,o;return n(t)};function o(n){return n===a?(e.enter(s),e.consume(n),e.exit(s),e.exit(r),t):(e.enter(i),l(n))}function l(t){return t===a?(e.exit(i),o(a)):null===t?n(t):pv(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),wv(e,l,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),c(t))}function c(t){return t===a||null===t||pv(t)?(e.exit("chunkString"),l(t)):(e.consume(t),92===t?u:c)}function u(t){return t===a||92===t?(e.consume(t),c):c(t)}}function Vv(e,t){let n;return function r(s){if(pv(s))return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n=!0,r;if(vv(s))return wv(e,r,n?"linePrefix":"lineSuffix")(s);return t(s)}}function Hv(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Wv={name:"definition",tokenize:function(e,t,n){const r=this;let s;return function(t){return e.enter("definition"),function(t){return Uv.call(r,e,i,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)}(t)};function i(t){return s=Hv(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),a):n(t)}function a(t){return gv(t)?Vv(e,o)(t):o(t)}function o(t){return zv(e,l,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(t)}function l(t){return e.attempt(Gv,c,c)(t)}function c(t){return vv(t)?wv(e,u,"whitespace")(t):u(t)}function u(i){return null===i||pv(i)?(e.exit("definition"),r.parser.defined.push(s),t(i)):n(i)}}},Gv={partial:!0,tokenize:function(e,t,n){return function(t){return gv(t)?Vv(e,r)(t):n(t)};function r(t){return qv(e,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t)}function s(t){return vv(t)?wv(e,i,"whitespace")(t):i(t)}function i(e){return null===e||pv(e)?t(e):n(e)}}};const Kv={name:"codeIndented",tokenize:function(e,t,n){const r=this;return function(t){return e.enter("codeIndented"),wv(e,s,"linePrefix",5)(t)};function s(e){const t=r.events[r.events.length-1];return t&&"linePrefix"===t[1].type&&t[2].sliceSerialize(t[1],!0).length>=4?i(e):n(e)}function i(t){return null===t?o(t):pv(t)?e.attempt(Qv,i,o)(t):(e.enter("codeFlowValue"),a(t))}function a(t){return null===t||pv(t)?(e.exit("codeFlowValue"),i(t)):(e.consume(t),a)}function o(n){return e.exit("codeIndented"),t(n)}}},Qv={partial:!0,tokenize:function(e,t,n){const r=this;return s;function s(t){return r.parser.lazy[r.now().line]?n(t):pv(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s):wv(e,i,"linePrefix",5)(t)}function i(e){const i=r.events[r.events.length-1];return i&&"linePrefix"===i[1].type&&i[2].sliceSerialize(i[1],!0).length>=4?t(e):pv(e)?s(e):n(e)}}};const Yv={name:"headingAtx",resolve:function(e,t){let n,r,s=e.length-2,i=3;"whitespace"===e[i][1].type&&(i+=2);s-2>i&&"whitespace"===e[s][1].type&&(s-=2);"atxHeadingSequence"===e[s][1].type&&(i===s-1||s-4>i&&"whitespace"===e[s-2][1].type)&&(s-=i+1===s?2:4);s>i&&(n={type:"atxHeadingText",start:e[i][1].start,end:e[s][1].end},r={type:"chunkText",start:e[i][1].start,end:e[s][1].end,contentType:"text"},Zg(e,i,s-i+1,[["enter",n,t],["enter",r,t],["exit",r,t],["exit",n,t]]));return e},tokenize:function(e,t,n){let r=0;return function(t){return e.enter("atxHeading"),function(t){return e.enter("atxHeadingSequence"),s(t)}(t)};function s(t){return 35===t&&r++<6?(e.consume(t),s):null===t||gv(t)?(e.exit("atxHeadingSequence"),i(t)):n(t)}function i(n){return 35===n?(e.enter("atxHeadingSequence"),a(n)):null===n||pv(n)?(e.exit("atxHeading"),t(n)):vv(n)?wv(e,i,"whitespace")(n):(e.enter("atxHeadingText"),o(n))}function a(t){return 35===t?(e.consume(t),a):(e.exit("atxHeadingSequence"),i(t))}function o(t){return null===t||35===t||gv(t)?(e.exit("atxHeadingText"),i(t)):(e.consume(t),o)}}};const Jv={name:"setextUnderline",resolveTo:function(e,t){let n,r,s,i=e.length;for(;i--;)if("enter"===e[i][0]){if("content"===e[i][1].type){n=i;break}"paragraph"===e[i][1].type&&(r=i)}else"content"===e[i][1].type&&e.splice(i,1),s||"definition"!==e[i][1].type||(s=i);const a={type:"setextHeading",start:(0,o.A)({},e[n][1].start),end:(0,o.A)({},e[e.length-1][1].end)};e[r][1].type="setextHeadingText",s?(e.splice(r,0,["enter",a,t]),e.splice(s+1,0,["exit",e[n][1],t]),e[n][1].end=(0,o.A)({},e[s][1].end)):e[n][1]=a;return e.push(["exit",a,t]),e},tokenize:function(e,t,n){const r=this;let s;return function(t){let a,o=r.events.length;for(;o--;)if("lineEnding"!==r.events[o][1].type&&"linePrefix"!==r.events[o][1].type&&"content"!==r.events[o][1].type){a="paragraph"===r.events[o][1].type;break}if(!r.parser.lazy[r.now().line]&&(r.interrupt||a))return e.enter("setextHeadingLine"),s=t,function(t){return e.enter("setextHeadingLineSequence"),i(t)}(t);return n(t)};function i(t){return t===s?(e.consume(t),i):(e.exit("setextHeadingLineSequence"),vv(t)?wv(e,a,"lineSuffix")(t):a(t))}function a(r){return null===r||pv(r)?(e.exit("setextHeadingLine"),t(r)):n(r)}}};const Xv=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],$v=["pre","script","style","textarea"],Zv={concrete:!0,name:"htmlFlow",resolveTo:function(e){let t=e.length;for(;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2));return e},tokenize:function(e,t,n){const r=this;let s,i,a,o,l;return function(t){return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),c}(t)};function c(o){return 33===o?(e.consume(o),u):47===o?(e.consume(o),i=!0,m):63===o?(e.consume(o),s=3,r.interrupt?t:R):lv(o)?(e.consume(o),a=String.fromCharCode(o),f):n(o)}function u(i){return 45===i?(e.consume(i),s=2,d):91===i?(e.consume(i),s=5,o=0,h):lv(i)?(e.consume(i),s=4,r.interrupt?t:R):n(i)}function d(s){return 45===s?(e.consume(s),r.interrupt?t:R):n(s)}function h(s){const i="CDATA[";return s===i.charCodeAt(o++)?(e.consume(s),6===o?r.interrupt?t:E:h):n(s)}function m(t){return lv(t)?(e.consume(t),a=String.fromCharCode(t),f):n(t)}function f(o){if(null===o||47===o||62===o||gv(o)){const l=47===o,c=a.toLowerCase();return l||i||!$v.includes(c)?Xv.includes(a.toLowerCase())?(s=6,l?(e.consume(o),p):r.interrupt?t(o):E(o)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(o):i?g(o):v(o)):(s=1,r.interrupt?t(o):E(o))}return 45===o||cv(o)?(e.consume(o),a+=String.fromCharCode(o),f):n(o)}function p(s){return 62===s?(e.consume(s),r.interrupt?t:E):n(s)}function g(t){return vv(t)?(e.consume(t),g):j(t)}function v(t){return 47===t?(e.consume(t),j):58===t||95===t||lv(t)?(e.consume(t),x):vv(t)?(e.consume(t),v):j(t)}function x(t){return 45===t||46===t||58===t||95===t||cv(t)?(e.consume(t),x):y(t)}function y(t){return 61===t?(e.consume(t),b):vv(t)?(e.consume(t),y):v(t)}function b(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),l=t,w):vv(t)?(e.consume(t),b):D(t)}function w(t){return t===l?(e.consume(t),l=null,N):null===t||pv(t)?n(t):(e.consume(t),w)}function D(t){return null===t||34===t||39===t||47===t||60===t||61===t||62===t||96===t||gv(t)?y(t):(e.consume(t),D)}function N(e){return 47===e||62===e||vv(e)?v(e):n(e)}function j(t){return 62===t?(e.consume(t),C):n(t)}function C(t){return null===t||pv(t)?E(t):vv(t)?(e.consume(t),C):n(t)}function E(t){return 45===t&&2===s?(e.consume(t),F):60===t&&1===s?(e.consume(t),_):62===t&&4===s?(e.consume(t),P):63===t&&3===s?(e.consume(t),R):93===t&&5===s?(e.consume(t),I):!pv(t)||6!==s&&7!==s?null===t||pv(t)?(e.exit("htmlFlowData"),A(t)):(e.consume(t),E):(e.exit("htmlFlowData"),e.check(ex,O,A)(t))}function A(t){return e.check(tx,k,O)(t)}function k(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),S}function S(t){return null===t||pv(t)?A(t):(e.enter("htmlFlowData"),E(t))}function F(t){return 45===t?(e.consume(t),R):E(t)}function _(t){return 47===t?(e.consume(t),a="",T):E(t)}function T(t){if(62===t){const n=a.toLowerCase();return $v.includes(n)?(e.consume(t),P):E(t)}return lv(t)&&a.length<8?(e.consume(t),a+=String.fromCharCode(t),T):E(t)}function I(t){return 93===t?(e.consume(t),R):E(t)}function R(t){return 62===t?(e.consume(t),P):45===t&&2===s?(e.consume(t),R):E(t)}function P(t){return null===t||pv(t)?(e.exit("htmlFlowData"),O(t)):(e.consume(t),P)}function O(n){return e.exit("htmlFlow"),t(n)}}},ex={partial:!0,tokenize:function(e,t,n){return function(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),e.attempt(Cv,t,n)}}},tx={partial:!0,tokenize:function(e,t,n){const r=this;return function(t){if(pv(t))return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s;return n(t)};function s(e){return r.parser.lazy[r.now().line]?n(e):t(e)}}};const nx={partial:!0,tokenize:function(e,t,n){const r=this;return function(t){if(null===t)return n(t);return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s};function s(e){return r.parser.lazy[r.now().line]?n(e):t(e)}}},rx={concrete:!0,name:"codeFenced",tokenize:function(e,t,n){const r=this,s={partial:!0,tokenize:function(e,t,n){let s=0;return a;function a(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l}function l(t){return e.enter("codeFencedFence"),vv(t)?wv(e,c,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):c(t)}function c(t){return t===i?(e.enter("codeFencedFenceSequence"),u(t)):n(t)}function u(t){return t===i?(s++,e.consume(t),u):s>=o?(e.exit("codeFencedFenceSequence"),vv(t)?wv(e,d,"whitespace")(t):d(t)):n(t)}function d(r){return null===r||pv(r)?(e.exit("codeFencedFence"),t(r)):n(r)}}};let i,a=0,o=0;return function(t){return function(t){const n=r.events[r.events.length-1];return a=n&&"linePrefix"===n[1].type?n[2].sliceSerialize(n[1],!0).length:0,i=t,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),l(t)}(t)};function l(t){return t===i?(o++,e.consume(t),l):o<3?n(t):(e.exit("codeFencedFenceSequence"),vv(t)?wv(e,c,"whitespace")(t):c(t))}function c(n){return null===n||pv(n)?(e.exit("codeFencedFence"),r.interrupt?t(n):e.check(nx,m,x)(n)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),u(n))}function u(t){return null===t||pv(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),c(t)):vv(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),wv(e,d,"whitespace")(t)):96===t&&t===i?n(t):(e.consume(t),u)}function d(t){return null===t||pv(t)?c(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),h(t))}function h(t){return null===t||pv(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),c(t)):96===t&&t===i?n(t):(e.consume(t),h)}function m(t){return e.attempt(s,x,f)(t)}function f(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),p}function p(t){return a>0&&vv(t)?wv(e,g,"linePrefix",a+1)(t):g(t)}function g(t){return null===t||pv(t)?e.check(nx,m,x)(t):(e.enter("codeFlowValue"),v(t))}function v(t){return null===t||pv(t)?(e.exit("codeFlowValue"),g(t)):(e.consume(t),v)}function x(n){return e.exit("codeFenced"),t(n)}}};const sx=document.createElement("i");function ix(e){const t="&"+e+";";sx.innerHTML=t;const n=sx.textContent;return(59!==n.charCodeAt(n.length-1)||"semi"===e)&&(n!==t&&n)}const ax={name:"characterReference",tokenize:function(e,t,n){const r=this;let s,i,a=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),o};function o(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),l):(e.enter("characterReferenceValue"),s=31,i=cv,c(t))}function l(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,i=mv,c):(e.enter("characterReferenceValue"),s=7,i=hv,c(t))}function c(o){if(59===o&&a){const s=e.exit("characterReferenceValue");return i!==cv||ix(r.sliceSerialize(s))?(e.enter("characterReferenceMarker"),e.consume(o),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(o)}return i(o)&&a++<s?(e.consume(o),c):n(o)}}};const ox={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),r};function r(r){return fv(r)?(e.enter("characterEscapeValue"),e.consume(r),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(r)}}};const lx={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),wv(e,t,"linePrefix")}}};function cx(e,t,n){const r=[];let s=-1;for(;++s<e.length;){const i=e[s].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}const ux={name:"labelEnd",resolveAll:function(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),"labelImage"===r.type||"labelLink"===r.type||"labelEnd"===r.type){const e="labelImage"===r.type?4:2;r.type="data",t+=e}}e.length!==n.length&&Zg(e,0,e.length,n);return e},resolveTo:function(e,t){let n,r,s,i,a=e.length,l=0;for(;a--;)if(n=e[a][1],r){if("link"===n.type||"labelLink"===n.type&&n._inactive)break;"enter"===e[a][0]&&"labelLink"===n.type&&(n._inactive=!0)}else if(s){if("enter"===e[a][0]&&("labelImage"===n.type||"labelLink"===n.type)&&!n._balanced&&(r=a,"labelLink"!==n.type)){l=2;break}}else"labelEnd"===n.type&&(s=a);const c={type:"labelLink"===e[r][1].type?"link":"image",start:(0,o.A)({},e[r][1].start),end:(0,o.A)({},e[e.length-1][1].end)},u={type:"label",start:(0,o.A)({},e[r][1].start),end:(0,o.A)({},e[s][1].end)},d={type:"labelText",start:(0,o.A)({},e[r+l+2][1].end),end:(0,o.A)({},e[s-2][1].start)};return i=[["enter",c,t],["enter",u,t]],i=ev(i,e.slice(r+1,r+l+3)),i=ev(i,[["enter",d,t]]),i=ev(i,cx(t.parser.constructs.insideSpan.null,e.slice(r+l+4,s-3),t)),i=ev(i,[["exit",d,t],e[s-2],e[s-1],["exit",u,t]]),i=ev(i,e.slice(s+1)),i=ev(i,[["exit",c,t]]),Zg(e,r,e.length,i),e},tokenize:function(e,t,n){const r=this;let s,i,a=r.events.length;for(;a--;)if(("labelImage"===r.events[a][1].type||"labelLink"===r.events[a][1].type)&&!r.events[a][1]._balanced){s=r.events[a][1];break}return function(t){if(!s)return n(t);if(s._inactive)return u(t);return i=r.parser.defined.includes(Hv(r.sliceSerialize({start:s.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),o};function o(t){return 40===t?e.attempt(dx,c,i?c:u)(t):91===t?e.attempt(hx,c,i?l:u)(t):i?c(t):u(t)}function l(t){return e.attempt(mx,c,u)(t)}function c(e){return t(e)}function u(e){return s._balanced=!0,n(e)}}},dx={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),r};function r(t){return gv(t)?Vv(e,s)(t):s(t)}function s(t){return 41===t?c(t):zv(e,i,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(t)}function i(t){return gv(t)?Vv(e,o)(t):c(t)}function a(e){return n(e)}function o(t){return 34===t||39===t||40===t?qv(e,l,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):c(t)}function l(t){return gv(t)?Vv(e,c)(t):c(t)}function c(r){return 41===r?(e.enter("resourceMarker"),e.consume(r),e.exit("resourceMarker"),e.exit("resource"),t):n(r)}}},hx={tokenize:function(e,t,n){const r=this;return function(t){return Uv.call(r,e,s,i,"reference","referenceMarker","referenceString")(t)};function s(e){return r.parser.defined.includes(Hv(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(e):n(e)}function i(e){return n(e)}}},mx={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),r};function r(r){return 93===r?(e.enter("referenceMarker"),e.consume(r),e.exit("referenceMarker"),e.exit("reference"),t):n(r)}}};const fx={name:"labelStartImage",resolveAll:ux.resolveAll,tokenize:function(e,t,n){const r=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),s};function s(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),i):n(t)}function i(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}}};function px(e){return null===e||gv(e)||yv(e)?1:xv(e)?2:void 0}const gx={name:"attention",resolveAll:function(e,t){let n,r,s,i,a,l,c,u,d=-1;for(;++d<e.length;)if("enter"===e[d][0]&&"attentionSequence"===e[d][1].type&&e[d][1]._close)for(n=d;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[d][1]).charCodeAt(0)){if((e[n][1]._close||e[d][1]._open)&&(e[d][1].end.offset-e[d][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[d][1].end.offset-e[d][1].start.offset)%3))continue;l=e[n][1].end.offset-e[n][1].start.offset>1&&e[d][1].end.offset-e[d][1].start.offset>1?2:1;const h=(0,o.A)({},e[n][1].end),m=(0,o.A)({},e[d][1].start);vx(h,-l),vx(m,l),i={type:l>1?"strongSequence":"emphasisSequence",start:h,end:(0,o.A)({},e[n][1].end)},a={type:l>1?"strongSequence":"emphasisSequence",start:(0,o.A)({},e[d][1].start),end:m},s={type:l>1?"strongText":"emphasisText",start:(0,o.A)({},e[n][1].end),end:(0,o.A)({},e[d][1].start)},r={type:l>1?"strong":"emphasis",start:(0,o.A)({},i.start),end:(0,o.A)({},a.end)},e[n][1].end=(0,o.A)({},i.start),e[d][1].start=(0,o.A)({},a.end),c=[],e[n][1].end.offset-e[n][1].start.offset&&(c=ev(c,[["enter",e[n][1],t],["exit",e[n][1],t]])),c=ev(c,[["enter",r,t],["enter",i,t],["exit",i,t],["enter",s,t]]),c=ev(c,cx(t.parser.constructs.insideSpan.null,e.slice(n+1,d),t)),c=ev(c,[["exit",s,t],["enter",a,t],["exit",a,t],["exit",r,t]]),e[d][1].end.offset-e[d][1].start.offset?(u=2,c=ev(c,[["enter",e[d][1],t],["exit",e[d][1],t]])):u=0,Zg(e,n-1,d-n+3,c),d=n+c.length-u-2;break}d=-1;for(;++d<e.length;)"attentionSequence"===e[d][1].type&&(e[d][1].type="data");return e},tokenize:function(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=px(r);let i;return function(t){return i=t,e.enter("attentionSequence"),a(t)};function a(o){if(o===i)return e.consume(o),a;const l=e.exit("attentionSequence"),c=px(o),u=!c||2===c&&s||n.includes(o),d=!s||2===s&&c||n.includes(r);return l._open=Boolean(42===i?u:u&&(s||!d)),l._close=Boolean(42===i?d:d&&(c||!u)),t(o)}}};function vx(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const xx={name:"autolink",tokenize:function(e,t,n){let r=0;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s};function s(t){return lv(t)?(e.consume(t),i):64===t?n(t):l(t)}function i(e){return 43===e||45===e||46===e||cv(e)?(r=1,a(e)):l(e)}function a(t){return 58===t?(e.consume(t),r=0,o):(43===t||45===t||46===t||cv(t))&&r++<32?(e.consume(t),a):(r=0,l(t))}function o(r){return 62===r?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(r),e.exit("autolinkMarker"),e.exit("autolink"),t):null===r||32===r||60===r||dv(r)?n(r):(e.consume(r),o)}function l(t){return 64===t?(e.consume(t),c):uv(t)?(e.consume(t),l):n(t)}function c(e){return cv(e)?u(e):n(e)}function u(n){return 46===n?(e.consume(n),r=0,c):62===n?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t):d(n)}function d(t){if((45===t||cv(t))&&r++<63){const n=45===t?d:u;return e.consume(t),n}return n(t)}}};const yx={name:"htmlText",tokenize:function(e,t,n){const r=this;let s,i,a;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),o};function o(t){return 33===t?(e.consume(t),l):47===t?(e.consume(t),b):63===t?(e.consume(t),x):lv(t)?(e.consume(t),N):n(t)}function l(t){return 45===t?(e.consume(t),c):91===t?(e.consume(t),i=0,m):lv(t)?(e.consume(t),v):n(t)}function c(t){return 45===t?(e.consume(t),h):n(t)}function u(t){return null===t?n(t):45===t?(e.consume(t),d):pv(t)?(a=u,T(t)):(e.consume(t),u)}function d(t){return 45===t?(e.consume(t),h):u(t)}function h(e){return 62===e?_(e):45===e?d(e):u(e)}function m(t){const r="CDATA[";return t===r.charCodeAt(i++)?(e.consume(t),6===i?f:m):n(t)}function f(t){return null===t?n(t):93===t?(e.consume(t),p):pv(t)?(a=f,T(t)):(e.consume(t),f)}function p(t){return 93===t?(e.consume(t),g):f(t)}function g(t){return 62===t?_(t):93===t?(e.consume(t),g):f(t)}function v(t){return null===t||62===t?_(t):pv(t)?(a=v,T(t)):(e.consume(t),v)}function x(t){return null===t?n(t):63===t?(e.consume(t),y):pv(t)?(a=x,T(t)):(e.consume(t),x)}function y(e){return 62===e?_(e):x(e)}function b(t){return lv(t)?(e.consume(t),w):n(t)}function w(t){return 45===t||cv(t)?(e.consume(t),w):D(t)}function D(t){return pv(t)?(a=D,T(t)):vv(t)?(e.consume(t),D):_(t)}function N(t){return 45===t||cv(t)?(e.consume(t),N):47===t||62===t||gv(t)?j(t):n(t)}function j(t){return 47===t?(e.consume(t),_):58===t||95===t||lv(t)?(e.consume(t),C):pv(t)?(a=j,T(t)):vv(t)?(e.consume(t),j):_(t)}function C(t){return 45===t||46===t||58===t||95===t||cv(t)?(e.consume(t),C):E(t)}function E(t){return 61===t?(e.consume(t),A):pv(t)?(a=E,T(t)):vv(t)?(e.consume(t),E):j(t)}function A(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),s=t,k):pv(t)?(a=A,T(t)):vv(t)?(e.consume(t),A):(e.consume(t),S)}function k(t){return t===s?(e.consume(t),s=void 0,F):null===t?n(t):pv(t)?(a=k,T(t)):(e.consume(t),k)}function S(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):47===t||62===t||gv(t)?j(t):(e.consume(t),S)}function F(e){return 47===e||62===e||gv(e)?j(e):n(e)}function _(r){return 62===r?(e.consume(r),e.exit("htmlTextData"),e.exit("htmlText"),t):n(r)}function T(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),I}function I(t){return vv(t)?wv(e,R,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(t):R(t)}function R(t){return e.enter("htmlTextData"),a(t)}}};const bx={name:"labelStartLink",resolveAll:ux.resolveAll,tokenize:function(e,t,n){const r=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),s};function s(e){return 94===e&&"_hiddenFootnoteSupport"in r.parser.constructs?n(e):t(e)}}};const wx={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.consume(t),r};function r(r){return pv(r)?(e.exit("hardBreakEscape"),t(r)):n(r)}}};const Dx={name:"codeText",previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type},resolve:function(e){let t,n,r=e.length-4,s=3;if(("lineEnding"===e[s][1].type||"space"===e[s][1].type)&&("lineEnding"===e[r][1].type||"space"===e[r][1].type))for(t=s;++t<r;)if("codeTextData"===e[t][1].type){e[s][1].type="codeTextPadding",e[r][1].type="codeTextPadding",s+=2,r-=2;break}t=s-1,r++;for(;++t<=r;)void 0===n?t!==r&&"lineEnding"!==e[t][1].type&&(n=t):t!==r&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),r-=t-n-2,t=n+2),n=void 0);return e},tokenize:function(e,t,n){let r,s,i=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),a(t)};function a(t){return 96===t?(e.consume(t),i++,a):(e.exit("codeTextSequence"),o(t))}function o(t){return null===t?n(t):32===t?(e.enter("space"),e.consume(t),e.exit("space"),o):96===t?(s=e.enter("codeTextSequence"),r=0,c(t)):pv(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),o):(e.enter("codeTextData"),l(t))}function l(t){return null===t||32===t||96===t||pv(t)?(e.exit("codeTextData"),o(t)):(e.consume(t),l)}function c(n){return 96===n?(e.consume(n),r++,c):r===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(s.type="codeTextData",l(n))}}};const Nx={42:Ov,43:Ov,45:Ov,48:Ov,49:Ov,50:Ov,51:Ov,52:Ov,53:Ov,54:Ov,55:Ov,56:Ov,57:Ov,62:Bv},jx={91:Wv},Cx={[-2]:Kv,[-1]:Kv,32:Kv},Ex={35:Yv,42:Pv,45:[Jv,Pv],60:Zv,61:Jv,95:Pv,96:rx,126:rx},Ax={38:ax,92:ox},kx={[-5]:lx,[-4]:lx,[-3]:lx,33:fx,38:ax,42:gx,60:[xx,yx],91:bx,92:[wx,ox],93:ux,95:gx,96:Dx},Sx={null:[gx,Sv]},Fx={null:[42,95]},_x={null:[]};function Tx(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let a=[],o=[],l=!0;const c={attempt:x((function(e,t){y(e,t.from)})),check:x(v),consume:function(e){pv(e)?(r.line++,r.column=1,r.offset+=-3===e?2:1,b()):-1!==e&&(r.column++,r.offset++);r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===a[r._index].length&&(r._bufferIndex=-1,r._index++));u.previous=e,l=!0},enter:function(e,t){const n=t||{};return n.type=e,n.start=f(),u.events.push(["enter",n,u]),o.push(n),n},exit:function(e){const t=o.pop();return t.end=f(),u.events.push(["exit",t,u]),t},interrupt:x(v,{interrupt:!0})},u={code:null,containerState:{},defineSkip:function(e){s[e.line]=e.column,b()},events:[],now:f,parser:e,previous:null,sliceSerialize:function(e,t){return function(e,t){let n=-1;const r=[];let s;for(;++n<e.length;){const i=e[n];let a;if("string"===typeof i)a=i;else switch(i){case-5:a="\r";break;case-4:a="\n";break;case-3:a="\r\n";break;case-2:a=t?" ":"\t";break;case-1:if(!t&&s)continue;a=" ";break;default:a=String.fromCharCode(i)}s=-2===i,r.push(a)}return r.join("")}(m(e),t)},sliceStream:m,write:function(e){if(a=ev(a,e),p(),null!==a[a.length-1])return[];return y(t,0),u.events=cx(i,u.events,u),u.events}};let d,h=t.tokenize.call(u,c);return t.resolveAll&&i.push(t),u;function m(e){return function(e,t){const n=t.start._index,r=t.start._bufferIndex,s=t.end._index,i=t.end._bufferIndex;let a;if(n===s)a=[e[n].slice(r,i)];else{if(a=e.slice(n,s),r>-1){const e=a[0];"string"===typeof e?a[0]=e.slice(r):a.shift()}i>0&&a.push(e[s].slice(0,i))}return a}(a,e)}function f(){const{_bufferIndex:e,_index:t,line:n,column:s,offset:i}=r;return{_bufferIndex:e,_index:t,line:n,column:s,offset:i}}function p(){let e;for(;r._index<a.length;){const t=a[r._index];if("string"===typeof t)for(e=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===e&&r._bufferIndex<t.length;)g(t.charCodeAt(r._bufferIndex));else g(t)}}function g(e){l=void 0,d=e,h=h(e)}function v(e,t){t.restore()}function x(e,t){return function(n,s,i){let a,d,h,m;return Array.isArray(n)?p(n):"tokenize"in n?p([n]):function(e){return t;function t(t){const n=null!==t&&e[t],r=null!==t&&e.null;return p([...Array.isArray(n)?n:n?[n]:[],...Array.isArray(r)?r:r?[r]:[]])(t)}}(n);function p(e){return a=e,d=0,0===e.length?i:g(e[d])}function g(e){return function(n){m=function(){const e=f(),t=u.previous,n=u.currentConstruct,s=u.events.length,i=Array.from(o);return{from:s,restore:a};function a(){r=e,u.previous=t,u.currentConstruct=n,u.events.length=s,o=i,b()}}(),h=e,e.partial||(u.currentConstruct=e);if(e.name&&u.parser.constructs.disable.null.includes(e.name))return x(n);return e.tokenize.call(t?Object.assign(Object.create(u),t):u,c,v,x)(n)}}function v(t){return l=!0,e(h,m),s}function x(e){return l=!0,m.restore(),++d<a.length?g(a[d]):i}}}function y(e,t){e.resolveAll&&!i.includes(e)&&i.push(e),e.resolve&&Zg(u.events,t,u.events.length-t,e.resolve(u.events.slice(t),u)),e.resolveTo&&(u.events=e.resolveTo(u.events,u))}function b(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function Ix(e){const n=function(e){const t={};let n=-1;for(;++n<e.length;)av(t,e[n]);return t}([t,...(e||{}).extensions||[]]),r={constructs:n,content:s(Dv),defined:[],document:s(Nv),flow:s(kv),lazy:{},string:s(Fv),text:s(_v)};return r;function s(e){return function(t){return Tx(r,e,t)}}}const Rx=/[\0\t\n\r]/g;function Px(e,t){const n=Number.parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535===(65535&n)||65534===(65535&n)||n>1114111?"\ufffd":String.fromCodePoint(n)}const Ox=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Mx(e,t,n){if(t)return t;if(35===n.charCodeAt(0)){const e=n.charCodeAt(1),t=120===e||88===e;return Px(n.slice(t?2:1),t?16:10)}return ix(n)||e}const Lx={}.hasOwnProperty;function Bx(e,t,n){return"string"!==typeof t&&(n=t,t=void 0),function(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(te),autolinkProtocol:C,autolinkEmail:C,atxHeading:i(X),blockQuote:i(G),characterEscape:C,characterReference:C,codeFenced:i(K),codeFencedFenceInfo:a,codeFencedFenceMeta:a,codeIndented:i(K,a),codeText:i(Q,a),codeTextData:C,data:C,codeFlowValue:C,definition:i(Y),definitionDestinationString:a,definitionLabelString:a,definitionTitleString:a,emphasis:i(J),hardBreakEscape:i($),hardBreakTrailing:i($),htmlFlow:i(Z,a),htmlFlowData:C,htmlText:i(Z,a),htmlTextData:C,image:i(ee),label:a,link:i(te),listItem:i(re),listItemValue:h,listOrdered:i(ne,d),listUnordered:i(ne),paragraph:i(se),reference:B,referenceString:a,resourceDestinationString:a,resourceTitleString:a,setextHeading:i(X),strong:i(ie),thematicBreak:i(oe)},exit:{atxHeading:l(),atxHeadingSequence:w,autolink:l(),autolinkEmail:W,autolinkProtocol:H,blockQuote:l(),characterEscapeValue:E,characterReferenceMarkerHexadecimal:U,characterReferenceMarkerNumeric:U,characterReferenceValue:q,characterReference:V,codeFenced:l(g),codeFencedFence:p,codeFencedFenceInfo:m,codeFencedFenceMeta:f,codeFlowValue:E,codeIndented:l(v),codeText:l(_),codeTextData:E,data:E,definition:l(),definitionDestinationString:b,definitionLabelString:x,definitionTitleString:y,emphasis:l(),hardBreakEscape:l(k),hardBreakTrailing:l(k),htmlFlow:l(S),htmlFlowData:E,htmlText:l(F),htmlTextData:E,image:l(I),label:P,labelText:R,lineEnding:A,link:l(T),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:z,resourceDestinationString:O,resourceTitleString:M,resource:L,setextHeading:l(j),setextHeadingLineSequence:N,setextHeadingText:D,strong:l(),thematicBreak:l()}};Ux(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(e){let r={type:"root",children:[]};const i={stack:[r],tokenStack:[],config:t,enter:o,exit:c,buffer:a,resume:u,data:n},l=[];let d=-1;for(;++d<e.length;)if("listOrdered"===e[d][1].type||"listUnordered"===e[d][1].type)if("enter"===e[d][0])l.push(d);else{d=s(e,l.pop(),d)}for(d=-1;++d<e.length;){const n=t[e[d][0]];Lx.call(n,e[d][1].type)&&n[e[d][1].type].call(Object.assign({sliceSerialize:e[d][2].sliceSerialize},i),e[d][1])}if(i.tokenStack.length>0){const e=i.tokenStack[i.tokenStack.length-1];(e[1]||Vx).call(i,void 0,e[0])}for(r.position={start:zx(e.length>0?e[0][1].start:{line:1,column:1,offset:0}),end:zx(e.length>0?e[e.length-2][1].end:{line:1,column:1,offset:0})},d=-1;++d<t.transforms.length;)r=t.transforms[d](r)||r;return r}function s(e,t,n){let r,s,i,a,o=t-1,l=-1,c=!1;for(;++o<=n;){const t=e[o];switch(t[1].type){case"listUnordered":case"listOrdered":case"blockQuote":"enter"===t[0]?l++:l--,a=void 0;break;case"lineEndingBlank":"enter"===t[0]&&(!r||a||l||i||(i=o),a=void 0);break;case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:a=void 0}if(!l&&"enter"===t[0]&&"listItemPrefix"===t[1].type||-1===l&&"exit"===t[0]&&("listUnordered"===t[1].type||"listOrdered"===t[1].type)){if(r){let a=o;for(s=void 0;a--;){const t=e[a];if("lineEnding"===t[1].type||"lineEndingBlank"===t[1].type){if("exit"===t[0])continue;s&&(e[s][1].type="lineEndingBlank",c=!0),t[1].type="lineEnding",s=a}else if("linePrefix"!==t[1].type&&"blockQuotePrefix"!==t[1].type&&"blockQuotePrefixWhitespace"!==t[1].type&&"blockQuoteMarker"!==t[1].type&&"listItemIndent"!==t[1].type)break}i&&(!s||i<s)&&(r._spread=!0),r.end=Object.assign({},s?e[s][1].start:t[1].end),e.splice(s||o,0,["exit",r,t[2]]),o++,n++}if("listItemPrefix"===t[1].type){const s={type:"listItem",_spread:!1,start:Object.assign({},t[1].start),end:void 0};r=s,e.splice(o,0,["enter",s,t[2]]),o++,n++,i=void 0,a=!0}}}return e[t][1]._spread=c,n}function i(e,t){return n;function n(n){o.call(this,e(n),n),t&&t.call(this,n)}}function a(){this.stack.push({type:"fragment",children:[]})}function o(e,t,n){this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push([t,n||void 0]),e.position={start:zx(t.start),end:void 0}}function l(e){return t;function t(t){e&&e.call(this,t),c.call(this,t)}}function c(e,t){const n=this.stack.pop(),r=this.tokenStack.pop();if(!r)throw new Error("Cannot close `"+e.type+"` ("+kg({start:e.start,end:e.end})+"): it\u2019s not open");if(r[0].type!==e.type)if(t)t.call(this,e,r[0]);else{(r[1]||Vx).call(this,e,r[0])}n.position.end=zx(e.end)}function u(){return function(e,t){const n=t||Jg;return Xg(e,"boolean"!==typeof n.includeImageAlt||n.includeImageAlt,"boolean"!==typeof n.includeHtml||n.includeHtml)}(this.stack.pop())}function d(){this.data.expectingFirstListItemValue=!0}function h(e){if(this.data.expectingFirstListItemValue){this.stack[this.stack.length-2].start=Number.parseInt(this.sliceSerialize(e),10),this.data.expectingFirstListItemValue=void 0}}function m(){const e=this.resume();this.stack[this.stack.length-1].lang=e}function f(){const e=this.resume();this.stack[this.stack.length-1].meta=e}function p(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function g(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const e=this.resume();this.stack[this.stack.length-1].value=e.replace(/(\r?\n|\r)$/g,"")}function x(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=Hv(this.sliceSerialize(e)).toLowerCase()}function y(){const e=this.resume();this.stack[this.stack.length-1].title=e}function b(){const e=this.resume();this.stack[this.stack.length-1].url=e}function w(e){const t=this.stack[this.stack.length-1];if(!t.depth){const n=this.sliceSerialize(e).length;t.depth=n}}function D(){this.data.setextHeadingSlurpLineEnding=!0}function N(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).codePointAt(0)?1:2}function j(){this.data.setextHeadingSlurpLineEnding=void 0}function C(e){const t=this.stack[this.stack.length-1].children;let n=t[t.length-1];n&&"text"===n.type||(n=ae(),n.position={start:zx(e.start),end:void 0},t.push(n)),this.stack.push(n)}function E(e){const t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=zx(e.end)}function A(e){const n=this.stack[this.stack.length-1];if(this.data.atHardBreak){return n.children[n.children.length-1].position.end=zx(e.end),void(this.data.atHardBreak=void 0)}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(n.type)&&(C.call(this,e),E.call(this,e))}function k(){this.data.atHardBreak=!0}function S(){const e=this.resume();this.stack[this.stack.length-1].value=e}function F(){const e=this.resume();this.stack[this.stack.length-1].value=e}function _(){const e=this.resume();this.stack[this.stack.length-1].value=e}function T(){const e=this.stack[this.stack.length-1];if(this.data.inReference){const t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function I(){const e=this.stack[this.stack.length-1];if(this.data.inReference){const t=this.data.referenceType||"shortcut";e.type+="Reference",e.referenceType=t,delete e.url,delete e.title}else delete e.identifier,delete e.label;this.data.referenceType=void 0}function R(e){const t=this.sliceSerialize(e),n=this.stack[this.stack.length-2];n.label=function(e){return e.replace(Ox,Mx)}(t),n.identifier=Hv(t).toLowerCase()}function P(){const e=this.stack[this.stack.length-1],t=this.resume(),n=this.stack[this.stack.length-1];if(this.data.inReference=!0,"link"===n.type){const t=e.children;n.children=t}else n.alt=t}function O(){const e=this.resume();this.stack[this.stack.length-1].url=e}function M(){const e=this.resume();this.stack[this.stack.length-1].title=e}function L(){this.data.inReference=void 0}function B(){this.data.referenceType="collapsed"}function z(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.label=t,n.identifier=Hv(this.sliceSerialize(e)).toLowerCase(),this.data.referenceType="full"}function U(e){this.data.characterReferenceType=e.type}function q(e){const t=this.sliceSerialize(e),n=this.data.characterReferenceType;let r;if(n)r=Px(t,"characterReferenceMarkerNumeric"===n?10:16),this.data.characterReferenceType=void 0;else{r=ix(t)}this.stack[this.stack.length-1].value+=r}function V(e){this.stack.pop().position.end=zx(e.end)}function H(e){E.call(this,e);this.stack[this.stack.length-1].url=this.sliceSerialize(e)}function W(e){E.call(this,e);this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)}function G(){return{type:"blockquote",children:[]}}function K(){return{type:"code",lang:null,meta:null,value:""}}function Q(){return{type:"inlineCode",value:""}}function Y(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function J(){return{type:"emphasis",children:[]}}function X(){return{type:"heading",depth:0,children:[]}}function $(){return{type:"break"}}function Z(){return{type:"html",value:""}}function ee(){return{type:"image",title:null,url:"",alt:null}}function te(){return{type:"link",title:null,url:"",children:[]}}function ne(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}function re(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}}function se(){return{type:"paragraph",children:[]}}function ie(){return{type:"strong",children:[]}}function ae(){return{type:"text",value:""}}function oe(){return{type:"thematicBreak"}}}(n)(function(e){for(;!rv(e););return e}(Ix(n).document().write(function(){let e,t=1,n="",r=!0;return function(s,i,a){const o=[];let l,c,u,d,h;for(s=n+("string"===typeof s?s.toString():new TextDecoder(i||void 0).decode(s)),u=0,n="",r&&(65279===s.charCodeAt(0)&&u++,r=void 0);u<s.length;){if(Rx.lastIndex=u,l=Rx.exec(s),d=l&&void 0!==l.index?l.index:s.length,h=s.charCodeAt(d),!l){n=s.slice(u);break}if(10===h&&u===d&&e)o.push(-3),e=void 0;else switch(e&&(o.push(-5),e=void 0),u<d&&(o.push(s.slice(u,d)),t+=d-u),h){case 0:o.push(65533),t++;break;case 9:for(c=4*Math.ceil(t/4),o.push(-2);t++<c;)o.push(-1);break;case 10:o.push(-4),t=1;break;default:e=!0,t=1}u=d+1}return a&&(e&&o.push(-5),n&&o.push(n),o.push(null)),o}}()(e,t,!0))))}function zx(e){return{line:e.line,column:e.column,offset:e.offset}}function Ux(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?Ux(e,r):qx(e,r)}}function qx(e,t){let n;for(n in t)if(Lx.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function Vx(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+kg({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+kg({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+kg({start:t.start,end:t.end})+") is still open")}function Hx(e){const t=this;t.parser=function(n){return Bx(n,(0,o.A)((0,o.A)((0,o.A)({},t.data("settings")),e),{},{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}}const Wx="object"===typeof self?self:globalThis,Gx=e=>((e,t)=>{const n=(t,n)=>(e.set(n,t),t),r=s=>{if(e.has(s))return e.get(s);const[i,a]=t[s];switch(i){case 0:case-1:return n(a,s);case 1:{const e=n([],s);for(const t of a)e.push(r(t));return e}case 2:{const e=n({},s);for(const[t,n]of a)e[r(t)]=r(n);return e}case 3:return n(new Date(a),s);case 4:{const{source:e,flags:t}=a;return n(new RegExp(e,t),s)}case 5:{const e=n(new Map,s);for(const[t,n]of a)e.set(r(t),r(n));return e}case 6:{const e=n(new Set,s);for(const t of a)e.add(r(t));return e}case 7:{const{name:e,message:t}=a;return n(new Wx[e](t),s)}case 8:return n(BigInt(a),s);case"BigInt":return n(Object(BigInt(a)),s);case"ArrayBuffer":return n(new Uint8Array(a).buffer,a);case"DataView":{const{buffer:e}=new Uint8Array(a);return n(new DataView(e),a)}}return n(new Wx[i](a),s)};return r})(new Map,e)(0),Kx="",{toString:Qx}={},{keys:Yx}=Object,Jx=e=>{const t=typeof e;if("object"!==t||!e)return[0,t];const n=Qx.call(e).slice(8,-1);switch(n){case"Array":return[1,Kx];case"Object":return[2,Kx];case"Date":return[3,Kx];case"RegExp":return[4,Kx];case"Map":return[5,Kx];case"Set":return[6,Kx];case"DataView":return[1,n]}return n.includes("Array")?[1,n]:n.includes("Error")?[7,n]:[2,n]},Xx=e=>{let[t,n]=e;return 0===t&&("function"===n||"symbol"===n)},$x=function(e){let{json:t,lossy:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];return((e,t,n,r)=>{const s=(e,t)=>{const s=r.push(e)-1;return n.set(t,s),s},i=r=>{if(n.has(r))return n.get(r);let[a,o]=Jx(r);switch(a){case 0:{let t=r;switch(o){case"bigint":a=8,t=r.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+o);t=null;break;case"undefined":return s([-1],r)}return s([a,t],r)}case 1:{if(o){let e=r;return"DataView"===o?e=new Uint8Array(r.buffer):"ArrayBuffer"===o&&(e=new Uint8Array(r)),s([o,[...e]],r)}const e=[],t=s([a,e],r);for(const n of r)e.push(i(n));return t}case 2:{if(o)switch(o){case"BigInt":return s([o,r.toString()],r);case"Boolean":case"Number":case"String":return s([o,r.valueOf()],r)}if(t&&"toJSON"in r)return i(r.toJSON());const n=[],l=s([a,n],r);for(const t of Yx(r))!e&&Xx(Jx(r[t]))||n.push([i(t),i(r[t])]);return l}case 3:return s([a,r.toISOString()],r);case 4:{const{source:e,flags:t}=r;return s([a,{source:e,flags:t}],r)}case 5:{const t=[],n=s([a,t],r);for(const[s,a]of r)(e||!Xx(Jx(s))&&!Xx(Jx(a)))&&t.push([i(s),i(a)]);return n}case 6:{const t=[],n=s([a,t],r);for(const s of r)!e&&Xx(Jx(s))||t.push(i(s));return n}}const{message:l}=r;return s([a,{name:o,message:l}],r)};return i})(!(t||n),!!t,new Map,r)(e),r},Zx="function"===typeof structuredClone?(e,t)=>t&&("json"in t||"lossy"in t)?Gx($x(e,t)):structuredClone(e):(e,t)=>Gx($x(e,t));function ey(e){const t=[];let n=-1,r=0,s=0;for(;++n<e.length;){const i=e.charCodeAt(n);let a="";if(37===i&&cv(e.charCodeAt(n+1))&&cv(e.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(a=String.fromCharCode(i));else if(i>55295&&i<57344){const t=e.charCodeAt(n+1);i<56320&&t>56319&&t<57344?(a=String.fromCharCode(i,t),s=1):a="\ufffd"}else a=String.fromCharCode(i);a&&(t.push(e.slice(r,n),encodeURIComponent(a)),r=n+s+1,a=""),s&&(n+=s,s=0)}return t.join("")+e.slice(r)}function ty(e,t){const n=[{type:"text",value:"\u21a9"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function ny(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}const ry=function(e){if(null===e||void 0===e)return iy;if("function"===typeof e)return sy(e);if("object"===typeof e)return Array.isArray(e)?function(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=ry(e[n]);return sy(r);function r(){let e=-1;for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];for(;++e<t.length;)if(t[e].apply(this,r))return!0;return!1}}(e):function(e){const t=e;return sy(n);function n(n){const r=n;let s;for(s in e)if(r[s]!==t[s])return!1;return!0}}(e);if("string"===typeof e)return function(e){return sy(t);function t(t){return t&&t.type===e}}(e);throw new Error("Expected function, string, or object as test")};function sy(e){return function(t,n,r){return Boolean(ay(t)&&e.call(this,t,"number"===typeof n?n:void 0,r||void 0))}}function iy(){return!0}function ay(e){return null!==e&&"object"===typeof e&&"type"in e}const oy=[],ly=!0,cy=!1;function uy(e,t,n,r){let s;"function"===typeof t&&"function"!==typeof n?(r=n,n=t):s=t;const i=ry(s),a=r?-1:1;!function e(s,o,l){const c=s&&"object"===typeof s?s:{};if("string"===typeof c.type){const e="string"===typeof c.tagName?c.tagName:"string"===typeof c.name?c.name:void 0;Object.defineProperty(u,"name",{value:"node ("+s.type+(e?"<"+e+">":"")+")"})}return u;function u(){let c,u,d,h=oy;if((!t||i(s,o,l[l.length-1]||void 0))&&(h=function(e){if(Array.isArray(e))return e;if("number"===typeof e)return[ly,e];return null===e||void 0===e?oy:[e]}(n(s,l)),h[0]===cy))return h;if("children"in s&&s.children){const t=s;if(t.children&&"skip"!==h[0])for(u=(r?t.children.length:-1)+a,d=l.concat(t);u>-1&&u<t.children.length;){const n=t.children[u];if(c=e(n,u,d)(),c[0]===cy)return c;u="number"===typeof c[1]?c[1]:u+a}}return h}}(e,void 0,[])()}function dy(e,t,n,r){let s,i,a;"function"===typeof t&&"function"!==typeof n?(i=void 0,a=t,s=n):(i=t,a=n,s=r),uy(e,i,(function(e,t){const n=t[t.length-1],r=n?n.children.indexOf(e):void 0;return a(e,r,n)}),s)}function hy(e,t){const n=t.referenceType;let r="]";if("collapsed"===n?r+="[]":"full"===n&&(r+="["+(t.label||t.identifier)+"]"),"imageReference"===t.type)return[{type:"text",value:"!["+t.alt+r}];const s=e.all(t),i=s[0];i&&"text"===i.type?i.value="["+i.value:s.unshift({type:"text",value:"["});const a=s[s.length-1];return a&&"text"===a.type?a.value+=r:s.push({type:"text",value:r}),s}function my(e){const t=e.spread;return null===t||void 0===t?e.children.length>1:t}function fy(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),s=0;const i=[];for(;r;)i.push(py(t.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(t);return i.push(py(t.slice(s),s>0,!1)),i.join("")}function py(e,t,n){let r=0,s=e.length;if(t){let t=e.codePointAt(r);for(;9===t||32===t;)r++,t=e.codePointAt(r)}if(n){let t=e.codePointAt(s-1);for(;9===t||32===t;)s--,t=e.codePointAt(s-1)}return s>r?e.slice(r,s):""}const gy={blockquote:function(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)},break:function(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:"\n"}]},code:function(e,t){const n=t.value?t.value+"\n":"",r={};t.lang&&(r.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s},delete:function(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},emphasis:function(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},footnoteReference:function(e,t){const n="string"===typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),s=ey(r.toLowerCase()),i=e.footnoteOrder.indexOf(r);let a,o=e.footnoteCounts.get(r);void 0===o?(o=0,e.footnoteOrder.push(r),a=e.footnoteOrder.length):a=i+1,o+=1,e.footnoteCounts.set(r,o);const l={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(o>1?"-"+o:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(a)}]};e.patch(t,l);const c={type:"element",tagName:"sup",properties:{},children:[l]};return e.patch(t,c),e.applyData(t,c)},heading:function(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},html:function(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}},imageReference:function(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return hy(e,t);const s={src:ey(r.url||""),alt:t.alt};null!==r.title&&void 0!==r.title&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,i),e.applyData(t,i)},image:function(e,t){const n={src:ey(t.url)};null!==t.alt&&void 0!==t.alt&&(n.alt=t.alt),null!==t.title&&void 0!==t.title&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)},inlineCode:function(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)},linkReference:function(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return hy(e,t);const s={href:ey(r.url||"")};null!==r.title&&void 0!==r.title&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)},link:function(e,t){const n={href:ey(t.url)};null!==t.title&&void 0!==t.title&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)},listItem:function(e,t,n){const r=e.all(t),s=n?function(e){let t=!1;if("list"===e.type){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=my(n[r])}return t}(n):my(t),i={},a=[];if("boolean"===typeof t.checked){const e=r[0];let n;e&&"element"===e.type&&"p"===e.tagName?n=e:(n={type:"element",tagName:"p",properties:{},children:[]},r.unshift(n)),n.children.length>0&&n.children.unshift({type:"text",value:" "}),n.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let o=-1;for(;++o<r.length;){const e=r[o];(s||0!==o||"element"!==e.type||"p"!==e.tagName)&&a.push({type:"text",value:"\n"}),"element"!==e.type||"p"!==e.tagName||s?a.push(e):a.push(...e.children)}const l=r[r.length-1];l&&(s||"element"!==l.type||"p"!==l.tagName)&&a.push({type:"text",value:"\n"});const c={type:"element",tagName:"li",properties:i,children:a};return e.patch(t,c),e.applyData(t,c)},list:function(e,t){const n={},r=e.all(t);let s=-1;for("number"===typeof t.start&&1!==t.start&&(n.start=t.start);++s<r.length;){const e=r[s];if("element"===e.type&&"li"===e.tagName&&e.properties&&Array.isArray(e.properties.className)&&e.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,i),e.applyData(t,i)},paragraph:function(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},root:function(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)},strong:function(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},table:function(e,t){const n=e.all(t),r=n.shift(),s=[];if(r){const n={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],n),s.push(n)}if(n.length>0){const r={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},i=Eg(t.children[1]),a=Cg(t.children[t.children.length-1]);i&&a&&(r.position={start:i,end:a}),s.push(r)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,i),e.applyData(t,i)},tableCell:function(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)},tableRow:function(e,t,n){const r=n?n.children:void 0,s=0===(r?r.indexOf(t):1)?"th":"td",i=n&&"table"===n.type?n.align:void 0,a=i?i.length:t.children.length;let o=-1;const l=[];for(;++o<a;){const n=t.children[o],r={},a=i?i[o]:void 0;a&&(r.align=a);let c={type:"element",tagName:s,properties:r,children:[]};n&&(c.children=e.all(n),e.patch(n,c),c=e.applyData(n,c)),l.push(c)}const c={type:"element",tagName:"tr",properties:{},children:e.wrap(l,!0)};return e.patch(t,c),e.applyData(t,c)},text:function(e,t){const n={type:"text",value:fy(String(t.value))};return e.patch(t,n),e.applyData(t,n)},thematicBreak:function(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)},toml:vy,yaml:vy,definition:vy,footnoteDefinition:vy};function vy(){}const xy=["children"],yy={}.hasOwnProperty,by={};function wy(e,t){e.position&&(t.position=function(e){const t=Eg(e),n=Cg(e);if(t&&n)return{start:t,end:n}}(e))}function Dy(e,t){let n=t;if(e&&e.data){const t=e.data.hName,r=e.data.hChildren,s=e.data.hProperties;if("string"===typeof t)if("element"===n.type)n.tagName=t;else{n={type:"element",tagName:t,properties:{},children:"children"in n?n.children:[n]}}"element"===n.type&&s&&Object.assign(n.properties,Zx(s)),"children"in n&&n.children&&null!==r&&void 0!==r&&(n.children=r)}return n}function Ny(e,t){const n=t.data||{},r=!("value"in t)||yy.call(n,"hProperties")||yy.call(n,"hChildren")?{type:"element",tagName:"div",properties:{},children:e.all(t)}:{type:"text",value:t.value};return e.patch(t,r),e.applyData(t,r)}function jy(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:"\n"});++r<e.length;)r&&n.push({type:"text",value:"\n"}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:"\n"}),n}function Cy(e){let t=0,n=e.charCodeAt(t);for(;9===n||32===n;)t++,n=e.charCodeAt(t);return e.slice(t)}function Ey(e,t){const n=function(e,t){const n=t||by,r=new Map,s=new Map,i=new Map,l=(0,o.A)((0,o.A)({},gy),n.handlers),c={all:function(e){const t=[];if("children"in e){const n=e.children;let r=-1;for(;++r<n.length;){const s=c.one(n[r],e);if(s){if(r&&"break"===n[r-1].type&&(Array.isArray(s)||"text"!==s.type||(s.value=Cy(s.value)),!Array.isArray(s)&&"element"===s.type)){const e=s.children[0];e&&"text"===e.type&&(e.value=Cy(e.value))}Array.isArray(s)?t.push(...s):t.push(s)}}}return t},applyData:Dy,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:l,one:function(e,t){const n=e.type,r=c.handlers[n];if(yy.call(c.handlers,n)&&r)return r(c,e,t);if(c.options.passThrough&&c.options.passThrough.includes(n)){if("children"in e){const{children:t}=e,n=(0,a.A)(e,xy),r=Zx(n);return r.children=c.all(e),r}return Zx(e)}return(c.options.unknownHandler||Ny)(c,e,t)},options:n,patch:wy,wrap:jy};return dy(e,(function(e){if("definition"===e.type||"footnoteDefinition"===e.type){const t="definition"===e.type?r:s,n=String(e.identifier).toUpperCase();t.has(n)||t.set(n,e)}})),c}(e,t),r=n.one(e,void 0),s=function(e){const t="string"===typeof e.options.clobberPrefix?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||ty,r=e.options.footnoteBackLabel||ny,s=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",a=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<e.footnoteOrder.length;){const s=e.footnoteById.get(e.footnoteOrder[c]);if(!s)continue;const i=e.all(s),a=String(s.identifier).toUpperCase(),o=ey(a.toLowerCase());let u=0;const d=[],h=e.footnoteCounts.get(a);for(;void 0!==h&&++u<=h;){d.length>0&&d.push({type:"text",value:" "});let e="string"===typeof n?n:n(c,u);"string"===typeof e&&(e={type:"text",value:e}),d.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+o+(u>1?"-"+u:""),dataFootnoteBackref:"",ariaLabel:"string"===typeof r?r:r(c,u),className:["data-footnote-backref"]},children:Array.isArray(e)?e:[e]})}const m=i[i.length-1];if(m&&"element"===m.type&&"p"===m.tagName){const e=m.children[m.children.length-1];e&&"text"===e.type?e.value+=" ":m.children.push({type:"text",value:" "}),m.children.push(...d)}else i.push(...d);const f={type:"element",tagName:"li",properties:{id:t+"fn-"+o},children:e.wrap(i,!0)};e.patch(s,f),l.push(f)}if(0!==l.length)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:(0,o.A)((0,o.A)({},Zx(a)),{},{id:"footnote-label"}),children:[{type:"text",value:s}]},{type:"text",value:"\n"},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:"\n"}]}}(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:"\n"},s),i}function Ay(e,t){return e&&"run"in e?async function(n,r){const s=Ey(n,(0,o.A)({file:r},t));await e.run(s,r)}:function(n,r){return Ey(n,(0,o.A)({file:r},e||t))}}function ky(e){if(e)throw e}var Sy=n(3240);function Fy(e){if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function _y(){const e=[],t={run:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];let s=-1;const i=n.pop();if("function"!==typeof i)throw new TypeError("Expected function as last argument, not "+i);!function t(r){const a=e[++s];let o=-1;if(r)i(r);else{for(var l=arguments.length,c=new Array(l>1?l-1:0),u=1;u<l;u++)c[u-1]=arguments[u];for(;++o<n.length;)null!==c[o]&&void 0!==c[o]||(c[o]=n[o]);n=c,a?function(e,t){let n;return s;function s(){for(var t=arguments.length,s=new Array(t),o=0;o<t;o++)s[o]=arguments[o];const l=e.length>s.length;let c;l&&s.push(i);try{c=e.apply(this,s)}catch(r){if(l&&n)throw r;return i(r)}l||(c&&c.then&&"function"===typeof c.then?c.then(a,i):c instanceof Error?i(c):a(c))}function i(e){if(!n){n=!0;for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];t(e,...s)}}function a(e){i(null,e)}}(a,t)(...c):i(null,...c)}}(null,...n)},use:function(n){if("function"!==typeof n)throw new TypeError("Expected `middelware` to be a function, not "+n);return e.push(n),t}};return t}const Ty={basename:function(e,t){if(void 0!==t&&"string"!==typeof t)throw new TypeError('"ext" argument must be a string');Iy(e);let n,r=0,s=-1,i=e.length;if(void 0===t||0===t.length||t.length>e.length){for(;i--;)if(47===e.codePointAt(i)){if(n){r=i+1;break}}else s<0&&(n=!0,s=i+1);return s<0?"":e.slice(r,s)}if(t===e)return"";let a=-1,o=t.length-1;for(;i--;)if(47===e.codePointAt(i)){if(n){r=i+1;break}}else a<0&&(n=!0,a=i+1),o>-1&&(e.codePointAt(i)===t.codePointAt(o--)?o<0&&(s=i):(o=-1,s=a));r===s?s=a:s<0&&(s=e.length);return e.slice(r,s)},dirname:function(e){if(Iy(e),0===e.length)return".";let t,n=-1,r=e.length;for(;--r;)if(47===e.codePointAt(r)){if(t){n=r;break}}else t||(t=!0);return n<0?47===e.codePointAt(0)?"/":".":1===n&&47===e.codePointAt(0)?"//":e.slice(0,n)},extname:function(e){Iy(e);let t,n=e.length,r=-1,s=0,i=-1,a=0;for(;n--;){const o=e.codePointAt(n);if(47!==o)r<0&&(t=!0,r=n+1),46===o?i<0?i=n:1!==a&&(a=1):i>-1&&(a=-1);else if(t){s=n+1;break}}if(i<0||r<0||0===a||1===a&&i===r-1&&i===s+1)return"";return e.slice(i,r)},join:function(){let e,t=-1;for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];for(;++t<r.length;)Iy(r[t]),r[t]&&(e=void 0===e?r[t]:e+"/"+r[t]);return void 0===e?".":function(e){Iy(e);const t=47===e.codePointAt(0);let n=function(e,t){let n,r,s="",i=0,a=-1,o=0,l=-1;for(;++l<=e.length;){if(l<e.length)n=e.codePointAt(l);else{if(47===n)break;n=47}if(47===n){if(a===l-1||1===o);else if(a!==l-1&&2===o){if(s.length<2||2!==i||46!==s.codePointAt(s.length-1)||46!==s.codePointAt(s.length-2))if(s.length>2){if(r=s.lastIndexOf("/"),r!==s.length-1){r<0?(s="",i=0):(s=s.slice(0,r),i=s.length-1-s.lastIndexOf("/")),a=l,o=0;continue}}else if(s.length>0){s="",i=0,a=l,o=0;continue}t&&(s=s.length>0?s+"/..":"..",i=2)}else s.length>0?s+="/"+e.slice(a+1,l):s=e.slice(a+1,l),i=l-a-1;a=l,o=0}else 46===n&&o>-1?o++:o=-1}return s}(e,!t);0!==n.length||t||(n=".");n.length>0&&47===e.codePointAt(e.length-1)&&(n+="/");return t?"/"+n:n}(e)},sep:"/"};function Iy(e){if("string"!==typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const Ry={cwd:function(){return"/"}};function Py(e){return Boolean(null!==e&&"object"===typeof e&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&void 0===e.auth)}function Oy(e){if("string"===typeof e)e=new URL(e);else if(!Py(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if("file:"!==e.protocol){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return function(e){if(""!==e.hostname){const e=new TypeError('File URL host must be "localhost" or empty on darwin');throw e.code="ERR_INVALID_FILE_URL_HOST",e}const t=e.pathname;let n=-1;for(;++n<t.length;)if(37===t.codePointAt(n)&&50===t.codePointAt(n+1)){const e=t.codePointAt(n+2);if(70===e||102===e){const e=new TypeError("File URL path must not include encoded / characters");throw e.code="ERR_INVALID_FILE_URL_PATH",e}}return decodeURIComponent(t)}(e)}const My=["history","path","basename","stem","extname","dirname"];class Ly{constructor(e){let t;t=e?Py(e)?{path:e}:"string"===typeof e||function(e){return Boolean(e&&"object"===typeof e&&"byteLength"in e&&"byteOffset"in e)}(e)?{value:e}:e:{},this.cwd="cwd"in t?"":Ry.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n,r=-1;for(;++r<My.length;){const e=My[r];e in t&&void 0!==t[e]&&null!==t[e]&&(this[e]="history"===e?[...t[e]]:t[e])}for(n in t)My.includes(n)||(this[n]=t[n])}get basename(){return"string"===typeof this.path?Ty.basename(this.path):void 0}set basename(e){zy(e,"basename"),By(e,"basename"),this.path=Ty.join(this.dirname||"",e)}get dirname(){return"string"===typeof this.path?Ty.dirname(this.path):void 0}set dirname(e){Uy(this.basename,"dirname"),this.path=Ty.join(e||"",this.basename)}get extname(){return"string"===typeof this.path?Ty.extname(this.path):void 0}set extname(e){if(By(e,"extname"),Uy(this.dirname,"extname"),e){if(46!==e.codePointAt(0))throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Ty.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){Py(e)&&(e=Oy(e)),zy(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return"string"===typeof this.path?Ty.basename(this.path,this.extname):void 0}set stem(e){zy(e,"stem"),By(e,"stem"),this.path=Ty.join(this.dirname||"",e+(this.extname||""))}fail(e,t,n){const r=this.message(e,t,n);throw r.fatal=!0,r}info(e,t,n){const r=this.message(e,t,n);return r.fatal=void 0,r}message(e,t,n){const r=new Tg(e,t,n);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(e){if(void 0===this.value)return"";if("string"===typeof this.value)return this.value;return new TextDecoder(e||void 0).decode(this.value)}}function By(e,t){if(e&&e.includes(Ty.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+Ty.sep+"`")}function zy(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Uy(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}const qy=function(e){const t=this.constructor.prototype,n=t[e],r=function(){return n.apply(r,arguments)};return Object.setPrototypeOf(r,t),r},Vy={}.hasOwnProperty;class Hy extends qy{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=_y()}copy(){const e=new Hy;let t=-1;for(;++t<this.attachers.length;){const n=this.attachers[t];e.use(...n)}return e.data(Sy(!0,{},this.namespace)),e}data(e,t){return"string"===typeof e?2===arguments.length?(Qy("data",this.frozen),this.namespace[e]=t,this):Vy.call(this.namespace,e)&&this.namespace[e]||void 0:e?(Qy("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[t,...n]=this.attachers[this.freezeIndex];if(!1===n[0])continue;!0===n[0]&&(n[0]=void 0);const r=t.call(e,...n);"function"===typeof r&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const t=Xy(e),n=this.parser||this.Parser;return Gy("parse",n),n(String(t),t)}process(e,t){const n=this;return this.freeze(),Gy("process",this.parser||this.Parser),Ky("process",this.compiler||this.Compiler),t?r(void 0,t):new Promise(r);function r(r,s){const i=Xy(e),a=n.parse(i);function o(e,n){e||!n?s(e):r?r(n):t(void 0,n)}n.run(a,i,(function(e,t,r){if(e||!t||!r)return o(e);const s=t,i=n.stringify(s,r);var a;"string"===typeof(a=i)||function(e){return Boolean(e&&"object"===typeof e&&"byteLength"in e&&"byteOffset"in e)}(a)?r.value=i:r.result=i,o(e,r)}))}}processSync(e){let t,n=!1;return this.freeze(),Gy("processSync",this.parser||this.Parser),Ky("processSync",this.compiler||this.Compiler),this.process(e,(function(e,r){n=!0,ky(e),t=r})),Jy("processSync","process",n),t}run(e,t,n){Yy(e),this.freeze();const r=this.transformers;return n||"function"!==typeof t||(n=t,t=void 0),n?s(void 0,n):new Promise(s);function s(s,i){const a=Xy(t);r.run(e,a,(function(t,r,a){const o=r||e;t?i(t):s?s(o):n(void 0,o,a)}))}}runSync(e,t){let n,r=!1;return this.run(e,t,(function(e,t){ky(e),n=t,r=!0})),Jy("runSync","run",r),n}stringify(e,t){this.freeze();const n=Xy(t),r=this.compiler||this.Compiler;return Ky("stringify",r),Yy(e),r(e,n)}use(e){const t=this.attachers,n=this.namespace;if(Qy("use",this.frozen),null===e||void 0===e);else if("function"===typeof e){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];c(e,s)}else{if("object"!==typeof e)throw new TypeError("Expected usable value, not `"+e+"`");Array.isArray(e)?l(e):o(e)}return this;function a(e){if("function"===typeof e)c(e,[]);else{if("object"!==typeof e)throw new TypeError("Expected usable value, not `"+e+"`");if(Array.isArray(e)){const[t,...n]=e;c(t,n)}else o(e)}}function o(e){if(!("plugins"in e)&&!("settings"in e))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(e.plugins),e.settings&&(n.settings=Sy(!0,n.settings,e.settings))}function l(e){let t=-1;if(null===e||void 0===e);else{if(!Array.isArray(e))throw new TypeError("Expected a list of plugins, not `"+e+"`");for(;++t<e.length;){a(e[t])}}}function c(e,n){let r=-1,s=-1;for(;++r<t.length;)if(t[r][0]===e){s=r;break}if(-1===s)t.push([e,...n]);else if(n.length>0){let[r,...i]=n;const a=t[s][1];Fy(a)&&Fy(r)&&(r=Sy(!0,a,r)),t[s]=[e,r,...i]}}}}const Wy=(new Hy).freeze();function Gy(e,t){if("function"!==typeof t)throw new TypeError("Cannot `"+e+"` without `parser`")}function Ky(e,t){if("function"!==typeof t)throw new TypeError("Cannot `"+e+"` without `compiler`")}function Qy(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function Yy(e){if(!Fy(e)||"string"!==typeof e.type)throw new TypeError("Expected node, got `"+e+"`")}function Jy(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Xy(e){return function(e){return Boolean(e&&"object"===typeof e&&"message"in e&&"messages"in e)}(e)?e:new Ly(e)}const $y=[],Zy={allowDangerousHtml:!0},eb=/^(https?|ircs?|mailto|xmpp)$/i,tb=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function nb(e){const t=rb(e),n=sb(e);return ib(t.runSync(t.parse(n),n),e)}function rb(e){const t=e.rehypePlugins||$y,n=e.remarkPlugins||$y,r=e.remarkRehypeOptions?(0,o.A)((0,o.A)({},e.remarkRehypeOptions),Zy):Zy;return Wy().use(Hx).use(n).use(Ay,r).use(t)}function sb(e){const t=e.children||"",n=new Ly;return"string"===typeof t&&(n.value=t),n}function ib(e,t){const n=t.allowedElements,r=t.allowElement,s=t.components,i=t.disallowedElements,a=t.skipHtml,o=t.unwrapDisallowed,l=t.urlTransform||ab;for(const c of tb)Object.hasOwn(t,c.from)&&(c.from,c.to&&c.to,c.id);return dy(e,(function(e,t,s){if("raw"===e.type&&s&&"number"===typeof t)return a?s.children.splice(t,1):s.children[t]={type:"text",value:e.value},t;if("element"===e.type){let t;for(t in Yg)if(Object.hasOwn(Yg,t)&&Object.hasOwn(e.properties,t)){const n=e.properties[t],r=Yg[t];(null===r||r.includes(e.tagName))&&(e.properties[t]=l(String(n||""),t,e))}}if("element"===e.type){let a=n?!n.includes(e.tagName):!!i&&i.includes(e.tagName);if(!a&&r&&"number"===typeof t&&(a=!r(e,t,s)),a&&s&&"number"===typeof t)return o&&e.children?s.children.splice(t,1,...e.children):s.children.splice(t,1),t}})),Bg(e,{Fragment:Et.Fragment,components:s,ignoreInvalidStyle:!0,jsx:Et.jsx,jsxs:Et.jsxs,passKeys:!0,passNode:!0})}function ab(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),s=e.indexOf("/");return-1===t||-1!==s&&t>s||-1!==n&&t>n||-1!==r&&t>r||eb.test(e.slice(0,t))?e:""}const ob=()=>{const[e,t]=(0,r.useState)(null),[n,s]=(0,r.useState)(!0),[i,a]=(0,r.useState)(null),[o,l]=(0,r.useState)(!1),{resourceId:c}=he(),u=de();(0,r.useEffect)((()=>{(async()=>{try{const e=(0,Dt.H9)(wt.db,"learningResources",c),n=await(0,Dt.x7)(e);n.exists()?t(n.data()):a("Resource not found"),s(!1)}catch(gb){console.error("Error fetching resource:",gb),a("Failed to load resource"),s(!1)}})()}),[c]);return n?(0,Et.jsx)("div",{className:"flex-1 flex justify-center items-center p-4",children:(0,Et.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):i||!e?(0,Et.jsx)("div",{className:"flex-1 p-4",children:(0,Et.jsxs)("div",{className:"text-center p-8 bg-red-50 rounded-lg",children:[(0,Et.jsx)("p",{className:"text-red-600",children:i||"Resource not available"}),(0,Et.jsx)("button",{className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg",onClick:()=>u("/knowledge/resources"),children:"Back to Resources"})]})}):(0,Et.jsxs)("div",{className:"flex-1 p-4 max-w-4xl mx-auto",children:[(0,Et.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Et.jsx)("button",{className:"mr-2 p-2 hover:bg-gray-100 rounded-full",onClick:()=>u("/knowledge/resources"),children:(0,Et.jsx)(op,{size:20})}),(0,Et.jsxs)("span",{className:"text-sm text-gray-500",children:["Learning Resources / ",e.category]})]}),(0,Et.jsxs)("div",{className:"mb-8",children:[(0,Et.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:e.title}),(0,Et.jsxs)("div",{className:"flex flex-wrap items-center text-sm text-gray-600 mb-4 gap-4",children:[e.author&&(0,Et.jsxs)("span",{children:["By ",e.author]}),e.updatedAt&&(0,Et.jsxs)("span",{children:["Updated: ",(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})(e.updatedAt)]}),(0,Et.jsx)("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded-full",children:e.category})]}),e.description&&(0,Et.jsx)("p",{className:"text-lg text-gray-600 italic mb-6",children:e.description}),(0,Et.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>{l(!o)},className:o?"bg-blue-50":"",children:[(0,Et.jsx)(vi,{size:16,className:"mr-1 ".concat(o?"fill-blue-500 text-blue-500":"")}),o?"Bookmarked":"Bookmark"]}),(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>{navigator.share?navigator.share({title:e.title,text:e.description,url:window.location.href}).catch((e=>{console.error("Error sharing:",e)})):navigator.clipboard.writeText(window.location.href).then((()=>{alert("Link copied to clipboard!")}))},children:[(0,Et.jsx)(Ep,{size:16,className:"mr-1"}),"Share"]}),(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",onClick:()=>{window.print()},children:[(0,Et.jsx)(Mp,{size:16,className:"mr-1"}),"Print"]}),e.downloadUrl&&(0,Et.jsxs)(Kc,{variant:"outline",size:"sm",as:"a",href:e.downloadUrl,download:!0,children:[(0,Et.jsx)(Nc,{size:16,className:"mr-1"}),"Download"]})]})]}),e.imageUrl&&(0,Et.jsx)("div",{className:"mb-8",children:(0,Et.jsx)("img",{src:e.imageUrl,alt:e.title,className:"w-full rounded-lg shadow-md object-cover max-h-96"})}),(0,Et.jsx)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-8",children:(()=>{const t=e.content;if(!t)return null;switch(e.contentType){case"markdown":return(0,Et.jsx)("div",{className:"prose max-w-none",children:(0,Et.jsx)(nb,{children:t})});case"html":return(0,Et.jsx)("div",{dangerouslySetInnerHTML:{__html:t}});case"image":return(0,Et.jsx)("div",{className:"flex justify-center",children:(0,Et.jsx)("img",{src:t,alt:e.title,className:"max-w-full rounded-lg shadow-md"})});case"iframe":return(0,Et.jsx)("div",{className:"aspect-w-16 aspect-h-9 rounded-lg overflow-hidden",children:(0,Et.jsx)("iframe",{src:t,title:e.title,className:"w-full h-full border-0",allowFullScreen:!0})});default:return(0,Et.jsx)("p",{className:"text-gray-700",children:t})}})()}),e.relatedResources&&e.relatedResources.length>0&&(0,Et.jsxs)("div",{className:"mb-8",children:[(0,Et.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Related Resources"}),(0,Et.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.relatedResources.map(((e,t)=>(0,Et.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 cursor-pointer",onClick:()=>u("/knowledge/resources/".concat(e)),children:(0,Et.jsxs)("div",{className:"flex items-center",children:[(0,Et.jsx)(vu,{size:18,className:"text-blue-500 mr-2"}),(0,Et.jsx)("span",{className:"text-blue-600 hover:underline",children:e})]})},t)))})]}),(0,Et.jsxs)("div",{className:"border-t border-gray-200 pt-4 flex flex-wrap items-center justify-between text-sm",children:[(0,Et.jsxs)("div",{className:"flex items-center gap-6",children:[(0,Et.jsxs)("button",{className:"flex items-center text-gray-600 hover:text-blue-600",children:[(0,Et.jsx)(Lp,{size:16,className:"mr-1"}),"Helpful"]}),(0,Et.jsxs)("button",{className:"flex items-center text-gray-600 hover:text-blue-600",children:[(0,Et.jsx)(Fi,{size:16,className:"mr-1"}),"Feedback"]})]}),(0,Et.jsx)("span",{className:"text-gray-500",children:e.viewCount?"".concat(e.viewCount.toLocaleString()," views"):"New content"})]})]})};function lb(){return(0,r.useEffect)((()=>{const e=()=>{const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",(()=>{setTimeout(e,200)})),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}),[]),null}function cb(){const{user:e}=kt();return(0,r.useEffect)((()=>{e&&(console.log("User authenticated, initializing push notifications..."),Xc.default.initPushNotifications().then((()=>{console.log("Push notifications initialized successfully")})).catch((e=>{console.error("Error initializing push notifications:",e)})))}),[e]),null}function ub(){const e=le(),[t,n]=(0,r.useState)(""),{user:s}=kt(),i=Ct();return(0,r.useEffect)((()=>{const e=localStorage.getItem("instructorAccessError");if(e){n(e),localStorage.removeItem("instructorAccessError");const t=setTimeout((()=>{n("")}),5e3);return()=>clearTimeout(t)}}),[e.pathname]),i&&s&&!s.emailVerified?(0,Et.jsx)(Ae,{to:"/verify-email"}):(0,Et.jsxs)(ap,{children:[t&&(0,Et.jsx)("div",{className:"fixed top-4 right-4 z-50 bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded shadow-lg",children:(0,Et.jsx)("p",{children:t})}),(0,Et.jsxs)(Fe,{children:[(0,Et.jsx)(ke,{path:"/",element:(0,Et.jsx)($f,{})}),(0,Et.jsx)(ke,{path:"/profile",element:(0,Et.jsx)(Ss,{})}),(0,Et.jsx)(ke,{path:"/buddy/:userId",element:(0,Et.jsx)(tf,{})}),(0,Et.jsx)(ke,{path:"/logbook",element:(0,Et.jsx)(ki,{})}),(0,Et.jsx)(ke,{path:"/training",element:(0,Et.jsx)(nu,{})}),(0,Et.jsx)(ke,{path:"/travel",element:(0,Et.jsx)(dp,{})}),(0,Et.jsx)(ke,{path:"/messages",element:(0,Et.jsx)(Zm,{})}),(0,Et.jsx)(ke,{path:"/buddies",element:(0,Et.jsx)(ef,{})}),(0,Et.jsx)(ke,{path:"/rewards",element:(0,Et.jsx)(cp,{})}),(0,Et.jsx)(ke,{path:"/admin",element:(0,Et.jsx)(Ru,{})}),(0,Et.jsx)(ke,{path:"/instructor",element:(0,Et.jsx)(ru,{children:(0,Et.jsx)(pu,{})})}),(0,Et.jsx)(ke,{path:"/loyalty",element:(0,Et.jsx)(lf,{children:(0,Et.jsx)(of,{})})}),(0,Et.jsx)(ke,{path:"/team",element:(0,Et.jsx)(df,{children:(0,Et.jsx)(Jf,{})})}),(0,Et.jsx)(ke,{path:"/knowledge/*",element:(0,Et.jsx)(Ip,{})}),(0,Et.jsx)(ke,{path:"/knowledge/resources",element:(0,Et.jsx)(Op,{})}),(0,Et.jsx)(ke,{path:"/knowledge/resources/:resourceId",element:(0,Et.jsx)(ob,{})}),(0,Et.jsx)(ke,{path:"*",element:(0,Et.jsx)(Ae,{to:"/"})})]})]})}function db(){const{user:e}=kt(),t=Ct();return console.log("Current user state:",e),console.log("Current path:",window.location.pathname),console.log("Email verification required:",t),e?t&&e&&!e.emailVerified?(0,Et.jsxs)(Fe,{children:[(0,Et.jsx)(ke,{path:"/verify-email",element:(0,Et.jsx)(Is,{})}),(0,Et.jsx)(ke,{path:"*",element:(0,Et.jsx)(Ae,{to:"/verify-email"})})]}):(0,Et.jsx)(ub,{}):(0,Et.jsx)("div",{className:"min-h-screen-safe bg-gray-100 smooth-scroll",children:(0,Et.jsxs)(Fe,{children:[(0,Et.jsx)(ke,{path:"/register",element:(0,Et.jsx)(_s,{})}),(0,Et.jsx)(ke,{path:"/forgot-password",element:(0,Et.jsx)(Ts,{})}),(0,Et.jsx)(ke,{path:"*",element:(0,Et.jsx)(Fs,{})})]})})}const hb=function(){return(0,Et.jsx)(St,{children:(0,Et.jsx)(ui,{children:(0,Et.jsxs)(dt,{children:[(0,Et.jsx)(lb,{}),(0,Et.jsx)(cb,{}),(0,Et.jsx)("div",{className:"no-tap-highlight smooth-scroll no-overscroll",children:(0,Et.jsx)(db,{})})]})})})},mb="v1.0.2",fb=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function pb(e,t){navigator.serviceWorker.register(e).then((e=>{setInterval((()=>{console.log("Checking for app updates..."),e.update()}),36e5),e.onupdatefound=()=>{const n=e.installing;null!=n&&(n.onstatechange=()=>{"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content (".concat(mb,") is available.")),caches.keys().then((e=>Promise.all(e.map((e=>(console.log("Deleting cache:",e),caches.delete(e))))).then((()=>{console.log("Caches cleared, reloading page"),window.location.reload(!0)})))),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content (".concat(mb,") is cached for offline use.")),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}window.addEventListener("error",(function(e){console.error("Global error:",e.message,e.filename,e.lineno)}));try{console.log("Initializing React app...");const e=document.getElementById("root");if(e)try{console.log("Using React 18 createRoot...");i.createRoot(e).render((0,Et.jsx)(hb,{})),console.log("React 18 rendering complete.")}catch(gb){console.error("Error with React 18 method:",gb)}else console.error("Root element not found!"),document.body.innerHTML='<div style="padding:20px">Error: Root element not found</div>'}catch(gb){console.error("Critical initialization error:",gb),document.body.innerHTML='<div style="padding:20px">Critical error: '+gb.message+"</div>"}!function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="".concat("","/service-worker.js?v=").concat(mb);fb?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((n=>{const r=n.headers.get("content-type");404===n.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):pb(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):pb(t,e)}))}}()})()})();
//# sourceMappingURL=main.27c39710.js.map